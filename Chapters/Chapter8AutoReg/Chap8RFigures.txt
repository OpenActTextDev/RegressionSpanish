## FILENAME IS Chap8RFigures.txt 
library(HH)
setwd("c://BOOK3//CUPBook//Chapter8AutoReg")
#setwd("R://BOOK3//CUPBook//Chapter8AutoReg")

# Figure 8.1
# Input filename is Chapter8Figure1,2,4&5data.txt;

inflation = read.table(choose.files(),  quote = "",header=TRUE)
#inflation1 = read.csv(choose.files(),  quote = "",header=TRUE)
attach(inflation)

par(cex=1.3, mar=c(4.1,2.8,1.8,.2))
plot(YEAR,INFBOND, type="o", pch=20, ylim=c(1.5,3), las=1, ylab="", xlab="Year")
mtext("Index", side=2, las=1, at=3.15, cex=1.3, adj=1.2)
export.eps("InfBondTS.eps", width=6,height=4)
dev.off()

# Figure 8.2
par(cex=1.3, mar=c(4.1,2.8,1.8,.2))
plot(LAGINFBOND,INFBOND,  xlim=c(1.5,3), ylim=c(1.5,3), xlab="Lagged Index", ylab="", las=1)
mtext("Inflation Bond Index", side=2, at=3.15, las=1,cex=1.3, adj=.2)
export.eps("InfBondLag.eps", width=5,height=4)
dev.off()

detach(inflation)


# Figure 8.3
# Input filename is Chapter8Figure3data.txt;

exchange = read.table(choose.files(),  quote = "",header=TRUE)

par(cex=1.3, mar=c(4.2,2.9,1.2,.2))
plot(exchange$LAGEXHK, exchange$EXHKUS, xlim=c(7.75,7.82), ylim=c(7.75,7.82), xlab="Lagged Exchange Rate", ylab="",las=1)
mtext("Exchange Rate", side=2, at=7.827, las=1,cex=1.3,adj=.45)
export.eps("HKLag.eps", width=5,height=4)
dev.off()

# Figure 8.4
# Input filename is Chapter8Figure1,2,4&5data.txt;

inflation = read.table(choose.files(),  quote = "",header=TRUE)
attach(inflation)


par(cex=1.3, mar=c(4.1,2.8,1.8,.2))
plot(TIME,et,type="o",ylim=c(-.6,.6),las=1,yaxt="n",pch=19,ylab="")
axis(2, at=seq(-.6,.6,.3),las=1)
abline(h=0)
abline(h=-0.012879373+3*.14,lty=2)
abline(h=-0.012879373-3*.14,lty=2)
export.eps("InfBondControl.eps", width=6,height=4)
dev.off()

# Figure 8.5
#  Input filename is  Chapter8Figure1,2,4&5data.txt;

par(cex=1.3, mar=c(4.1,2.8,1.8,.2))
plot(YEAR,INFBOND,type="o",ylim=c(1.5,3.1),las=1,pch=19,ylab="")
par(new=TRUE)
plot(YEAR,indext,type="o",ylim=c(1.5,3.1),las=1,yaxt="n",ylab="",pch=1)
legend(2006.3,2.99,pch=c(19,1),c("INFBOND", "SMOOTH"), bty="n", cex=.7)
export.eps("InfBondSmooth.eps", width=6,height=4)
dev.off()

detach(inflation)

# Figure 8.6
# Input filename is  Chapter8Figure6data.txt;

inflationF = read.table(choose.files(),  quote = "",header=TRUE)
attach(inflationF)

par(cex=1.3, mar=c(4.1,2.7,1.4,.2))
plot(YEAR, INFBOND, pch=20,xlim=c(2003,2008), ylim=c(1.5,3), xlab="Year", ylab="",las=1)
mtext("Bond Index", side=2, las=1, at=3.15, adj=.55, cex=1.3)
par(new=TRUE)
plot(YEAR, LowerForInt, type="l",xlim=c(2003,2008), ylim=c(1.5,3), xlab="", ylab="", xaxt="n", yaxt="n")
par(new=TRUE)
plot(YEAR, UpperForeInt, type="l",lty=2,xlim=c(2003,2008), 
   ylim=c(1.5,3), xlab="", ylab="", xaxt="n", yaxt="n")
export.eps("InfBondForInt.eps", width=6,height=4)

dev.off()
detach(inflationF)

# Figure 8.7
# Input filename is  Chapter8Figure7data.txt;

exchangeF = read.table(choose.files(),  quote = "",header=TRUE)

par(mar=c(4.1,3.2,1.4,.2), cex=1)
x <- exchangeF$EXHKUS-exchangeF$REGRFITS
plot.ts(x, type="o", las=1, xlab="Index", ylab="", cex.lab=1.3)
mtext("Residuals", side=2, las=1, cex=1.3, at=0.019, adj=0.4)
export.eps("HKResids.eps", width=6,height=4)
dev.off()

#  Need Code For Figure 8.8



# Exercise 8.9 Figure
# Input filename is  Chapter8Exercise9data.txt

exchangeN = read.table(choose.files(),  quote = "",header=TRUE)

par(mar=c(3.1,3.2,1.6,.2))
plot.ts(exchangeN$vwretd, xlim=c(0,500), type="o", pch=20, 
     las=1, ylab="", xlab="")
mtext("Value Weighted Return", side=2, las=1, cex=1.3, at=.0245, adj=0.25)
mtext("Index", side=1, line=2, cex=1.3)
export.eps("ValueWgtReturn.eps", width=8,height=4)

dev.off()
detach(exchange)

# Figure 1

#setwd("R://Book3//CUPBook//Chapter21Graphs")
setwd("c://Book3//CUPBook//Chapter21Graphs")
library(HH)
postscript("Fig21_1FlowChart.ps")

x <- 100; y <- 100
par(mar=c(0,0,0,0), cex=1.2)
plot(x,y, xlim=c(0.03,4.51), ylim=c(1.14,2.53), ylab="", xlab="", bty="n", axes=FALSE )
text(.5,2.5, "Interpretation")
text(0,2, "Data")
text(1,2, "Encoding")
text(2,2, "Graph")
text(3,2, "Decoding")
text(4.2,2, "Interpretation")
text(1,1.15, "Sender")
text(3.5,1.15, "Receiver")
arrows(.2,2,.65,2, code=2,length=.1)
arrows(1.35,2,1.75,2, code=2,length=.1)
arrows(2.25,2,2.65,2, code=2,length=.1)
arrows(3.35,2,3.7,2, code=2,length=.1)
arrows(.45,2.4,.45,2.05, code=2,length=.1)

a <- c(-.1,2.2);b <- c(1.5,1.5)
lines(a,b, lty=2)

a <- c(2.7,4.65);b <- c(1.5,1.5)
lines(a,b, lty=2)

a <- c(-.1,-.1);b <- c(1.85,1.5)
lines(a,b, lty=2)

a <- c(2.2,2.2);b <- c(1.85,1.5)
lines(a,b, lty=2)

a <- c(2.7,2.7);b <- c(1.85,1.5)
lines(a,b, lty=2)

a <- c(4.65,4.65);b <- c(1.85,1.5)
lines(a,b, lty=2)

dev.off()

# Figure 2
# FILENAME is Figure2data.txt;
insur = read.table(choose.files(),  quote = "",header=TRUE)
attach(insur)
#postscript("Fig21_2InsurEmploy.ps")

par(cex=1.3, mar=c(4.1,3.1,2.5,1))
plot(YEAR,INSUR, type="l", ylim=c(0,1.6), xlab="Year", ylab="", las = 1)
  mtext("Insurance \n Employees", side=2, at=1.83 ,las=1, cex=1.2, adj=.7)
export.eps("Fig21_2InsurEmploya.eps", width=4,height=4) 
  plot(YEAR,INSUR, type="l", xlab="Year", las = 1, ylab="")
  mtext("Insurance \n Employees", side=2, at=1.593, las=1, adj=.7, cex=1.2)
export.eps("Fig21_2InsurEmployb.eps", width=4,height=4) 
dev.off()
detach(insur)

#Figure 3
# FILENAME is Figure3data.txt;

FC = read.table(choose.files(), quote="", header=TRUE)
attach(FC)
#postscript("Fig21_3FirmRMcostvsSize.ps")

par(cex=1.3, mar=c(4.1,3.1,1.4,1))
plot(SIZELOG, COSTLOG, xlim=c(5,11), ylim=c(-2,5), xlab="Logarithmic Firm Size", ylab="", las=1)
mtext("Firm Cost", side=2, las=1, at=5.7, cex=1.3, adj=.7)
export.eps("Fig21_3FirmRMcostvsSizea.eps", width=4,height=4) 
plot(SIZELOG, COSTLOG, xlim=c(0,15), ylim=c(-10,10), xlab="Logarithmic Firm Size", ylab="", las=1)
mtext("Firm Cost", side=2, las=1, at=12, cex=1.3, adj=.7)
export.eps("Fig21_3FirmRMcostvsSizeb.eps", width=4,height=4) 
dev.off()
detach(FC)

# Figure 4
# FILENAME is Figure4data.txt;

inforce = read.table(choose.files(),  quote = "",header=TRUE)
attach(inforce)

LOGYEAR= log(YEAR)
LOGINFORCE= log(INFORCE)
#  postscript("Fig21_4InsurInForce.ps")

par(cex=1.3, mar=c(4.1,4.1,2.4,1))
plot(YEAR,INFORCE, type="o", pch=20, yaxt="n", xlab="Year",ylab="", cex.axis=.9)
axis(2, at=seq(0,200000,100000), labels=c("0", "100,000", "200,000"), las = 1, cex.axis=.9)
mtext("Insurance \nIn Force", side=2, las=1, at=294000, cex=1.2, adj=.9)
export.eps("Fig21_4InsurInForcea.eps", width=4,height=4) 

plot(LOGYEAR,LOGINFORCE, type="o", pch=20,yaxt="n", xaxt="n", xlab="Year",ylab="", cex.axis=.9,ylim=c(7.5,12.5))
axis(2, at=seq(7.5,12.1,2), labels=c("1000", "10,000", "100,000"), las =1, cex.axis=.9)
mtext("Insurance \n In Force", side=2, las=1, at=13.3, cex=1.2, adj=.9)
axis(1, at=seq(7.575,7.595,.005), labels=c("1950", "1960", "1970", "1980", "1990"), cex.axis=.9)
export.eps("Fig21_4InsurInForceb.eps", width=4,height=4) 
dev.off()
detach(inforce)

# Figure 5
# FILENAME is Figure5data.txt;

cpi = read.table(choose.files(),  quote = "",header=TRUE)
attach(cpi)
#  postscript("Fig21_5CPI.ps")
par( mar=c(4.1,3,1.8,3), cex=1.2)
plot(YEAR, CPI_U, type="l", xlim=c(1945, 1995), ylim=c(20,170), xaxt="n", yaxt="n", ylab="")
axis(1, at=seq(1945,1995,10), labels=c("1945", "1955", "1965", "1975", "1985", "1995"))
axis(2, at=seq(20,170,50), labels=c("20","70", "120", "170"), las =1)
mtext("CPI_U", side=2, las=1, at=184, cex=1.2)
text(1980, 110, "CPI_U", cex=.9)
text(1990,80, "CPI_M", cex=.9)
par(new=TRUE)
plot(YEAR, CPI_M, type="l", ann=FALSE, axes = FALSE, ylim=c(0, 250))
axis(4, las=1)
mtext("CPI_M", side=4, las=1, at=275, cex=1.2)
export.eps("Fig21_5CPIa.eps", width=4,height=4) 

plot(YEAR, CPI_U, type="l", xlim=c(1945, 1995), ylim=c(0,250), xaxt="n", yaxt="n", ylab="")
axis(1, at=seq(1945,1995,10), labels=c("1945", "1955", "1965", "1975", "1985", "1995"))
axis(2, at=seq(0,250,50), labels=c("0","50", "100", "150", "200", "250"), las =1)
mtext("CPI_U", side=2, las=1, at=275, cex=1.2)
text(1958, 50, "CPI_U", cex=.9)
text(1975,10, "CPI_M", cex=.9)
par(new=TRUE)
plot(YEAR, CPI_M, type="l", ann=FALSE, axes = FALSE, ylim=c(0, 250))
axis(4, las=1)
mtext("CPI_M", side=4, las=1, at=275, cex=1.2)
export.eps("Fig21_5CPIb.eps", width=4,height=4) 

dev.off()
detach(cpi)

# Figure 6
# FILENAME is Figure6data.txt;

unemploy = read.table(choose.files(),  quote = "",header=TRUE)
attach(unemploy)

postscript("Fig21_6tsUnemploy.ps")
layout(matrix(c(1,2)), heights=c(3,1.3))
par(mar=c(4,3,2,.2), cex=1.3)

plot.ts(YEAR,UNEMPLOY, type="l", ylab="", xlim=c(1950, 1993), ylim=c(2,11), las=1)
axis(2, at=seq(3,11,2), labels=c("3", "5", "7", "9", "11"), las=1)
mtext("Unemployment", side=2, las=1, at=12, adj=.5, cex=1.3)

par(mar=c(4,3,2,.2), cex=1.3)
plot.ts(YEAR,UNEMPLOY, type="l", ylab="", xlim=c(1950, 1993), ylim=c(2,11), las=1, yaxt="n")
axis(2, at=seq(2,11,4), labels=c("2", "6", "10"), las=1)
mtext("Unemployment", side=2, las=1, at=16, adj=.5, cex=1.3)

dev.off()
detach(unemploy)

# Figure 7
# FILENAME is Figure7data.txt;

# The following code draws a 2-d bar chart
# FILENAME is Figure7adata.txt;
#premiumA = read.table(choose.files(),  quote = "",header=TRUE)
#attach(premiumA)

#m <- as.matrix(premiumA)
#barplot(t(m[,2:4]), yaxt="n")
#axis(2, at=seq(0,100,20), labels=c("0%", "20%", "40%", "60%", "80%", "100%"), las=1)
#axis(1, at=c(.7,1.8,3,4.3,5.7), labels=c("1973", "1978", "1983", "1988", "1993"))

#detach(premiumA)
#dev.off()


#premium = read.table(choose.files(),  quote = "",header=TRUE)


Year <- rep(seq(1973 , 1993, 5),each=3);Year
PerCent <- c(31.9, 13.9, 54.2, 32.8, 20.7, 46.5,
             32.1, 25.7, 42.2, 22.8, 45.1, 32.1,
             21.4, 49.0, 29.6)          
Line <- rep(1:3,5);Line
premium <-data.frame(cbind(Year,PerCent,Line));premium
attach(premium)

Line1 <- subset(premium, Line==1)
Line2 <- subset(premium, Line==2)
Line3 <- subset(premium, Line==3)

#postscript("Fig21_7bDotPlotPremiumReceipts.ps")
par(mar=c(4.1,3,2.7,.2), cex=1.3)
dotchart(Line1$PerCent, xlab="Per Cent of Premium Receipts", las=1, xaxt=NULL, xlim=c(10,60))
#mtext("Distribution of Premium Receipts \n of U.S. Life Insurance Companies",
#        side=3, cex=1.4, line=.5)
mtext("Year", side=2, at=6.3, las=1, cex=1.3, adj=1.5)
par(new=TRUE)
dotchart(Line2$PerCent, pch=3, xlab=NULL, xlim=c(10,60), lcolor = "red")
par(new=TRUE)
dotchart(Line3$PerCent, pch=4, xlab=NULL, xlim=c(10,60))
axis(2, at=seq(1,5,1), labels=c("1973", "1978","1983","1988","1993"), las=1)
legend(50,3.5, c("Health", "Annuity", "Life"), pch=c(1,3,4),cex=.9,y.intersp=1.5)    
#bty="n",box.lwd=2,)
export.eps("Fig21_7bDotPlotPremiumReceipts.eps", width=6,height=4) 
dev.off()
detach(premium)

# Figure 8
# FILENAME is Figure8data.txt;

risk = read.table(choose.files(),  quote = "",header=TRUE)
attach(risk)

postscript("Fig21_8MultipleDotPlots1.ps")
par(mfrow=c(4,1))

q1s1 <- subset(risk, q==1 & Source==1)
q1s2 <- subset(risk, q==1 & Source==2)
q1s3 <- subset(risk, q==1 & Source==3)
par(mar=c(1,12,3,.2))
dotchart(q1s1$Prop, xlim=c(0,100), pch=5)
par(new=TRUE)
dotchart(q1s2$Prop, xlim=c(0,100), pch=20)
par(new=TRUE)
dotchart(q1s3$Prop, xlim=c(0,100), pch=4)
mtext("Expected Year \nUntil Disaster", side=2, las=1, at=5, cex=.9, adj=.7)
axis(2, at=seq(1,3,1), labels=c("10", "50", "500"), las=1)
mtext("Disaster Probability", side=2, at=2.5, las=1, cex=.8, adj=1.25)
mtext("q = 0", side=2, at=1.5,las=1, cex=.7, adj=4)

q2s1 <- subset(risk, q==2 & Source==1)
q2s2 <- subset(risk, q==2 & Source==2)
q2s3 <- subset(risk, q==2 & Source==3)
par(mar=c(2,12,2,.2))
dotchart(q2s1$Prop, xlim=c(0,100), pch=5)
par(new=TRUE)
dotchart(q2s2$Prop, xlim=c(0,100), pch=20)
par(new=TRUE)
dotchart(q2s3$Prop, xlim=c(0,100), pch=4)
axis(2, at=seq(1,3,1), labels=c("10", "50", "500"), las=1)
mtext("q = 0.02", side=2, at=2,las=1, cex=.7, adj=2.5)

q3s1 <- subset(risk, q==3 & Source==1)
q3s2 <- subset(risk, q==3 & Source==2)
q3s3 <- subset(risk, q==3 & Source==3)
par(mar=c(2,12,2,.2))
dotchart(q3s1$Prop, xlim=c(0,100), pch=5)
par(new=TRUE)
dotchart(q3s2$Prop, xlim=c(0,100), pch=20)
par(new=TRUE)
dotchart(q3s3$Prop, xlim=c(0,100), pch=4)
axis(2, at=seq(1,3,1), labels=c("10", "50", "500"), las=1)
mtext("q = 0.20", side=2, at=2,las=1, cex=.7, adj=2.5)

q4s1 <- subset(risk, q==4 & Source==1)
q4s2 <- subset(risk, q==4 & Source==2)
q4s3 <- subset(risk, q==4 & Source==3)
par(mar=c(4,12,1,.2))
dotchart(q4s1$Prop, xlim=c(0,100), pch=5)
par(new=TRUE)
dotchart(q4s2$Prop, xlim=c(0,100), pch=20)
par(new=TRUE)
dotchart(q4s3$Prop, xlim=c(0,100), pch=4)
axis(2, at=seq(1,3,1), labels=c("10", "50", "500"), las=1)
mtext("q = 1.0", side=2, at=2,las=1, cex=.7, adj=3)
mtext("Proportion of Variability of Claim Amounts", cex=.9, side=1, line=2.8)

dev.off()
detach(risk)

# Figure 8 LEGEND

setwd("f:")
postscript("Fig21_8LEGEND.ps")

par(mar=c(0,0,0,0), cex=1.3)
plot(.2,.8,xlim=c(.15,.7), pch=5, ylim=c(0,.9), axes=FALSE)
par(new=TRUE)
plot(.2,.5, xlim=c(.15,.7), pch=19, ylim=c(0,.9), axes=FALSE)
par(new=TRUE)
plot(.2,.2, xlim=c(.15,.7), pch=4, ylim=c(0,.9), axes=FALSE)
text(.5,.8,"Interest")
text(.5,.5,"Disaster")
text(.5,.2,"Mortality")

dev.off()


# Figure 9
# FILENAME is Figure9data.txt;

discharge = read.table(choose.files(),  quote = "",header=TRUE)
attach(discharge)
#  postscript("Fig21_9PlotsLogCostDischarge.ps")

par(mar=c(4.15,3,2.2,2), cex=1.2)
lnNUM= log(NO_DSCHG)
lnCOST= log(CHG_NUM)
plot(lnNUM, lnCOST, xlim=c(0,9), ylim=c(6,10), xlab="Logarithmic Number of Discharges", 
     las=1, ylab="", cex=.8)
axis(1, at=seq(1,9,2), labels=c("1", "3", "5", "7", "9"))
mtext("Logarithmic Cost \n Per Discharge", side=2, las=1, at=10.55, adj=.4, cex=1.2)
export.eps("Fig21_9PlotsLogCostDischargea.eps", width=5,height=4) 

plot(lnNUM, lnCOST, xlim=c(0,9), ylim=c(6,10), xlab="Logarithmic Number of Discharges", 
     las=1, ylab="", pch=as.numeric(DRGCODE), cex=.8)
axis(1, at=seq(1,9,2), labels=c("1", "3", "5", "7", "9"))
mtext("Logarithmic Cost \n Per Discharge", side=2, las=1, at=10.55, adj=.4, cex=1.2)
legend(0.1,8.1, c("209", "391", "430"), pch=1:3, cex=.70, y.intersp=1.5, 
         text.width=1.1)#x.intersp=.8)#bty="n", 
export.eps("Fig21_9PlotsLogCostDischargeb.eps", width=5,height=4) 
dev.off()
detach(discharge)

# Figure 10
# FILENAME is Figure10data.txt and Figure10bdata.txt;

setwd("f:")
inflationa = read.table(choose.files(),  quote = "",header=TRUE)
inflationb = read.table(choose.files(),  quote = "",header=TRUE)
inflationc = read.table(choose.files(),  quote = "",header=TRUE)

postscript("Fig21_10InflationWithProjections.ps")

par(mar=c(4.1,2,2,2.8), cex=1.3)
plot(inflationa$time1, y=inflationa$obser, xaxt="n",  xlab="Year", ylab="", las=1, xlim=c(1975, 2005), type="l", bty="l")
mtext("Inflation", side=2, las=1, at=4.5, cex=1.6, adj=.5)
axis(1, at=seq(1975,2005,10))

par(new=TRUE)
plot(inflationb$time2, inflationb$low, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", lwd=2, ylim=c(-.6,4), bty="l")

par(new=TRUE)
plot(inflationb$time2, inflationb$high, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", lwd=2, ylim=c(-.6,4), bty="l")

par(new=TRUE)
plot(inflationb$time2, inflationb$intermed, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", lwd=2, ylim=c(-.6,4), bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X5.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X95.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X15.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X85.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X25.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X75.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X35.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X65.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X45.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")

par(new=TRUE)
plot(inflationc$time3, inflationc$X55.ile, xlab="", ylab="", xaxt="n", yaxt="n", xlim=c(1975,2005), type="l", ylim=c(-.6,4), lty=6, bty="l")
par(cex=1.1,las=1)
mtext("90% P.I.", side=4, at=2.6)
mtext("70% P.I.", side=4, at=2)
mtext("50% P.I.", side=4, at=1.65)
mtext("30% P.I.", side=4, at=1.4)
mtext("10% P.I.", side=4, at=1.2)

dev.off()

# Figure 11
setwd("f:")

postscript("Fig21_11aExperiments.ps")
x <- c(35,50,65,80)
y <- c(1,2,3,4)
par(mar=c(4.1,3.9,1.2,1), cex=2)
plot(x,y, xlim=c(0,100), ylim=c(0,5),xaxt="n", yaxt="n", ylab="", xlab="Y", pch=19, xaxs="i")
mtext("CATEGORY", side=2, at=5.4, las=1, cex=2, adj=.7)
axis(1, at=seq(0,100,100), labels=c("0", "100"),tcl=0)
axis(2, at=seq(1,4,1), labels=c("D", "C", "B", "A"),tcl=.5, las=1)
axis(4, at=seq(1,4,1), tcl=.5,labels=c("", "", "", ""))

dev.off()

postscript("Fig21_11bExperiments.ps")

par(mar=c(19,1,1,1), cex=2, mfrow=c(1,4))
x <- 80
y <- 4
plot(x,y, xaxt="n", yaxt="n", xlim=c(0,100), ylim=c(0,5), xlab="", ylab="", pch=19, xaxs="i")
axis(1, at=seq(0,100,100), labels=c("0", "100"),tcl=0)
axis(2, at=seq(1,4,1), labels=c("", "", "", ""),tcl=.5, las=1)
axis(4, at=seq(1,4,1), tcl=.5,labels=c("", "", "", ""))
text(70,4,"A", cex=6)

#postscript("Fig21_11bExperiments2.ps")

x <- 65
y <- 3
par(mar=c(14,1,6,1))
plot(x,y, xaxt="n", yaxt="n", xlim=c(0,100), ylim=c(0,5), xlab="", ylab="", pch=19, xaxs="i")
axis(1, at=seq(0,100,100), labels=c("0", "100"),tcl=0)
axis(2, at=seq(1,4,1), labels=c("", "", "", ""),tcl=.5, las=1)
axis(4, at=seq(1,4,1), tcl=.5,labels=c("", "", "", ""))
text(50,3,"B", cex=6)

#postscript("Fig21_11bExperiments3.ps")

x <- 50
y <- 2
par(mar=c(9,1,11,1))
plot(x,y, xaxt="n", yaxt="n", xlim=c(0,100), ylim=c(0,5), xlab="", ylab="", pch=19, xaxs="i")
axis(1, at=seq(0,100,100), labels=c("0", "100"),tcl=0)
axis(2, at=seq(1,4,1), labels=c("", "", "", ""),tcl=.5, las=1)
axis(4, at=seq(1,4,1), tcl=.5,labels=c("", "", "", ""))
text(67,2,"C", cex=6)

#postscript("Fig21_11bExperiments4.ps")

x <- 35
y <- 1
par(mar=c(4,1,16,1))
plot(x,y, xaxt="n", yaxt="n", xlim=c(0,100), ylim=c(0,5), xlab="", ylab="", pch=19, xaxs="i")
axis(1, at=seq(0,100,100), labels=c("0", "100"),tcl=0)
axis(2, at=seq(1,4,1), labels=c("", "", "", ""),tcl=.5, las=1)
axis(4, at=seq(1,4,1), tcl=.5,labels=c("", "", "", ""))
text(55,1,"D", cex=6)

dev.off()

#postscript("Fig21_11cExperiments.ps")
par(mar=c(0,0,0,0))
y <- c(40,120)
x <- c(1.2,1.2)
plot(x,y, type="l", xlim=c(.95,4.05), ylim=c(0,120), xlab="", ylab="", axes=FALSE)
text(1.2,25,"A", cex=6)
par(new=TRUE)
y <- c(30,80)
x <- c(2.1,2.1)
plot(x,y, type="l", xlim=c(.95,4.05), ylim=c(0,120),xlab="", ylab="", axes=FALSE)
text(2.1,14,"B", cex=6)
par(new=TRUE)
y <- c(60,120)
x <- c(3,3)
plot(x,y, type="l", xlim=c(.95,4.05), ylim=c(0,120), xlab="", ylab="", axes=FALSE)
text(3,45,"C", cex=6)
par(new=TRUE)
y <- c(28,110)
x <- c(3.8,3.8)
plot(x,y, type="l", xlim=c(.95,4.05), ylim=c(0,120), xlab="", ylab="", axes=FALSE)
text(3.8,13,"D", cex=6)
dev.off()

postscript("Fig21_11dExperiments.ps")

x <- c(.1,.1,.25)
y <- c(.7,.1,.67)

par(mar=c(0,0,0,0))
plot(x,y, type="l", axes=FALSE, xlim=c(.09,.91), ylim=c(.09,.91))
text(.13,.39,"A", cex=3)

a <- c(.25,.6,.27)
b <- c(.85,.9,.63)
par(new=TRUE)
plot(a,b, type="l", axes=FALSE, xlim=c(.09,.91), ylim=c(.09,.91))
text(.39,.81,"B", cex=3)

c <- c(.74,.4,.7)
d <- c(.55,.5,.2)
par(new=TRUE)
plot(c,d, type="l", axes=FALSE, xlim=c(.09,.91), ylim=c(.09,.91))
text(.56,.43,"C", cex=3)

e <- c(.76,.9,.9)
f <- c(.3,.8,.2)
par(new=TRUE)
plot(e,f, type="l", axes=FALSE, xlim=c(.09,.91), ylim=c(.09,.91))
text(.86,.5,"D", cex=3)

dev.off()

#postscript("Fig21_11eExperiments.ps")
par(mar=c(0,0,0,0))
x <- c(15,33,55,80)
y <- c(2.5,3.8,2.7,3.5)
z <- c(8,6,3,11)
symbols(x,y,circles= (z/4),xlim=c(0,100), ylim=c(1.3,5),xlab="", ylab="", axes=FALSE)
text(15,2.5,"A")
text(33,3.8,"B")
text(55,2.7,"C")
text(80,3.5,"D")

# Figure 12
# FILENAME is Figure13data.txt;
library(plotrix)

x1973 <- c(0.675, 0.249, 0.076)
namesx <- c("Commercial","1-4 Family","Farm" )
par(cex=1.3, mar=c(2, 0, 2, 0) + 0.1)
pie3D(x1973, start=pi/2,
  col=color.scale(x1973,c(1,1,1),c(1,1,1),c(1,0,1)))

text(-0.1,1.15, "1973",     cex =2.6)
text(0.3,0.75, "Farm - 8 %",     cex =1.6)
text(1.2,0.5, "1-4 Family",     cex =1.6)
text(1.3,0.3, "- 25 %",     cex =1.6)
text(-0.6,-1.1, "Commercial - 67 %",     cex =1.6)

export.eps("F21Mortgage73.eps", width=5,height=5) 
dev.off()

x1983 <- c(0.813, 0.101, 0.086)
par(cex=1.3, mar=c(2, 0, 2, 0) + 0.1)
pie3D(x1983, start=pi/2,
  col=color.scale(x1983,c(1,1,1),c(1,1,1),c(1,0,1)))

text(-0.1,1.15, "1983",     cex =2.6)
text(0.3,0.75, "Farm - 9 %",     cex =1.6)
text(1.2,0.5, "1-4 Family",     cex =1.6)
text(1.3,0.3, "- 10 %",     cex =1.6)
text(-0.6,-1.1, "Commercial - 81 %",     cex =1.6)

export.eps("F21Mortgage83.eps", width=5,height=5) 
dev.off()

par(cex=1.3, mar=c(2, 0, 2, 0) + 0.1)
x1993 <- c(0.917,0.041,0.042)
pie3D(x1993, start=pi/2,
  col=color.scale(x1993,c(1,1,1),c(1,1,1),c(1,0,1)))

text(-0.1,1.15, "1993",     cex =2.6)
text(0.3,0.75, "Farm - 4 %",     cex =1.6)
text(1.2,0.5, "1-4 Family",     cex =1.6)
text(1.3,0.3, "- 4 %",     cex =1.6)
text(-0.6,-1.1, "Commercial - 92 %",     cex =1.6)

export.eps("F21Mortgage93.eps", width=5,height=5) 
dev.off()

# Figure 13
# FILENAME is Figure13data.txt;

mortgage= read.table(choose.files(),  quote = "",header=TRUE)
attach(mortgage)

Comm <- subset(mortgage, Type==1)
Fam <- subset(mortgage, Type==2)
Farm <- subset(mortgage, Type==3)

#postscript("Fig21_13DotPlotPerCentMortgages.ps")

par(mar=c(4.2,3.1,1.2,.1), cex=1.3)
dotchart(Comm$PerCent, xlab="Per Cent of Mortgages", las=1, xaxt=NULL, xlim=c(0,100))
mtext("Year", side=2, at=4.1, las=1, cex=1.3, adj=1.2)
axis(1, at=seq(10,90,10))
par(new=TRUE)
dotchart(Fam$PerCent, pch=3, xlab=NULL, xlim=c(0,100))
axis(1, at=seq(10,90,10))
par(new=TRUE)
dotchart(Farm$PerCent, pch=4, xlab=NULL, xlim=c(0,100))
axis(2, at=seq(1,3,1), labels=c("1973","1983","1993"), las=1)
axis(1, at=seq(10,90,10))
legend(40,4.0, c("Commercial", "1-4 Family", "Farm"), pch=c(1,3,4),cex=1,
   y.intersp=1.1, text.width=25)
export.eps("Fig21_13DotPlotPerCentMortgages.eps", width=6,height=6) 
dev.off()

#  try something new....
library(Hmisc)
par(mar=c(4.2,3.1,1.2,.1), cex=1.3)
dotchart2(Comm$PerCent, xlab="Per Cent of Mortgages", 
 las=1, xaxt=NULL, yaxt=NULL, xlim=c(0,100),xaxis=FALSE, labels=NULL)
mtext("Year", side=2, at=3.15, las=1, cex=1.3, adj=0.7)
axis(1, at=seq(00,100,20))
#axis(1, at=seq(10,90,10))
par(new=TRUE)
dotchart2(Fam$PerCent, pch=3, xlab=NULL, xlim=c(0,100))
axis(1, at=seq(00,100,20))
par(new=TRUE)
dotchart2(Farm$PerCent, pch=4, xlab=NULL, xlim=c(0,100), 
     lty=1, lwd=8,lcolor="black")
axis(2, at=seq(1,3,1), labels=c("1973","1983","1993"), las=1)
axis(1, at=seq(00,100,20))
legend(40,3.0, c("Commercial", "1-4 Family", "Farm"), pch=c(1,3,4),cex=1,
   y.intersp=1.1, text.width=25)

export.eps("Fig21_13DotPlotPerCentMortgages.eps", width=6,height=6) 
dev.off()

detach(mortgage)






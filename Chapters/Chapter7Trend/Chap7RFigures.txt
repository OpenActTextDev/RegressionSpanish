## FILENAME IS Chap7RFigures.txt 

setwd("c://BOOK3//CUPBook//Chapter7Trend")
#setwd("R://BOOK3//CUPBook//Chapter7Trend")

library(HH)
#  Input file is SpuriousCorrelations.txt
Spur1 = read.table(choose.files(),  quote = "",header=TRUE)
TIME=Spur1$t
Sxt=Spur1$Sxt
Syt=Spur1$Syt

par(mfrow=c(1, 2), mar=c(4.1,3.1,1.7,1), cex=1.1)
plot(TIME,Sxt, type="l", ylim=c(0,35), ylab="", xlab="Time", las=1)
lines(TIME,Syt)
text(30, 25, expression(x[t]), cex=1.2)
text(40, 15, expression(y[t]), cex=1.2)
plot(Sxt, Syt, ylab="", las=1, xlab=expression(x[t]))
mtext(expression(y[t]), side=2, las=1, at=37.35, cex=1.3, adj=2.3)
export.eps("Figure71SpurCorr.eps", width=8,height=4)

dev.off()



# Figure 7.2
# Input file is Components.txt;

Data1 = read.table(choose.files(),  quote = "",header=TRUE)
names(Data1)
TIME=Data1$TIME
TREND=Data1$TREND
SEASON=Data1$SEASON
RANDOM=Data1$RANDOM
SUM=Data1$SUM

par(mfrow=c(2, 2), mar=c(4,2,2,1), cex=0.6)
plot(TIME, TREND, type="l", ylim=c(-2, 8), xlab="", ylab="", las=1)
mtext("Trend", side=2, las=1, at=10,adj=0.2)
par(mar=c(4,3,2,.1), cex=0.6)
plot(TIME, SEASON, type="l", ylim=c(-2, 8), xlab="", ylab="", las=1)
mtext("Season", side=2, las=1, at=10, adj=.6)
par(mar=c(4.1,2,2,1), cex=0.6)
plot(TIME, RANDOM, type="l", ylim=c(-2, 8), ylab="", xlab="Time", 
      las=1,cex.lab=1.5)
mtext("Random", side=2, las=1, at=10, adj=.2)
par(mar=c(4,3,2,.1), cex=0.6)
plot(TIME, SUM, type="l", ylim=c(-2, 8), ylab="", xlab="Time", 
     las=1,cex.lab=1.5)
mtext("Sum", side=2, las=1, at=10)
export.eps("Components.eps", width=6,height=4)
dev.off()

# Figure 7.3
# Input file is Chapter7Figure3data.txt;


exchange = read.table(choose.files(),  quote = "",header=TRUE)
attach(exchange)

par(cex=1.1, mar=c(2.2,3,.2,1.3))
plot.ts(EXHKUS, type="l", ylim=c(7.74,7.84), las=1, ylab="", xaxt="n",xlab="")
axis(1, at=seq(0,550,65), labels=c("Feb-05", "May-05", 
   "Sep-05", "Dec-05", "Mar-06", "Jul-06", "Oct-06", 
   "Jan-07", "Apr-07"), cex=.7)
par(new=TRUE)
plot.ts(REGRFITS, type="l", ylim=c(7.74,7.84), 
    las=1, ylab="", xaxt="n",xlab="")
export.eps("HKFits.eps", width=6,height=4)
dev.off()
detach(exchange)


#  Figure 7.4
#  Input file is  RegimeSwitch.txt;

RegimeSwitch1 = read.table(choose.files(),  quote = "",header=TRUE)
names(RegimeSwitch1)
TIME=RegimeSwitch1$TIME
YT=RegimeSwitch1$YT


par(mar=c(4.1,.1,.1,.1), cex=1.3)
plot(TIME,YT,yaxt="n",  ylab="", xlab="Time",cex.lab=1.3)
abline(3, 0, lty=2)
abline(8, 0, lty=2)
text(1.5, 2.5, expression(beta[0]), cex=1.0)
text(1.5, 8.5, expression(beta[0]+beta[1]), cex=1.0)
export.eps("RegimeSwitch.eps", width=8,height=4)
dev.off()

#  Figure 7.5
#  Input file is WiscVotes.txt;

WVote1 = read.table(choose.files(),  quote = "",header=TRUE)
names(WVote1)
YEAR=WVote1$YEAR
QUALPCNT=WVote1$QUALPCNT
FITS=WVote1$FITS

par(mar=c(4.1,3.1,2,1), cex=1.1)
plot(YEAR,QUALPCNT, type="p", pch=19, xlab="Year", ylab="", las=1)
lines(YEAR,FITS, lty=2)
mtext("Percentage", side=2, las=1, at=77, cex=1.1, adj=.5)
export.eps("WiscVotes.eps", width=6,height=4)
dev.off()


# Figure 7.6
# Input file is RandomWalkDice.txt;

RWDice1= read.table(choose.files(),  quote = "",header=TRUE)
names(RWDice1)
t=RWDice1$t
Ct=RWDice1$Ct

par(mar=c(4.1,3.1,2,.1), cex=1.1)
plot(t,Ct, type="b", pch=19, xlab="Time", ylab="", cex.lab=1.2,las=1)
mtext(expression(y[t]), side=2, at=110, cex=1.5, las=1, adj=2.5)
export.eps("RWDice.eps", width=6,height=4)
dev.off()

# Figure 7.7
# Input file is Chapter7Figure7&8data.txt;

labor = read.table(choose.files(),  quote = "",header=TRUE)
attach(labor)

par(cex=1.1, mar=c(4.1,2.8,.2,.2))
plot.ts(MSC6U, type="o", pch=20, ylim=c(-.2,.8), las=1, ylab="", xlab="Year", xlim=c(-2,33), xaxt="n")
par(new=TRUE)
plot.ts(Diff, type="o", ylim=c(-.2,.8), las=1, xlab="", xlim=c(-2,33), xaxt="n", ylab="")
axis(1, at=seq(-2,33,5), labels=c("1965", "1970", "1975", "1980", "1985", "1990", "1995", "2000"))
legend(0,.77,pch=c(20,1),c("LFPR", "Differences"), bty="n", cex=.9)
export.eps("LFPR.eps", width=6,height=4)
dev.off()



# Figure 7.8
# Input file is Chapter7Figure8b.txt

labor2 = read.table(choose.files(),  quote = "",header=TRUE)

par(cex=1.1, mar=c(4.1,2.7,.2,.2))
plot(labor$YEAR, labor$MSC6U,pch=20, type="o", ylim=c(.2,.8), las=1, ylab="", 
    xlab="Year", xlim=c(1965,2005), yaxt="n", xaxt="n")
axis(1, at=seq(1965,2005,5))
axis(2, at=seq(.2,.8,.2), las=1)
par(new=TRUE)
plot(labor2$YEAR,labor2$Lower, pch=20,type="o", ylim=c(.2,.8), ylab="", xlab="", xlim=c(1965,2005), xaxt="n", yaxt="n")
par(new=TRUE)
plot(labor2$YEAR,labor2$Upper, pch=20,type="o", ylim=c(.2,.8), ylab="", xlab="", xlim=c(1965,2005), xaxt="n", yaxt="n")
par(new=TRUE)
plot(labor2$YEAR,labor2$Middle, pch=20,type="o", ylim=c(.2,.8), ylab="", xlab="", xlim=c(1965,2005), xaxt="n", yaxt="n")

export.eps("LFPRFore.eps", width=6,height=4)
dev.off()
detach(labor)

# Figure 7.9
# Input file is SandPQuarterly.txt

SandPQ1= read.table(choose.files(),  quote = "",header=TRUE)
names(SandPQ1)
YEAR=SandPQ1$YEAR

par(mfrow=c(2, 2),mar=c(5,4,1,1))
plot(YEAR,SandPQ1$SPINDEX, type="l", ylab="S&P 500 Index",las=1)
par(mar=c(5,5,1,.1))
plot(YEAR,SandPQ1$DIFFINDEX, type="l", ylab="S&P 500 Differences",las=1)
par(mar=c(4.2,4,1.8,1))
plot(YEAR,SandPQ1$LNSPINDEX, type="l", ylab="S&P 500 Logarithmic Index",las=1)
par(mar=c(4.2,5,1.8,.1))
plot(YEAR,SandPQ1$DIFFLNSP, type="l", 
  ylab="S&P 500 Differences of Logs",las=1)
export.eps("SandPTS.eps", width=8,height=8)
dev.off()


[["index.html", "Modelado de Regresión con Aplicaciones Actuariales y Financieras Prefacio Prólogo Dedicación", " Modelado de Regresión con Aplicaciones Actuariales y Financieras Edward (Jed) Frees, University of Wisconsin - Madison, Australian National University Prefacio Prólogo Los actuarios y otros analistas financieros cuantifican situaciones usando datos; somos personas de ‘números’. Muchos de nuestros enfoques y modelos son estilizados, basados en años de experiencia e investigaciones realizadas por legiones de analistas. Sin embargo, el mundo financiero y de gestión de riesgos evoluciona rápidamente. Muchos analistas se enfrentan a nuevas situaciones en las que los métodos probados simplemente no funcionan. Aquí es donde entra un conjunto de herramientas como el análisis de regresión. La regresión es el estudio de las relaciones entre variables. Es una disciplina estadística genérica que no se limita al mundo financiero; tiene aplicaciones en campos de ciencias sociales, biológicas y físicas. Puedes usar técnicas de regresión para investigar conjuntos de datos grandes y complejos. Para familiarizarte con la regresión, este libro explora muchos ejemplos y conjuntos de datos basados en aplicaciones actuariales y financieras. Esto no quiere decir que no encontrarás aplicaciones fuera del mundo financiero (por ejemplo, un actuario puede necesitar entender la evidencia científica más reciente sobre pruebas genéticas para fines de suscripción). Sin embargo, al familiarizarte con este conjunto de herramientas, verás cómo la regresión puede aplicarse en muchas (y a veces nuevas) situaciones. ¿Para Quién Es Este Libro? Este libro está escrito para analistas financieros que enfrentan eventos inciertos y desean cuantificar estos eventos utilizando información empírica. No se asume conocimiento previo del sector, aunque los lectores encontrarán la lectura mucho más fácil si tienen interés en las aplicaciones discutidas aquí. Este libro está diseñado para estudiantes que están siendo introducidos al campo, así como para analistas de la industria que deseen repasar técnicas antiguas y (para los capítulos posteriores) obtener una introducción a nuevos desarrollos. Para leer este libro, asumo un conocimiento comparable a una introducción de un semestre a la probabilidad y estadística; el Apéndice A1 proporciona una breve revisión para refrescar conceptos si estás oxidado. Los estudiantes actuariales en Norteamérica tendrán una introducción de un año a la probabilidad y estadística; este tipo de introducción ayudará a los lectores a captar conceptos más rápidamente que una base de un semestre. Finalmente, los lectores encontrarán útil el álgebra matricial, o lineal, aunque no es un requisito previo para leer este texto. Los diferentes lectores están interesados en entender la estadística a diferentes niveles. Este libro está escrito para acomodar al ‘lector de sillón’, es decir, aquel que lee pasivamente y no se involucra intentando realizar los ejercicios del texto. Considera una analogía con el fútbol, o cualquier otro juego. Al igual que el mariscal de campo de sillón en el fútbol, hay mucho que puedes aprender sobre el juego solo con observar. Sin embargo, si quieres agudizar tus habilidades, tienes que salir y jugar el juego. Si realizas los ejercicios o reproduces los análisis estadísticos en el texto, te convertirás en un mejor jugador. Aún así, este texto está escrito entrelazando ejemplos con los principios básicos. Así, incluso el lector de sillón puede obtener una sólida comprensión de las técnicas de regresión a través de este texto. ¿De Qué Trata Este Libro? La Tabla de Contenidos proporciona una visión general de los temas tratados, organizados en cuatro partes. La primera parte introduce la regresión lineal. Este es el material central del libro, con refrescadores sobre estadísticas matemáticas, distribuciones y álgebra matricial entrelazados según sea necesario. La segunda parte se dedica a temas en series temporales. ¿Por qué integrar temas de series temporales en un libro de regresión? Las razones son simples, pero convincentes; la mayoría de los datos contables, financieros y económicos se vuelven disponibles a lo largo del tiempo. Aunque las inferencias transversales son útiles, las decisiones empresariales deben tomarse en tiempo real con los datos actualmente disponibles. Los Capítulos 7-10 introducen técnicas de series temporales que se pueden realizar fácilmente usando herramientas de regresión (y hay muchas). La regresión no lineal es el tema de la tercera parte. Muchas de las herramientas modernas de ‘modelado predictivo’ están basadas en regresión no lineal; estas son las herramientas de trabajo en las oficinas estadísticas de la industria financiera y de gestión de riesgos. La cuarta parte se refiere a ‘aplicaciones actuariales,’ temas que he encontrado relevantes en mi investigación y trabajo de consultoría en gestión de riesgos financieros. Los primeros cuatro capítulos de esta parte consisten en variaciones de modelos de regresión que son particularmente útiles en la gestión de riesgos. Los últimos dos capítulos se centran en las comunicaciones, específicamente, en la redacción de informes y el diseño de gráficos. Comunicar información es un aspecto importante de toda disciplina técnica y la estadística ciertamente no es una excepción. Aquí está la traducción al español del texto proporcionado, manteniendo la estructura en Markdown y utilizando un lenguaje simple cuando sea posible: ¿Cómo Transmite Este Libro Su Mensaje? Desarrollo de Capítulos. Cada capítulo tiene varios ejemplos entretejidos con teoría. En los capítulos donde se introduce un modelo, comienzo con un ejemplo y discuto el análisis de datos sin hacer referencia a la teoría. Este análisis se presenta a un nivel intuitivo, sin referencia a un modelo específico. Esto es sencillo, porque se trata de poco más que ajustar curvas. El objetivo es que los estudiantes resuman los datos de manera sensata sin que la noción de un modelo obscurezca un buen análisis de datos. Luego, se proporciona una introducción a la teoría en el contexto del ejemplo introductorio. Se siguen uno o más ejemplos adicionales que refuerzan la teoría ya introducida y proporcionan un contexto para explicar la teoría adicional. En los Capítulos 5 y 6, que no introducen modelos sino técnicas para el análisis, comienzo con una introducción de la técnica. Esta introducción es seguida por un ejemplo que refuerza la explicación. De esta manera, el análisis de datos se puede omitir fácilmente sin pérdida de continuidad, si el tiempo es una preocupación. Datos Reales. Muchos de los ejercicios piden al lector que trabaje con datos reales. La necesidad de trabajar con datos reales está bien documentada; por ejemplo, véase Hogg (1972) o Singer y Willett (1990). Algunos criterios de Singer y Willett para juzgar un buen conjunto de datos incluyen: (1) autenticidad, (2) disponibilidad de información de fondo, (3) interés y relevancia para el aprendizaje sustantivo, y (4) disponibilidad de elementos con los que los lectores puedan identificarse. Por supuesto, hay algunas desventajas importantes al trabajar con datos reales. Los conjuntos de datos pueden volverse obsoletos rápidamente. Además, el conjunto de datos ideal para ilustrar un problema estadístico específico es difícil de encontrar. Esto se debe a que, con datos reales, casi por definición, varios problemas ocurren simultáneamente. Esto hace que sea difícil aislar un aspecto específico. Particularmente disfruto trabajar con grandes conjuntos de datos. Cuanto mayor es el conjunto de datos, mayor es la necesidad de estadísticas para resumir el contenido informativo. Software Estadístico y Datos. Mi objetivo al escribir este texto es llegar a un amplio grupo de estudiantes y analistas de la industria. Por lo tanto, para evitar excluir grandes segmentos, elegí no integrar ningún paquete de software estadístico específico en el texto. Sin embargo, debido a la orientación hacia las aplicaciones, es crucial que la metodología presentada pueda lograrse fácilmente utilizando paquetes disponibles. Para el curso que enseño en la Universidad de Wisconsin, uso los paquetes estadísticos SAS y R. En el sitio web del libro, http://research.bus.wisc.edu/RegActuaries los usuarios encontrarán scripts escritos en SAS y R para el análisis presentado en el texto. Los datos están disponibles en formato de texto, permitiendo a los lectores usar cualquier paquete estadístico que deseen. Cuando veas una nota como esta en el margen, también podrás encontrar este conjunto de datos (TermLife) en el sitio web del libro. Here is the translated text into Spanish, maintaining the original Markdown format and respecting the instructions: Código en la Versión en Línea. La mayoría de los cálculos ilustrativos para el libro, escritos alrededor de 2008, se realizaron en SAS. Siguiendo el enfoque moderno de análisis, el código ilustrativo proporcionado en la versión en línea está en el software estadístico R. Por lo tanto, los usuarios deben esperar ver algunas discrepancias entre los resultados en el libro y los que se calculan utilizando el software R. Suplementos Técnicos. Los suplementos técnicos refuerzan y amplían los resultados en el cuerpo principal del texto al proporcionar un tratamiento más formal y matemático del material. Este tratamiento es en realidad un suplemento porque las aplicaciones y ejemplos están descritos en el cuerpo principal del texto. Para los lectores con suficiente fondo matemático, los suplementos proporcionan material adicional que es útil para comunicarse con audiencias técnicas. Los suplementos técnicos ofrecen una cobertura más profunda y amplia de la regresión aplicada. Creo que los analistas deberían tener una idea de ‘lo que ocurre bajo el capó,’ o ‘cómo funciona el motor.’ La mayoría de estos temas se omitirán en la primera lectura del material. Sin embargo, a medida que trabajes con regresión, te enfrentarás a preguntas sobre ‘¿Por qué?’ y necesitarás profundizar en los detalles para ver exactamente cómo funciona una técnica en particular. Además, los suplementos técnicos proporcionan un menú de elementos opcionales que un instructor puede desear cubrir. Cursos Sugeridos. Hay una amplia variedad de temas que pueden incluirse en un curso de regresión. Aquí están algunos cursos sugeridos. El curso que enseño en la Universidad de Wisconsin es el primero en la lista de la siguiente tabla. \\[ {\\small \\begin{array}{ll} \\begin{array}{lll} \\hline \\textbf{Audiencia} &amp; \\textbf{Naturaleza del Curso}&amp; \\textbf{Capítulos Sugeridos} \\\\ \\hline \\text{Fondo de un año en} &amp; \\text{Introducción a la regresión y} &amp; \\text{Capítulos } 1-8 ,11-13, 20-21,\\\\ ~~~\\text{probabilidad y estadística} &amp; ~~~\\text{modelos de series temporales} &amp; ~~~\\text{solo cuerpo principal del texto} \\\\ \\text{Fondo de un año en} &amp; \\text{Regresión y modelos de} &amp; \\text{ Capítulos } 1-8, 20-21, \\text{seleccionados} \\\\ ~~~\\text{probabilidad y estadística} &amp; ~~~\\text{series temporales} &amp; ~~~\\text{porciones de los suplementos técnicos} \\\\ \\text{Fondo de un año en} &amp; \\text{Modelado de regresión} &amp; \\text{Capítulos } 1-6, 11-13, 20-21, \\text{seleccionados} \\\\ ~~~\\text{probabilidad y estadística} &amp; &amp; ~~~ \\text{porciones de los suplementos técnicos} \\\\ \\text{Fondo en estadísticas} &amp; \\text{Regresión actuarial} &amp; \\text{ Capítulos } 10-21, \\text{seleccionados} \\\\ ~~~\\text{y regresión lineal} &amp; ~~~\\text{modelos} &amp; ~~~ \\text{porciones de los suplementos técnicos} \\\\ \\hline \\end{array} \\end{array} } \\] Además de estos cursos sugeridos, este libro está diseñado para lectura complementaria para un curso de series temporales, así como un libro de referencia para analistas de la industria. Mi esperanza es que los estudiantes universitarios que utilicen las primeras partes del libro en su curso universitario encuentren los capítulos posteriores útiles en sus posiciones en la industria. De esta manera, espero promover el aprendizaje continuo a lo largo de la vida. Agradecimientos Es apropiado comenzar la sección de agradecimientos agradeciendo a los estudiantes del programa actuarial aquí en la Universidad de Wisconsin; los estudiantes son socios importantes en el negocio de la creación y difusión del conocimiento en las universidades. A través de sus preguntas y comentarios, he aprendido una cantidad tremenda a lo largo de los años. También he beneficiado de la excelente asistencia de quienes me han ayudado a reunir todas las piezas para este libro, específicamente, Missy Pinney, Peng Shi, Yunjie (Winnie) Sun y Ziyan Xie. He disfrutado trabajando con varios antiguos estudiantes y colegas en problemas de regresión en los últimos años, incluyendo a Katrien Antonio, Jie Gao, Paul Johnson, Margie Rosenberg, Jiafeng Sun, Emil Valdez y Ping Wang. Sus contribuciones están reflejadas indirectamente a lo largo del texto. Debido a mi larga asociación con la Universidad de Wisconsin-Madison, soy reacio a retroceder más en el tiempo y proporcionar una lista más extensa por temor a olvidar personas importantes. También he tenido la suerte de tener una asociación más reciente con el Insurance Services Office (ISO). Los colegas en ISO me han proporcionado importantes perspectivas sobre aplicaciones. A través de este texto que presenta aplicaciones de regresión en problemas actuariales y de la industria financiera, espero fomentar asociaciones adicionales entre la academia y la industria. Estoy encantado de reconocer las revisiones detalladas que he recibido de los colegas Tim Welnetz y Margie Rosenberg. También deseo agradecer a Bob Miller por permitirme incluir nuestro trabajo conjunto sobre diseño de gráficos efectivos en el Capítulo 21. Bob me ha enseñado mucho sobre regresión a lo largo de los años. Además, me alegra reconocer el apoyo financiero a través del Assurant Health Professorship en Ciencias Actuariales en la Universidad de Wisconsin-Madison. Guardando lo más importante para el final, agradezco a mi familia por su apoyo. Mil gracias a mi madre Mary, hermanos Randy, Guy y Joe, mi esposa Deirdre y nuestros hijos Nathan y Adam. Dedicación Hay un viejo dicho, atribuido a Sir Isaac Newton y que se puede encontrar en Google Scholar, Si he visto más lejos, es porque me he subido a los hombros de gigantes. Dedico este libro a la memoria de dos gigantes que me ayudaron, y a todos los que los conocieron, a ver más lejos y vivir mejor: James C. Hickman y Joseph P. Sullivan. "],["translation.html", "Translation", " Translation Under Construction!!! What? The purpose of this project is to develop a Spanish translation for the text Regression Modeling with Actuarial and Financial Application. This translation will be open and freely available - a resource for our community. Why? Regression provides the foundations for data science techniques such as machine learning. Although this book is a bit dated (written in 2009), it provides an easy introduction to statistical learning tools geared for applications of interest to actuaries and other financial analysts. Who? Jed Frees jfrees@bus.wisc.edu is the author of the text and has secured permission from Cambridge University Press to publish an online Spanish version. Jed is learning Spanish and is familiar with online publishing. He will take responsibility for uploading the translated version to the web. Carla Parodi and Armando Zarruk (Chair) of the Society of Actuaries´s Latin America Committee will be coordinating translation volunteers. It has been already confirmed the collaboration from the different Associations of Actuaries of Latam countries, including those from Argentina, Colombia, Ecuador, Mexico, Panama, and Peru. If you are interested in participating, please contact carla.parodi@carlaparodi.com and/or azarrukr@unal.edu.co . How? We are following a procedure similar to our successful Spanish version of Loss Data Analytics, available at https://openacttexts.github.io/LDASpanish/. Check out our Google Usage Data to see who is using this book. In short, Jed is converting his text, written in 2009 using latex, to R markdown, and then using ChatGPT for the initial translation into Spanish. Volunteers will review this translation. If the number of suggested changes are small, probably these easiest thing is to send them Carla and Armando. They will review for consistency among terminology, then forward on to Jed who will upload the changes to Github. If major changes are required, another possibility is to go to the Github site, download the .Rmd file, make the changes in the file, and send on to Jed. An “.Rmd” file is based on R’s version of a markdown file. You can open it with any text editor (e.g. Notepad - not Word), make changes, and save as text file. Date: 30 September 2024 "],["regresión-y-la-distribución-normal.html", "Chapter 1 Regresión y la Distribución Normal 1.1 ¿Qué es el Análisis de Regresión? 1.2 Ajuste de Datos a una Distribución Normal 1.3 Transformaciones de Potencia 1.4 Muestreo y el Papel de la Normalidad 1.5 Regresión y Diseños de Muestreo 1.6 Aplicaciones Actuariales de la Regresión 1.7 Lecturas Adicionales y Referencias 1.8 Ejercicios 1.9 Suplemento Técnico - Teorema del Límite Central", " Chapter 1 Regresión y la Distribución Normal Vista Previa del Capítulo. El análisis de regresión es un método estadístico que se utiliza ampliamente en muchos campos de estudio, y la ciencia actuarial no es una excepción. Este capítulo proporciona una introducción al papel de la distribución normal en la regresión, el uso de transformaciones logarítmicas para especificar relaciones de regresión y la base de muestreo que es crítica para inferir resultados de regresión a poblaciones amplias de interés. 1.1 ¿Qué es el Análisis de Regresión? La estadística trata sobre datos. Como disciplina, se ocupa de la recolección, resumen y análisis de datos para hacer afirmaciones sobre el mundo real. Cuando los analistas recolectan datos, realmente están recolectando información que se cuantifica, es decir, se transforma a una escala numérica. Existen reglas fáciles y bien entendidas para reducir los datos, utilizando medidas de resumen numéricas o gráficas. Estas medidas de resumen pueden luego vincularse a una representación teórica, o modelo, de los datos. Con un modelo que se calibra con datos, se pueden hacer afirmaciones sobre el mundo. Los métodos estadísticos han tenido un gran impacto en varios campos de estudio. En el área de recolección de datos, el diseño cuidadoso de encuestas por muestreo es crucial para los grupos de investigación de mercado y para los procedimientos de auditoría de las firmas de contabilidad. El diseño experimental es una segunda subdisciplina dedicada a la recolección de datos. El enfoque del diseño experimental es construir métodos de recolección de datos que extraigan información de la manera más eficiente posible. Esto es especialmente importante en campos como la agricultura y la ingeniería, donde cada observación es costosa, posiblemente costando millones de dólares. Otros métodos estadísticos aplicados se centran en la gestión y predicción de datos. El control de procesos se ocupa de monitorear un proceso a lo largo del tiempo y decidir cuándo la intervención es más fructífera. El control de procesos ayuda a gestionar la calidad de los bienes producidos por los fabricantes. La previsión se trata de extrapolar un proceso hacia el futuro, ya sea las ventas de un producto o los movimientos de una tasa de interés. El análisis de regresión es un método estadístico utilizado para analizar datos. Como veremos, la característica distintiva de este método es la capacidad de hacer afirmaciones sobre variables después de haber controlado los valores de variables explicativas conocidas. Aunque otros métodos son importantes, el análisis de regresión ha sido el más influyente. Para ilustrar, un índice de revistas de negocios, ABI/INFORM, enumera más de veinticuatro mil artículos que utilizan técnicas de regresión en el período de treinta años de 1978-2007. ¡Y estas son solo las aplicaciones que se consideraron lo suficientemente innovadoras como para ser publicadas en revistas académicas! El análisis de regresión de datos es tan omnipresente en los negocios modernos que es fácil pasar por alto el hecho de que la metodología tiene poco más de 120 años. Los estudiosos atribuyen el nacimiento de la regresión al discurso presidencial de 1885 de Sir Francis Galton en la sección antropológica de la Asociación Británica para el Avance de las Ciencias. En ese discurso, descrito en Stigler (1986), Galton proporcionó una descripción de la regresión y la vinculó a la teoría de la curva normal. Su descubrimiento surgió de sus estudios sobre las propiedades de la selección natural y la herencia. Para ilustrar un conjunto de datos que se puede analizar utilizando métodos de regresión, la Tabla 1.1 muestra algunos datos incluidos en el artículo de Galton de 1885. Esta tabla muestra las alturas de 928 hijos adultos, clasificados por un índice de la altura de sus padres. Aquí, todas las alturas femeninas se multiplicaron por 1.08, y el índice se creó tomando el promedio de la altura del padre y la altura reescalada de la madre. Galton era consciente de que tanto la altura de los padres como la del hijo adulto podían ser adecuadamente aproximadas por una curva normal. Al desarrollar el análisis de regresión, proporcionó un único modelo para la distribución conjunta de alturas. Tabla 1.1: Galtons 1885 Regression Data &lt;64.0 64.5 65.5 66.5 67.5 68.5 69.5 70.5 71.5 72.5 &gt;73.0 Total &gt;73.7 0 0 0 0 0 0 5 3 2 4 0 14 73.2 0 0 0 0 0 3 4 3 2 2 3 17 72.2 0 0 1 0 4 4 11 4 9 7 1 41 71.2 0 0 2 0 11 18 20 7 4 2 0 64 70.2 0 0 5 4 19 21 25 14 10 1 0 99 69.2 1 2 7 13 38 48 33 18 5 2 0 167 68.2 1 0 7 14 28 34 20 12 3 1 0 120 67.2 2 5 11 17 38 31 27 3 4 0 0 138 66.2 2 5 11 17 36 25 17 1 3 0 0 117 65.2 1 1 7 2 15 16 4 1 1 0 0 48 64.2 4 4 5 5 14 11 16 0 0 0 0 59 63.2 2 4 9 3 5 7 1 1 0 0 0 32 62.2 0 1 0 3 3 0 0 0 0 0 0 7 &lt;61.2 1 1 1 0 0 1 0 1 0 0 0 5 Total 14 23 66 78 211 219 183 68 43 19 4 928 Fuente: Stigler (1986) La Tabla 1.1 muestra que gran parte de la información sobre la altura de un hijo adulto puede atribuirse o ‘explicarse’ en términos de la altura de los padres. Por lo tanto, utilizamos el término variable explicativa para las mediciones que proporcionan información sobre una variable de interés. El análisis de regresión es un método para cuantificar la relación entre una variable de interés y las variables explicativas. La metodología utilizada para estudiar los datos en la Tabla 1.1 también se puede utilizar para estudiar problemas actuariales y de gestión de riesgos, la tesis de este libro. 1.2 Ajuste de Datos a una Distribución Normal Históricamente, la distribución normal tuvo un papel fundamental en el desarrollo del análisis de regresión. Continúa desempeñando un papel importante, aunque estaremos interesados en extender las ideas de regresión a datos altamente ‘no normales’. Formalmente, la curva normal se define por la función \\[\\begin{equation} \\mathrm{f}(y)=\\frac{1}{\\sigma \\sqrt{2\\pi }}\\exp \\left( -\\frac{1}{2\\sigma ^{2}% }\\left( y-\\mu \\right) ^{2}\\right) . \\tag{1.1} \\end{equation}\\] Esta curva es una función de densidad de probabilidad con toda la línea real como su dominio. De la ecuación (1.1), vemos que la curva es simétrica respecto a \\(\\mu\\) (la media y la mediana). El grado de agudeza está controlado por el parámetro \\(\\sigma ^{2}\\). Estos dos parámetros, \\(\\mu\\) y \\(\\sigma ^{2}\\), son conocidos como los parámetros de ubicación y escala, respectivamente. El Apéndice A3.1 proporciona detalles adicionales sobre esta curva, incluyendo un gráfico y tablas de su distribución acumulada que utilizaremos a lo largo del texto. La curva normal también se muestra en la Figura 1.1, una imagen de un billete de moneda alemana ahora fuera de circulación, el diez Deutsche Mark. Este billete contiene la imagen del alemán Carl Gauss, un eminente matemático cuyo nombre a menudo se asocia con la curva normal (a veces se refiere a ella como la curva Gaussiana). Gauss desarrolló la curva normal en relación con la teoría de los mínimos cuadrados para ajustar curvas a los datos en 1809, aproximadamente al mismo tiempo que el trabajo relacionado del científico francés Pierre LaPlace. Según Stigler (1986), ¡hubo bastante acritud entre estos dos científicos sobre la prioridad del descubrimiento! La curva normal se utilizó por primera vez como una aproximación a los histogramas de datos alrededor de 1835 por Adolph Quetelet, un matemático y científico social belga. Como muchas cosas buenas, la curva normal ha existido durante algún tiempo, desde aproximadamente 1720 cuando Abraham de Moivre la derivó para su trabajo sobre modelado de juegos de azar. La curva normal es popular porque es fácil de usar y ha demostrado ser exitosa en muchas aplicaciones. Figura 1.1: Diez Deutsche Mark. Moneda alemana con el científico Gauss y la curva normal. Ejemplo: Reclamaciones por Lesiones Corporales en Massachusetts. Para nuestra primera mirada al ajuste de la curva normal a un conjunto de datos, consideramos los datos de Rempala y Derrig (2005). Ellos consideraron las reclamaciones derivadas de coberturas de seguros de lesiones corporales por accidentes de automóvil. Estos son montos incurridos por tratamientos médicos ambulatorios que surgen de accidentes de automóvil, típicamente esguinces, fracturas de clavícula y similares. Los datos consisten en una muestra de 272 reclamaciones de Massachusetts que se cerraron en 2001 (por ‘cerradas,’ queremos decir que la reclamación está resuelta y no pueden surgir responsabilidades adicionales del mismo accidente). Rempala y Derrig estaban interesados en desarrollar procedimientos para manejar mezclas de reclamaciones ‘típicas’ y otras de proveedores que informaron reclamaciones fraudulentas. Para esta muestra, consideramos solo esas reclamaciones típicas, ignorando las potencialmente fraudulentas. La Tabla 1.2 proporciona varias estadísticas que resumen diferentes aspectos de la distribución. Los montos de las reclamaciones están en unidades de logaritmos de miles de dólares. La reclamación logarítmica promedio es 0.481, lo que corresponde a $1,617.77 (=1000 \\(\\exp(0.481)\\)). Las reclamaciones más pequeñas y más grandes son -3.101 (45 dólares) y 3.912 (50,000 dólares), respectivamente. Tabla 1.2: Summary Statistics of Massachusetts Automobile Bodily Injury Claims Number Mean Median Standard Deviation Minimum Maximum 25th Percentile 75th Percentile Claims 272 0.481 0.793 1.101 -3.101 3.912 -0.114 1.168 Para completar, aquí hay algunas definiciones. La muestra es el conjunto de datos disponibles para el análisis, denotado por \\(y_1,\\ldots,y_n\\). Aquí, \\(n\\) es el número de observaciones, \\(y_1\\) representa la primera observación, \\(y_2\\) la segunda, y así sucesivamente hasta \\(y_n\\) para la \\(n\\)-ésima observación. Aquí hay algunas estadísticas de resumen importantes. Estadísticas Básicas de Resumen La media es el promedio de las observaciones, es decir, la suma de las observaciones dividida por el número de unidades. Usando notación algebraica, la media es \\[ \\overline{y}=\\frac{1}{n}\\left( y_1 + \\cdots + y_n \\right) = \\frac{1}{n} \\sum_{i=1}^{n} y_i. \\] La mediana es la observación central cuando las observaciones están ordenadas por tamaño. Es decir, es la observación en la que el 50% está por debajo de ella (y el 50% está por encima de ella). La desviación estándar es una medida de la dispersión, o escala, de la distribución. Se calcula como \\[ s_y = \\sqrt{\\frac{1}{n-1}\\sum_{i=1}^{n}\\left( y_i-\\overline{y}\\right) ^{2}} . \\] Un percentil es un número en el que una fracción específica de las observaciones está por debajo de él, cuando las observaciones están ordenadas por tamaño. Por ejemplo, el percentil 25 es aquel número en el que el 25% de las observaciones están por debajo de él. Para ayudar a visualizar la distribución, la Figura 1.2 muestra un histograma de los datos. Aquí, la altura de cada rectángulo muestra la frecuencia relativa de observaciones que caen dentro del rango dado por su base. El histograma proporciona una impresión visual rápida de la distribución; muestra que el rango de los datos es aproximadamente (-4,4), la tendencia central es ligeramente mayor que cero y que la distribución es aproximadamente simétrica. Aproximación de la Curva Normal. La Figura 1.2 también muestra una curva normal superpuesta, utilizando \\(\\overline{y}\\) para \\(\\mu\\) y \\(s_y^{2}\\) para \\(\\sigma ^{2}\\). Con la curva normal, solo se requieren dos cantidades (\\(\\mu\\) y \\(\\sigma ^{2}\\)) para resumir toda la distribución. Por ejemplo, la Tabla 1.2 muestra que 1.168 es el percentil 75, que es aproximadamente la observación número 204 (\\(=0.75\\times 272\\)) más grande de toda la muestra. De la ecuación (1.1) de la distribución normal, tenemos que \\(z=(y-\\mu )/\\sigma\\) es una normal estándar, de la cual 0.675 es el percentil 75. Así, \\(\\overline{y}+0.675s_y=\\) \\(0.481+0.675\\times 1.101=1.224\\) es el percentil 75 usando la aproximación de la curva normal. Figura 1.2: Frecuencia Relativa de Lesiones Corporales con Curva Normal Superpuesta. Código R para Producir la Figura 1.2 injury &lt;- read.csv(&quot;CSVData/MassBodilyInjury.csv&quot;, header=TRUE) injury2&lt;-subset(injury, providerA != 0 ) LOGCLAIMS&lt;-log(injury2$claims) # FIGURA 1.2 x &lt;- seq(-4, 4, 0.01) y &lt;- dnorm(x, mean=mean(LOGCLAIMS), sd=sqrt(var(LOGCLAIMS))) hist(LOGCLAIMS, freq=FALSE, main=&quot;&quot;, ylab=&quot;&quot;, las=1) mtext(&quot;Densidad&quot;, side=2, at=.35,las=1, adj=.7,cex=1.4) lines(x,y) Diagrama de Caja. Una inspección visual rápida de la distribución de una variable puede revelar algunas características sorprendentes que están ocultas por estadísticas, medidas de resumen numéricas. El diagrama de caja, también conocido como diagrama de ‘caja y bigotes’, es uno de estos dispositivos gráficos. La Figura 1.3 ilustra un diagrama de caja para las reclamaciones por lesiones corporales. Aquí, la caja captura el 50% central de los datos, con las tres líneas horizontales que corresponden a los percentiles 75, 50 y 25, leyendo de arriba a abajo. Las líneas horizontales por encima y por debajo de la caja son los ‘bigotes’. El bigote superior es 1.5 veces el rango intercuartílico (la diferencia entre los percentiles 75 y 25) por encima del percentil 75. De manera similar, el bigote inferior es 1.5 veces el rango intercuartílico por debajo del percentil 25. Las observaciones individuales fuera de los bigotes se denotan con pequeños símbolos de trazado circulares, y se denominan ‘valores atípicos’. Figura 1.3: Diagrama de Caja de Reclamaciones por Lesiones Corporales. Código R para Producir la Figura 1.3 boxplot(LOGCLAIMS, boxwex=.7, las=1) text(1, .57, &quot;mediana&quot;, cex=1.2) text(1.36, -0.2, &quot;percentil 25&quot;, cex=1.2) text(1.36, 1.1, &quot;percentil 75&quot;, cex=1.2) arrows(1.05, -2, 1.05, -3.3, code=3, angle=20, length=0.1) text(1.15, -2.5, &quot;valores atípicos&quot;, cex=1.2) text(1.13, 3.9, &quot;valor atípico&quot;, cex=1.2) Los gráficos son herramientas poderosas; permiten a los analistas visualizar fácilmente relaciones no lineales que son difíciles de comprender cuando se expresan verbalmente o mediante fórmulas matemáticas. Sin embargo, debido a su gran flexibilidad, los gráficos también pueden engañar fácilmente al analista. El Capítulo 21 subrayará este punto. Por ejemplo, la Figura 1.4 es un re-dibujo de la Figura 1.2; la diferencia es que la Figura 1.4 usa más y más finos rectángulos. Este análisis más detallado revela la naturaleza asimétrica de la distribución de la muestra que no era evidente en la Figura 1.2. Figura 1.4: Re-dibujo de la Figura 1.2 con un número aumentado de rectángulos. Código R para Producir la Figura 1.4 hist(LOGCLAIMS, freq=FALSE, nclass=32, main=&quot;&quot;, ylab=&quot;&quot;, las=1) mtext(&quot;Densidad&quot;, side=2, at=.75,las=1, adj=.7,cex=1.1) lines(x,y) Gráficos Cuantiles-Cuantiles. Aumentar el número de rectángulos puede descubrir características que no eran evidentes antes; sin embargo, en general hay menos observaciones por rectángulo, lo que significa que la incertidumbre de la estimación de la frecuencia relativa aumenta. Esto representa un compromiso. En lugar de forzar al analista a tomar una decisión arbitraria sobre el número de rectángulos, una alternativa es usar un dispositivo gráfico para comparar una distribución con otra conocida, llamado gráfico de cuantiles-cuantiles, o qq. La Figura 1.5 ilustra un gráfico \\(qq\\) para los datos de lesiones corporales utilizando la curva normal como distribución de referencia. Para cada punto, el eje vertical da el cuantil usando la distribución de la muestra. El eje horizontal da la cantidad correspondiente usando la curva normal. Por ejemplo, anteriormente consideramos el punto del percentil 75. Este punto aparece como (1.168, 0.675) en el gráfico. Para interpretar un gráfico \\(qq\\), si los puntos de los cuantiles se alinean a lo largo de la línea superpuesta, entonces la muestra y la distribución de referencia normal tienen la misma forma. (Esta línea se define conectando los percentiles 75 y 25). En la Figura 1.5, los percentiles pequeños de la muestra son consistentemente más pequeños que los valores correspondientes de la normal estándar, lo que indica que la distribución está sesgada a la izquierda. La diferencia en los valores en los extremos de la distribución se debe a los valores atípicos mencionados anteriormente que también podrían interpretarse como que la distribución de la muestra tiene colas más grandes que la distribución de referencia normal. Figura 1.5: Un gráfico \\(qq\\) de Reclamaciones por Lesiones Corporales, usando una distribución de referencia normal. Código R para Producir la Figura 1.5 qqnorm(LOGCLAIMS, main=&quot;&quot;, las=1, ylab=&quot;&quot;) mtext(&quot;Cuantiles de la Muestra&quot;, side=2, at=4.5, las=1,cex=1.1,adj=.4) qqline(LOGCLAIMS) 1.3 Transformaciones de Potencia En el ejemplo de la Sección 1.2, consideramos las reclamaciones sin justificar el uso de la escala logarítmica. Al analizar variables como los activos de las empresas, los salarios de los individuos y los precios de las viviendas en aplicaciones empresariales y económicas, es común considerar logaritmos en lugar de las unidades originales. Una transformación logarítmica mantiene el orden original (por ejemplo, los salarios altos siguen siendo altos en la escala de logaritmos de los salarios) pero sirve para ‘acercar’ los valores extremos de la distribución. Para ilustrar, la Figura 1.6 muestra la distribución de las reclamaciones por lesiones corporales en (miles de) dólares. Para graficar los datos de manera significativa, se eliminó la observación más grande ($50,000) antes de hacer este gráfico. Incluso con esta observación eliminada, la Figura 1.6 muestra que la distribución está muy inclinada hacia la derecha, con varios valores grandes de reclamaciones apareciendo. Las distribuciones que están inclinadas en una dirección u otra se conocen como sesgadas. La Figura 1.6 es un ejemplo de una distribución sesgada a la derecha, o sesgada positivamente. Aquí, la cola de la distribución a la derecha es más larga y hay una mayor concentración de masa a la izquierda. En contraste, una distribución sesgada a la izquierda, o sesgada negativamente, tiene una cola más larga a la izquierda y una mayor concentración de masa a la derecha. Muchas distribuciones de reclamaciones de seguros están sesgadas a la derecha (ver el texto de Klugman, Panjer y Willmot, 2008, para discusiones extensas). Como vimos en las Figuras 1.4 y 1.5, una transformación logarítmica produce una distribución que está solo ligeramente sesgada a la izquierda. Figura 1.6: Distribución de Reclamaciones por Lesiones Corporales. Las observaciones están en (miles de) dólares con la observación más grande omitida. Código R para Producir la Figura 1.6 injury3 = subset(injury, claims &lt; 25 ) CLAIMS25 &lt;- injury3$claims par(mar=c(4.2,4,1.2,.2),cex=1.1) hist(CLAIMS25, freq=FALSE, main=&quot;&quot;, las=1, ylab=&quot;&quot;, xlab=&quot;CLAIMS&quot;) mtext(&quot;Densidad&quot;, side=2, at=.28, las=1,cex=1.1) Las transformaciones logarítmicas se usan extensamente en el trabajo de estadística aplicada. Una ventaja es que sirven para simetrizar distribuciones que están sesgadas. Más generalmente, consideramos transformaciones de potencia, también conocidas como la familia de transformaciones de Box-Cox. Dentro de esta familia de transformaciones, en lugar de usar la respuesta \\(y\\), usamos una versión transformada o reescalada, \\(y^{\\lambda}\\). Aquí, la potencia \\(\\lambda\\) (lambda, una ‘l’ griega) es un número que puede ser especificado por el usuario. Los valores típicos de \\(\\lambda\\) que se usan en la práctica son \\(\\lambda\\)=1, 1/2, 0 o -1. Cuando usamos \\(\\lambda =0\\), queremos decir \\(\\ln (y)\\), es decir, la transformación logarítmica natural. Más formalmente, la familia de Box-Cox puede expresarse como \\[ y^{(\\lambda )}=\\left\\{ \\begin{array}{ll} \\frac{y^{\\lambda }-1}{\\lambda } &amp; \\lambda \\neq 0 \\\\ \\ln (y) &amp; \\lambda =0 \\end{array} \\right. . \\] Como veremos, porque las estimaciones de regresión no se ven afectadas por desplazamientos de ubicación y escala, en la práctica no necesitamos restar uno ni dividir por \\(\\lambda\\) al reescalar la respuesta. La ventaja de la expresión anterior es que, si dejamos que \\(\\lambda\\) se acerque a 0, entonces \\(y^{(\\lambda )}\\) se acerca a \\(\\ln (y)\\), a partir de algunos argumentos de cálculo sencillos. Para ilustrar la utilidad de las transformaciones, simulamos 500 observaciones de una distribución chi-cuadrado con dos grados de libertad. El Apéndice A3.2 introduce esta distribución (que encontraremos nuevamente más adelante al estudiar el comportamiento de los estadísticos de prueba). El panel superior izquierdo de la Figura 1.7 muestra que la distribución original está muy sesgada hacia la derecha. Los otros paneles en la Figura 1.7 muestran los datos reescalados utilizando las transformaciones de raíz cuadrada, logarítmica y recíproca negativa. La transformación logarítmica, en el panel inferior izquierdo, proporciona la mejor aproximación a la simetría para este ejemplo. La transformación recíproca negativa se basa en \\(\\lambda =-1\\), y luego multiplicando las observaciones reescaladas por menos uno, de modo que las observaciones grandes sigan siendo grandes. Figura 1.7: 500 observaciones simuladas de una distribución chi-cuadrado. El panel superior izquierdo se basa en la distribución original. El superior derecho corresponde a la transformación de raíz cuadrada, el inferior izquierdo a la transformación logarítmica y el inferior derecho a la transformación recíproca negativa. Código R para Producir la Figura 1.7 set.seed(1237) X1 &lt;- 10000*rchisq(500*1, df=2) X2 &lt;- sqrt(X1) X3 &lt;- log(X1) X4 &lt;- -1/X1 par(mfrow=c(2, 2), cex=.75, mar=c(3,5,1.5,0)) hist(X1, freq=FALSE, nclass=16, main=&quot;&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, las=1, yaxt=&quot;n&quot;,xlim=c(0,200000),ylim=c(0,.00005)) axis(2, at=seq(0,.00005,.00001),las=1, cex=.3, labels=c(&quot;0&quot;, &quot;0.00001&quot;, &quot;0.00002&quot;,&quot;0.00003&quot;, &quot;0.00004&quot;, &quot;0.00005&quot;)) mtext(&quot;Densidad&quot;, side=2, at=.000055, las=1, cex=.75) mtext(&quot;y&quot;, side=1, cex=.75, line=2) par(mar=c(3,4,1.5,0.2)) hist(X2, freq=FALSE, nclass=16, main=&quot;&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, las=1,xlim=c(0,400), ylim=c(0,.008)) mtext(&quot;Densidad&quot;, side=2, at=.0088, las=1, cex=.75) mtext(&quot;Raíz cuadrada de y&quot;, side=1, cex=.75, line=2) par(mar=c(3.2,5,1,0)) hist(X3, freq=FALSE, nclass=16, main=&quot;&quot;, xlab=&quot;&quot;, ylab=&quot;&quot;, las=1, ylim=c(0,.4)) mtext(&quot;Densidad&quot;, side=2, at=.44, las=1, cex=.75) mtext(&quot;Logaritmo de y&quot;, side=1, cex=.75, line=2) par(mar=c(3.2,4,1,0.2)) hist(X4, freq=FALSE, nclass=16, main=&quot;&quot;,xlab=&quot;&quot;, ylab=&quot;&quot;, las=1, ylim=c(0,100)) mtext(&quot;Densidad&quot;, side=2, at=110, las=1, cex=.75) mtext(&quot;Recíproco negativo de y&quot;, side=1, cex=.75, line=2) 1.4 Muestreo y el Papel de la Normalidad Una estadística es una medida resumen de los datos, como una media, mediana o percentil. Las colecciones de estadísticas son muy útiles para analistas, tomadores de decisiones y consumidores cotidianos para comprender grandes cantidades de datos que representan situaciones complejas. Hasta este punto, nuestro enfoque ha sido introducir técnicas sensatas para resumir variables; técnicas que se usarán repetidamente a lo largo de este texto. Sin embargo, la verdadera utilidad de la disciplina de la estadística es su capacidad para decir algo sobre lo desconocido, no solo para resumir la información ya disponible. Con este fin, necesitamos hacer algunas suposiciones bastante formales sobre la manera en que se observan los datos. Como ciencia, una característica destacada de la estadística (como disciplina) es la capacidad de criticar estas suposiciones y ofrecer alternativas mejoradas en situaciones específicas. Es costumbre suponer que los datos se extraen de una población más grande que estamos interesados en describir. El proceso de extracción de los datos se conoce como muestreo, o proceso generador de datos. Denotamos esta muestra como \\(\\{y_1,\\ldots,y_n\\}\\). Para que podamos criticar y modificar estas suposiciones de muestreo, las enumeramos a continuación en detalle: \\[ \\begin{array}{l} \\hline \\textbf{Suposiciones Básicas de Muestreo} \\\\ \\hline 1. ~\\mathrm{E~}y_i=\\mu \\\\ 2. ~\\mathrm{Var~}y_i=\\sigma ^{2} \\\\ 3. ~\\{y_i\\} \\text{ son independientes} \\\\ 4. ~\\{y_i\\} \\text{ están distribuidos normalmente}. \\\\ \\hline \\end{array} \\] En esta configuración básica, \\(\\mu\\) y \\(\\sigma ^{2}\\) sirven como parámetros que describen la ubicación y escala de la población de origen. El objetivo es inferir algo sensato sobre ellos basándose en estadísticas como \\(\\overline{y}\\) y \\(s_y^{2}\\). Para la tercera suposición, asumimos independencia entre las extracciones. En un esquema de muestreo, esto puede ser garantizado tomando una muestra aleatoria simple de una población. La cuarta suposición no es necesaria para muchos procedimientos de inferencia estadística porque los teoremas del límite central proporcionan una normalidad aproximada para muchas estadísticas de interés. Sin embargo, una justificación formal de algunas estadísticas, como las t-estadísticas, requiere esta suposición adicional. La Sección 1.9 proporciona una declaración explícita de una versión del teorema del límite central, dando condiciones bajo las cuales \\(\\overline{y}\\) está aproximadamente distribuido normalmente. Esta sección también discute un resultado relacionado, conocido como aproximación de Edgeworth, que muestra que la calidad de la aproximación normal es mejor para poblaciones de origen simétricas en comparación con distribuciones sesgadas. ¿Cómo se aplica esta discusión al estudio del análisis de regresión? Después de todo, hasta ahora nos hemos centrado solo en el promedio aritmético simple, \\(\\overline{y}\\). En capítulos posteriores, enfatizaremos que la regresión lineal es el estudio de promedios ponderados; específicamente, muchos coeficientes de regresión pueden expresarse como promedios ponderados con pesos apropiadamente elegidos. Los teoremas de límite central y aproximación de Edgeworth están disponibles para promedios ponderados; estos resultados asegurarán la normalidad aproximada de los coeficientes de regresión. Para usar aproximaciones de la curva normal en un contexto de regresión, a menudo transformaremos variables para lograr una simetría aproximada. 1.5 Regresión y Diseños de Muestreo La aproximación a la normalidad será un tema importante en las aplicaciones prácticas de la regresión lineal. Las Partes I y II de este libro se centran en la regresión lineal, donde aprenderemos conceptos básicos de regresión y diseño de muestreo. La Parte III se centrará en la regresión no lineal, que involucra respuestas binarias, de conteo y de colas pesadas, donde la normalidad no es la distribución de referencia más útil. Las ideas sobre conceptos básicos y diseño también se usarán en el contexto no lineal. En el análisis de regresión, nos enfocamos en una medición de interés y la llamamos variable dependiente. Otras mediciones se usan como variables explicativas. Un objetivo es comparar las diferencias en la variable dependiente en términos de diferencias en las variables explicativas. Como se mencionó en la Sección 1.1, la regresión se usa extensamente en muchos campos científicos. Tabla 1.3 enumera términos alternativos que puedes encontrar al leer aplicaciones de regresión. Tabla 1.3. Terminología para Variables de Regresión \\[ {\\small \\begin{array}{ll}\\hline\\hline y-\\text{Variable} &amp; x-\\text{Variable} \\\\\\hline \\text{Resultado de interés} &amp; \\text{Variable explicativa} \\\\ \\text{Variable dependiente} &amp; \\text{Variable independiente} \\\\ \\text{Variable endógena} &amp; \\text{Variable exógena} \\\\ \\text{Respuesta} &amp; \\text{Tratamiento} \\\\ \\text{Regresando} &amp; \\text{Regresor} \\\\ \\text{Variable del lado izquierdo} &amp; \\text{Variable del lado derecho} \\\\ \\text{Variable explicada} &amp; \\text{Variable predictora} \\\\ \\text{Resultado} &amp; \\text{Entrada} \\\\ \\hline \\end{array} } \\] En la última parte del siglo XIX y principios del siglo XX, la estadística comenzó a tener un impacto importante en el desarrollo de la ciencia experimental. Las ciencias experimentales a menudo utilizan estudios diseñados, donde los datos están bajo el control de un analista. Los estudios diseñados se realizan en entornos de laboratorio, donde hay restricciones físicas estrictas en cada variable que un investigador considera importante. Los estudios diseñados también ocurren en experimentos de campo más grandes, donde los mecanismos de control son diferentes a los de los entornos de laboratorio. La agricultura y la medicina utilizan estudios diseñados. Los datos de un estudio diseñado se dicen que son datos experimentales. Para ilustrar, un ejemplo clásico es considerar el rendimiento de un cultivo como el maíz, donde cada uno de varios parcelas de tierra (las observaciones) se asigna a varios niveles de fertilizante. El objetivo es determinar el efecto del fertilizante (la variable explicativa) en el rendimiento del maíz (la variable de respuesta). Aunque los investigadores intentan hacer que las parcelas de tierra sean lo más similares posible, inevitablemente surgen diferencias. Los investigadores agrícolas utilizan técnicas de aleatorización para asignar diferentes niveles de fertilizante a cada parcela de tierra. De esta manera, los analistas pueden explicar la variación en los rendimientos de maíz en términos de la variación de los niveles de fertilizante. A través del uso de técnicas de aleatorización, los investigadores que utilizan estudios diseñados pueden inferir que el tratamiento tiene un efecto causal sobre la respuesta. El Capítulo 6 discute la causalidad más a fondo. Ejemplo: Experimento de Seguro de Salud Rand. ¿Cómo están relacionados los gastos en atención médica con la demanda de seguro? Muchos estudios han establecido una relación positiva entre la cantidad gastada en atención médica y la demanda de seguro de salud. Aquellos en mala salud anticipan usar más servicios médicos que las personas en buena o regular salud y buscarán niveles más altos de seguro de salud para compensar estos gastos anticipados. Obtienen este seguro adicional al (i) seleccionar un plan de seguro de salud más generoso de un empleador, (ii) elegir un empleador con un plan de seguro de salud más generoso o (iii) pagar más por un seguro de salud individual. Así, es difícil desenredar la relación causa-efecto de los gastos en atención médica y la disponibilidad de seguro de salud. Un estudio reportado por Manning et al. (1987) buscó responder a esta pregunta utilizando un experimento cuidadosamente diseñado. En este estudio, los hogares inscritos de seis ciudades, entre noviembre de 1974 y febrero de 1977, fueron asignados aleatoriamente a uno de 14 planes de seguro diferentes. Estos planes variaban según los elementos de participación en los costos, la tasa de coaseguro (el porcentaje pagado de los gastos de bolsillo que variaba entre 0, 25, 50 y 95%) así como el deducible (5, 10 o 15 por ciento del ingreso familiar, hasta un máximo de $1,000). Así, hubo una asignación aleatoria a los niveles del tratamiento, la cantidad de seguro de salud. El estudio encontró que los planes más favorables resultaron en mayores gastos totales, incluso después de controlar el estado de salud de los participantes. Para la ciencia actuarial y otras ciencias sociales, los estudios diseñados son la excepción más que la regla. Por ejemplo, si queremos estudiar los efectos del tabaquismo en la mortalidad, es muy poco probable que podamos conseguir que los participantes en el estudio acepten ser asignados aleatoriamente a grupos de fumadores/no fumadores durante varios años solo para observar sus patrones de mortalidad. Al igual que en el estudio de Galton de la Sección 1.1, los investigadores en ciencias sociales generalmente trabajan con datos observacionales. Los datos observacionales no están bajo el control del analista. Con datos observacionales, no podemos inferir relaciones causales, pero podemos introducir medidas de asociación. Para ilustrar, en los datos de Galton, es evidente que los padres ‘altos’ tienden a tener hijos ‘altos’ y, a la inversa, los padres ‘bajos’ tienden a tener hijos ‘bajos’. El Capítulo 2 introducirá la correlación y otras medidas de asociación. Sin embargo, no podemos inferir causalidad a partir de los datos. Por ejemplo, puede haber otra variable, como la dieta familiar, que esté relacionada con ambas variables. Una buena dieta en la familia podría estar asociada con alturas altas de los padres y de los hijos adultos, mientras que una dieta pobre limita el crecimiento. Si ese fuera el caso, llamaríamos a la dieta familiar una variable confusora. En experimentos diseñados como el Experimento de Seguro de Salud Rand, podemos controlar los efectos de variables como el estado de salud mediante métodos de asignación aleatoria. En estudios observacionales, usamos control estadístico, en lugar de control experimental. Para ilustrar, en los datos de Galton, podríamos dividir nuestras observaciones en dos grupos, uno para ‘buena dieta familiar’ y otro para ‘mala dieta familiar’, y examinar la relación entre la altura de los padres y la de los hijos para cada subgrupo. Esta es la esencia del método de regresión, comparar un \\(y\\) y un \\(x\\), ‘controlando’ los efectos de otras variables explicativas. Por supuesto, para usar control estadístico y métodos de regresión, uno debe registrar la dieta familiar y cualquier otra medida de altura que pueda confundir los efectos de la altura de los padres en la altura de su hijo adulto. La dificultad en diseñar estudios es tratar de imaginar todas las variables que podrían afectar una variable de respuesta, una tarea imposible en la mayoría de los problemas de interés en ciencias sociales. Para dar algunas orientaciones sobre cuándo ‘es suficiente’, el Capítulo 6 discutirá medidas de la importancia de una variable explicativa y su impacto en la selección del modelo. 1.6 Aplicaciones Actuariales de la Regresión Este libro introduce un método estadístico, el análisis de regresión. La introducción está organizada en torno a la tríada tradicional de la inferencia estadística: prueba de hipótesis, estimación y predicción. Además, este libro muestra cómo esta metodología puede ser utilizada en aplicaciones que probablemente serán de interés para los actuarios y otros analistas de riesgos. Como tal, es útil comenzar con las tres áreas tradicionales de aplicaciones actuariales: tarificación, reservas y pruebas de solvencia. Tarificación y selección adversa. El análisis de regresión puede utilizarse para determinar los precios de seguros para muchas líneas de negocio. Por ejemplo, en el seguro de automóviles de pasajeros privados, las reclamaciones esperadas varían según el género del asegurado, la edad, la ubicación (ciudad versus rural), el propósito del vehículo (trabajo o placer) y una serie de otras variables explicativas. La regresión puede utilizarse para identificar las variables que son determinantes importantes de las reclamaciones esperadas. En mercados competitivos, las compañías de seguros no usan el mismo precio para todos los asegurados. Si lo hicieran, los ‘buenos riesgos’, aquellos con reclamaciones esperadas inferiores a la media, pagarían de más y abandonarían la compañía. En contraste, los ‘malos riesgos’, aquellos con reclamaciones esperadas superiores a la media, permanecerían con la compañía. Si la compañía continuara con esta política de precios plana, las primas aumentarían (para compensar las reclamaciones de la creciente proporción de malos riesgos) y la participación en el mercado disminuiría a medida que la compañía pierde buenos riesgos. Este problema se conoce como ‘selección adversa’. Usando un conjunto apropiado de variables explicativas, se pueden desarrollar sistemas de clasificación para que cada asegurado pague su parte justa. Reservas y pruebas de solvencia. Tanto la constitución de reservas como las pruebas de solvencia se preocupan por predecir si las obligaciones asociadas con un grupo de pólizas excederán el capital destinado a cumplir con las obligaciones derivadas de las pólizas. La constitución de reservas implica determinar la cantidad apropiada de capital para cumplir con estas obligaciones. Las pruebas de solvencia se centran en evaluar la adecuación del capital para financiar las obligaciones de un bloque de negocio. En algunas áreas de práctica, la regresión puede usarse para pronosticar futuras obligaciones y ayudar a determinar las reservas (ver, por ejemplo, el Capítulo 19). La regresión también puede utilizarse para comparar las características de empresas saludables y financieramente angustiadas para pruebas de solvencia (ver, por ejemplo, el Capítulo 14). Otras aplicaciones en gestión de riesgos. El análisis de regresión es una herramienta cuantitativa que puede aplicarse en una amplia variedad de problemas de negocio, no solo en las áreas tradicionales de tarificación, reservas y pruebas de solvencia. Al familiarizarse con el análisis de regresión, los actuarios tendrán otra habilidad cuantitativa que puede aplicarse a problemas generales relacionados con la seguridad financiera de personas, empresas y organizaciones gubernamentales. Para ayudarte a desarrollar ideas, este libro proporciona muchos ejemplos de aplicaciones potenciales ‘no actuariales’ a través de viñetas destacadas etiquetadas como ‘ejemplos’ y conjuntos de datos ilustrativos. Para entender las posibles aplicaciones de la regresión, comienza revisando los varios conjuntos de datos presentados en los Ejercicios del Capítulo 1. Incluso si no completas los ejercicios para fortalecer tus habilidades de resumen de datos (que requieren el uso de una computadora), una revisión de las descripciones de los problemas te ayudará a familiarizarte con los tipos de aplicaciones en las que un actuario podría usar técnicas de regresión. 1.7 Lecturas Adicionales y Referencias Este libro introduce herramientas de regresión y series temporales que son más relevantes para los actuarios y otros analistas de riesgos financieros. Afortunadamente, existen otras fuentes que proporcionan excelentes introducciones a estos temas estadísticos (aunque no desde un punto de vista de gestión de riesgos). En particular, para los analistas que desean especializarse en estadística, es útil obtener otra perspectiva. Para regresión, recomiendo Weisburg (2005) y Faraway (2005). Para series temporales, Diebold (2004) es una buena fuente. Además, Klugman, Panjer y Willmot (2008) proporciona una buena introducción a las aplicaciones actuariales de la estadística; este libro está destinado a complementar el libro de Klugman et al. al centrarse en métodos de regresión y series temporales. Referencias del Capítulo Beard, Robert E., Teivo Pentik\"{a}inen and Erkki Pesonen (1984). Risk Theory: The Stochastic Basis of Insurance (Third Edition). Chapman &amp; Hall, New York. Diebold, Francis. X. (2004). Elements of Forecasting, Third Edition. Thomson, South-Western, Mason, Ohio. Faraway, Julian J. (2005). Linear Models in R. Chapman &amp; Hall/CRC, New York. Hogg, Robert V. (1972). On statistical education. The American Statistician 26, 8-11. Klugman, Stuart A, Harry H. Panjer and Gordon E. Willmot (2008). Loss Models: From Data to Decisions. John Wiley &amp; Sons, Hoboken, New Jersey. Manning, Willard G., Joseph P. Newhouse, Naihua Duan, Emmett B. Keeler, Arleen Leibowitz and M. Susan Marquis (1987). Health insurance and the demand for medical care: Evidence from a randomized experiment. American Economic Review 77, No. 3, 251-277. Rempala, Grzegorz A. and Richard A. Derrig (2005). Modeling hidden exposures in claim severity via the EM algorithm. North American Actuarial Journal 9, No. 2, 108-128. Singer, Judith D. and Willett, J. B. (1990). Improving the teaching of applied statistics: Putting the data back into data analysis. The American Statistician 44, 223-230. Stigler, Steven M. (1986). The History of Statistics: The Measurement of Uncertainty before 1900. The Belknap Press of Harvard University Press, Cambridge, MA. Weisberg, Sanford (2005). Applied Linear Regression, Third Edition. John Wiley &amp; Sons, New York. 1.8 Ejercicios 1.1 Gastos de Salud de MEPS. Este ejercicio considera datos de la Encuesta de Gastos Médicos (MEPS), realizada por la Agencia de Investigación y Calidad en Salud de EE.UU. (AHRQ). MEPS es una encuesta probabilística que proporciona estimaciones nacionalmente representativas del uso de atención médica, gastos, fuentes de pago y cobertura de seguros para la población civil de EE.UU. Esta encuesta recopila información detallada sobre episodios de atención médica de cada tipo de servicio, incluyendo visitas a consultorios médicos, visitas a salas de emergencia hospitalarias, visitas a hospitales ambulatorios, estancias hospitalarias, otras visitas a proveedores médicos y uso de medicamentos prescritos. Esta información detallada permite desarrollar modelos de utilización de atención médica para predecir futuros gastos. Puedes obtener más información sobre MEPS en http://www.meps.ahrq.gov/mepsweb/. Consideramos los datos de MEPS de los paneles 7 y 8 de 2003, que consisten en 18,735 individuos entre las edades de 18 y 65 años. De esta muestra, tomamos una muestra aleatoria de 2,000 individuos que aparecen en el archivo ‘HealthExpend’. De esta muestra, hay 157 individuos que tuvieron gastos hospitalarios positivos. También hay 1,352 que tuvieron gastos ambulatorios positivos. Analizaremos estas dos muestras por separado. Nuestras variables dependientes consisten en las cantidades de gastos para visitas hospitalarias (EXPENDIP) y ambulatorias (EXPENDOP). Para MEPS, los eventos ambulatorios incluyen visitas al departamento ambulatorio del hospital, visitas a proveedores en consultorios y visitas a salas de emergencia, excluyendo servicios dentales. (Los servicios dentales, en comparación con otros tipos de servicios de atención médica, son más predecibles y ocurren de manera más regular). Las estancias hospitalarias con la misma fecha de admisión y alta, conocidas como ‘estancias de cero noches’, se incluyeron en los recuentos y gastos ambulatorios. (Los pagos asociados con visitas a salas de emergencia que precedieron inmediatamente a una estancia hospitalaria se incluyeron en los gastos hospitalarios. Los medicamentos prescritos que se pueden vincular a las admisiones hospitalarias se incluyeron en los gastos hospitalarios, no en la utilización ambulatoria). Parte 1: Usa solo los 157 individuos que tuvieron gastos hospitalarios positivos y realiza el siguiente análisis. Calcula estadísticas descriptivas para los gastos hospitalarios (EXPENDIP). a(i). ¿Cuál es el gasto típico (media y mediana)? a(ii). ¿Cómo se compara la desviación estándar con la media? ¿Los datos parecen estar sesgados? Calcula un diagrama de caja, un histograma y un gráfico \\(qq\\) (normal) para EXPENDIP. Comenta sobre la forma de la distribución. Transformaciones. c(i). Realiza una transformación de raíz cuadrada de los gastos hospitalarios. Resume la distribución resultante usando un histograma y un gráfico \\(qq\\). ¿Parece estar aproximadamente distribuida normalmente? c(ii). Realiza una transformación logarítmica (natural) de los gastos hospitalarios. Resume la distribución resultante usando un histograma y un gráfico \\(qq\\). ¿Parece estar aproximadamente distribuida normalmente? Parte 2: Usa solo los 1,352 individuos que tuvieron gastos ambulatorios positivos. Repite la parte (a) y calcula histogramas para los gastos y los gastos logarítmicos. Comenta sobre la normalidad aproximada de cada histograma. 1.2 Utilización de Hogares de Cuidado de Ancianos. Este ejercicio considera datos de hogares de cuidado de ancianos proporcionados por el Departamento de Salud y Servicios Familiares de Wisconsin (DHFS). El programa Medicaid del Estado de Wisconsin financia el cuidado en hogares de cuidado de ancianos para individuos que califican en base a necesidades y estado financiero. Como parte de las condiciones de participación, los hogares de cuidado de ancianos certificados por Medicaid deben presentar un informe de costos anual al DHFS, resumiendo el volumen y costo del cuidado proporcionado a todos sus residentes, financiados por Medicaid y de otro tipo. Estos informes de costos son auditados por el personal del DHFS y forman la base para las tasas diarias de pago de Medicaid específicas para cada instalación para los períodos subsiguientes. Los datos están disponibles públicamente; consulta [http://dhs.wisconsin.gov] para más información. El DHFS está interesado en técnicas predictivas que proporcionen pronósticos de utilización confiables para actualizar su programa de tasas de financiamiento de Medicaid para instalaciones de cuidado de ancianos. En esta tarea, consideramos los datos en el archivo ‘WiscNursingHome’ en los años de informe de costos 2000 y 2001. Hay 362 instalaciones en 2000 y 355 instalaciones en 2001. Típicamente, la utilización del cuidado en hogares de cuidado de ancianos se mide en días de paciente (‘días de paciente’ es el número de días que cada paciente estuvo en la instalación, sumado sobre todos los pacientes). Para este ejercicio, definimos la variable de resultado como años totales de pacientes (TPY), el número total de días de pacientes en el período de informe de costos dividido por el número de días operativos de la instalación en el período de informe de costos (ver Rosenberg et al., 2007, Apéndice 1, para una discusión adicional sobre esta elección). El número de camas (NUMBED) y el metraje cuadrado (SQRFOOT) del hogar de cuidado de ancianos miden el tamaño de la instalación. No sorprende que estas variables sean importantes predictores de TPY. Parte 1: Usa los datos del año de informe de costos 2000 y realiza el siguiente análisis. Calcula estadísticas descriptivas para TPY, NUMBED y SQRFOOT. Resume la distribución de TPY usando un histograma y un gráfico \\(qq\\). ¿Parece estar aproximadamente distribuida normalmente? Transformaciones. Realiza una transformación logarítmica (natural) de TPY (LOGTPY). Resume la distribución resultante usando un histograma y un gráfico \\(qq\\). ¿Parece estar aproximadamente distribuida normalmente? Parte 2: Usa los datos del año de informe de costos 2001 y repite las partes (a) y (c). 1.3 Reclamaciones de Seguros de Automóviles. Como analista actuarial, estás trabajando con una gran compañía de seguros para ayudarles a entender la distribución de sus reclamaciones para sus pólizas de automóviles particulares. Tienes disponibles datos de reclamaciones para un año reciente, que consisten en: STATE CODE: códigos del 01 al 17 utilizados, con cada código asignado aleatoriamente a un estado real. CLASS: clase de calificación del operador, basada en edad, género, estado civil y uso del vehículo. GENDER: género del operador. AGE: edad del operador. PAID: monto pagado para resolver y cerrar una reclamación. Te estás enfocando en conductores mayores de 50 años, para los cuales hay \\(n = 6,773\\) reclamaciones disponibles. Examina el histograma del monto PAID y comenta sobre la simetría. Crea una nueva variable, las reclamaciones pagadas en logaritmo natural, LNPAID. Crea un histograma y un gráfico \\(qq\\) de LNPAID. Comenta sobre la simetría de esta variable. 1.4 Costos Hospitalarios. Supongamos que eres un actuario de beneficios para empleados trabajando con una empresa de tamaño mediano en Wisconsin. Esta empresa está considerando ofrecer, por primera vez en su industria, cobertura de seguro hospitalario para los hijos dependientes de sus empleados. Tienes acceso a los registros de la empresa y, por lo tanto, tienes disponibles el número, edad y género de los hijos dependientes, pero no tienes otra información sobre los costos hospitalarios de la empresa. En particular, ninguna empresa en esta industria ha ofrecido esta cobertura, por lo que tienes poca experiencia histórica en la industria sobre la cual puedas prever los reclamos esperados. Recopilas datos del Nationwide Inpatient Sample del Healthcare Cost and Utilization Project (NIS-HCUP), una encuesta nacional de costos hospitalarios realizada por la Agencia de Investigación y Calidad en Salud de EE.UU. (AHRQ). Restringes la consideración a hospitales de Wisconsin y analizas una muestra aleatoria de \\(n=500\\) reclamaciones de datos de 2003. Aunque los datos provienen de registros hospitalarios, están organizados por alta individual y por lo tanto tienes información sobre la edad y el género del paciente dado de alta. Específicamente, consideras pacientes de 0 a 17 años. En un proyecto separado, considerarás la frecuencia de hospitalización. Para este proyecto, el objetivo es modelar la gravedad de los cargos hospitalarios, por edad y género. Examina la distribución de la variable dependiente, TOTCHG. Haz esto creando un histograma y luego un gráfico \\(qq\\), comparando el empírico con una distribución normal. Realiza una transformación logarítmica natural y llama a la nueva variable LNTOTCHG. Examina la distribución de esta variable transformada. Para visualizar la relación logarítmica, traza LNTOTCHG frente a TOTCHG. 1.5 Reclamaciones de Seguros de Lesiones Automovilísticas. Consideramos datos de reclamaciones por lesiones en automóviles utilizando datos del Insurance Research Council (IRC), una división del American Institute for Chartered Property Casualty Underwriters y del Insurance Institute of America. Los datos, recopilados en 2002, contienen información sobre la demografía del reclamante, la participación del abogado y la pérdida económica (LOSS, en miles), entre otras variables. Aquí analizamos una muestra de \\(n=1,340\\) pérdidas de un solo estado. El estudio completo de 2002 contiene más de 70,000 reclamaciones cerradas basadas en datos de treinta y dos aseguradoras. El IRC realizó estudios similares en 1977, 1987, 1992 y 1997. Calcula las estadísticas descriptivas para la pérdida económica total (LOSS). ¿Cuál es la pérdida típica? Calcula un histograma y un gráfico \\(qq\\) (normal) para LOSS. Comenta sobre la forma de la distribución. Divide el conjunto de datos en dos submuestras, una correspondiente a las reclamaciones que involucraron a un ATTORNEY (=1) y otra en la que no se involucró un ATTORNEY (=2). c(i). Para cada submuestra, calcula la pérdida típica. ¿Parece haber una diferencia en las pérdidas típicas según la participación del abogado? c(ii) Para comparar las distribuciones, calcula un diagrama de caja (boxplot) por nivel de participación del abogado. c(iii). Para cada submuestra, calcula un histograma y un gráfico \\(qq\\). Compara las dos distribuciones entre sí. 1.6 Gastos de la Compañía de Seguros. Al igual que otros negocios, las compañías de seguros buscan minimizar los gastos asociados con la realización de negocios para mejorar la rentabilidad. Para estudiar los gastos, este ejercicio examina una muestra aleatoria de 500 compañías de seguros de la base de datos de la National Association of Insurance Commissioners (NAIC) de más de 3,000 compañías. La NAIC mantiene una de las bases de datos regulatorias de seguros más grandes del mundo; consideramos aquí datos basados en los informes anuales de 2005 para todas las compañías de seguros de propiedad y casualty en los Estados Unidos. Los informes anuales son estados financieros que utilizan principios contables estatutarios. Específicamente, nuestra variable dependiente es EXPENSES, los gastos no relacionados con reclamaciones para una compañía. Aunque no es necesario para este ejercicio, los gastos no relacionados con reclamaciones se basan en tres componentes: ajuste de pérdidas no asignadas, gastos de suscripción y gastos de inversión. El gasto por ajuste de pérdidas no asignadas es el gasto no directamente atribuible a una reclamación pero que está asociado indirectamente con la resolución de reclamaciones; incluye elementos como los salarios de los ajustadores de reclamaciones, honorarios legales, costos judiciales, testigos expertos y costos de investigación. Los gastos de suscripción consisten en costos de adquisición de pólizas, como comisiones, así como la parte de los gastos administrativos, generales y otros atribuibles a las operaciones de suscripción. Los gastos de inversión son aquellos gastos relacionados con las actividades de inversión del asegurador. Examina la distribución de la variable dependiente, EXPENSES. Haz esto creando un histograma y luego un gráfico \\(qq\\), comparando el empírico con una distribución normal. Realiza una transformación logarítmica natural y examina la distribución de esta variable transformada. ¿Ha ayudado la transformación a simetrizar la distribución? 1.7 Esperanzas de Vida Nacionales. ¿Quién está haciendo bien el cuidado de la salud? Las decisiones sobre la atención médica se toman a nivel individual, corporativo y gubernamental. Prácticamente todas las personas, corporaciones y gobiernos tienen su propia perspectiva sobre la atención médica; estas diferentes perspectivas dan lugar a una amplia variedad de sistemas para gestionar la atención médica. Comparar diferentes sistemas de atención médica nos ayuda a aprender sobre enfoques distintos al nuestro, lo que a su vez nos ayuda a tomar mejores decisiones al diseñar sistemas mejorados. Aquí, consideramos los sistemas de atención médica de \\(n=185\\) países en todo el mundo. Como medida de la calidad de la atención, utilizamos LIFEEXP, la esperanza de vida al nacer. Esta variable dependiente, con varias variables explicativas, se enumeran en [Tabla 1.4]. A partir de esta tabla, notarás que aunque hay 185 países considerados en este estudio, no todos los países proporcionaron información para cada variable. Los datos no disponibles se indican en la columna Num Miss. Los datos provienen del Informe sobre el Desarrollo Humano de las Naciones Unidas (UN). Examina la distribución de la variable dependiente, LIFEEXP. Haz esto creando un histograma y luego un gráfico \\(qq\\), comparando el empírico con una distribución normal. Realiza una transformación logarítmica natural y examina la distribución de esta variable transformada. ¿Ha ayudado la transformación a simetrizar la distribución? \\[ \\small{ \\begin{array}{ll|crrrrr} \\hline &amp; &amp; Num &amp; &amp; &amp; Std &amp; Mini- &amp; Maxi- \\\\ Variable &amp; Description &amp; Miss &amp; Mean &amp; Median &amp; Dev &amp; mum &amp; mum \\\\\\hline BIRTH &amp; \\text{ Births attended by skilled} &amp; 7 &amp; 78.25 &amp; 92.00 &amp; 26.42 &amp; 6.00 &amp; 100.00 \\\\ ~~ATTEND&amp; ~~ \\text{ health personnel} (\\%)\\\\ FEMALE &amp; \\text{ Legislators, senior officials} &amp; 87 &amp; 29.07 &amp; 30.00 &amp; 11.71 &amp; 2.00 &amp; 58.00 \\\\ ~~BOSS&amp; ~~ \\text{ and managers, % female }\\\\ FERTILITY &amp; \\text{ Total fertility rate,}&amp; 4 &amp; 3.19 &amp; 2.70 &amp; 1.71 &amp; 0.90 &amp; 7.50 \\\\ &amp; ~~ \\text{ births per woman }&amp; \\\\ GDP &amp; \\text{ Gross domestic product,} &amp; 7 &amp; 247.55 &amp; 14.20 &amp; 1,055.69 &amp; 0.10 &amp; 12,416.50 \\\\ &amp; ~~\\text{ in billions of USD} \\\\ HEALTH&amp; \\text{ 2004 Health expenditure} &amp; 5 &amp; 718.01 &amp; 297.50 &amp; 1,037.01 &amp; 15.00 &amp; 6,096.00 \\\\ ~~ EXPEND &amp; ~~ \\text{ per capita, PPP in USD} \\\\ ILLITERATE &amp; \\text{ Adult illiteracy rate,} &amp; 14 &amp; 17.69 &amp; 10.10 &amp; 19.86 &amp; 0.20 &amp; 76.40 \\\\ &amp; ~~ \\% \\text{ aged 15 and older} &amp; \\\\ PHYSICIAN &amp; \\text{ Physicians,}&amp; 3 &amp; 146.08 &amp; 107.50 &amp; 138.55 &amp; 2.00 &amp; 591.00 \\\\ &amp; ~~ \\text{ per 100,000 people} \\\\ POP &amp; \\text{ 2005 population,} &amp; 1 &amp; 35.36 &amp; 7.80 &amp; 131.70 &amp; 0.10 &amp; 1,313.00 \\\\ &amp; ~~\\text{ in millions }\\\\ PRIVATE &amp; \\text{ 2004 Private expenditure} &amp; 1 &amp; 2.52 &amp; 2.40 &amp; 1.33 &amp; 0.30 &amp; 8.50 \\\\ ~~HEALTH&amp; ~~\\text{on health, % of GDP} \\\\ PUBLIC &amp; \\text{ Public expenditure} &amp; 28 &amp; 4.69 &amp; 4.60 &amp; 2.05 &amp; 0.60 &amp; 13.40 \\\\ ~~EDUCATION&amp; ~~ \\text{ on education, % of GDP} \\\\ RESEAR &amp; \\text{ Researchers in R &amp; D,} &amp; 95 &amp; 2,034.66 &amp; 848.00 &amp; 4,942.93 &amp; 15.00 &amp; 45,454.00 \\\\ ~~CHERS&amp;~~ \\text{ per million people} &amp; \\\\ SMOKING &amp; \\text{ Prevalence of smoking,} &amp; 88 &amp; 35.09 &amp; 32.00 &amp; 14.40 &amp; 6.00 &amp; 68.00 \\\\ &amp; ~~\\text{ (male) % of adults } \\\\ \\hline LIFEEXP &amp; \\text{ Life expectancy at birth,}&amp; &amp; 67.05 &amp; 71.00 &amp; 11.08 &amp; 40.50 &amp; 82.30 \\\\ &amp; ~~ \\text{ in years } \\\\ \\hline \\end{array} } \\] 1.9 Suplemento Técnico - Teorema del Límite Central Los teoremas del límite central forman la base para gran parte de la inferencia estadística utilizada en el análisis de regresión. Por lo tanto, es útil proporcionar una declaración explícita de una versión del teorema del límite central. Teorema del Límite Central. Supongamos que \\(y_1, \\ldots, y_n\\) están distribuidos de manera independiente con media \\(\\mu\\), varianza finita \\(\\sigma^2\\) y \\(\\mathrm{E}|y|^3\\) es finito. Entonces, \\[ \\lim_{n \\rightarrow \\infty} \\Pr \\left( \\frac{\\sqrt{n}}{\\sigma }(\\overline{y} - \\mu ) \\leq x \\right) = \\Phi \\left( x \\right), \\] para cada \\(x\\), donde \\(\\Phi \\left( \\cdot \\right)\\) es la función de distribución normal estándar. Bajo las suposiciones de este teorema, la distribución reescalada de \\(\\overline{y}\\) se aproxima a una distribución normal estándar a medida que aumenta el tamaño de la muestra, \\(n\\). Interpretamos esto como que, para tamaños de muestra ‘grandes’, la distribución de \\(\\overline{y}\\) puede aproximarse mediante una distribución normal. Investigaciones empíricas han mostrado que tamaños de muestra de \\(n = 25\\) a 50 proporcionan aproximaciones adecuadas para la mayoría de los propósitos. ¿Cuándo no funciona bien el teorema del límite central? Algunos conocimientos se proporcionan mediante otro resultado de la estadística matemática. Aproximación de Edgeworth. Supongamos que \\(y_1, \\ldots, y_n\\) están distribuidos idéntica e independientemente con media \\(\\mu\\), varianza finita \\(\\sigma^2\\) y \\(\\mathrm{E}|y|^3\\) es finito. Entonces, \\[ \\Pr \\left( \\frac{\\sqrt{n}}{\\sigma }(\\overline{y} - \\mu ) \\leq x \\right) = \\Phi \\left( x \\right) + \\frac{1}{6}\\frac{1}{\\sqrt{2\\pi }} e^{-x^2/2} \\frac{\\mathrm{E}(y - \\mu)^3}{\\sigma^3 \\sqrt{n}} + \\frac{h_n}{\\sqrt{n}}, \\] para cada \\(x\\), donde \\(h_n \\rightarrow 0\\) a medida que \\(n \\rightarrow \\infty\\). Este resultado sugiere que la distribución de \\(\\bar{y}\\) se acerca más a una distribución normal a medida que la asimetría, \\(\\mathrm{E}(\\overline{y} - \\mu)^3\\), se acerca a cero. Esto es importante en aplicaciones de seguros porque muchas distribuciones tienden a ser asimétricas. Históricamente, los analistas utilizaban el segundo término en el lado derecho del resultado para proporcionar una ‘corrección’ para la aproximación de la curva normal. Véase, por ejemplo, Beard, Pentikäinen y Pesonen (1984) para una discusión adicional sobre las aproximaciones de Edgeworth en la ciencia actuarial. Una alternativa (utilizada en este libro) que vimos en la Sección 1.3 es transformar los datos, logrando así una aproximada simetría. Como sugiere el teorema de aproximación de Edgeworth, si nuestra población parental es cercana a simétrica, entonces la distribución de \\(\\overline{y}\\) será aproximadamente normal. "],["C2BasicLR.html", "Chapter 2 Regresión Lineal Básica 2.1 Correlaciones y Mínimos Cuadrados 2.2 Modelo Básico de Regresión Lineal 2.3 ¿Es Útil el Modelo? Algunas Medidas de Resumen Básicas 2.4 Propiedades de los Estimadores del Coeficiente de Regresión 2.5 Inferencia Estadística 2.6 Construyendo un Mejor Modelo: Análisis de Residuos 2.7 Aplicación: Modelo de Valoración de Activos Financieros 2.8 Salida Computacional Ilustrativa de Regresión 2.9 Lecturas Adicionales y Referencias 2.10 Ejercicios 2.11 Suplemento Técnico - Elementos del Álgebra de Matrices", " Chapter 2 Regresión Lineal Básica Vista previa del capítulo. Este capítulo considera la regresión en el caso de tener solo una variable explicativa. A pesar de esta aparente simplicidad, la mayoría de las ideas profundas de la regresión pueden desarrollarse en este marco. Al limitarnos al caso de una variable, podemos expresar muchos cálculos usando álgebra simple. Esto nos permitirá desarrollar nuestra intuición sobre las técnicas de regresión al reforzarla con demostraciones simples. Además, podemos ilustrar las relaciones entre dos variables gráficamente porque estamos trabajando en solo dos dimensiones. Las herramientas gráficas resultan ser importantes para desarrollar un vínculo entre los datos y un modelo. 2.1 Correlaciones y Mínimos Cuadrados La regresión trata sobre relaciones. Específicamente, estudiaremos cómo dos variables, una \\(x\\) y una \\(y\\), están relacionadas. Queremos poder responder preguntas como, si cambiamos el nivel de \\(x\\), ¿qué pasará con el nivel de \\(y\\)? Si comparamos dos “sujetos” que parecen similares excepto por la medición de \\(x\\), ¿cómo diferirán sus mediciones de \\(y\\)? Entender las relaciones entre variables es fundamental para la gestión cuantitativa, particularmente en ciencias actuariales donde la incertidumbre es tan prevalente. Es útil trabajar con un ejemplo específico para familiarizarnos con conceptos clave. El análisis de ventas de lotería no ha sido parte de la práctica actuarial tradicional, pero es un área de crecimiento en la que los actuarios podrían contribuir. Ejemplo: Ventas de la Lotería de Wisconsin. Los administradores de la lotería del estado de Wisconsin están interesados en evaluar los factores que afectan las ventas de lotería. Las ventas consisten en boletos de lotería en línea que se venden en establecimientos minoristas seleccionados en Wisconsin. Estos boletos generalmente tienen un precio de $1.00, por lo que el número de boletos vendidos equivale a los ingresos de la lotería. Analizamos las ventas promedio de lotería (SALES) durante un período de cuarenta semanas, de abril de 1998 a enero de 1999, en cincuenta áreas seleccionadas al azar identificadas por código postal (ZIP) dentro del estado de Wisconsin. Aunque muchas variables económicas y demográficas podrían influir en las ventas, nuestro primer análisis se centra en la población (POP) como un determinante clave. El Capítulo 3 mostrará cómo considerar variables explicativas adicionales. Intuitivamente, parece claro que las áreas geográficas con más personas tendrán mayores ventas. Entonces, otras cosas siendo iguales, un \\(x=POP\\) más grande significa un \\(y=SALES\\) más grande. Sin embargo, la lotería es una fuente importante de ingresos para el estado y queremos ser lo más precisos posible. Una notación adicional será útil posteriormente. En esta muestra, hay cincuenta áreas geográficas y usamos subíndices para identificar cada área. Por ejemplo, \\(y_1\\) = 1,285.4 representa las ventas para la primera área en la muestra que tiene una población de \\(x_1\\) = 435. Llamamos al par ordenado (\\(x_1\\), \\(y_1\\)) = (435, 1285.4) la primera observación. Extendiendo esta notación, la muestra completa que contiene cincuenta observaciones puede representarse por (\\(x_1\\), \\(y_1\\)), …, (\\(x_{50}\\), \\(y_{50}\\)). Los puntos suspensivos ( … ) significan que el patrón continúa hasta que se encuentra el último objeto. A menudo hablaremos de un miembro genérico de la muestra, refiriéndonos a (\\(x_i\\), \\(y_i\\)) como la \\(i\\)-ésima observación. Los conjuntos de datos pueden complicarse, por lo que será útil si comienza trabajando con cada variable por separado. Los dos paneles en la Figura 2.1 muestran histogramas que dan una impresión visual rápida de la distribución de cada variable de forma aislada. La Tabla 2.1 proporciona resúmenes numéricos correspondientes. Para ilustrar, para la variable población (POP), vemos que el área con el menor número contenía 280 personas, mientras que la más grande contenía 39,098. El promedio, sobre 50 códigos postales, fue de 9,311.04. Para nuestra segunda variable, las ventas fueron tan bajas como 189 y tan altas como 33,181. Figura 2.1: Histogramas de Población y Ventas. Cada distribución está sesgada a la derecha, lo que indica que hay muchas áreas pequeñas en comparación con unas pocas áreas con mayores ventas y poblaciones. Tabla 2.1: Estadísticas Resumen de Cada Variable Promedio Mediana Desviación Estándar Mínimo Máximo POP 9,311 4,406 11,098 280 39,098 SALES 6,495 2,426 8,103 189 33,181 Fuente: Frees y Miller (2003) Código R para producir la Figura 2.1 y la Tabla 2.1 Lot &lt;- read.csv(&quot;CSVData/WiscLottery.csv&quot;, header=TRUE) # FIGURA 2.1 par(mfrow=c(1, 2), cex=1.3, mar=c(4.1,3.1,1.2,1)) hist(Lot$POP, main=&quot;&quot;, ylab=&quot;&quot;, las=1, xlab = &quot;POP&quot;) mtext(&quot;Frecuencia&quot;, side=2, at=30, las=1, cex=1.3, adj=.6) hist(Lot$SALES, main=&quot;&quot;, ylab=&quot;&quot;, las=1, xlab = &quot;SALES&quot;) mtext(&quot;Frecuencia&quot;, side=2, at=34, las=1, cex=1.3, adj=.6) # TABLA 2.1 ESTADÍSTICAS RESUMEN BookSummStats &lt;- function(Xymat){ meanSummary &lt;- sapply(Xymat, mean, na.rm=TRUE) sdSummary &lt;- sapply(Xymat, sd, na.rm=TRUE) minSummary &lt;- sapply(Xymat, min, na.rm=TRUE) maxSummary &lt;- sapply(Xymat, max, na.rm=TRUE) medSummary &lt;- sapply(Xymat, median,na.rm=TRUE) tableMat &lt;- cbind(meanSummary, medSummary, sdSummary, minSummary, maxSummary) return(tableMat) } Xymat &lt;- data.frame(cbind(Lot$POP,Lot$SALES)) tableMat &lt;- BookSummStats(Xymat) colnames(tableMat) &lt;- c(&quot;Promedio&quot; , &quot;Mediana&quot; , &quot;Desviación Estándar&quot; , &quot;Mínimo&quot; , &quot;Máximo&quot;) rownames(tableMat) &lt;- c(&quot;POP&quot;, &quot;SALES&quot;) tableMat1 &lt;- format(round(tableMat, digits=0), big.mark = &#39;,&#39;) TableGen1(TableData=tableMat1, TextTitle=&#39;Estadísticas Resumen de Cada Variable&#39;, Align=&#39;r&#39;, Digits=0, ColumnSpec=1:5, ColWidth = ColWidth5) %&gt;% footnote(general = &quot;Frees y Miller (2003)&quot;, general_title = &quot;Fuente:&quot;, footnote_as_chunk = TRUE) Como muestra la Tabla 2.1, las estadísticas resumen básicas dan ideas útiles de la estructura de las características clave de los datos. Después de entender la información en cada variable de forma aislada, podemos comenzar a explorar la relación entre las dos variables. Gráfico de Dispersión y Coeficientes de Correlación - Herramientas Básicas de Resumen La herramienta gráfica básica utilizada para investigar la relación entre dos variables es un gráfico de dispersión, como se muestra en la Figura 2.2. Aunque podemos perder los valores exactos de las observaciones al graficar los datos, ganamos una impresión visual de la relación entre la población y las ventas. En la Figura 2.2 vemos que las áreas con poblaciones más grandes tienden a comprar más boletos de lotería. ¿Qué tan fuerte es esta relación? ¿Puede el conocimiento de la población del área ayudarnos a anticipar los ingresos por ventas de lotería? Exploramos estas dos preguntas a continuación. Figura 2.2: Un gráfico de dispersión de los datos de la lotería. Cada uno de los 50 símbolos de la gráfica corresponde a un código postal en el estudio. Esta figura sugiere que las áreas postales con poblaciones más grandes tienen mayores ingresos de lotería. Código R para Producir la Figura 2.2 #Lot &lt;- read.csv(&quot;CSVData/WiscLottery.csv&quot;, header=TRUE) # FIGURA 2.2, CON CORRELACIONES par(mar=c(4.1,3.8,2,1),cex=1.1) plot(Lot$POP, Lot$SALES, ylab=&quot;&quot;, las=1, xlab = &quot;POP&quot;) mtext(&quot;SALES&quot;,side=2, at=36000, las=1, cex=1.1) Una forma de resumir la fuerza de la relación entre dos variables es a través de una estadística de correlación. Definición. El coeficiente de correlación ordinario, o de Pearson se define como \\[\\begin{equation*} r=\\frac{1}{(n-1)s_xs_y}\\sum_{i=1}^{n}\\left( x_{i}-\\overline{x}\\right) \\left( y_{i}-\\overline{y}\\right) . \\end{equation*}\\] Aquí, usamos la desviación estándar de la muestra \\(s_y = \\sqrt{(n-1)^{-1} \\sum_{i=1}^{n}\\left( y_i - \\overline{y}\\right)^{2}}\\) definida en la Sección 1.2, con una notación similar para \\(s_x\\). Aunque existen otras estadísticas de correlación, el coeficiente de correlación ideado por Pearson (1895) tiene varias propiedades deseables. Una propiedad importante es que, para cualquier conjunto de datos, \\(r\\) está acotado entre -1 y 1, es decir, \\(-1\\leq r\\leq 1\\). (El Ejercicio 2.3 proporciona pasos para comprobar esta propiedad.) Si \\(r\\) es mayor que cero, se dice que las variables están correlacionadas positivamente. Si \\(r\\) es menor que cero, se dice que las variables están correlacionadas negativamente. Cuanto mayor sea el coeficiente en valor absoluto, más fuerte será la relación. De hecho, si \\(r=1\\), entonces las variables están perfectamente correlacionadas. En este caso, todos los datos se encuentran en una línea recta que pasa por los cuadrantes inferior izquierdo y superior derecho. Si \\(r=-1\\), entonces todos los datos se encuentran en una línea que pasa por los cuadrantes superior izquierdo e inferior derecho. El coeficiente \\(r\\) es una medida de una relación lineal entre dos variables. Se dice que el coeficiente de correlación es invariante a la ubicación y la escala. Así, el centro de ubicación de cada variable no importa en el cálculo de \\(r\\). Por ejemplo, si agregamos $100 a las ventas de cada código postal, cada \\(y_i\\) aumentará en 100. Sin embargo, \\(\\overline{y}\\), el precio de compra promedio, también aumentará en 100 de modo que la desviación \\(y_i - \\overline{y}\\) permanece sin cambios, o invariante. Además, la escala de cada variable no importa en el cálculo de \\(r\\). Por ejemplo, supongamos que dividimos cada población entre 1000, de modo que \\(x_i\\) ahora representa la población en miles. Así, \\(\\overline{x}\\) también se divide entre 1000 y usted debería verificar que \\(s_x\\) también se divide entre 1000. Así, la versión estandarizada de \\(x_i\\), \\(\\left( x_i-\\overline{x}\\right) /s_x\\), permanece sin cambios, o invariante. Muchos paquetes estadísticos calculan una versión estandarizada de una variable restando el promedio y dividiendo por la desviación estándar. Ahora, usemos \\(y_{i,std}=\\left( y_i- \\overline{y}\\right) /s_y\\) y \\(x_{i,std}=\\left( x_i-\\overline{x} \\right) /s_x\\) para que sean las versiones estandarizadas de \\(y_i\\) y \\(x_i\\), respectivamente. Con esta notación, podemos expresar el coeficiente de correlación como \\(r=(n-1)^{-1}\\sum_{i=1}^{n}x_{i,std}\\times y_{i,std}.\\) Se dice que el coeficiente de correlación es una medida adimensional. Esto se debe a que hemos eliminado dólares, y todas las demás unidades de medida, considerando las variables estandarizadas \\(x_{i,std}\\) y \\(y_{i,std}\\). Debido a que el coeficiente de correlación no depende de las unidades de medida, es una estadística que puede compararse fácilmente entre diferentes conjuntos de datos. En el mundo de los negocios, el término “correlación” se usa a menudo como sinónimo del término “relación.” Para los propósitos de este texto, utilizamos el término correlación cuando nos referimos únicamente a relaciones lineales. La relación no lineal clásica es \\(y=x^{2}\\), una relación cuadrática. Considere esta relación y el conjunto de datos ficticios para \\(x\\), \\(\\{-2,1,0,1,2\\}\\). Ahora, como ejercicio (2.2), produzca un gráfico aproximado del conjunto de datos: \\[ \\begin{array}{l|rrrrr} \\hline i &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 \\\\ \\hline x_i &amp; -2 &amp; -1 &amp; 0 &amp; 1 &amp; 2 \\\\ y_i &amp; 4 &amp; 1 &amp; 0 &amp; 1 &amp; 4 \\\\ \\hline \\end{array} \\] El coeficiente de correlación para este conjunto de datos resulta ser \\(r=0\\) (verifíquelo). Por lo tanto, a pesar de que hay una relación perfecta entre \\(x\\) y \\(y\\) (\\(=x^{2}\\)), hay una correlación cero. Recuerde que los cambios de ubicación y escala no son relevantes en las discusiones sobre correlación, por lo que podríamos cambiar fácilmente los valores de \\(x\\) y \\(y\\) para que sean más representativos de un conjunto de datos de negocios. ¿Qué tan fuerte es la relación entre \\(y\\) y \\(x\\) para los datos de la lotería? Gráficamente, la respuesta es un gráfico de dispersión, como en la Figura 2.2. Numéricamente, la respuesta principal es el coeficiente de correlación, que resulta ser \\(r\\) = 0.886 para este conjunto de datos. Interpretamos esta estadística diciendo que SALES y POP están correlacionados (positivamente). La fuerza de la relación es fuerte porque \\(r\\) = 0.886 está cerca de uno. En resumen, podemos describir esta relación diciendo que hay una fuerte correlación entre SALES y POP. Método de Mínimos Cuadrados Ahora comenzamos a explorar la pregunta: “¿Puede el conocimiento de la población ayudarnos a entender las ventas?” Para responder a esta pregunta, identificamos las ventas como la variable de respuesta, o dependiente. La variable de población, que se usa para ayudar a entender las ventas, se llama la variable explicativa, o independiente. Supongamos que tenemos disponibles los datos de muestra de cincuenta ventas \\(\\{y_1, \\ldots, y_{50} \\}\\) y tu trabajo es predecir las ventas de un código postal seleccionado al azar. Sin conocimiento de la variable de población, un predictor sensato es simplemente \\(\\overline{y}=6,495\\), el promedio de la muestra disponible. Naturalmente, anticipas que las áreas con mayores poblaciones tendrán mayores ventas. Es decir, si también tienes conocimiento de la población, ¿puede mejorarse esta estimación? Si es así, ¿cuánto? Para responder a estas preguntas, el primer paso asume una relación lineal aproximada entre \\(x\\) y \\(y\\). Para ajustar una línea a nuestro conjunto de datos, usamos el método de mínimos cuadrados. Necesitamos una técnica general para que, si diferentes analistas están de acuerdo en los datos y en la técnica de ajuste, entonces estarán de acuerdo en la línea. Si diferentes analistas ajustan un conjunto de datos usando aproximaciones a ojo, en general llegarán a diferentes líneas, incluso usando el mismo conjunto de datos. El método comienza con la línea \\(y=b_0^{\\ast}+b_1^{\\ast}x\\), donde la intersección y la pendiente, \\(b_0^{\\ast}\\) y \\(b_1^{\\ast}\\), son meramente valores genéricos. Para la \\(i\\)-ésima observación, \\(y_i-\\left( b_0^{\\ast}+b_1^{\\ast}x_i\\right)\\) representa la desviación del valor observado \\(y_i\\) de la línea en \\(x_i\\). La cantidad \\[\\begin{equation*} SS(b_0^{\\ast},b_1^{\\ast})=\\sum_{i=1}^{n}\\left( y_i-\\left( b_0^{\\ast}+b_1^{\\ast}x_i\\right) \\right) ^{2} \\end{equation*}\\] representa la suma de desviaciones cuadradas para esta línea candidata. El método de mínimos cuadrados consiste en determinar los valores de \\(b_0^{\\ast}\\) y \\(b_1^{\\ast}\\) que minimizan \\(SS(b_0^{\\ast},b_1^{\\ast})\\). Este es un problema fácil que puede resolverse mediante cálculo, de la siguiente manera. Tomando derivadas parciales con respecto a cada argumento obtenemos \\[\\begin{equation*} \\frac{\\partial }{\\partial b_0^{\\ast}}SS(b_0^{\\ast},b_1^{\\ast})=\\sum_{i=1}^{n}(-2)\\left( y_i-\\left( b_0^{\\ast}+b_1^{\\ast}x_i\\right) \\right) \\end{equation*}\\] y \\[\\begin{equation*} \\frac{\\partial }{\\partial b_1^{\\ast}}SS(b_0^{\\ast},b_1^{\\ast})=\\sum_{i=1}^{n}(-2x_i)\\left( y_i-\\left( b_0^{\\ast}+b_1^{\\ast}x_i\\right) \\right) . \\end{equation*}\\] Se invita al lector a tomar las segundas derivadas parciales para asegurarse de que estamos minimizando, no maximizando, esta función. Igualando estas cantidades a cero y cancelando términos constantes obtenemos \\[\\begin{equation*} \\sum_{i=1}^{n}\\left( y_i-\\left( b_0^{\\ast}+b_1^{\\ast}x_i\\right) \\right) =0 \\end{equation*}\\] y \\[\\begin{equation*} \\sum_{i=1}^{n}x_i\\left( y_i-\\left( b_0^{\\ast}+b_1^{\\ast}x_i\\right) \\right) =0, \\end{equation*}\\] que son conocidas como las ecuaciones normales. Resolver estas ecuaciones proporciona los valores de \\(b_0^{\\ast}\\) y \\(b_1^{\\ast}\\) que minimizan la suma de cuadrados. Definición. Las estimaciones de intersección y pendiente de mínimos cuadrados son \\[\\begin{equation*} b_1=r\\frac{s_y}{s_x}~~~~~\\mathrm{y}~~~~~b_0=\\overline{y}-b_1 \\overline{x}. \\end{equation*}\\] La línea que determinan, \\(\\widehat{y}=b_0+b_1x\\), se llama la línea de regresión ajustada. Hemos eliminado la notación de asterisco, o estrella, porque \\(b_0\\) y \\(b_1\\) ya no son valores “candidatos”. ¿Proporciona este procedimiento una línea sensata para nuestras ventas de lotería de Wisconsin? Anteriormente, calculamos \\(r=0.886\\). A partir de esto y de las estadísticas básicas resumidas en la Tabla 2.1, tenemos \\(b_1 = 0.886 \\left( 8,103\\right) /11,098=0.647\\) y \\(b_0 = 6,495-(0.647)9,311 = 469.7\\). Esto produce la línea de regresión ajustada \\[\\begin{equation*} \\widehat{y} = 469.7 + (0.647)x. \\end{equation*}\\] El sombrero, o “gorro”, encima de la \\(y\\) nos recuerda que esta \\(\\widehat{y}\\), o \\(\\widehat{SALES}\\), es un valor ajustado. Una aplicación de la línea de regresión es estimar ventas para una población específica, digamos, \\(x=10,000\\). La estimación es la altura de la línea de regresión, que es \\(469.7 + (0.647)(10,000) = 6,939.7\\). Ejemplo: Resumiendo Simulaciones. El análisis de regresión es una herramienta para resumir datos complejos. En el trabajo práctico, los actuarios a menudo simulan escenarios financieros complicados; a menudo se pasa por alto que la regresión puede usarse para resumir relaciones de interés. Para ilustrar, Manistre y Hancock (2005) simularon muchas realizaciones de una opción put europea a 10 años y demostraron la relación entre dos medidas de riesgo actuarial, el valor en riesgo (VaR) y la expectativa de cola condicional (CTE). Para un ejemplo, estos autores examinaron rendimientos de acciones distribuidos logarítmicamente con un precio inicial de $100, de modo que en 10 años el precio de la acción estaría distribuido como \\[\\begin{equation*} S(Z)=100 \\exp \\left( (.08) 10 + .15 \\sqrt{10} Z \\right), \\end{equation*}\\] basado en un retorno medio anual del 8%, desviación estándar del 15% y el resultado de una variable aleatoria normal estándar \\(Z\\). La opción put paga la diferencia entre el precio de ejercicio, que se tomará como 110 para este ejemplo, y \\(S(Z)\\). El valor presente de esta opción es \\[\\begin{equation*} C(Z)= \\mathrm{e}^{-0.06(10)} \\mathrm{max} \\left(0, 110-S(Z) \\right), \\end{equation*}\\] basado en una tasa de descuento del 6%. Para estimar el VaR y el CTE, para cada \\(i\\), se simularon 1000 variables aleatorias normales estándar i.i.d. y se usaron para calcular 1000 valores presentes, \\(C_{i1}, \\ldots, C_{i,1000}.\\) El percentil 95 de estos valores presentes es la estimación del valor en riesgo, denotado como \\(VaR_i.\\) El promedio de los 50 valores presentes más altos (\\(= (1-.05) \\times 1000\\)) es la estimación de la expectativa de cola condicional, denotada como \\(CTE_i\\). Manistre y Hancock (2005) realizaron este cálculo \\(i=1, \\ldots, 1000\\) veces; el resultado se presenta en la Figura 2.3. El diagrama de dispersión muestra una relación fuerte pero no perfecta entre el \\(VaR\\) y el \\(CTE\\), el coeficiente de correlación resulta ser \\(r=0.782\\). Figura 2.3: Gráfico de la Expectativa de Cola Condicional (CTE) frente al Valor en Riesgo (VaR). Basado en \\(n=1,000\\) simulaciones de un bono put europeo a 10 años. Fuente: Manistre y Hancock (2005). Código R para producir la Figura 2.3 # FIGURA 2.3 # simulación S &lt;- vector(mode = &quot;numeric&quot;, length = 1000) C &lt;- vector(mode = &quot;numeric&quot;, length = 1000) Var &lt;- vector(mode = &quot;numeric&quot;, length = 1000) CTE &lt;- vector(mode = &quot;numeric&quot;, length = 1000) for (i in 1:1000){ for (j in 1:1000){ S[j] &lt;- 100 * exp(.08 * 10 + .15 * (10 ^ .5) * rnorm(1)) C[j] &lt;- exp(-.06 * 10) * max(0, 110 - S[j]) } C &lt;- sort(C) Var[i] &lt;- C[950] CTE[i] &lt;- mean(C[950:1000]) } model &lt;- lm(CTE ~ Var) b0 &lt;- round(model$coef[1], digits = 3) b1 &lt;- round(model$coef[2], digits = 3) R2 &lt;- round(summary(model)$r.squared, digits = 4) plot(Var, CTE, xlab = expression(paste(&quot;Estimaciones de VaR&quot;)), ylab = expression(paste(&quot;Estimaciones de CTE&quot;)), xlim = c(0, 12), ylim = c(8, 20), xaxs = &quot;i&quot;, yaxs = &quot;i&quot;, pch = 20, cex = 0.4) lines(Var, model$fitted, lwd = .5) abline(h = c(10, 12, 14, 16, 18, 20), col = &quot;grey&quot;) 2.2 Modelo Básico de Regresión Lineal El diagrama de dispersión, el coeficiente de correlación y la línea de regresión ajustada son herramientas útiles para resumir la relación entre dos variables para un conjunto de datos específico. Para inferir relaciones generales, necesitamos modelos para representar los resultados de poblaciones amplias. Este capítulo se centra en un modelo de “regresión lineal básica”. La parte de “regresión lineal” proviene del hecho de que ajustamos una línea a los datos. La parte de “básica” es porque usamos solo una variable explicativa, \\(x\\). Este modelo también se conoce como una “regresión lineal simple”. Este texto evita este lenguaje porque da la falsa impresión de que las ideas e interpretaciones de regresión con una variable explicativa son siempre sencillas. Ahora introducimos dos conjuntos de supuestos del modelo básico, las representaciones “observables” y de “error”. Son equivalentes, pero cada una nos ayudará a medida que extendamos los modelos de regresión más allá de lo básico. \\[ {\\small \\begin{array}{l} \\hline \\hline &amp;\\textbf{Modelo Básico de Regresión Lineal} \\\\ &amp;\\textbf{Supuestos de Muestreo de la Representación Observable} \\\\ \\hline \\text{F1}. &amp; \\mathrm{E}~y_i=\\beta_0 + \\beta_1 x_i . \\\\ \\text{F2}. &amp; \\{x_1,\\ldots ,x_n\\} \\text{son variables no estocásticas}. \\\\ \\text{F3}. &amp; \\mathrm{Var}~y_i=\\sigma ^{2}. \\\\ \\text{F4}. &amp; \\{ y_i\\} \\text{son variables aleatorias independientes}. \\\\ \\hline\\ \\end{array} } \\] La “representación observable” se enfoca en variables que podemos ver (u observar), \\((x_i,y_i)\\). La inferencia sobre la distribución de \\(y\\) es condicional a las variables explicativas observadas, de modo que podemos tratar \\(\\{x_1,\\ldots ,x_n\\}\\) como variables no estocásticas (supuesto F2). Al considerar tipos de mecanismos de muestreo para \\((x_i,y_i)\\), es conveniente pensar en un esquema de muestreo aleatorio estratificado, donde los valores de \\(\\{x_1,\\ldots ,x_n\\}\\) se tratan como los estratos, o grupos. Bajo el muestreo estratificado, para cada valor único de \\(x_i\\), tomamos una muestra aleatoria de una población. Para ilustrar, supongamos que se está extrayendo de una base de datos de empresas para comprender el rendimiento de las acciones (\\(y\\)) y desea estratificar según el tamaño de la empresa. Si la cantidad de activos es una variable continua, entonces podemos imaginar tomar una muestra de tamaño 1 para cada empresa. De esta manera, hipotetizamos una distribución de rendimientos de acciones condicional al tamaño de los activos de la empresa. Digresión: A menudo verá informes que resumen resultados para los “50 mejores gerentes” o las “100 mejores universidades”, medidos por alguna variable de resultado. En aplicaciones de regresión, asegúrese de no seleccionar observaciones basadas en una variable dependiente, como el rendimiento más alto de las acciones, porque esto es estratificar basado en el \\(y\\), no en el \\(x\\). El Capítulo 6 discutirá los procedimientos de muestreo con mayor detalle. El muestreo estratificado también proporciona motivación para el supuesto F4, la independencia entre respuestas. Se puede motivar el supuesto F1 pensando en \\((x_i,y_i)\\) como una extracción de una población, donde la media de la distribución condicional de \\(y_i\\) dado {\\(x_i\\)} es lineal en la variable explicativa. El supuesto F3 se conoce como homocedasticidad, que discutiremos ampliamente en la Sección 5.7. Ver Goldberger (1991) para más información sobre esta representación. Un quinto supuesto que a menudo se usa implícitamente es: \\[ \\text{F5}. \\{y_i\\} \\text{ están distribuidos normalmente}. \\] Este supuesto no es necesario para muchos procedimientos de inferencia estadística porque los teoremas del límite central proporcionan normalidad aproximada para muchas estadísticas de interés. Sin embargo, la justificación formal para algunas, como las estadísticas \\(t\\), requieren este supuesto adicional. En contraste con la representación observable, un conjunto alternativo de supuestos se enfoca en las desviaciones, o “errores”, en la regresión, definidos como \\(\\varepsilon_i=y_i-\\left( \\beta_0 + \\beta_1 x_i \\right)\\). \\[ {\\small \\begin{array}{l} \\hline \\hline &amp;\\textbf{Modelo Básico de Regresión Lineal} \\\\ &amp;\\textbf{Supuestos de Muestreo de la Representación de Error} \\\\ \\hline \\text{E1}. &amp; y_i=\\beta_0 + \\beta_1 x_i + \\varepsilon_i . \\\\ \\text{E2}. &amp; \\{x_1,\\ldots ,x_n\\} \\text{ son variables no estocásticas}. \\\\ \\text{E3}. &amp; \\mathrm{E}~\\varepsilon _i=0 \\text{ y } \\mathrm{Var}~\\varepsilon _i=\\sigma ^{2}. \\\\ \\text{E4}. &amp; \\{ \\varepsilon_i\\} \\text{ son variables aleatorias independientes}. \\\\ \\hline\\ \\end{array} } \\] La “representación de error” se basa en la teoría gaussiana de errores (ver Stigler, 1986, para un contexto histórico). El supuesto E1 asume que \\(y\\) es en parte debido a una función lineal de la variable explicativa observada, \\(x\\). Otras variables no observadas que influyen en la medición de \\(y\\) se interpretan como incluidas en el término de “error” \\(\\varepsilon _i\\), que también se conoce como el término de “perturbación”. La independencia de errores, E4, puede motivarse asumiendo que {\\(\\varepsilon _i\\)} se realizan a través de una muestra aleatoria simple de una población desconocida de errores. Los supuestos E1-E4 son equivalentes a F1-F4. La representación de error proporciona una base útil para motivar las medidas de ajuste (Sección 2.3). Sin embargo, una desventaja de la representación de error es que desvía la atención de las cantidades observables \\((x_i,y_i)\\) a una cantidad no observable, {\\(\\varepsilon _i\\)}. Para ilustrar, la base de muestreo, ver {\\(\\varepsilon _i\\)} como una muestra aleatoria simple, no es directamente verificable porque no se puede observar directamente la muestra {\\(\\varepsilon _i\\)}. Además, el supuesto de errores aditivos en E1 será problemático cuando consideremos modelos de regresión no lineales. La Figura 2.4 ilustra algunos de los supuestos del modelo básico de regresión lineal. Los datos (\\(x_1,y_1\\)), (\\(x_2,y_2\\)) y (\\(x_3,y_3\\)) son observados y se representan con los símbolos de trazado circulares opacos. Según el modelo, estas observaciones deben estar cerca de la línea de regresión \\(\\mathrm{E}~y = \\beta_0 + \\beta_1 x\\). Cada desviación de la línea es aleatoria. A menudo asumimos que la distribución de desviaciones puede representarse por una curva normal, como en la Figura 2.4. Figura 2.4: La distribución de la respuesta varía según el nivel de la variable explicativa. Los supuestos del modelo básico de regresión lineal describen la población subyacente. Tabla 2.2 destaca la idea de que las características de esta población pueden resumirse mediante los parámetros \\(\\beta_0\\), \\(\\beta_1\\) y \\(\\sigma ^{2}\\). En la Sección 2.1, resumimos datos de una muestra, introduciendo las estadísticas \\(b_0\\) y \\(b_1\\). La Sección 2.3 introducirá \\(s^{2}\\), la estadística correspondiente al parámetro \\(\\sigma ^{2}\\). Tabla 2.2. Medidas Resumen de la Población y la Muestra \\[ {\\small \\begin{array}{llccc}\\hline\\hline &amp; \\text{Resumen} \\\\ \\text{Datos} &amp; \\text{Medidas} &amp; \\text{Intercepto} &amp; \\text{Pendiente} &amp; \\text{Varianza} \\\\\\hline \\text{Población} &amp; \\text{Parámetros} &amp; \\beta_0 &amp; \\beta_1 &amp; \\sigma^2 \\\\ \\text{Muestra} &amp; \\text{Estadísticas} &amp; b_0 &amp; b_1 &amp; s^2 \\\\ \\hline \\end{array} } \\] 2.3 ¿Es Útil el Modelo? Algunas Medidas de Resumen Básicas Aunque la estadística es la ciencia de resumir datos, también es el arte de argumentar con datos. Esta sección desarrolla algunas de las herramientas básicas usadas para justificar el modelo de regresión lineal básica. Un diagrama de dispersión puede proporcionar una fuerte evidencia visual de que \\(x\\) influye en \\(y\\); desarrollar evidencia numérica nos permitirá cuantificar la fuerza de la relación. Además, la evidencia numérica será útil cuando consideremos otros conjuntos de datos donde la evidencia gráfica no sea convincente. 2.3.1 Particionando la Variabilidad Las desviaciones cuadradas, \\(\\left( y_i-\\overline{y}\\right) ^2\\), proporcionan una base para medir la dispersión de los datos. Si deseamos estimar la \\(i\\)-ésima variable dependiente sin conocimiento de \\(x\\), entonces \\(\\overline{y}\\) es una estimación adecuada y \\(y_i- \\overline{y}\\) representa la desviación de la estimación. Usamos \\(Total~SS=\\sum_{i=1}^{n}\\left( y_i-\\overline{y}\\right) ^2\\), la suma total de cuadrados, para representar la variación en todas las respuestas. Supongamos ahora que también tenemos conocimiento de \\(x\\), una variable explicativa. Usando la línea de regresión ajustada, para cada observación podemos calcular el valor ajustado correspondiente, \\(\\widehat{y}_i = b_0 + b_1x_i\\). El valor ajustado es nuestra estimación con conocimiento de la variable explicativa. Como antes, la diferencia entre la respuesta y el valor ajustado, \\(y_i- \\widehat{y}_i\\), representa la desviación de esta estimación. Ahora tenemos dos “estimaciones” de \\(y_i\\), que son \\(\\widehat{y}_i\\) y \\(\\overline{y}\\). Presumiblemente, si la línea de regresión es útil, entonces \\(\\widehat{y}_i\\) es una medida más precisa que \\(\\overline{y}\\). Para juzgar esta utilidad, descomponemos algebraicamente la desviación total como: \\[\\begin{equation} {\\small \\begin{array}{ccccc} \\underbrace{y_i-\\overline{y}} &amp; = &amp; \\underbrace{y_i-\\widehat{y}_i} &amp; + &amp; \\underbrace{\\widehat{y}_i-\\overline{y}} \\\\ \\text{desviación} &amp; = &amp; \\text{desviación} &amp; + &amp; \\text{desviación} \\\\ \\text{total} &amp; &amp; \\text{no explicada} &amp; &amp; \\text{explicada} \\\\ \\end{array} \\tag{2.1} } \\end{equation}\\] Interpreta esta ecuación como “la desviación sin conocimiento de \\(x\\) es igual a la desviación con conocimiento de \\(x\\) más la desviación explicada por \\(x\\).” La Figura 2.5 es una representación geométrica de esta descomposición. En la figura, se eligió una observación por encima de la línea, lo que da una desviación positiva de la línea de regresión ajustada, para hacer que el gráfico sea más fácil de leer. Un buen ejercicio es hacer un boceto aproximado correspondiente a la Figura 2.5 con una observación por debajo de la línea de regresión ajustada. Figura 2.5: Representación geométrica de la descomposición de la desviación. Ahora, a partir de la descomposición algebraica en la ecuación (2.1), eleva al cuadrado cada lado de la ecuación y suma sobre todas las observaciones. Después de un poco de manipulación algebraica, esto da como resultado \\[\\begin{equation} \\sum_{i=1}^{n}\\left( y_i-\\overline{y}\\right) ^2=\\sum_{i=1}^{n}\\left( y_i-\\widehat{y}_i\\right) ^2+\\sum_{i=1}^{n}\\left( \\widehat{y}_i- \\overline{y}\\right) ^2. \\tag{2.2} \\end{equation}\\] Reescribimos esto como \\(Total~SS=Error~SS+Regression~SS\\) donde \\(SS\\) significa suma de cuadrados. Interpretamos: \\(Total~SS\\) como la variación total sin conocimiento de \\(x\\), \\(Error~SS\\) como la variación total que queda después de introducir \\(x\\), y \\(Regression~SS\\) como la diferencia entre el \\(Total~SS\\) y el \\(Error~SS\\), o la variación total “explicada” mediante el conocimiento de \\(x\\). Al elevar al cuadrado el lado derecho de la ecuación (2.1), tenemos el término de producto cruzado \\(2\\left(y_i-\\widehat{y}_i\\right) \\left( \\widehat{y}_i-\\overline{y}\\right)\\). Con la “manipulación algebraica”, se puede comprobar que la suma de los productos cruzados sobre todas las observaciones es cero. Este resultado no es cierto para todas las líneas ajustadas, pero es una propiedad especial de la línea ajustada por mínimos cuadrados. En muchos casos, la descomposición de la variabilidad se reporta a través de un solo estadístico. Definición. El coeficiente de determinación se denota por el símbolo \\(R^2\\), llamado “\\(R\\)-cuadrado”, y se define como \\[\\begin{equation*} R^2=\\frac{Regression~SS}{Total~SS}. \\end{equation*}\\] Interpretamos \\(R^2\\) como la proporción de variabilidad explicada por la línea de regresión. En un caso extremo donde la línea de regresión se ajusta perfectamente a los datos, tenemos \\(Error~SS=0\\) y \\(R^2=1\\). En el otro caso extremo donde la línea de regresión no proporciona ninguna información sobre la respuesta, tenemos \\(Regression~SS=0\\) y \\(R^2=0\\). El coeficiente de determinación está limitado por las desigualdades \\(0 \\leq R^2 \\leq 1\\) con valores mayores que implican un mejor ajuste. 2.3.2 El Tamaño de una Desviación Típica: s En el modelo de regresión lineal básica, la desviación de la respuesta de la línea de regresión, $y_i-( _0+_1x_i) $, no es una cantidad observable porque los parámetros \\(\\beta_0\\) y \\(\\beta_1\\) no son observados. Sin embargo, usando los estimadores \\(b_0\\) y \\(b_1\\), podemos aproximar esta desviación usando \\[\\begin{equation*} e_i=y_i-\\widehat{y}_i=y_i-\\left( b_0+b_1x_i\\right) , \\end{equation*}\\] conocido como el residuo. Los residuos serán cruciales para desarrollar estrategias para mejorar la especificación del modelo en la Sección 2.6. Ahora mostramos cómo usar los residuos para estimar \\(\\sigma ^2\\). De un primer curso en estadística, sabemos que si se pudieran observar las desviaciones \\(\\varepsilon _i\\), entonces una estimación deseable de \\(\\sigma ^2\\) sería \\((n-1)^{-1}\\sum_{i=1}^{n}\\left( \\varepsilon _i-\\overline{\\varepsilon }\\right) ^2\\). Como \\(\\{\\varepsilon _i\\}\\) no se observan, usamos lo siguiente. Definición. Un estimador de \\(\\sigma ^2\\), el error cuadrático medio (MSE), se define como \\[\\begin{equation} s^2=\\frac{1}{n-2}\\sum_{i=1}^{n}e_i{}^2. \\tag{2.3} \\end{equation}\\] La raíz cuadrada positiva, \\(s=\\sqrt{s^2},\\) se llama la desviación estándar residual. Comparando las definiciones de \\(s^2\\) y \\((n-1)^{-1}\\sum_{i=1}^{n}\\left( \\varepsilon _i-\\overline{\\varepsilon }\\right) ^2\\), verá dos diferencias importantes. Primero, al definir \\(s^2\\) no hemos restado el residuo promedio de cada residuo antes de elevar al cuadrado. Esto se debe a que el residuo promedio es cero, una propiedad especial de la estimación de mínimos cuadrados (ver Ejercicio 2.14). Este resultado se puede mostrar usando álgebra y está garantizado para todos los conjuntos de datos. En segundo lugar, al definir \\(s^2\\) hemos dividido por \\(n-2\\) en lugar de \\(n-1\\). Intuitivamente, dividir por \\(n\\) o \\(n-1\\) tiende a subestimar \\(\\sigma ^2\\). La razón es que, al ajustar líneas a los datos, necesitamos al menos dos observaciones para determinar una línea. Por ejemplo, debemos tener al menos tres observaciones para que haya alguna variabilidad alrededor de una línea. ¿Cuánta “libertad” hay para la variabilidad alrededor de una línea? Diremos que los grados de libertad del error son el número de observaciones disponibles, \\(n\\), menos el número de observaciones necesarias para determinar una línea, 2 (con símbolos, \\(df=n-2\\)). Sin embargo, como vimos en la subsección de estimación de mínimos cuadrados, no necesitamos identificar dos observaciones reales para determinar una línea. La idea es que si un analista conoce la línea y \\(n-2\\) observaciones, entonces las dos observaciones restantes se pueden determinar, sin variabilidad. Al dividir por \\(n-2\\), se puede mostrar que \\(s^2\\) es un estimador insesgado de \\(\\sigma ^2\\). También podemos expresar \\(s^2\\) en términos de las sumas de cuadrados. Es decir, \\[\\begin{equation*} s^2=\\frac{1}{n-2}\\sum_{i=1}^{n}\\left( y_i-\\widehat{y}_i\\right) ^2= \\frac{Error~SS}{n-2}=MSE. \\end{equation*}\\] Esto nos lleva a la tabla de análisis de varianza o ANOVA: \\[ {\\small \\begin{array}{llcl} \\hline \\hline \\text{Tabla ANOVA} \\\\ \\hline \\text{Fuente} &amp; \\text{Suma de Cuadrados} &amp; df &amp; \\text{Cuadrado Medio} \\\\ \\hline \\text{Regresión} &amp; Regression~SS &amp; 1 &amp; Regression~MS \\\\ \\text{Error} &amp; Error~SS &amp; n-2 &amp; MSE \\\\ \\text{Total} &amp; Total~SS &amp; n-1 &amp; \\\\ \\hline \\hline \\end{array} } \\] La tabla ANOVA es simplemente un dispositivo de contabilidad utilizado para hacer un seguimiento de las fuentes de variabilidad; aparece rutinariamente en paquetes de software estadístico como parte de los resultados de la regresión. Las figuras de la columna de cuadrados medios se definen como las sumas de cuadrados (\\(SS\\)) divididas por sus respectivos grados de libertad (\\(df\\)). En particular, el cuadrado medio de los errores (\\(MSE\\)) es igual a \\(s^2\\) y la suma de cuadrados de la regresión es igual al cuadrado medio de la regresión. Esta última propiedad es específica para la regresión con una variable; no es cierta cuando consideramos más de una variable explicativa. Los grados de libertad del error en la tabla ANOVA son \\(n-2\\). Los grados de libertad totales son \\(n-1\\), lo que refleja el hecho de que la suma total de cuadrados se centra en la media (se requieren al menos dos observaciones para una variabilidad positiva). El grado de libertad único asociado con la parte de regresión significa que la pendiente, más una observación, es suficiente información para determinar la línea. Esto se debe a que se necesitan dos observaciones para determinar una línea y al menos tres observaciones para que haya alguna variabilidad alrededor de la línea. La tabla de análisis de varianza para los datos de la lotería es: Suma de Cuadrados \\(df\\) Cuadrado Medio Regresión 2,527,165,015 1 2,527,165,015 Error 690,116,755 48 14,377,432 Total 3,217,281,770 49 Código R para Producir la Tabla ANOVA de Lotería #Lot &lt;- read.csv(&quot;CSVData/WiscLottery.csv&quot;, header=TRUE) model.basiclinearreg&lt;-lm(Lot$SALES ~ Lot$POP) #summary(model.basiclinearreg) ANOVA &lt;- anova(model.basiclinearreg) row1 &lt;- c(ANOVA$`Sum Sq`[1], ANOVA$`Df`[1], ANOVA$`Mean Sq`[1]) row2 &lt;- c(ANOVA$`Sum Sq`[2], ANOVA$`Df`[2], ANOVA$`Mean Sq`[2]) row3 &lt;- c(ANOVA$`Sum Sq`[1]+ANOVA$`Sum Sq`[2], ANOVA$`Df`[1] +ANOVA$`Df`[2], NaN) ANOVATable &lt;- rbind(row1, row2, row3) ANOVATable1 &lt;- format(round(ANOVATable, digits = 0), big.mark = &#39;,&#39;) ANOVATable1[3,3] &lt;- &quot;&quot; rownames(ANOVATable1) &lt;- c(&quot;Regresión&quot;, &quot;Error&quot;, &quot;Total&quot;) colnames(ANOVATable1) &lt;- c(&quot;Suma de Cuadrados&quot;, &quot;$df$&quot;, &quot;Cuadrado Medio&quot;) kable(ANOVATable1, align = &#39;r&#39;) %&gt;% kable_styling(position = &quot;center&quot;, full_width = FALSE) %&gt;% kableExtra::kable_classic(font = 12, html_font = &quot;Cambria&quot;) De esta tabla, puede verificar que \\(R^2=78.5\\%\\) y \\(s=3,792.\\) 2.4 Propiedades de los Estimadores del Coeficiente de Regresión Las estimaciones de mínimos cuadrados se pueden expresar como una suma ponderada de las respuestas. Para ver esto, define los pesos \\[\\begin{equation*} w_i=\\frac{x_i-\\overline{x}}{s_x^2(n-1)}. \\end{equation*}\\] Como la suma de las desviaciones de \\(x\\) (\\(x_i-\\overline{x}\\)) es cero, vemos que \\(\\sum_{i=1}^{n}w_i=0\\). Así, podemos expresar la estimación de la pendiente \\[\\begin{equation} b_1=r\\frac{s_y}{s_x}=\\frac{1}{(n-1)s_x^2}\\sum_{i=1}^{n}\\left( x_i-\\overline{x}\\right) \\left( y_i-\\overline{y}\\right) =\\sum_{i=1}^{n}w_i\\left( y_i-\\overline{y}\\right) =\\sum_{i=1}^{n}w_iy_i. \\tag{2.4} \\end{equation}\\] Los ejercicios piden al lector verificar que \\(b_0\\) también puede expresarse como una suma ponderada de las respuestas, por lo que nuestra discusión se refiere a ambos coeficientes de regresión. Dado que los coeficientes de regresión son sumas ponderadas de respuestas, pueden verse afectados drásticamente por observaciones inusuales (ver Sección 2.6). Como \\(b_1\\) es una suma ponderada, es sencillo derivar la esperanza y la varianza de esta estadística. Por la linealidad de las esperanzas y la Suposición F1, tenemos \\[\\begin{equation*} \\mathrm{E}~b_1=\\sum_{i=1}^{n}w_i~\\mathrm{E}~y_i=\\beta_0\\sum_{i=1}^{n}w_i+\\beta_1\\sum_{i=1}^{n}w_ix_i=\\beta_1. \\end{equation*}\\] Es decir, \\(b_1\\) es un estimador imparcial de \\(\\beta_1\\). Aquí, la suma \\(\\sum_{i=1}^{n}w_ix_i\\) \\(=\\) \\(\\left[ s_x^2(n-1)\\right] ^{-1}\\sum_{i=1}^{n}\\left( x_i-\\overline{x}\\right) x_i\\) \\(=\\left[s_x^2(n-1)\\right] ^{-1}\\sum_{i=1}^{n}\\left( x_i-\\overline{x}\\right) ^2=1.\\) A partir de la definición de los pesos, una sencilla algebra también muestra que \\(\\sum_{i=1}^{n}w_i^2=1/\\left( s_x^2(n-1)\\right)\\). Además, la independencia de las respuestas implica que la varianza de la suma es la suma de las varianzas, y así tenemos \\[\\begin{equation*} \\mathrm{Var}~b_1 =\\sum_{i=1}^{n}w_i^2\\mathrm{Var}~y_i=\\frac{\\sigma^2}{s_x^2(n-1)}. \\end{equation*}\\] Sustituyendo \\(\\sigma ^2\\) por su estimador \\(s^2\\) y tomando raíces cuadradas se obtiene lo siguiente. Definición. El error estándar de \\(b_1\\), la desviación estándar estimada de \\(b_1\\), se define como \\[\\begin{equation} se(b_1)=\\frac{s}{s_x\\sqrt{n-1}}. \\tag{2.5} \\end{equation}\\] Esta es nuestra medida de la fiabilidad, o precisión, del estimador de la pendiente. Usando la ecuación (2.5), vemos que \\(se(b_1)\\) está determinado por tres cantidades: \\(n\\), \\(s\\) y \\(s_x\\), de la siguiente manera: Si tenemos más observaciones, de manera que \\(n\\) sea mayor, entonces \\(se(b_1)\\) será menor, manteniendo todo lo demás constante. Si las observaciones tienen una mayor tendencia a estar más cerca de la línea, de manera que \\(s\\) sea menor, entonces \\(se(b_1)\\) será menor, manteniendo todo lo demás constante. Si los valores de la variable explicativa están más dispersos, de manera que \\(s_x\\) aumenta, entonces \\(se(b_1)\\) será menor, manteniendo todo lo demás constante. Valores menores de \\(se(b_1)\\) ofrecen una mejor oportunidad para detectar relaciones entre \\(y\\) y \\(x\\). La Figura 2.6 ilustra estas relaciones. Aquí, el diagrama de dispersión en el medio tiene el valor más pequeño de \\(se(b_1)\\). Comparado con el gráfico del medio, el gráfico de la izquierda tiene un valor mayor de \\(s\\) y por lo tanto \\(se(b_1)\\). Comparado con el gráfico de la derecha, el gráfico del medio tiene un valor mayor de \\(s_x\\), y por lo tanto un valor menor de \\(se(b_1)\\). Figura 2.6: Estos tres diagramas de dispersión muestran la misma relación lineal entre \\(y\\) y \\(x\\). El gráfico a la izquierda muestra una mayor variabilidad alrededor de la línea que el gráfico del medio. El gráfico a la derecha muestra una desviación estándar menor en \\(x\\) que el gráfico del medio. Código R para producir la Figura 2.6 # FIGURA 2.6 AQUÍ par(mfrow=c(1, 3),mar=c(3.8,2.8,1,1), cex=1.3) x &lt;- c(1,2,2.3,2.5,1.5,1.7,2.6,2.8,.9,.88,.8,1.2,1.3,1.45,1.8,2.2,2.1) y &lt;- c(.5,2.2,2.6,2.5,.8,1.5,2.3,2.4,.75,.7,1.3,1.5,1.7,2.3,2.3,2.7,1.25) plot(x,y, xlim=c(0.5,3), ylim=c(0,3.5), bty=&quot;l&quot;, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylab=&quot;&quot;, xlab=&quot;&quot;) mtext(&quot;y&quot;, side=2, at=3.5, line=2, las=1, cex=1.3) mtext(&quot;x&quot;, side=1, line=2, cex=1.3) a &lt;- seq(.75,2.75, by = .001) b = a lines(a,b) x &lt;- c(1,2,2.3,2.5,1.5,1.7,2.6,2.8,.9,.88,.8,1.2,1.3,1.45,1.8,2.2,2.45) y &lt;- c(1,2,2.3,2.5,1.2,1.6,2.4,2.6,1.1,1.11,1.2,1.3,1.45,1.6,1.95,2.3,2.7) plot(x,y, xlim=c(0.5,3), ylim=c(0,3.5), bty=&quot;l&quot;, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylab=&quot;&quot;, xlab=&quot;&quot;) mtext(&quot;y&quot;, side=2, at=3.5, line=2, las=1, cex=1.3) mtext(&quot;x&quot;, side=1, line=2, cex=1.3) a &lt;- seq(.75,2.75, by = .001) b = a lines(a,b) x &lt;- c(1,2,2.3,2.5,1.5,1.7,2.6,2.8,2.6,1.5,2,1.2,1.3,1.45,1.8,2.2,2.45) y &lt;- c(1,2,2.3,2.5,1.2,1.6,2.4,2.6,2,2,2.4,1.3,1.55,1.6,1.95,1.6,2.7) plot(x,y, xlim=c(-1.5,5), ylim=c(-2,5.5), bty=&quot;l&quot;, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylab=&quot;&quot;, xlab=&quot;&quot;) mtext(&quot;y&quot;, side=2, at=5.1, line=2, las=1, cex=1.3) mtext(&quot;x&quot;, side=1, line=2, cex=1.3) a &lt;- seq(-.5,4.5, by = .001) b = a lines(a,b) La ecuación (2.4) también implica que el coeficiente de regresión \\(b_1\\) sigue una distribución normal. Es decir, recordemos de la estadística matemática que las combinaciones lineales de variables aleatorias normales también son normales. Así, si se cumple la Suposición F5, entonces \\(b_1\\) sigue una distribución normal. Además, existen varias versiones de los teoremas del límite central para sumas ponderadas (ver, por ejemplo, Serfling, 1980). Así, como se discute en la Sección 1.4, si las respuestas \\(y_i\\) están siquiera aproximadamente distribuidas normalmente, entonces será razonable usar una aproximación normal para la distribución muestral de \\(b_1\\). Usando \\(se(b_1)\\) como la desviación estándar estimada de \\(b_1\\), para valores grandes de \\(n\\) tenemos que \\(\\left( b_1-\\beta_1\\right) /se(b_1)\\) tiene una distribución normal estándar aproximada. Aunque no lo probaremos aquí, bajo la Suposición F5 \\(\\left( b_1-\\beta_1\\right) /se(b_1)\\) sigue una distribución \\(t\\) con grados de libertad \\(df=n-2\\). 2.5 Inferencia Estadística Una vez que hemos ajustado un modelo con un conjunto de datos, podemos hacer una serie de afirmaciones importantes. Generalmente, es útil pensar en estas afirmaciones en tres categorías: (i) pruebas de ideas hipotetizadas, (ii) estimaciones de parámetros del modelo y (iii) predicciones de nuevos resultados. 2.5.1 ¿Es Importante la Variable Explicativa?: La Prueba t Respondemos a la pregunta de si la variable explicativa es importante investigando si \\(\\beta_1=0\\). La lógica es que si \\(\\beta_1=0\\), entonces el modelo de regresión lineal básico ya no incluye una variable explicativa \\(x\\). Por lo tanto, traducimos nuestra pregunta sobre la importancia de la variable explicativa en una pregunta más específica que puede ser respondida utilizando el marco de pruebas de hipótesis. Esta pregunta más específica es: ¿es válida la hipótesis nula \\(H_0:\\beta_1=0\\)? Respondemos a esta pregunta observando la estadística de prueba: \\[ {\\small t-\\mathrm{ratio}=\\frac{\\mathrm{valor~estimado~del~parámetro~-~valor~hipotetizado}} {\\mathrm{error~estándar~del~estimador}}. } \\] En el caso de \\(H_0:\\beta_1=0\\), examinamos la razón t \\(t(b_1)=b_1/se(b_1)\\) porque el valor hipotetizado de \\(\\beta_1\\) es 0. Esta es la estandarización apropiada porque, bajo la hipótesis nula y las suposiciones del modelo descritas en la Sección 2.4, la distribución muestral de \\(t(b_1)\\) se puede demostrar que sigue una distribución t con \\(df=n-2\\) grados de libertad. Así, para probar la hipótesis nula \\(H_0\\) contra la alternativa \\(H_{a}:\\beta_1\\neq 0\\), rechazamos \\(H_0\\) a favor de \\(H_{a}\\) si \\(|t(b_1)|\\) excede un valor t. Aquí, este valor t es un percentil de la distribución t usando \\(df=n-2\\) grados de libertad. Denotamos el nivel de significancia como \\(\\alpha\\) y este valor t como \\(t_{n-2,1-\\alpha /2}\\). Ejemplo: Ventas de Lotería - Continuación. Para el ejemplo de ventas de lotería, la desviación estándar residual es \\(s=3,792\\). En la Tabla 2.1, tenemos \\(s_x = 11,098\\). Por lo tanto, el error estándar de la pendiente es \\(se(b_1) = 3792/(11098\\sqrt{50-1})=0.0488\\). Según la Sección 2.1, la estimación de la pendiente es \\(b_1=0.647\\). Por lo tanto, la estadística t es \\(t(b_1) = 0.647/0.0488 = 13.4\\). Interpretamos esto diciendo que la pendiente está 13.4 errores estándar por encima de cero. Para el nivel de significancia, usamos el valor habitual de \\(\\alpha\\) = 5%. El percentil 97.5 de una distribución t con \\(df=50-2=48\\) grados de libertad es \\(t_{48,0.975}=2.011\\). Dado que \\(|13.4|&gt;2.011\\), rechazamos la hipótesis nula de que la pendiente \\(\\beta_1 = 0\\) a favor de la alternativa de que \\(\\beta_1 \\neq 0\\). Tomar decisiones comparando una razón t con un valor t se llama una prueba t. Probar \\(H_0:\\beta_1=0\\) frente a \\(H_{a}:\\beta_1\\neq 0\\) es solo una de las muchas pruebas de hipótesis que se pueden realizar, aunque es la más común. Tabla 2.3 describe procedimientos alternativos para la toma de decisiones. Estos procedimientos son para probar \\(H_0:\\beta_1 = d\\) donde \\(d\\) es un valor prescrito por el usuario que puede ser igual a cero o cualquier otro valor conocido. Por ejemplo, en nuestro ejemplo de la Sección 2.7, usaremos \\(d=1\\) para probar teorías financieras sobre el mercado de valores. Tabla 2.3 Procedimientos de Toma de Decisiones para Probar \\(H_0:\\beta_1 = d\\) \\[ {\\small \\begin{array}{c|c} \\hline \\text{Hipótesis Alternativa} (H_{a}) &amp; \\text{Procedimiento: Rechazar } H_0 \\text{ a favor de } H_{a} \\text{ si} \\\\ \\hline \\beta_1&gt;d &amp; t-\\mathrm{ratio}&gt;t_{n-2,1-\\alpha }. \\\\ \\beta_1&lt;d &amp; t-\\mathrm{ratio}&lt;-t_{n-2,1-\\alpha }. \\\\ \\beta_1\\neq d &amp; |t-\\mathrm{ratio}\\mathit{|}&gt;t_{n-2,1-\\alpha /2}. \\\\ \\end{array} }\\\\ {\\small \\begin{array}{l} \\hline \\text{Notas: El nivel de significancia es } \\alpha . \\text{Aquí, }t_{n-2,1-\\alpha} \\text{ es el percentil } (1-\\alpha )\\\\ ~~\\text{de la distribución *t* con } df=n-2 \\text{ grados de libertad.}\\\\ ~~\\text{La estadística de prueba es }t-\\mathrm{ratio} = (b_1 -d)/se(b_1) . \\\\ \\hline \\end{array} } \\] Alternativamente, se pueden construir valores de probabilidad (\\(p\\)-) y compararlos con los niveles de significancia dados. El valor \\(p\\)- es una estadística resumen útil para el analista de datos ya que permite al lector del informe entender la fuerza de la desviación de la hipótesis nula. Tabla 2.4 resume el procedimiento para calcular los valores \\(p\\)-. Tabla 2.4 Valores de Probabilidad para Probar \\(H_0:\\beta_1 = d\\) \\[ {\\small \\begin{array}{c|ccc} \\hline \\text{Hipótesis} &amp; &amp; &amp; \\\\ \\text{Alternativa} (H_a) &amp; \\beta_1&gt;d &amp; \\beta_1&lt;d &amp; \\beta_1\\neq d \\\\ \\hline p-value &amp; \\Pr(t_{n-2}&gt;t-\\mathrm{ratio}) &amp; \\Pr(t_{n-2}&lt;t-\\mathrm{ratio}) &amp; \\Pr (|t_{n-2}|&gt;|t-\\mathrm{ratio}\\mathit{|}) \\\\\\hline \\end{array} }\\\\ {\\small \\begin{array}{l} \\hline \\text{Notas: Aquí, }t_{n-2} \\text{ es una variable aleatoria distribuida como *t* con } df=n-2 \\text{ grados de libertad.}\\\\ ~~\\text{La estadística de prueba es }t-\\mathrm{ratio} = (b_1 -d)/se(b_1) . \\\\ \\hline \\end{array} } \\] Otra forma interesante de abordar la cuestión de la importancia de una variable explicativa es a través del coeficiente de correlación. Recuerda que el coeficiente de correlación es una medida de la relación lineal entre \\(x\\) e \\(y\\). Denotemos esta estadística por \\(r(y,x)\\). Esta cantidad no se ve afectada por cambios de escala en ninguna de las variables. Por ejemplo, si multiplicamos la variable \\(x\\) por el número \\(b_1\\), entonces el coeficiente de correlación permanece sin cambios. Además, las correlaciones no cambian con los desplazamientos aditivos. Así, si agregamos un número, digamos \\(b_0\\), a cada variable \\(x\\), entonces el coeficiente de correlación permanece sin cambios. Usar un cambio de escala y un desplazamiento aditivo en la variable \\(x\\) puede utilizarse para producir el valor ajustado \\(\\widehat{y}=b_0+b_1x\\). Por lo tanto, usando la notación, tenemos \\(|r(y,x)|=r(y,\\widehat{y})\\). Así, podemos interpretar que la correlación entre las respuestas y la variable explicativa es igual a la correlación entre las respuestas y los valores ajustados. Esto lleva al siguiente hecho algebraico interesante: \\(R^2=r^2.\\) Es decir, el coeficiente de determinación es igual al cuadrado del coeficiente de correlación. Esto es mucho más fácil de interpretar si uno piensa en \\(r\\) como la correlación entre los valores observados y los ajustados. Consulta el Ejercicio 2.13 para los pasos útiles para confirmar este resultado. 2.5.2 Intervalos de Confianza Los investigadores a menudo citan el mecanismo formal de pruebas de hipótesis para responder a la pregunta: “¿Tiene la variable explicativa una influencia real en la respuesta?” Una pregunta de seguimiento natural es: “¿En qué medida afecta \\(x\\) a \\(y\\)?” Hasta cierto punto, se puede responder utilizando el tamaño del \\(t\\)-ratio o el valor de \\(p\\). Sin embargo, en muchos casos, un intervalo de confianza para la pendiente es más útil. Para introducir los intervalos de confianza para la pendiente, recordemos que \\(b_1\\) es nuestro estimador puntual de la verdadera pendiente desconocida \\(\\beta_1\\). La Sección 2.4 argumentó que este estimador tiene un error estándar \\(se(b_1)\\) y que \\(\\left( b_1-\\beta_1\\right) /se(b_1)\\) sigue una distribución \\(t\\) con \\(n-2\\) grados de libertad. Las declaraciones de probabilidad se pueden invertir para obtener intervalos de confianza. Usando esta lógica, tenemos el siguiente intervalo de confianza para la pendiente \\(\\beta_1\\). Definición. Un intervalo de confianza del \\(100(1-\\alpha)\\)% para la pendiente \\(\\beta_1\\) es \\[\\begin{equation} b_1\\pm t_{n-2,1-\\alpha /2} ~se(b_1). \\tag{2.6} \\end{equation}\\] Al igual que con las pruebas de hipótesis, \\(t_{n-2,1-\\alpha /2}\\) es el percentil (1-\\(\\alpha\\) /2) de la distribución \\(t\\) con \\(df=n-2\\) grados de libertad. Debido a la naturaleza bilateral de los intervalos de confianza, el percentil es 1 - (1 - nivel de confianza) / 2. En este texto, por simplicidad, generalmente usamos un intervalo de confianza del 95%, por lo que el percentil es 1-(1-0.95)/2 = 0.975. El intervalo de confianza proporciona un rango de confiabilidad que mide la utilidad de la estimación. En la Sección 2.1, establecimos que la estimación de la pendiente por mínimos cuadrados para el ejemplo de ventas de lotería es \\(b_1=0.647\\). La interpretación es que si la población de un código postal difiere en 1,000, entonces esperamos que las ventas promedio de lotería difieran en $647. ¿Qué tan confiable es esta estimación? Resulta que \\(se(b_1)=0.0488\\) y, por lo tanto, un intervalo de confianza aproximado del 95% para la pendiente es \\[\\begin{equation*} 0.647\\pm (2.011)(.0488), \\end{equation*}\\] o (0.549, 0.745). De manera similar, si la población difiere en 1,000, un intervalo de confianza del 95% para el cambio esperado en las ventas es (549, 745). Aquí, usamos el valor \\(t\\) \\(t_{48,0.975}=2.011\\) porque hay 48 (= \\(n\\)-2) grados de libertad y, para un intervalo de confianza del 95%, necesitamos el percentil 97.5. 2.5.3 Intervalos de Predicción En la Sección 2.1, mostramos cómo usar los estimadores de mínimos cuadrados para predecir las ventas de lotería para un código postal, fuera de nuestra muestra, con una población de 10,000. Dado que la predicción es una tarea tan importante para los actuarios, formalizamos el procedimiento para que pueda ser utilizado regularmente. Para predecir una observación adicional, asumimos que el nivel de la variable explicativa es conocido y se denota por \\(x_{\\ast}\\). Por ejemplo, en nuestro ejemplo anterior de ventas de lotería usamos \\(x_{\\ast} = 10,000\\). También asumimos que la observación adicional sigue el mismo modelo de regresión lineal que las observaciones en la muestra. Usando nuestros estimadores de mínimos cuadrados, nuestra predicción puntual es \\(\\widehat{y}_{\\ast} = b_0 + b_1 x_{\\ast}\\), la altura de la línea de regresión ajustada en \\(x_{\\ast}\\). Podemos descomponer el error de predicción en dos partes: \\[ \\begin{array}{ccccc} \\underbrace{y_{\\ast} - \\widehat{y}_{\\ast}} &amp; = &amp; \\underbrace{\\beta_0 - b_0 + \\left( \\beta_1 - b_1 \\right) x_{\\ast}} &amp; + &amp; \\underbrace{\\varepsilon_{\\ast}} \\\\ {\\small \\text{error de predicción}} &amp; {\\small =} &amp; {\\small \\text{error en la estimación de la }} &amp; {\\small +} &amp; {\\small \\text{desviación de la observación adicional}} \\\\ &amp; &amp; {\\small \\text{línea de regresión en } x}_{\\ast} &amp; &amp; {\\small \\text{respuesta de su media}} \\end{array} \\] Se puede demostrar que el error estándar de la predicción es \\[\\begin{equation*} se(pred) = s \\sqrt{1+\\frac{1}{n}+\\frac{\\left( x_{\\ast}-\\overline{x}\\right) ^2}{(n-1)s_x^2}}. \\end{equation*}\\] Al igual que con \\(se(b_1)\\), los términos \\(n^{-1}\\) y $( x_{}- ) ^2/$ se acercan a cero a medida que el tamaño de la muestra \\(n\\) se vuelve grande. Por lo tanto, para grandes \\(n\\), tenemos que \\(se(pred)\\approx s\\), lo que refleja que el error en la estimación de la línea de regresión en un punto se vuelve insignificante y la desviación de la respuesta adicional de su media se convierte en la única fuente de incertidumbre. Definición. Un intervalo de predicción del \\(100(1-\\alpha)\\)% en \\(x_{\\ast}\\) es \\[\\begin{equation} \\widehat{y}_{\\ast} \\pm t_{n-2,1-\\alpha /2} ~se(pred) \\tag{2.7} \\end{equation}\\] donde el valor \\(t\\) \\(t_{n-2,1-\\alpha /2}\\) es el mismo que se usa para la prueba de hipótesis y el intervalo de confianza. Por ejemplo, la predicción puntual en \\(x_{\\ast} = 10,000\\) es \\(\\widehat{y}_{\\ast}\\)= 469.7 + 0.647 (10000) = 6,939.7. El error estándar de esta predicción es \\[\\begin{equation*} se(pred) = 3,792 \\sqrt{1+\\frac{1}{50} + \\frac{\\left( 10,000-9,311\\right)^2}{(50-1)(11,098)^2}} = 3,829.6. \\end{equation*}\\] Con un valor \\(t\\) igual a 2.011, esto da lugar a un intervalo de predicción aproximado del 95% \\[\\begin{equation*} 6,939.7 \\pm (2.011)(3,829.6) = 6,939.7 \\pm 7,701.3 = (-761.6, ~14,641.0). \\end{equation*}\\] Interpretamos estos resultados señalando primero que nuestra mejor estimación de ventas de lotería para un código postal con una población de 10,000 es 6,939.70. Nuestro intervalo de predicción del 95% representa un rango de confiabilidad para esta predicción. Si pudiéramos observar muchos códigos postales, cada uno con una población de 10,000, en promedio esperaríamos que aproximadamente 19 de cada 20, o el 95%, tendrían ventas de lotería entre 0 y 14,641. Es habitual truncar el límite inferior del intervalo de predicción a cero si se considera que los valores negativos de la respuesta son inapropiados. Código R para producir los análisis de la Sección 2.5 # RESULTADOS DE LA SECCIÓN 2.1 model.basiclinearreg&lt;-lm(SALES ~ POP, data = Lot) summary(model.basiclinearreg) # SECCIÓN 2.5.2 INTERVALOS DE CONFIANZA confint(model.basiclinearreg) confint(model.basiclinearreg, level=.90) # SECCIÓN 2.5.3 INTERVALOS DE PREDICCIÓN newdata &lt;- data.frame(POP &lt;- 10000) predict(model.basiclinearreg, newdata, interval=&quot;prediction&quot;) predict(model.basiclinearreg, newdata, interval=&quot;prediction&quot;, level=.90) # PROPORCIONA EL PERCENTIL 97.5 DE UNA DISTRIBUCIÓN T, SOLO PARA COMPROBAR qt(.975, 48) 2.6 Construyendo un Mejor Modelo: Análisis de Residuos Las disciplinas cuantitativas calibran modelos con datos. La estadística lleva esto un paso más allá, utilizando las discrepancias entre las suposiciones y los datos para mejorar la especificación del modelo. Examinaremos las suposiciones del modelo de la Sección 2.2 a la luz de los datos y utilizaremos cualquier desajuste para especificar un mejor modelo; este proceso se conoce como verificación diagnóstica (como cuando vas al médico y él o ella realiza pruebas diagnósticas para revisar tu salud). Comenzaremos con la representación del error de la Sección 2.2. Bajo este conjunto de suposiciones, las desviaciones {\\(\\varepsilon _i\\)} son idénticamente e independientemente distribuidas (i.i.d), y bajo la suposición F5, distribuidas normalmente. Para evaluar la validez de estas suposiciones, se usan los residuos (observados) {\\(e_i\\)} como aproximaciones para las desviaciones (no observadas) {\\(\\varepsilon _i\\)}. El tema básico es que si los residuos están relacionados con una variable o muestran algún otro patrón reconocible, entonces deberíamos poder aprovechar esta información y mejorar la especificación de nuestro modelo. Los residuos deberían contener poca o ninguna información y representar solo la variación natural de la muestra que no se puede atribuir a ninguna fuente específica. Análisis de residuos es el ejercicio de verificar los residuos en busca de patrones. Existen cinco tipos de discrepancias en el modelo que los analistas comúnmente buscan. Si se detectan, las discrepancias pueden corregirse con los ajustes apropiados en la especificación del modelo. Problemas de Especificación del Modelo Falta de Independencia. Puede haber relaciones entre las desviaciones {\\(\\varepsilon _i\\)} de modo que no sean independientes. Heterocedasticidad. La suposición E3 indica que todas las observaciones tienen una variabilidad común (aunque desconocida), conocida como homocedasticidad. Heterocedasticidad es el término usado cuando la variabilidad varía según la observación. Relaciones entre Desviaciones del Modelo y Variables Explicativas. Si una variable explicativa tiene la capacidad de ayudar a explicar la desviación \\(\\varepsilon\\), entonces deberíamos poder usar esta información para predecir mejor \\(y\\). Distribuciones No Normales. Si la distribución de la desviación representa una desviación seria de la normalidad, entonces los procedimientos de inferencia usuales ya no son válidos. Puntos Inusuales. Las observaciones individuales pueden tener un gran efecto en el ajuste del modelo de regresión, lo que significa que los resultados pueden ser sensibles al impacto de una sola observación. Esta lista servirá al lector durante el estudio del análisis de regresión. Por supuesto, con solo una introducción a los modelos básicos aún no hemos visto modelos alternativos que podrían usarse cuando encontramos estas discrepancias en el modelo. En la Parte II de este libro sobre modelos de series temporales, estudiaremos la falta de independencia entre datos ordenados en el tiempo. El Capítulo 5 considerará la heterocedasticidad con más detalle. La introducción a la regresión lineal múltiple en el Capítulo 3 será nuestra primera vista sobre cómo manejar las relaciones entre {\\(\\varepsilon _i\\)} y variables explicativas adicionales. Sin embargo, ya hemos tenido una introducción al efecto de las distribuciones normales, viendo que los gráficos \\(qq\\) pueden detectar la no normalidad y que las transformaciones pueden ayudar a inducir la normalidad aproximada. En esta sección, discutimos los efectos de los puntos inusuales. Gran parte del análisis de residuos se realiza examinando un residuo estandarizado, que es un residuo dividido por su error estándar. Un error estándar aproximado del residuo es \\(s\\); en el Capítulo 3 daremos una definición matemática precisa. Hay dos razones por las que a menudo examinamos residuos estandarizados en lugar de residuos básicos. Primero, si las respuestas están distribuidas normalmente, entonces los residuos estandarizados son aproximadamente realizaciones de una distribución normal estándar. Esto proporciona una distribución de referencia para comparar los valores de los residuos estandarizados. Por ejemplo, si un residuo estandarizado supera dos en valor absoluto, esto se considera inusualmente grande y la observación se llama outlier (punto atípico). Segundo, dado que los residuos estandarizados son adimensionales, podemos transferir la experiencia de un conjunto de datos a otro. Esto es cierto independientemente de si la distribución de referencia normal es aplicable o no. Puntos Atípicos y Puntos de Alta Influencia. Otra parte importante del análisis de residuos es la identificación de observaciones inusuales en un conjunto de datos. Debido a que las estimaciones de regresión son promedios ponderados con pesos que varían según la observación, algunas observaciones son más importantes que otras. Esta ponderación es más importante de lo que muchos usuarios del análisis de regresión se dan cuenta. De hecho, el ejemplo a continuación demuestra que una sola observación puede tener un efecto dramático en un gran conjunto de datos. Hay dos direcciones en las que un punto de datos puede ser inusual: la dirección horizontal y la dirección vertical. Por “inusual”, nos referimos a que una observación bajo consideración parece estar lejos de la mayoría del conjunto de datos. Una observación que es inusual en la dirección vertical se llama punto atípico. Una observación que es inusual en la dirección horizontal se llama punto de alta influencia. Una observación puede ser tanto un punto atípico como un punto de alta influencia. Ejemplo: Puntos Atípicos y Puntos de Alta Influencia. Considera el conjunto de datos ficticio de 19 puntos más tres puntos, etiquetados como A, B y C, que se muestra en la Figura 2.7 y Tabla 2.5. Piensa en los primeros 19 puntos como observaciones “buenas” que representan algún tipo de fenómeno. Queremos investigar el efecto de agregar un solo punto aberrante. Tabla 2.5. 19 Puntos Base Más Tres Tipos de Observaciones Inusuales \\[ \\small{ \\begin{array}{c|cccccccccc|ccc} \\hline Variables &amp; &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; &amp; A &amp; B &amp; C \\\\ \\hline x &amp; 1.5 &amp; 1.7 &amp; 2.0 &amp; 2.2 &amp; 2.5 &amp; 2.5 &amp; 2.7 &amp; 2.9 &amp; 3.0 &amp; 3.5 &amp; 3.4 &amp; 9.5 &amp; 9.5 \\\\ y &amp; 3.0 &amp; 2.5 &amp; 3.5 &amp; 3.0 &amp; 3.1 &amp; 3.6 &amp; 3.2 &amp; 3.9 &amp; 4.0 &amp; 4.0 &amp; 8.0 &amp; 8.0 &amp; 2.5 \\\\ \\hline x &amp; 3.8 &amp; 4.2 &amp; 4.3 &amp; 4.6 &amp; 4.0 &amp; 5.1 &amp; 5.1 &amp; 5.2 &amp; 5.5 &amp; &amp; &amp; &amp; \\\\ y &amp; 4.2 &amp; 4.1 &amp; 4.8 &amp; 4.2 &amp; 5.1 &amp; 5.1 &amp; 5.1 &amp; 4.8 &amp; 5.3 &amp; &amp; &amp; &amp; \\\\ \\hline \\end{array} } \\] Figura 2.7: Gráfico de dispersión de 19 puntos base más tres puntos inusuales, etiquetados A, B, y C. Código R para Producir la Figura 2.7 # EJEMPLO 2.6 PUNTO ATÍPICO OUTLR &lt;- read.csv(&quot;CSVData/OutlierExample.csv&quot;, header=TRUE) # FIGURA 2.7 par(mar=c(4.1,3.1,1.1,.1), cex=1.3) plot(OUTLR$X, OUTLR$Y, xlab=&quot;x&quot;, ylab=&quot;&quot;, xlim=c(0, 10), ylim=c(2, 9), las=1) mtext(&quot;y&quot;, at=5.5,side=2,las=1,cex=1.3, line=2.3) points(4.3, 8.0) text(4.7, 8.0, &quot;A&quot;, cex=1.3) points(9.5, 8.0) text(9.9, 8.0, &quot;B&quot;, cex=1.3) points(9.5, 2.5) text(9.9, 2.5, &quot;C&quot;, cex=1.3) Para investigar el efecto de cada tipo de punto aberrante, Tabla 2.6 resume los resultados de cuatro regresiones separadas. La primera regresión es para los diecinueve puntos base. Las otras tres regresiones utilizan los diecinueve puntos base más cada tipo de observación inusual. Tabla 2.6. Resultados de Cuatro Regresiones \\[ {\\small \\begin{array}{l|rrrrr} \\hline Datos &amp; b_0 &amp; b_1 &amp; s &amp; R^2(\\%) &amp; t(b_1) \\\\ \\hline 19 \\text{ Puntos Base} &amp; 1.869 &amp; 0.611 &amp; 0.288 &amp; 89.0 &amp; 11.71 \\\\ 19 \\text{ Puntos Base} ~+~ A &amp; 1.750 &amp; 0.693 &amp; 0.846 &amp; 53.7 &amp; 4.57 \\\\ 19 \\text{ Puntos Base} ~+~ B &amp; 1.775 &amp; 0.640 &amp; 0.285 &amp; 94.7 &amp; 18.01 \\\\ 19 \\text{ Puntos Base} ~+~ C &amp; 3.356 &amp; 0.155 &amp; 0.865 &amp; 10.3 &amp; 1.44 \\\\ \\hline \\end{array} } \\] Tabla 2.6 muestra que una línea de regresión proporciona un buen ajuste para los diecinueve puntos base. El coeficiente de determinación, \\(R^2\\), indica que alrededor del 89% de la variabilidad ha sido explicada por la línea. El tamaño del error típico, \\(s\\), es de aproximadamente 0.29, pequeño en comparación con la dispersión en los valores de \\(y\\). Además, el cociente \\(t\\) para el coeficiente de la pendiente es grande. Cuando se agrega el punto atípico A a los diecinueve puntos base, la situación empeora dramáticamente. El \\(R^2\\) baja del 89% al 53.7% y \\(s\\) aumenta de aproximadamente 0.29 a alrededor de 0.85. La línea de regresión ajustada en sí no cambia mucho, aunque nuestra confianza en las estimaciones ha disminuido. Un punto atípico es inusual en el valor de \\(y\\), pero “inusual en el valor de \\(y\\)” depende del valor de \\(x\\). Para ver esto, mantén el valor de \\(y\\) del Punto A igual, pero aumenta el valor de \\(x\\) y llama al punto B. Cuando se agrega el punto B a los diecinueve puntos base, la línea de regresión proporciona un ajuste mejor. El punto B está cerca de estar en la línea de ajuste de regresión generada por los diecinueve puntos base. Así, la línea de regresión ajustada y el tamaño del error típico, \\(s\\), no cambian mucho. Sin embargo, \\(R^2\\) aumenta del 89% a casi el 95%. Si pensamos en \\(R^2\\) como \\(1-(Error~SS)/(Total~SS)\\), al agregar el punto B hemos aumentado \\(Total~SS\\), la desviación total cuadrada en los \\(y\\), aunque el \\(Error~SS\\) se mantiene relativamente sin cambios. El punto B no es un punto atípico, pero es un punto de alta influencia. Para mostrar cuán influyente es este punto, reduce considerablemente el valor de \\(y\\) y llama a este el nuevo punto C. Cuando se agrega este punto a los diecinueve puntos base, la situación empeora dramáticamente. El coeficiente \\(R^2\\) baja del 89% al 10%, y el \\(s\\) más que se triplica, de 0.29 a 0.87. Además, los coeficientes de la línea de regresión cambian drásticamente. La mayoría de los usuarios de la regresión al principio no creen que un punto de veinte pueda tener un efecto tan dramático en el ajuste de la regresión. El ajuste de una línea de regresión siempre puede mejorarse eliminando un punto atípico. Si el punto es un punto de alta influencia y no un punto atípico, no está claro si el ajuste mejorará cuando el punto sea eliminado. ¡Simplemente porque puedes mejorar dramáticamente un ajuste de regresión omitiendo una observación no significa que siempre debas hacerlo! El objetivo del análisis de datos es comprender la información en los datos. A lo largo del texto, encontraremos muchos conjuntos de datos donde los puntos inusuales proporcionan alguna de la información más interesante sobre los datos. El objetivo de esta subsección es reconocer los efectos de los puntos inusuales; el Capítulo 5 proporcionará opciones para manejar puntos inusuales en tu análisis. Todas las disciplinas cuantitativas, como contabilidad, economía, programación lineal, etc., practican el arte del análisis de sensibilidad. El análisis de sensibilidad es una descripción de los cambios globales en un sistema debido a un pequeño cambio local en un elemento del sistema. Examinar los efectos de observaciones individuales en el ajuste de regresión es un tipo de análisis de sensibilidad. Ejemplo: Ventas de Lotería – Continuación. La Figura 2.8 muestra un valor atípico; el punto en la parte superior izquierda del gráfico representa un código postal que incluye a Kenosha, Wisconsin. Las ventas para este código postal son inusualmente altas dada su población. Kenosha está cerca de la frontera con Illinois; los residentes de Illinois probablemente participen en la lotería de Wisconsin, lo que aumenta efectivamente el potencial de ventas en Kenosha. Tabla 2.7 resume el ajuste de la regresión tanto con como sin este código postal. Tabla 2.7. Resultados de la Regresión con y sin Kenosha \\[ {\\small \\begin{array}{l|rrrrr} \\hline \\text{Datos} &amp; b_0 &amp; b_1 &amp; s &amp; R^2(\\%) &amp; t(b_1) \\\\ \\hline \\text{Con Kenosha} &amp; 469.7 &amp; 0.647 &amp; 3,792 &amp; 78.5 &amp; 13.26 \\\\ \\text{Sin Kenosha} &amp; -43.5 &amp; 0.662 &amp; 2,728 &amp; 88.3 &amp; 18.82 \\\\ \\hline \\end{array} } \\] Figura 2.8: Gráfico de dispersión de SALES versus POP, con el valor atípico correspondiente a Kenosha marcado. Código R para producir la Figura 2.8 y la Tabla 2.7 Lot &lt;- read.csv(&quot;CSVData/WiscLottery.csv&quot;, header=TRUE) # FIGURA 2.8 par(mar=c(4.1,3.9,2,1),cex=1.1) plot(Lot$POP, Lot$SALES, ylab=&quot;&quot;, las=1, xlab = &quot;POP&quot;) mtext(&quot;SALES&quot;,side=2, at=36000, las=1, cex=1.1) text(5000, 24000, &quot;Kenosha&quot;) # TABLA 2.7 model.basiclinearreg&lt;-lm(SALES ~ POP, Lot) summary(model.basiclinearreg) model.Kenosha&lt;-lm(SALES ~ POP, Lot, subset=-c(9)) summary(model.Kenosha) Para los propósitos de inferencia sobre la pendiente, la presencia de Kenosha no altera los resultados de manera dramática. Ambas estimaciones de la pendiente son cualitativamente similares y los correspondientes valores \\(t\\) son muy altos, muy por encima de los umbrales para la significancia estadística. Sin embargo, hay diferencias notables al evaluar la calidad del ajuste. El coeficiente de determinación, \\(R^2\\), aumentó del 78.5% al 88.3% al eliminar Kenosha. Además, nuestro “desviación típica” \\(s\\) disminuyó en más de $1,000. Esto es particularmente importante si queremos ajustar nuestros intervalos de predicción. Para verificar la exactitud de nuestras suposiciones, también es común revisar la suposición de normalidad. Una forma de hacerlo es mediante el gráfico \\(qq\\), introducido en la Sección 1.2. Los dos paneles en las Figuras 2.9 son gráficos \\(qq\\) con y sin el código postal de Kenosha. Recuerda que los puntos “cercanos” a una línea indican normalidad aproximada. En el panel derecho de la Figura 2.9, la secuencia parece ser lineal, por lo que los residuos están aproximadamente distribuidos de manera normal. Este no es el caso en el panel izquierdo, donde la secuencia de puntos parece aumentar dramáticamente para grandes cuantiles. Lo interesante es que la no-normalidad de la distribución se debe a un solo valor atípico, no a un patrón de sesgo común a todas las observaciones. Figura 2.9: Gráficos \\(qq\\) de los residuos de la Lotería de Wisconsin. El panel izquierdo se basa en los 50 puntos. El panel derecho se basa en 49 puntos, residuos de una regresión después de eliminar Kenosha. Código R para producir la Figura 2.9 #Lot &lt;- read.csv(&quot;CSVData/WiscLottery.csv&quot;, header=TRUE) # FIGURA 2.9 # TABLA 2.7 model.basiclinearreg&lt;-lm(SALES ~ POP, Lot) #summary(model.basiclinearreg) model.Kenosha&lt;-lm(SALES ~ POP, Lot, subset=-c(9)) #summary(model.Kenosha) par(mfrow=c(1, 2), mar=c(4.1,3.9,1.7,1),cex=1.1) qqnorm(residuals(model.basiclinearreg), main=&quot;&quot;, ylab=&quot;&quot;, las=1) mtext(&quot;Cuantiles Muestrales&quot;, side=2,at=20500,las=1,cex=1.1, adj=.5) qqnorm(residuals(model.Kenosha), main=&quot;&quot;, ylab=&quot;&quot;, las=1) mtext(&quot;Cuantiles Muestrales&quot;, side=2,at=9050,las=1,cex=1.1, adj=.5) 2.7 Aplicación: Modelo de Valoración de Activos Financieros En esta sección, estudiamos una aplicación financiera, el Modelo de Valoración de Activos Financieros, a menudo conocido por el acrónimo CAPM. El nombre es algo engañoso, ya que el modelo realmente trata sobre rendimientos basados en activos de capital, no sobre los precios en sí mismos. Los tipos de activos que examinamos son valores de acciones que se negocian en un mercado activo, como la Bolsa de Valores de Nueva York (NYSE). Para una acción en la bolsa, podemos relacionar los rendimientos con los precios mediante la siguiente expresión: \\[ {\\small \\mathrm{rendimiento =}\\frac{\\mathrm{precio~al~final~de~un~período+dividendos-precio~al~inicio~de~un~período}}{\\mathrm{precio~al~inicio~de~un~período}}. } \\] Si podemos estimar los rendimientos que genera una acción, entonces el conocimiento del precio al inicio de un período financiero genérico nos permite estimar el valor al final del período (precio final más dividendos). Por lo tanto, seguimos la práctica estándar y modelamos los rendimientos de una acción. Una idea intuitivamente atractiva, y una de las características básicas del CAPM, es que debería haber una relación entre el rendimiento de una acción y el mercado. Una justificación es simplemente que si las fuerzas económicas hacen que el mercado mejore, entonces esas mismas fuerzas deberían actuar sobre una acción individual, sugiriendo que también debería mejorar. Como se mencionó anteriormente, medimos el rendimiento de una acción a través del rendimiento. Para medir el rendimiento del mercado, existen varios índices de mercado que resumen el rendimiento de cada bolsa. Usaremos el índice “ponderado por igual” del Standard &amp; Poor’s 500. El Standard &amp; Poor’s 500 es la colección de las 500 empresas más grandes que se negocian en la NYSE, donde “grande” es identificado por Standard &amp; Poor’s, una organización de calificación de servicios financieros. El índice ponderado por igual se define asumiendo que se crea una cartera invirtiendo un dólar en cada una de las 500 empresas. Otra justificación para una relación entre los rendimientos de las acciones y el mercado proviene de la teoría de la economía financiera. Esta es la teoría CAPM, atribuida a Sharpe (1964) y Lintner (1965) y basada en las ideas de diversificación de cartera de Harry Markowitz (1959). Otros factores iguales, los inversionistas desearían seleccionar un rendimiento con un alto valor esperado y una baja desviación estándar, esta última siendo una medida de riesgo. Una de las propiedades deseables de usar desviaciones estándar como medida de riesgo es que es sencillo calcular la desviación estándar de una cartera. Solo es necesario conocer la desviación estándar de cada acción y las correlaciones entre acciones. Una acción notable es una libre de riesgo, es decir, una acción que teóricamente tiene una desviación estándar cero. Los inversionistas a menudo utilizan un bono del Tesoro de EE. UU. a 30 días como una aproximación de una acción libre de riesgo, argumentando que la probabilidad de default del gobierno de EE. UU. dentro de 30 días es insignificante. Positando la existencia de un activo libre de riesgo y algunas otras condiciones suaves, bajo la teoría CAPM existe una frontera eficiente llamada la línea de mercado de valores. Esta frontera especifica el rendimiento mínimo esperado que los inversionistas deberían exigir para un nivel específico de riesgo. Para estimar esta línea, podemos usar la ecuación: \\[\\begin{equation*} \\mathrm{E}~r = \\beta_0 + \\beta_1 r_m \\end{equation*}\\] donde \\(r\\) es el rendimiento de la acción y \\(r_m\\) es el rendimiento del mercado. Interpretamos \\(\\beta_1 r_m\\) como una medida de la cantidad de rendimiento de la acción que se atribuye al comportamiento del mercado. Probar la teoría económica, o modelos que surgen de cualquier disciplina, implica recolectar datos. La teoría CAPM trata sobre rendimientos ex-ante (antes del hecho), aunque solo podemos probar con rendimientos ex-post (después del hecho). Antes del hecho, los rendimientos son desconocidos y hay toda una distribución de rendimientos. Después del hecho, solo hay una realización única del rendimiento de la acción y del mercado. Debido a que se requieren al menos dos observaciones para determinar una línea, los modelos CAPM se estiman usando datos de acciones y del mercado recopilados a lo largo del tiempo. De esta manera, se pueden realizar varias observaciones. Para los propósitos de nuestras discusiones, seguimos la práctica estándar en la industria de valores y examinamos precios mensuales. Datos Para ilustrar, considere los rendimientos mensuales durante el período de cinco años desde enero de 1986 hasta diciembre de 1990, inclusive. Específicamente, usamos los rendimientos de la acción de Lincoln National Insurance Corporation como la variable dependiente (\\(y\\)) y los rendimientos del mercado del índice Standard &amp; Poor’s 500 como la variable explicativa (\\(x\\)). En ese momento, Lincoln era una gran compañía de seguros multirama, con sede en el medio oeste de EE. UU., específicamente en Fort Wayne, Indiana. Debido a que era bien conocida por su gestión prudente y estabilidad, es una buena compañía para comenzar nuestro análisis de la relación entre el mercado y una acción individual. Comenzamos interpretando algunas estadísticas básicas, en la Tabla 2.8, en términos de teoría financiera. Primero, un inversionista en Lincoln estará preocupado de que el rendimiento promedio de cinco años, \\(\\overline{y}=0.00510\\), esté por debajo del rendimiento del mercado, \\(\\overline{x}=0.00741\\). Los estudiantes de teoría de intereses reconocen que los rendimientos mensuales se pueden convertir a una base anual usando la capitalización geométrica. Por ejemplo, el rendimiento anual de Lincoln es \\((1.0051)^{12}-1=0.062946\\), o aproximadamente 6.29 por ciento. Esto se compara con un rendimiento anual de 9.26% (= (1\\(00((1.00741)^{12}-1\\))) para el mercado. Una medida de riesgo, o volatilidad, que se usa en finanzas es la desviación estándar. Así, interprete \\(s_y\\) = 0.0859 \\(&gt;\\) 0.05254 = \\(s_x\\) para significar que una inversión en Lincoln es más riesgosa que la del mercado. Otro aspecto interesante de la Tabla 2.8 es que el rendimiento más bajo del mercado, -0.22052, está 4.338 desviaciones estándar por debajo de su promedio ((-0.22052-0.00741)/0.05254 = -4.338). Esto es muy inusual con respecto a una distribución normal. knitr::kable(2, caption = &quot;Silly. Crear una tabla solo para actualizar el contador...&quot;) Tabla 2.2: Silly. Crear una tabla solo para actualizar el contador… x 2 knitr::kable(2, caption = &quot;Silly.&quot;) Tabla 2.3: Silly. x 2 knitr::kable(2, caption = &quot;Silly. &quot;) Tabla 2.4: Silly. x 2 knitr::kable(2, caption = &quot;Silly.&quot;) Tabla 2.5: Silly. x 2 knitr::kable(2, caption = &quot;Silly.&quot;) Tabla 2.6: Silly. x 2 Tabla 2.7: Silly. x 2 Tabla 2.8: Estadísticas Resumen de 60 Observaciones Mensuales Promedio Mediana Desviación Estándar Mínimo Máximo LINCOLN 0.0051 0.0075 0.0859 -0.2803 0.3147 MARKET 0.0074 0.0142 0.0525 -0.2205 0.1275 Fuente: Center for Research on Security Prices, University of Chicago A continuación, examinamos los datos a lo largo del tiempo, como se muestra gráficamente en la Figura 2.10. Estos son gráficos de dispersión de los rendimientos versus el tiempo, llamados gráficos de series temporales. En la Figura 2.10, se puede ver claramente el rendimiento más bajo del mercado y un vistazo rápido al eje horizontal revela que este punto inusual está en octubre de 1987, el momento del conocido colapso del mercado. Figura 2.10: Gráfico de series temporales de los rendimientos de la Lincoln National Corporation y del mercado. Hay 60 rendimientos mensuales durante el período de enero de 1986 a diciembre de 1990. El gráfico de dispersión en la Figura 2.11 resume gráficamente la relación entre el rendimiento de Lincoln y el rendimiento del mercado. El colapso del mercado es claramente evidente en la Figura 2.11 y representa un punto de alta influencia. Con la línea de regresión (descrita a continuación) superpuesta, los dos puntos atípicos que se pueden ver en la Figura 2.10 también son evidentes. A pesar de estas anomalías, el gráfico en la Figura 2.11 sugiere que hay una relación lineal entre los rendimientos de Lincoln y del mercado. Figura 2.11: Gráfico de dispersión del rendimiento de Lincoln versus el rendimiento del índice S&amp;P 500. La línea de regresión está superpuesta, lo que nos permite identificar el colapso del mercado y dos puntos atípicos. Código R para producir la Tabla 2.8 y las Figuras 2.10 y 2.11 CAPM &lt;- read.csv(&quot;CSVData/CAPM.csv&quot;, header=TRUE) # TABLA 2.8 ESTADÍSTICAS RESUMEN Xymat &lt;- data.frame(cbind(CAPM$LINCOLN,CAPM$MARKET)) tableMat &lt;- BookSummStats(Xymat) colnames(tableMat) &lt;- c(&quot;Promedio&quot; , &quot;Mediana&quot; , &quot;Desviación Estándar&quot; , &quot;Mínimo&quot; , &quot;Máximo&quot;) rownames(tableMat) &lt;- c(&quot;LINCOLN&quot;, &quot;MARKET&quot;) #tableMat1 &lt;- format(round(tableMat, digits=0), big.mark = &#39;,&#39;) TableGen1(TableData=tableMat, TextTitle=&#39;Estadísticas Resumen de 60 Observaciones Mensuales&#39;, Align=&#39;r&#39;, Digits=4, ColumnSpec=1:5, ColWidth = ColWidth5) %&gt;% footnote(general = &quot;Center for Research on Security Prices, University of Chicago&quot;, general_title = &quot;Fuente:&quot;, footnote_as_chunk = TRUE) # FIGURA 2.10 par(mar=c(4.1,3.1,2,1),cex=1.1, las=1) foo &lt;- ts(CAPM, freq = 12, start = c(1986, 1)) ts.plot(foo[,2], foo[,3], xlab=&quot;Año&quot;, ylab=&quot;&quot;, type=&quot;o&quot;, lty=c(1, 2)) mtext(&quot;Rendimiento Mensual&quot;, side=2, at=.38,las=1,cex=1.1, adj=.5) legend(1986, 0.3, c(&quot;LINCOLN&quot;, &quot;MARKET&quot;), lty=1:2, cex=0.5) # FIGURA 2.11 par(mar=c(4.1,3.1,1.4,0.2),cex=1.1, las=1) plot(CAPM$MARKET, CAPM$LINCOLN, xlab=&quot;MARKET&quot;, ylab=&quot;&quot;, xlim=c(-0.3, 0.2), ylim=c(-0.3, 0.4),las=1) mtext(&quot;LINCOLN&quot;, side=2,at=0.46,las=1, cex=1.1, adj=.5) reg &lt;- lm(LINCOLN ~ MARKET, data = CAPM) abline(reg) arrows(-0.22, -0.1, -0.22, -0.22,length=0.1, angle = 10) text(-0.22, -0.08, &quot;COLAPSO DE OCTUBRE, 1987&quot;, cex=0.8) arrows(0.1, 0.02, 0, -0.27,length=0.1, angle = 10) arrows(0.1, 0.02, 0.06, 0.3,length=0.1, angle = 10) text(0.16, 0.02, &quot;PUNTOS ATÍPICOS DE 1990&quot;, cex=0.8) Puntos Inusuales Para resumir la relación entre el mercado y el rendimiento de Lincoln, se ajustó un modelo de regresión. La regresión ajustada es \\[\\begin{equation*} \\widehat{LINCOLN}=-0.00214+0.973 MARKET. \\end{equation*}\\] El error estándar estimado resultante, \\(s = 0.0696\\), es menor que la desviación estándar de los rendimientos de Lincoln, \\(s_y=0.0859\\). Por lo tanto, el modelo de regresión explica parte de la variabilidad de los rendimientos de Lincoln. Además, el estadístico \\(t\\) asociado con la pendiente \\(b_1\\) resulta ser \\(t(b_1)=5.64\\), lo cual es significativamente alto. Un aspecto decepcionante es que el estadístico \\(R^2=35.4\\%\\) se puede interpretar como que el mercado explica solo un poco más de un tercio de la variabilidad. Por lo tanto, aunque el mercado es claramente un determinante importante, como lo evidencian el alto estadístico \\(t\\), solo proporciona una explicación parcial del rendimiento de los rendimientos de Lincoln. En el contexto del modelo de mercado, podemos interpretar la desviación estándar del mercado, \\(s_x\\), como riesgo no diversificable. Por lo tanto, el riesgo de un valor puede descomponerse en dos componentes: el componente diversificable y el componente del mercado, que es no diversificable. La idea es que, al combinar varios valores, podemos crear una cartera de valores que, en la mayoría de los casos, reducirá el riesgo de nuestras inversiones en comparación con un solo valor. Nuevamente, la razón para tener un valor es que estamos compensados con rendimientos esperados más altos al tener un valor con mayor riesgo. Para cuantificar el riesgo relativo, no es difícil demostrar que \\[\\begin{equation} s_y^2 = b_1^2 s_x^2 + s^2 \\frac{n-2}{n-1}. \\tag{2.8} \\end{equation}\\] El riesgo de un valor se debe al riesgo del mercado más el riesgo de un componente diversificable. Tenga en cuenta que el riesgo del componente del mercado, \\(s_x^2\\), es mayor para los valores con pendientes más grandes. Por esta razón, los inversores consideran que los valores con pendientes \\(b_1\\) mayores que uno son “agresivos” y las pendientes menores que uno como “defensivos”. Análisis de Sensibilidad El resumen anterior plantea inmediatamente dos cuestiones adicionales. Primero, ¿cuál es el efecto del colapso de octubre de 1987 en la ecuación de regresión ajustada? Sabemos que las observaciones inusuales, como el colapso, pueden influir mucho en el ajuste. Con este fin, se volvió a ejecutar la regresión sin la observación correspondiente al colapso. La motivación para esto es que el colapso de octubre de 1987 representa una combinación de eventos altamente inusuales (la interacción de varios programas de comercio automatizado operados por grandes casas de corretaje de valores) que no deseamos representar con el mismo modelo que nuestras otras observaciones. Eliminando esta observación, la regresión ajustada es \\[\\begin{equation*} \\widehat{LINCOLN} = -0.00181 + 0.956 MARKET, \\end{equation*}\\] con \\(R^2=26.4\\%\\), \\(t(b_1)=4.52\\), \\(s=0.0702\\) y \\(s_y=0.0811\\). Interpretamos estas estadísticas de la misma manera que el modelo ajustado que incluye el colapso de octubre de 1987. Sin embargo, es interesante notar que la proporción de variabilidad explicada ha disminuido al excluir el punto influyente. Esto sirve para ilustrar un punto importante. Los puntos de alta influencia a menudo son temidos por los analistas de datos porque, por definición, son diferentes de otras observaciones en el conjunto de datos y requieren una atención especial. Sin embargo, al ajustar las relaciones entre variables, también representan una oportunidad porque permiten al analista de datos observar la relación entre variables en rangos más amplios que de otro modo serían posibles. La desventaja es que estas relaciones pueden ser no lineales o seguir un patrón completamente diferente en comparación con las relaciones observadas en la parte principal de los datos. La segunda pregunta planteada por el análisis de regresión es qué se puede decir sobre las circunstancias inusuales que dieron lugar al comportamiento inusual de los rendimientos de Lincoln en octubre y noviembre de 1990. Una característica útil del análisis de regresión es identificar y plantear la pregunta; no la resuelve. Debido a que el análisis señala claramente dos puntos altamente inusuales, sugiere al analista de datos que vuelva y haga algunas preguntas específicas sobre las fuentes de los datos. En este caso, la respuesta es directa. En octubre de 1990, la compañía Travelers’ Insurance, una competidora, anunció que tomaría una gran amortización en su cartera de bienes raíces debido a un número sin precedentes de incumplimientos hipotecarios. El mercado reaccionó rápidamente a esta noticia, y los inversores asumieron que otras grandes compañías de seguros de vida también anunciarían pronto grandes amortizaciones. Anticipando esta noticia, los inversores trataron de vender sus carteras de, por ejemplo, las acciones de Lincoln, lo que provocó una caída en el precio. Sin embargo, resultó que los inversores reaccionaron en exceso a esta noticia y que la cartera de bienes raíces de Lincoln estaba en realidad en buen estado. Así, los precios rápidamente volvieron a sus niveles históricos. 2.8 Salida Computacional Ilustrativa de Regresión Las computadoras y los paquetes de software estadístico que realizan cálculos especializados juegan un papel vital en los análisis estadísticos modernos. Las capacidades informáticas económicas han permitido a los analistas de datos centrarse en las relaciones de interés. Es mucho menos importante especificar modelos que sean atractivos únicamente por su simplicidad computacional en comparación con épocas anteriores a la disponibilidad generalizada de computación económica. Un tema importante de este texto es centrarse en las relaciones de interés y confiar en el software estadístico ampliamente disponible para estimar los modelos que especificamos. Con cualquier paquete de computadora, generalmente las partes más difíciles de operar el paquete son (i) la entrada, (ii) el uso de los comandos y (iii) la interpretación de la salida. Encontrarás que la mayoría de los paquetes estadísticos modernos aceptan archivos en formato de hoja de cálculo o texto, lo que facilita la entrada de datos. Los paquetes de software estadístico para computadoras personales tienen lenguajes de comando basados en menús con facilidades de ayuda en línea fácilmente accesibles. Una vez que decides qué hacer, encontrar los comandos correctos es relativamente fácil. Esta sección proporciona orientación para interpretar la salida de los paquetes estadísticos. La mayoría de los paquetes estadísticos generan salidas similares. A continuación, se presentan tres ejemplos de paquetes estadísticos estándar: EXCEL, SAS y R. El símbolo de anotación “[.]” marca una cantidad estadística que se describe en la leyenda. Así, esta sección proporciona un enlace entre la notación utilizada en el texto y la salida de algunos de los paquetes estadísticos estándar. Salida en EXCEL Regression Statistics Multiple R 0.886283[F] R Square 0.785497[k] Adjusted R Square 0.781028[l] Standard Error 3791.758[j] Observations 50[a] ANOVA df SS MS F Significance F Regression 1[m] 2527165015 [p] 2527165015 [s] 175.773[u] 1.15757E-17[v] Residual 48[n] 690116754.8[q] 14377432.39[t] Total 49[o] 3217281770 [r] Coefficients Standard Error t Stat P-value Intercept 469.7036[b] 702.9061896[d] 0.668230846[f] 0.507187[h] X Variable 1 0.647095[c] 0.048808085[e] 13.25794257[g] 1.16E-17[i] El Sistema SAS The REG Procedure Dependent Variable: SALES Analysis of Variance Sum of Mean Source DF Squares Square F Value Pr &gt; F Model 1[m] 2527165015[p] 2527165015[s] 175.77[u] &lt;.0001[v] Error 48[n] 690116755[q] 14377432[t] Corrected Total 49[o] 3217281770[r] Root MSE 3791.75848[j] R-Square 0.7855[k] Dependent Mean 6494.82900[H] Adj R-Sq 0.7810[l] Coeff Var 58.38119[I] Parameter Estimates Parameter Standard Variable Label DF Estimate Error t Value Pr &gt; |t| Intercept Intercept 1 469.70360[b] 702.90619[d] 0.67[f] 0.5072[h] POP POP 1 0.64709[c] 0.04881[e] 13.26[g] &lt;.0001[i] Salida en R Analysis of Variance Table Response: SALES Df Sum Sq Mean Sq F value Pr(&gt;F) POP 1[m] 2527165015[p] 2527165015[s] 175.77304[u] &lt;2.22e-16[v]*** Residuals 48[n] 690116755[q] 14377432[t] --- Call: lm(formula = SALES ~ POP) Residuals: Min 1Q Median 3Q Max -6047 -1461 -670 486 18229 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 469.7036[b] 702.9062[d] 0.67[f] 0.51 [h] POP 0.6471[c] 0.0488[e] 13.26[g] &lt;2e-16 ***[i] --- Signif. codes: 0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 Residual standard error: 3792[j] on 48[n] degrees of freedom Multiple R-Squared: 0.785[k], Adjusted R-squared: 0.781[l] F-statistic: 176[u] on 1[m] and 48[n] DF, p-value: &lt;2e-16[v] Definición de Anotación de Leyenda, Símbolo [a] Número de observaciones \\(n\\). [b] La intersección estimada \\(b_0\\). [c] La pendiente estimada \\(b_1\\). [d] El error estándar de la intersección, \\(se(b_0)\\). [e] El error estándar de la pendiente, \\(se(b_1)\\). [f] El valor del \\(t\\) asociado con la intersección, \\(t(b_0) = b_0/se(b_0)\\). [g] El valor del \\(t\\) asociado con la pendiente, \\(t(b_1) = b_1/se(b_1)\\). [h] El valor \\(p\\) asociado con la intersección; aquí, \\(p-value=Pr(|t_{n-2}|&gt;|t(b_0)|)\\), donde \\(t(b_0)\\) es el valor realizado (0.67 aquí) y \\(t_{n-2}\\) tiene una distribución \\(t\\) con \\(df=n-2\\). [i] El valor \\(p\\) asociado con la pendiente; aquí, \\(p-value=Pr(|t_{n-2}|&gt;|t(b_1)|)\\), donde \\(t(b_1)\\) es el valor realizado (13.26 aquí) y \\(t_{n-2}\\) tiene una distribución \\(t\\) con \\(df=n-2\\). [j] La desviación estándar residual, \\(s\\). [k] El coeficiente de determinación, \\(R^2\\). [l] El coeficiente de determinación ajustado por grados de libertad, \\(R_{a}^2\\). (Este término se definirá en el Capítulo 3.) [m] Grados de libertad para el componente de regresión. Esto es 1 para una variable explicativa. [n] Grados de libertad para el componente de error, \\(n-2\\), para la regresión con una variable explicativa. [o] Grados de libertad totales, \\(n-1\\). [p] La suma de cuadrados de la regresión, \\(Regression~SS\\). [q] La suma de cuadrados del error, \\(Error~SS\\). [r] La suma total de cuadrados, \\(Total~SS\\). [s] El cuadrado medio de la regresión, \\(Regression~MS = Regression~SS/1\\), para una variable explicativa. [t] El cuadrado medio del error, \\(s^2=Error~MS = Error~SS/(n-2)\\), para una variable explicativa. [u] El \\(F-ratio=(Regression~MS)/(Error~MS)\\). (Este término se definirá en el Capítulo 3.) [v] El valor \\(p\\) asociado con el \\(F-ratio\\). (Este término se definirá en el Capítulo 3.) [w] El número de observación, \\(i\\). [x] El valor de la variable explicativa para la \\(i\\)-ésima observación, \\(x_i\\). [y] La respuesta para la \\(i\\)-ésima observación, \\(y_i\\). [z] El valor ajustado para la \\(i\\)-ésima observación, \\(\\widehat{y}_i\\). [A] El error estándar del ajuste, \\(se(\\widehat{y}_i)\\). [B] El residual para la \\(i\\)-ésima observación, \\(e_i\\). [C] El residual estandarizado para la \\(i\\)-ésima observación, \\(e_i/se(e_i)\\). El error estándar \\(se(e_i)\\) se definirá en la Sección 5.3.1. [F] El coeficiente de correlación múltiple es la raíz cuadrada del coeficiente de determinación, \\(R=\\sqrt{R^2}\\). Esto se definirá en el Capítulo 3. [G] El coeficiente estandarizado es \\(b_1s_x/s_y\\). Para regresión con una variable explicativa, esto es equivalente a \\(r\\), el coeficiente de correlación. [H] La respuesta promedio, \\(\\overline{y}\\). [I] El coeficiente de variación de la respuesta es \\(s_y/\\overline{y}\\). SAS imprime \\(100s_y/\\overline{y}\\). 2.9 Lecturas Adicionales y Referencias Relativamente pocas aplicaciones de la regresión son básicas en el sentido de que usan solo una variable explicativa; el propósito del análisis de regresión es reducir las relaciones complejas entre muchas variables. La Sección 2.7 describe una excepción importante a esta regla general, el modelo financiero CAPM; consulta a Panjer et al. (1998) para descripciones actuariales adicionales de este modelo. Campbell et al. (1997) ofrece una perspectiva desde la econometría financiera. Referencias del Capítulo Anscombe, Frank (1973). Graphs in statistical analysis. The American Statistician 27, 17-21. Campbell, John Y., Andrew W. Lo and A. Craig MacKinlay (1997). The Econometrics of Financial Markets. Princeton University Press, Princeton, New Jersey. Frees, Edward W. and Tom W. Miller (2003). Sales forecasting using longitudinal data models. International Journal of Forecasting 20, 97-111. Goldberger, Arthur (1991). A Course in Econometrics. Harvard University Press, Cambridge. Koch, Gary J. (1985). A basic demonstration of the [-1, 1] range for the correlation coefficient. American Statistician 39, 201-202. Linter, J. (1965). The valuation of risky assets and the selection of risky investments in stock portfolios and capital budgets. Review of Economics and Statistics, 13-37. Manistre, B. John and Geoffrey H. Hancock (2005). Variance of the CTE estimator. North American Actuarial Journal 9(2), 129-156. Markowitz, Harry (1959). Portfolio Selection: Efficient Diversification of Investments. John Wiley, New York. Panjer, Harry H., Phelim P. Boyle, Samuel H. Cox, Daniel Dufresne, Hans U. Gerber, Heinz H. Mueller, Hal W. Pedersen, Stanley R. Pliska, Michael Sherris, Elias S. Shiu and Ken S. Tan (1998). Financial Economics: With Applications to Investment, Insurance and Pensions. Society of Actuaries, Schaumburg, Illinois. Pearson, Karl (1895). Royal Society Proceedings 58, 241. Serfling, Robert J. (1980). Approximation Theorems of Mathematical Statistics. John Wiley and Sons, New York. Sharpe, William F. (1964). Capital asset prices: A theory of market equilibrium under risk. Journal of Finance, 425-442. Stigler, Steven M. (1986). The History of Statistics: The Measurement of Uncertainty before 1900. Harvard University Press, Cambridge, MA. 2.10 Ejercicios Secciones 2.1-2.2 2.1 Considera el siguiente conjunto de datos \\[ \\begin{array}{l|ccc} \\hline i &amp; 1 &amp; 2 &amp; 3 \\\\ \\hline x_i &amp; 2 &amp; -6 &amp; 7 \\\\ y_i &amp; 3 &amp; 4 &amp; 6\\\\ \\hline \\end{array} \\] Ajusta una línea de regresión utilizando el método de mínimos cuadrados. Determina \\(r\\), \\(b_1\\) y \\(b_0\\). 2.2 Una relación perfecta, pero sin correlación. Considera la relación cuadrática \\(y=x^2\\), con datos \\[ \\begin{array}{l|ccccc} \\hline i &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5\\\\ \\hline x_i &amp; -2 &amp; -1 &amp; 0 &amp; 1 &amp; 2 \\\\ y_i &amp; 4 &amp; 1 &amp; 0 &amp; 1 &amp; 4\\\\ \\hline \\end{array} \\] Produce un gráfico aproximado para este conjunto de datos. Verifica que el coeficiente de correlación es \\(r=0\\). 2.3 Acotación del coeficiente de correlación. Utiliza los siguientes pasos para demostrar que \\(r\\) está acotado entre -1 y 1 (Estos pasos son de Koch, 1990). Deja que \\(a\\) y \\(c\\) sean constantes genéricas. Verifica \\[\\begin{eqnarray*} 0 &amp; \\leq &amp; \\frac{1}{n-1}\\sum_{i=1}^{n}\\left( a\\frac{x_i-\\overline{x}}{s_x}-c \\frac{y_i-\\overline{y}}{s_y}\\right) ^2 \\\\ &amp;=&amp; a^2+c^2-2acr. \\end{eqnarray*}\\] Utiliza los resultados del apartado (a) para demostrar que \\(2ac(r-1)\\leq (a-c)^2.\\) Al tomar \\(a=c\\), utiliza el resultado del apartado (b) para demostrar que \\(r\\leq 1\\). Al tomar \\(a=-c\\), utiliza los resultados del apartado (b) para demostrar que \\(r\\geq -1\\). ¿En qué condiciones es \\(r=-1\\)? ¿En qué condiciones es \\(r=1\\)? 2.4 Los coeficientes de regresión son sumas ponderadas. Demuestra que el término de intercepto, \\(b_0\\), puede expresarse como una suma ponderada de las variables dependientes. Es decir, demuestra que \\(b_0=\\sum_{i=1}^{n}w_{i,0}y_i.\\) Además, expresa los pesos en términos de los pesos de la pendiente, \\(w_i\\). 2.5 Otra expresión para la pendiente como una suma ponderada Utilizando álgebra, establece una expresión alternativa \\[\\begin{equation*} b_1=\\frac{\\sum_{i=1}^{n}weight_i~slope_i}{ \\sum_{i=1}^{n}weight_i}. \\end{equation*}\\] Aquí, \\(slope_i\\) es la pendiente entre \\((x_i,y_i)\\) y \\((\\bar{x},\\bar{y})\\). Da una forma precisa para el peso \\(weight_i\\) como una función de la variable explicativa \\(x\\). Supón que \\(\\bar{x} = 4, \\bar{y} = 3, x_1 = 2 \\text{ y } y_1= 6\\). Determina la pendiente y el peso para la primera observación, es decir, \\(slope_1\\) y \\(weight_1\\). 2.6 Considera dos variables, \\(y\\) y \\(x\\). Realiza una regresión de \\(y\\) sobre \\(x\\) para obtener un coeficiente de pendiente que llamaremos \\(b_{1,x,y}\\). Realiza otra regresión de \\(x\\) sobre \\(y\\) para obtener un coeficiente de pendiente que llamaremos \\(b_{1,y,x}\\). Demuestra que el coeficiente de correlación entre \\(x\\) y \\(y\\) es la media geométrica de los dos coeficientes de pendiente según el signo, es decir, demuestra que \\(|r|=\\sqrt{ b_{1,x,y}b_{1,y,x}}.\\) 2.7 Regresión a través del origen. Considera el modelo \\(y_i=\\beta_1 x_i + \\varepsilon _i\\), es decir, regresión con una variable explicativa sin el término de intercepto. Este modelo se llama regresión a través del origen porque la verdadera línea de regresión \\(\\mathrm{E}y = \\beta_1 x\\) pasa por el origen (el punto (0, 0)). Para este modelo, la estimación de mínimos cuadrados de \\(\\beta_1\\) es ese número \\(b_1\\) que minimiza la suma de cuadrados \\(\\mathrm{SS}(b_1^{\\ast} )=\\sum_{i=1}^{n}\\left( y_i - b_1^{\\ast}x_i\\right) ^2.\\) Verifica que \\[\\begin{equation*} b_1 = \\frac{\\sum_{i=1}^{n} x_i y_i}{\\sum_{i=1}^{n}x_i^2}. \\end{equation*}\\] Considera el modelo \\(y_i=\\beta_1 z_i^2 + \\varepsilon _i\\), un modelo cuadrático que pasa por el origen. Utiliza el resultado del apartado (a) para determinar la estimación de mínimos cuadrados de \\(\\beta_1\\). 2.8 a. Demuestra que \\[\\begin{equation*} s_y^2=\\frac{1}{n-1}\\sum_{i=1}^{n}\\left( y_i-\\overline{y}\\right) ^2= \\frac{1}{n-1}\\left( \\sum_{i=1}^{n}y_i^2-n\\overline{y}^2\\right) . \\end{equation*}\\] Sigue los mismos pasos para demostrar que \\(\\sum_{i=1}^{n}\\left( y_i - \\overline{y} \\right) \\left( x_i-\\overline{x}\\right) =\\sum_{i=1}^{n} x_i y_i - n \\overline{x}~\\overline{y}.\\) Demuestra que \\[ b_{1}=\\frac{\\sum_{i=1}^{n}\\left( y_i-\\overline{y}\\right) \\left( x_i- \\overline{x}\\right) }{\\sum_{i=1}^{n}\\left( x_i - \\overline{x} \\right) ^2} \\] Establece la fórmula comúnmente utilizada \\[ b_{1}= \\frac{\\sum_{i=1}^{n}x_iy_i-n\\overline{x}~\\overline{y}} {\\sum_{i=1}^{n}x_i^2 - n\\overline{x}^2}. \\] 2.9 Interpretación de los coeficientes asociados con una variable explicativa binaria. Supón que \\(x_i\\) solo toma los valores 0 y 1. De las \\(n\\) observaciones, \\(n_1\\) toman el valor \\(x=0\\). Estas \\(n_1\\) observaciones tienen un valor promedio \\(y\\) de \\(\\overline{y}_1\\). Las restantes \\(n-n_1\\) observaciones tienen el valor \\(x=1\\) y un valor promedio \\(y\\) de \\(\\overline{y}_2\\). Utiliza el Ejercicio 2.8 para demostrar que \\(b_1 = \\overline{y}_2 - \\overline{y}_1.\\) 2.10 Utilización de Hogares de Cuidado. Este ejercicio considera los datos de hogares de cuidado proporcionados por el Departamento de Salud y Servicios Familiares de Wisconsin (DHFS) y descritos en el Ejercicio 1.2. Parte 1: Utiliza los datos del año 2000 y realiza el siguiente análisis. Correlaciones a(i). Calcula la correlación entre TPY y LOGTPY. Comenta tu resultado. a(ii). Calcula la correlación entre TPY, NUMBED y SQRFOOT. ¿Parecen estas variables altamente correlacionadas? a(iii). Calcula la correlación entre TPY y NUMBED/10. Comenta tu resultado. Diagramas de dispersión. Grafica TPY versus NUMBED y TPY versus SQRFOOT. Comenta los gráficos. Regresión lineal básica. c(i). Ajusta un modelo de regresión lineal básico usando TPY como variable de resultado y NUMBED como variable explicativa. Resume el ajuste citando el coeficiente de determinación, \\(R^2\\), y el estadístico \\(t\\) para NUMBED. c(ii). Repite c(i), usando SQRFOOT en lugar de NUMBED. En términos de \\(R^2\\), ¿cuál modelo se ajusta mejor? c(iii). Repite c(i), usando LOGTPY como variable de resultado y LOG(NUMBED) como variable explicativa. c(iv). Repite c(iii), usando LOGTPY como variable de resultado y LOG(SQRFOOT) como variable explicativa. Parte 2: Ajusta el modelo en la Parte 1.c(i) usando datos de 2001. ¿Son los patrones estables a lo largo del tiempo? Secciones 2.3-2.4 2.11 Supón que, para un tamaño de muestra de \\(n\\) = 3, tienes \\(e_2\\) = 24 y \\(e_{3}\\) = -1. Determina \\(e_{1}\\). 2.12 Supón que \\(r=0\\), \\(n=15\\) y \\(s_y = 10\\). Determina \\(s\\). 2.13 El coeficiente de correlación y el coeficiente de determinación. Usa los siguientes pasos para establecer una relación entre el coeficiente de determinación y el coeficiente de correlación. Muestra que \\(\\widehat{y}_i-\\overline{y}=b_1(x_i-\\overline{x}).\\) Usa el apartado (a) para mostrar que \\(Regress~SS=\\sum_{i=1}^{n}\\left(\\widehat{y}_i - \\overline{y} \\right)^2 = b_1^2s_x^2(n-1).\\) Usa el apartado (b) para establecer que \\(R^2=r^2.\\) 2.14 Muestra que el residuo promedio es cero, es decir, muestra que \\(n^{-1}\\sum_{i=1}^{n} e_i=0.\\) 2.15 Correlación entre residuos y variables explicativas. Considera una secuencia genérica de pares de números \\((x_1,y_1)\\), …, \\((x_n,y_n)\\) con el coeficiente de correlación calculado como \\(r(y,x)=\\left[ (n-1)s_ys_x\\right] ^{-1}\\sum_{i=1}^{n}\\left( y_i-\\overline{y}\\right) \\left( x_i-\\overline{x}\\right) .\\) Supón que \\(\\overline{y}=0\\), \\(\\overline{x}=0\\) o ambos \\(\\overline{x}\\) y \\(\\overline{y}=0\\). Luego, verifica que \\(r(y,x)=0\\) implica \\(\\sum_{i=1}^{n}y_i x_i=0\\) y viceversa. Muestra que la correlación entre los residuos y las variables explicativas es cero. Haz esto usando la parte (a) del Ejercicio 2.13 para mostrar que \\(\\sum_{i=1}^{n} x_i e_i = 0\\) y luego aplica la parte (a). Muestra que la correlación entre los residuos y los valores ajustados es cero. Haz esto mostrando que \\(\\sum_{i=1}^n \\widehat{y}_i e_i = 0\\) y luego aplica la parte (a). 2.16 Correlación y estadísticas \\(t\\). Usa los siguientes pasos para establecer una relación entre el coeficiente de correlación y el estadístico \\(t\\) para la pendiente. Usa álgebra para verificar que \\[\\begin{equation*} R^2=1-\\frac{n-2}{n-1}\\frac{s^2}{s_y^2}. \\end{equation*}\\] Usa la parte (a) para establecer la siguiente fórmula rápida para \\(s\\), \\[\\begin{equation*}s = s_y \\sqrt{(1-r^2)\\frac{n-1}{n-2}}.\\end{equation*}\\] Usa la parte (b) para mostrar que \\[\\begin{equation*} t(b_1) = \\sqrt{n-2}\\frac{r}{\\sqrt{1-r^2}}. \\end{equation*}\\] 2.17 Efectos de un punto inusual. Estás analizando un conjunto de datos de tamaño \\(n=100\\). Has realizado un análisis de regresión usando una variable predictora y notas que el residuo para la décima observación es inusualmente grande. Supón que, de hecho, resulta que \\(e_{10}=8s\\). ¿Qué porcentaje de la suma de cuadrados de los errores, \\(Error~SS\\), se debe a la décima observación? Supón que \\(e_{10}=4s\\). ¿Qué porcentaje de la suma de cuadrados de errores, \\(Error~SS\\), se debe a la décima observación? Supón que reduces el conjunto de datos a tamaño \\(n=20\\). Después de realizar la regresión, resulta que todavía tenemos \\(e_{10}=4s\\). ¿Qué porcentaje de la suma de cuadrados de errores, \\(Error~SS\\), se debe a la décima observación? 2.18 Considera un conjunto de datos de 20 observaciones con las siguientes estadísticas resumen: \\(\\overline{x}=0\\), \\(\\overline{y}=9\\), \\(s_x=1\\) y \\(s_y=10\\). Realizas una regresión usando una variable y determinas que \\(s=7\\). Determina el error estándar de una predicción en \\(x_{\\ast}=1.\\) 2.19 Las estadísticas resumen pueden ocultar relaciones importantes. Los datos en Tabla 2.9 son de Anscombe (1973). El propósito de este ejercicio es demostrar cómo graficar los datos puede revelar información importante que no es evidente en las estadísticas numéricas resumen. Tabla 2.9. Datos de Anscombe (1973) \\[ {\\small \\begin{array}{c|rrrrrr} \\hline obs &amp; &amp; &amp; &amp; &amp; &amp; \\\\ num &amp; x_1 &amp; y_1 &amp; y_2 &amp; y_3 &amp; x_2 &amp; y_4 \\\\ \\hline 1 &amp; 10 &amp; 8.04 &amp; 9.14 &amp; 7.46 &amp; 8 &amp; 6.58 \\\\ 2 &amp; 8 &amp; 6.95 &amp; 8.14 &amp; 6.77 &amp; 8 &amp; 5.76 \\\\ 3 &amp; 13 &amp; 7.58 &amp; 8.74 &amp; 12.74 &amp; 8 &amp; 7.71 \\\\ 4 &amp; 9 &amp; 8.81 &amp; 8.77 &amp; 7.11 &amp; 8 &amp; 8.84 \\\\ 5 &amp; 11 &amp; 8.33 &amp; 9.26 &amp; 7.81 &amp; 8 &amp; 8.47 \\\\ 6 &amp; 14 &amp; 9.96 &amp; 8.10 &amp; 8.84 &amp; 8 &amp; 7.04 \\\\ 7 &amp; 6 &amp; 7.24 &amp; 6.13 &amp; 6.08 &amp; 8 &amp; 5.25 \\\\ 8 &amp; 4 &amp; 4.26 &amp; 3.10 &amp; 5.39 &amp; 8 &amp; 5.56 \\\\ 9 &amp; 12 &amp; 10.84 &amp; 9.13 &amp; 8.15 &amp; 8 &amp; 7.91 \\\\ 10 &amp; 7 &amp; 4.82 &amp; 7.26 &amp; 6.42 &amp; 8 &amp; 6.89 \\\\ 11 &amp; 5 &amp; 5.68 &amp; 4.74 &amp; 5.73 &amp; 19 &amp; 12.50 \\\\ \\hline \\end{array} } \\] Calcula los promedios y desviaciones estándar de cada columna de datos. Verifica que los promedios y desviaciones estándar de cada una de las columnas \\(x\\) son iguales, dentro de dos decimales, y de manera similar para cada una de las columnas \\(y\\). Realiza cuatro regresiones, (1) \\(y_{1}\\) sobre \\(x_{1}\\), (2) \\(y_2\\) sobre \\(x_{1}\\), (3) \\(y_{3}\\) sobre \\(x_{1}\\) y (4) \\(y_{4}\\) sobre \\(x_2\\). Verifica, para cada uno de los cuatro ajustes de regresión, que \\(b_0\\approx 3.0\\), \\(b_{1}\\approx 0.5\\), \\(s\\approx 1.237\\) y \\(R^2\\approx 0.677\\), dentro de dos decimales. Produce diagramas de dispersión para cada uno de los cuatro modelos de regresión que ajustaste en el apartado (b). Discute el hecho de que los modelos de regresión ajustados en el apartado (b) implican que los cuatro conjuntos de datos son similares, aunque los cuatro diagramas de dispersión producidos en el apartado (c) muestran una historia dramáticamente diferente. 2.20 Utilización de Hogares de Cuidado. Este ejercicio considera los datos de hogares de cuidado proporcionados por el Departamento de Salud y Servicios Familiares de Wisconsin (DHFS) y descritos en el Ejercicio 1.2 y 2.10. Decides examinar la relación entre los años totales de pacientes (LOGTPY) y el número de camas (LOGNUMBED), ambos en unidades logarítmicas, usando datos del año 2001. Estadísticas descriptivas. Crea estadísticas descriptivas básicas para cada variable. Resume la relación mediante un estadístico de correlación y un diagrama de dispersión. Ajusta el modelo lineal básico. Cita las estadísticas descriptivas básicas, incluye el coeficiente de determinación, el coeficiente de regresión para LOGNUMBED y el estadístico \\(t\\) correspondiente. Pruebas de hipótesis. Prueba las siguientes hipótesis al nivel de significancia del 5% usando un estadístico \\(t\\). También calcula el valor \\(p\\) correspondiente. c(i). Prueba \\(H_0: \\beta_1 = 0\\) frente a \\(H_a: \\beta_1 \\neq 0\\). c(ii). Prueba \\(H_0: \\beta_1 = 1\\) frente a \\(H_a: \\beta_1 \\neq 1\\). c(iii). Prueba \\(H_0: \\beta_1 = 1\\) frente a \\(H_a: \\beta_1 &gt; 1\\). c(iv). Prueba \\(H_0: \\beta_1 = 1\\) frente a \\(H_a: \\beta_1 &lt; 1\\). Estás interesado en el efecto que un cambio marginal en LOGNUMBED tiene sobre el valor esperado de LOGTPY. d(i). Supón que hay un cambio marginal en LOGNUMBED de 2. Proporciona una estimación puntual del cambio esperado en LOGTPY. d(ii). Proporciona un intervalo de confianza del 95% correspondiente a la estimación puntual en la parte d(i). d(iii). Proporciona un intervalo de confianza del 99% correspondiente a la estimación puntual en la parte d(i). En un número especificado de camas estimado en \\(x_{*} = 100\\), haz lo siguiente: e(i). Encuentra el valor predicho de LOGTPY. e(ii). Obtén el error estándar de la predicción. e(iii). Obtén un intervalo de predicción del 95% para tu predicción. e(iv). Convierte la predicción puntual en la parte e(i) y el intervalo de predicción obtenido en la parte e(iii) en años totales de personas (mediante exponenciación). e(v). Obtén un intervalo de predicción como en la parte e(iv), correspondiente a un nivel del 90% (en lugar del 95%). 2.21 Ofertas Públicas Iniciales. Como analista financiero, deseas convencer a un cliente de las ventajas de invertir en empresas que acaban de ingresar a una bolsa de valores, en una OPI (oferta pública inicial). Por lo tanto, reúnes datos de 116 empresas que fijaron precios durante el período de seis meses del 1 de enero de 1998 al 1 de junio de 1998. Al mirar estos datos históricos recientes, puedes calcular RETURN, el retorno de la empresa en un año (en porcentaje). También estás interesado en observar características financieras de la empresa que puedan ayudarte a entender (y predecir) el retorno. Inicialmente examinas REVENUE, los ingresos de la empresa en 1997 en millones de dólares. Desafortunadamente, esta variable no estaba disponible para seis empresas. Por lo tanto, las estadísticas a continuación son para las 110 empresas que tienen tanto REVENUE como RETURN. Además, la Tabla 2.9 proporciona información sobre los ingresos logarítmicos (naturales), denominados como LnREV, y el precio inicial de la acción, denominado PRICEIPO. Tabla 2.9: Estadísticas Resumen de Cada Variable Media Mediana Desviación Estándar Mínimo Máximo RETURN 0.106 -0.130 0.824 -0.938 4.333 REV 134.487 39.971 261.881 0.099 1455.761 LnREV 3.686 3.688 1.698 -2.316 7.283 PRICEIPO 13.195 13.000 4.694 4.000 29.000 Hipotetizas que las empresas más grandes, medida por ingresos, son más estables y, por lo tanto, deberían tener mayores retornos. Has determinado que la correlación entre RETURN y REVENUE es -0.0175. a(i). Calcula el ajuste de mínimos cuadrados usando REVENUE para predecir RETURN. Determina \\(b_0\\) y \\(b_1\\). a(ii). Para Hyperion Telecommunications, los ingresos son 95.55 (millones de dólares). Calcula el RETURN ajustado usando el ajuste de regresión en la parte a(i). Tabla 2.11. Resultados de la Regresión con Ingresos Logarítmicos \\[ {\\small \\begin{array}{l|rrr} \\hline &amp; &amp; \\text{Error} &amp; \\\\ \\text{Variable} &amp; \\text{Coeficiente} &amp; \\text{Estándar} &amp; t-\\text{estadístico} \\\\ \\hline \\text{INTERCEPTO} &amp; 0.438 &amp; 0.186 &amp; 2.35\\\\ \\text{LnREV} &amp; -0.090 &amp; 0.046 &amp; -1.97 \\\\ \\hline s = 0.8136, &amp; R^2 = 0.03452 \\\\ \\hline \\end{array} } \\] Ingresos logarítmicos y retornos. b(i). Supón que usas LnREV para predecir RETURN. Calcula el RETURN ajustado bajo este modelo de regresión. ¿Es igual a tu respuesta en la parte a(ii)? b(ii) ¿Afectan significativamente los ingresos logarítmicos a los retornos? Para ello, proporciona una prueba formal de hipótesis. Expón tus hipótesis nula y alternativa, el criterio de toma de decisiones y la regla de toma de decisiones. Usa un nivel de significancia del 10%. b(iii). Hipotetizas que, manteniendo todo constante, las empresas con mayores ingresos serán más estables y, por lo tanto, tendrán un mayor retorno inicial. Por lo tanto, deseas considerar la hipótesis nula de ninguna relación entre LnREV y RETURN frente a la hipótesis alternativa de que hay una relación positiva entre LnREV y RETURN. Para ello, proporciona una prueba formal de hipótesis. Expón tus hipótesis nula y alternativa, el criterio de toma de decisiones y la regla de toma de decisiones. Usa un nivel de significancia del 10%. Determina la correlación entre LnREV y RETURN. Asegúrate de indicar si esta correlación es positiva, negativa o cero. Estás considerando invertir en una empresa que tiene LnREV = 2 (por lo que los ingresos son \\(e^2\\) = 7.389 millones de dólares). d(i). Usando el modelo de regresión ajustado, determina la predicción puntual de mínimos cuadrados. d(ii). Determina el intervalo de predicción del 95% correspondiente a tu predicción en la parte d(i). El \\(R^2\\) del modelo de regresión ajustado es un decepcionante 3.5%. Parte de la dificultad se debe a la observación número 59, la Corporación Inktomi. Las ventas de Inktomi están en el 12º lugar más bajo del conjunto de datos, con LnREV = 1.76 (por lo que los ingresos son \\(e^{1.76} = 5.79\\) millones de dólares), pero tiene el mayor retorno en el primer año, con RETURN = 433.33. e(i). Calcula el residuo para esta observación. e(ii). ¿Qué proporción de la variabilidad no explicada (suma de cuadrados de errores) representa esta observación? e(iii). Define la idea de una observación de alto apalancamiento. e(iv). ¿Se consideraría esta observ ación como una observación de alto apalancamiento? Justifica tu respuesta. 2.22 Esperanzas de Vida Nacionales. Continuamos el análisis iniciado en el Ejercicio 1.7 examinando la relación entre \\(y= LIFEEXP\\) y \\(x=FERTILITY\\), mostrado en la Figura 2.12. Ajusta un modelo de regresión lineal de \\(LIFEEXP\\) usando la variable explicativa \\(x=FERTILITY\\). Figura 2.12: Gráfico de FERTILITY versus LIFEEXP. EE.UU. tiene una tasa de FERTILITY de 2.0. Determina la esperanza de vida ajustada. La nación insular Dominica no reportó una tasa de FERTILITY y, por lo tanto, no se incluyó en la regresión. Supón que su tasa de FERTILITY es 2.0. Proporciona un intervalo de predicción del 95% para la esperanza de vida en Dominica. China tiene una tasa de FERTILITY de 1.7 y una esperanza de vida de 72.5. Determina el residuo bajo el modelo. ¿Cuántos múltiplos de \\(s\\) está este residuo alejado de cero? Supón que tu hipótesis previa es que la pendiente de FERTILITY es -6.0 y deseas probar la hipótesis nula de que la pendiente ha aumentado (es decir, la pendiente es mayor que -6.0). Prueba esta hipótesis al nivel de significancia del 5%. También calcula un valor \\(p\\) aproximado. 2.11 Suplemento Técnico - Elementos del Álgebra de Matrices Los ejemplos son una herramienta excelente para introducir temas técnicos como la regresión. Sin embargo, este capítulo también ha utilizado álgebra, así como probabilidad y estadística básica, para darte una comprensión más profunda del análisis de regresión. A partir de ahora, estudiaremos relaciones multivariantes. Con muchas cosas ocurriendo simultáneamente en varias dimensiones, el álgebra ya no es útil para proporcionar información. En cambio, necesitaremos el álgebra de matrices. Este suplemento ofrece una breve introducción al álgebra de matrices para que puedas estudiar los capítulos de regresión lineal de este texto. El Apéndice A3 define conceptos adicionales de matrices. 2.11.1 Definiciones Básicas Una matriz es una tabla rectangular de números organizados en filas y columnas (el plural de matriz es matrices). Por ejemplo, considera los ingresos y la edad de 3 personas. \\[\\begin{equation*} \\mathbf{A}= \\begin{array}{c} Fila~1 \\\\ Fila~2 \\\\ Fila~3 \\end{array} \\overset{ \\begin{array}{cc} ~~~Col~1~ &amp; Col~2 \\end{array} }{\\left( \\begin{array}{cc} 6,000 &amp; 23 \\\\ 13,000 &amp; 47 \\\\ 11,000 &amp; 35 \\end{array} \\right) } \\end{equation*}\\] Aquí, la columna 1 representa el ingreso y la columna 2 representa la edad. Cada fila corresponde a un individuo. Por ejemplo, el primer individuo tiene 23 años y un ingreso de $6,000. El número de filas y columnas se llama la dimensión de la matriz. Por ejemplo, la dimensión de la matriz \\(\\mathbf{A}\\) anterior es \\(3\\times 2\\) (se lee 3 “por” 2). Esto significa 3 filas y 2 columnas. Si quisiéramos representar los ingresos y la edad de 100 personas, entonces la dimensión de la matriz sería \\(100\\times 2\\). Es conveniente representar una matriz usando la notación \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{cc} a_{11} &amp; a_{12} \\\\ a_{21} &amp; a_{22} \\\\ a_{31} &amp; a_{32} \\end{array} \\right) . \\end{equation*}\\] Aquí, \\(a_{ij}\\) es el símbolo para el número en la \\(i\\)-ésima fila y \\(j\\)-ésima columna de \\(\\mathbf{A}\\). En general, trabajamos con matrices de la forma \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{cccc} a_{11} &amp; a_{12} &amp; \\cdots &amp; a_{1k} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ a_{n1} &amp; a_{n2} &amp; \\cdots &amp; a_{nk} \\end{array} \\right) . \\end{equation*}\\] En este caso, la matriz \\(\\mathbf{A}\\) tiene dimensión \\(n\\times k\\). Un vector es una matriz especial. Un vector fila es una matriz que contiene solo 1 fila (\\(k=1\\)). Un vector columna es una matriz que contiene solo 1 columna (\\(n=1\\)). Por ejemplo, \\[\\begin{equation*} \\text{vector columna}\\rightarrow \\left( \\begin{array}{c} 2 \\\\ 3 \\\\ 4 \\\\ 5 \\\\ 6 \\end{array} \\right) ~~~~\\text{vector fila}\\rightarrow \\left( \\begin{array}{ccccc} 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 \\end{array} \\right) . \\end{equation*}\\] Observa que el vector fila ocupa mucho menos espacio en una página impresa que el vector columna correspondiente. Una operación básica que relaciona estas dos cantidades es la transposición. La transposición de una matriz \\(\\mathbf{A}\\) se define intercambiando las filas y columnas y se denota por \\(\\mathbf{A }^{\\prime }\\) (o \\(\\mathbf{A}^{T}\\)). Por ejemplo, \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{cc} 6,000 &amp; 23 \\\\ 13,000 &amp; 47 \\\\ 11,000 &amp; 35 \\end{array} \\right) ~~~\\mathbf{A}^{\\prime }=\\left( \\begin{array}{ccc} 6,000 &amp; 13,000 &amp; 11,000 \\\\ 23 &amp; 47 &amp; 35 \\end{array} \\right) . \\end{equation*}\\] Así, si \\(\\mathbf{A}\\) tiene dimensión \\(n\\times k\\), entonces \\(\\mathbf{A}^{\\prime }\\) tiene dimensiones \\(k\\times n\\). 2.11.2 Algunas Matrices Especiales Una matriz cuadrada es una matriz donde el número de filas es igual al número de columnas, es decir, \\(n=k\\). Los números diagonales de una matriz cuadrada son los números en una matriz donde el número de fila es igual al número de columna, por ejemplo, \\(a_{11}\\), \\(a_{22}\\), y así sucesivamente. Una matriz diagonal es una matriz cuadrada en la que todos los números no diagonales son iguales a 0. Por ejemplo, \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{ccc} -1 &amp; 0 &amp; 0 \\\\ 0 &amp; 2 &amp; 0 \\\\ 0 &amp; 0 &amp; 3 \\end{array} \\right) . \\end{equation*}\\] Una matriz identidad es una matriz diagonal donde todos los números diagonales son iguales a 1. Esta matriz especial se denota a menudo por \\(\\mathbf{I}\\). Una matriz simétrica es una matriz cuadrada \\(\\mathbf{A}\\) tal que la matriz permanece sin cambios si intercambiamos las filas y las columnas. Más formalmente, una matriz \\(\\mathbf{A}\\) es simétrica si \\(\\mathbf{A=A} ^{\\prime }\\). Por ejemplo, \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{ccc} 1 &amp; 2 &amp; 3 \\\\ 2 &amp; 4 &amp; 5 \\\\ 3 &amp; 5 &amp; 10 \\end{array} \\right) \\mathbf{=A}^{\\prime }. \\end{equation*}\\] Observa que una matriz diagonal es una matriz simétrica. 2.11.3 Operaciones Básicas Multiplicación por un Escalar Sea \\(\\mathbf{A}\\) una matriz de \\(n\\times k\\) y sea \\(c\\) un número real. Es decir, un número real es una matriz de \\(1\\times 1\\) y también se llama escalar. Multiplicar un escalar \\(c\\) por una matriz \\(\\mathbf{A}\\) se denota por \\(c\\mathbf{A}\\) y se define por \\[\\begin{equation*} c\\mathbf{A}=\\left( \\begin{array}{cccc} ca_{11} &amp; ca_{12} &amp; \\cdots &amp; ca_{1k} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ ca_{n1} &amp; ca_{n2} &amp; \\cdots &amp; ca_{nk} \\end{array} \\right) . \\end{equation*}\\] Por ejemplo, supongamos que \\(c=10\\) y \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{cc} 1 &amp; 2 \\\\ 6 &amp; 8 \\end{array} \\right) ~~~~~\\text{entonces} ~~~~\\mathbf{B}=c\\mathbf{A}=\\left( \\begin{array}{cc} 10 &amp; 20 \\\\ 60 &amp; 80 \\end{array} \\right) . \\end{equation*}\\] Observa que \\(c\\mathbf{A}=\\mathbf{A}c\\). Suma y Resta de Matrices Sean \\(\\mathbf{A}\\) y \\(\\mathbf{B}\\) matrices con dimensiones \\(n\\times k\\). Utiliza \\(a_{ij}\\) y \\(b_{ij}\\) para denotar los números en la \\(i\\)-ésima fila y \\(j\\)-ésima columna de \\(\\mathbf{A}\\) y \\(\\mathbf{B}\\), respectivamente. Entonces, la matriz \\(\\mathbf{C}=\\mathbf{A}+\\mathbf{B}\\) se define como la matriz con \\((a_{ij}+b_{ij})\\) en la \\(i\\)-ésima fila y \\(j\\)-ésima columna. De manera similar, la matriz \\(\\mathbf{C}=\\mathbf{A}-\\mathbf{B}\\) se define como la matriz con \\((a_{ij}-b_{ij})\\) en la \\(i\\)-ésima fila y \\(j\\)-ésima columna. Simbólicamente, escribimos esto como sigue. \\[\\begin{equation*} \\text{Si }\\mathbf{A=}\\left( a_{ij}\\right) _{ij}\\text{ y } \\mathbf{B=}\\left( b_{ij}\\right) _{ij}\\text{, entonces} \\end{equation*}\\] \\[\\begin{equation*} \\mathbf{C}=\\mathbf{A}+\\mathbf{B=}\\left( a_{ij}+b_{ij}\\right) _{ij}\\text{ y }\\mathbf{C}=\\mathbf{A}-\\mathbf{B=}\\left( a_{ij}-b_{ij}\\right) _{ij}. \\end{equation*}\\] Por ejemplo, considera \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{cc} 2 &amp; 5 \\\\ 4 &amp; 1 \\end{array} \\right) ~~~\\mathbf{B}=\\left( \\begin{array}{cc} 4 &amp; 6 \\\\ 8 &amp; 1 \\end{array} \\right). \\end{equation*}\\] Entonces \\[\\begin{equation*} \\mathbf{A}+\\mathbf{B}=\\left( \\begin{array}{cc} 6 &amp; 11 \\\\ 12 &amp; 2 \\end{array} \\right) ~~~\\mathbf{A}-\\mathbf{B}=\\left( \\begin{array}{cc} -2 &amp; -1 \\\\ -4 &amp; 0 \\end{array} \\right) . \\end{equation*}\\] Ejemplo Básico de Regresión Lineal de Suma y Resta. Ahora, recuerda que el modelo básico de regresión lineal puede escribirse como \\(n\\) ecuaciones: \\[\\begin{equation*} \\begin{array}{c} y_1=\\beta_0+\\beta_1x_1+\\varepsilon _1 \\\\ \\vdots \\\\ y_n=\\beta_0+\\beta_1x_n+\\varepsilon _n. \\end{array} \\end{equation*}\\] Podemos definir \\[\\begin{equation*} \\mathbf{y}=\\left( \\begin{array}{c} y_1 \\\\ \\vdots \\\\ y_n \\end{array} \\right) ~~~\\boldsymbol \\varepsilon = \\left( \\begin{array}{c} \\varepsilon_1 \\\\ \\vdots \\\\ \\varepsilon_n \\end{array} \\right) ~~~\\text{y}~~~ \\mathrm{E~}\\mathbf{y} =\\left( \\begin{array}{c} \\beta_0+\\beta_1 x_1 \\\\ \\vdots \\\\ \\beta_0 + \\beta_1 x_n \\end{array} \\right) . \\end{equation*}\\] Con esta notación, podemos expresar las \\(n\\) ecuaciones de manera más compacta como \\(\\mathbf{y} = \\mathrm{E~}\\mathbf{y}+\\boldsymbol \\varepsilon\\). Multiplicación de Matrices En general, si \\(\\mathbf{A}\\) es una matriz de dimensión \\(n\\times c\\) y \\(\\mathbf{B}\\) es una matriz de dimensión \\(c\\times k\\), entonces \\(\\mathbf{C}=\\mathbf{AB}\\) es una matriz de dimensión \\(n\\times k\\) y se define por \\[\\begin{equation*} \\mathbf{C}=\\mathbf{AB}=\\left( \\sum_{s=1}^{c}a_{is}b_{sj}\\right)_{ij}. \\end{equation*}\\] Por ejemplo, considera las matrices \\(2\\times 2\\) \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{cc} 2 &amp; 5 \\\\ 4 &amp; 1 \\end{array} \\right) ~~~\\mathbf{B}=\\left( \\begin{array}{cc} 4 &amp; 6 \\\\ 8 &amp; 1 \\end{array} \\right) . \\end{equation*}\\] La matriz \\(\\mathbf{AB}\\) tiene dimensión \\(2\\times 2\\). Para ilustrar el cálculo, considera el número en la primera fila y segunda columna de \\(\\mathbf{AB}\\). Según la regla presentada arriba, con \\(i=1\\) y \\(j=2\\), el elemento correspondiente de \\(\\mathbf{AB}\\) es \\(\\sum_{s=1}^2a_{1s}b_{s2}=a_{11}b_{12}+a_{12}b_{22}=2(6)+5(1)=17\\). Los otros cálculos se resumen como \\[\\begin{equation*} \\mathbf{AB}=\\left( \\begin{array}{cc} 2(4)+5(8) &amp; 2(6)+5(1) \\\\ 4(4)+1(8) &amp; 4(6)+1(1) \\end{array} \\right) =\\left( \\begin{array}{cc} 48 &amp; 17 \\\\ 24 &amp; 25 \\end{array} \\right) . \\end{equation*}\\] Como otro ejemplo, supongamos \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{ccc} 1 &amp; 2 &amp; 4 \\\\ 0 &amp; 5 &amp; 8 \\end{array} \\right) ~~~\\mathbf{B}=\\left( \\begin{array}{c} 3 \\\\ 5 \\\\ 2 \\end{array} \\right) . \\end{equation*}\\] Como \\(\\mathbf{A}\\) tiene dimensión \\(2\\times 3\\) y \\(\\mathbf{B}\\) tiene dimensión \\(3\\times 1\\), esto significa que el producto \\(\\mathbf{AB}\\) tiene dimensión \\(2\\times 1\\). Los cálculos se resumen como \\[\\begin{equation*} \\mathbf{AB}=\\left( \\begin{array}{c} 1(3)+2(5)+4(2) \\\\ 0(3)+5(5)+8(2) \\end{array} \\right) =\\left( \\begin{array}{c} 21 \\\\ 41 \\end{array} \\right) . \\end{equation*}\\] Para algunos ejemplos adicionales, tenemos \\[\\begin{equation*} \\left( \\begin{array}{cc} 4 &amp; 2 \\\\ 5 &amp; 8 \\end{array} \\right) \\left( \\begin{array}{c} a_1 \\\\ a_2 \\end{array} \\right) =\\left( \\begin{array}{c} 4a_1+2a_2 \\\\ 5a_1+8a_2 \\end{array} \\right) . \\end{equation*}\\] \\[\\begin{equation*} \\left( \\begin{array}{ccc} 2 &amp; 3 &amp; 5 \\end{array} \\right) \\left( \\begin{array}{c} 2 \\\\ 3 \\\\ 5 \\end{array} \\right) =2^2+3^2+5^2=38~~~\\left( \\begin{array}{c} 2 \\\\ 3 \\\\ 5 \\end{array} \\right) \\left( \\begin{array}{ccc} 2 &amp; 3 &amp; 5 \\end{array} \\right) =\\left( \\begin{array}{ccc} 4 &amp; 6 &amp; 10 \\\\ 6 &amp; 9 &amp; 15 \\\\ 10 &amp; 15 &amp; 25 \\end{array} \\right) . \\end{equation*}\\] En general, observa que \\(\\mathbf{AB}\\neq \\mathbf{BA}\\) en la multiplicación de matrices, a diferencia de la multiplicación de escalares (números reales). Además, observamos que la matriz identidad cumple el papel de “uno” en la multiplicación de matrices, ya que \\(\\mathbf{AI=A}\\) y \\(\\mathbf{IA=A}\\) para cualquier matriz \\(\\mathbf{A}\\), siempre que las dimensiones sean compatibles para permitir la multiplicación de matrices. Ejemplo Básico de Regresión Lineal de Multiplicación de Matrices. Define \\[\\begin{equation*} \\mathbf{X}=\\left( \\begin{array}{cc} 1 &amp; x_1 \\\\ \\vdots &amp; \\vdots \\\\ 1 &amp; x_n \\end{array} \\right) \\text{ y } \\boldsymbol \\beta =\\left( \\begin{array}{c} \\beta_0 \\\\ \\beta_1 \\end{array} \\right) \\text{, para obtener } \\mathbf{X} \\boldsymbol{\\beta} =\\left( \\begin{array}{c} \\beta_0+\\beta_1x_1 \\\\ \\vdots \\\\ \\beta_0+\\beta_1x_n \\end{array} \\right) =\\mathbf{\\mathrm{E~}\\mathbf{y}}. \\end{equation*}\\] Así, se obtiene la expresión matricial familiar del modelo de regresión, \\(\\mathbf{y}=\\mathbf{X} \\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}\\). Otras cantidades útiles incluyen \\[\\begin{equation*} \\mathbf{y}^{\\prime }\\mathbf{y}=\\left( \\begin{array}{ccc} y_1 &amp; \\cdots &amp; y_n \\end{array} \\right) \\left( \\begin{array}{c} y_1 \\\\ \\vdots \\\\ y_n \\end{array} \\right) =y_1^2+\\cdots +y_n^2=\\sum_{i=1}^{n}y_i^2, \\end{equation*}\\] \\[\\begin{equation*} \\mathbf{X}^{\\prime }\\mathbf{y}=\\left( \\begin{array}{ccc} 1 &amp; \\cdots &amp; 1 \\\\ x_1 &amp; \\cdots &amp; x_n \\end{array} \\right) \\left( \\begin{array}{c} y_1 \\\\ \\vdots \\\\ y_n \\end{array} \\right) =\\left( \\begin{array}{c} \\sum_{i=1}^{n}y_i \\\\ \\sum_{i=1}^{n}x_iy_i \\end{array} \\right) \\end{equation*}\\] y \\[\\begin{equation*} \\mathbf{X}^{\\prime }\\mathbf{X}=\\left( \\begin{array}{ccc} 1 &amp; \\cdots &amp; 1 \\\\ x_1 &amp; \\cdots &amp; x_n \\end{array} \\right) \\left( \\begin{array}{cc} 1 &amp; x_1 \\\\ \\vdots &amp; \\vdots \\\\ 1 &amp; x_n \\end{array} \\right) =\\left( \\begin{array}{cc} n &amp; \\sum_{i=1}^{n}x_i \\\\ \\sum_{i=1}^{n}x_i &amp; \\sum_{i=1}^{n} x_i^2 \\end{array} \\right) . \\end{equation*}\\] Observa que \\(\\mathbf{X}^{\\prime }\\mathbf{X}\\) es una matriz simétrica. Inversas de Matrices En álgebra de matrices, no existe el concepto de “división.” En su lugar, extendemos el concepto de “recíprocos” de los números reales. Para comenzar, supongamos que \\(\\mathbf{A}\\) es una matriz cuadrada de dimensión \\(k \\times k\\) y que \\(\\mathbf{I}\\) es la matriz identidad de dimensión \\(k \\times k\\). Si existe una matriz \\(k \\times k\\) llamada \\(\\mathbf{B}\\) tal que \\(\\mathbf{AB}=\\mathbf{I}=\\mathbf{BA}\\), entonces \\(\\mathbf{B}\\) se llama inversa de \\(\\mathbf{A}\\) y se escribe como \\[\\begin{equation*} \\mathbf{B}=\\mathbf{A}^{-1}. \\end{equation*}\\] No todas las matrices cuadradas tienen inversas. Además, incluso cuando existe una inversa, puede no ser fácil de calcular manualmente. Una excepción a esta regla son las matrices diagonales. Supongamos que \\(\\mathbf{A}\\) es una matriz diagonal de la forma \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{ccc} a_{11} &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; \\cdots &amp; a_{kk} \\end{array} \\right). \\text{ Entonces } \\mathbf{A}^{-1}=\\left( \\begin{array}{ccc} \\frac{1}{a_{11}} &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; \\cdots &amp; \\frac{1}{a_{kk}} \\end{array} \\right). \\end{equation*}\\] Por ejemplo, \\[\\begin{equation*} \\begin{array}{cccc} \\left( \\begin{array}{cc} 2 &amp; 0 \\\\ 0 &amp; -19 \\end{array} \\right) &amp; \\left( \\begin{array}{cc} \\frac{1}{2} &amp; 0 \\\\ 0 &amp; -\\frac{1}{19} \\end{array} \\right) &amp; = &amp; \\left( \\begin{array}{cc} 1 &amp; 0 \\\\ 0 &amp; 1 \\end{array} \\right) \\\\ \\mathbf{A} &amp; \\mathbf{A}^{-1} &amp; = &amp; \\mathbf{I} \\end{array} . \\end{equation*}\\] En el caso de una matriz de dimensión \\(2\\times 2\\), el procedimiento de inversión se puede realizar manualmente incluso cuando la matriz no es diagonal. En el caso de \\(2\\times 2\\), supongamos que si \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{cc} a &amp; b \\\\ c &amp; d \\end{array} \\right), \\text{ entonces } \\mathbf{A}^{-1}=\\frac{1}{ad-bc}\\left( \\begin{array}{cc} d &amp; -b \\\\ -c &amp; a \\end{array} \\right) \\text{.} \\end{equation*}\\] Así, por ejemplo, si \\[\\begin{equation*} \\mathbf{A}=\\left( \\begin{array}{cc} 2 &amp; 2 \\\\ 3 &amp; 4 \\end{array} \\right) \\text{ entonces } \\mathbf{A}^{-1}=\\frac{1}{2(4)-2(3)} \\left( \\begin{array}{cc} 4 &amp; -2 \\\\ -3 &amp; 2 \\end{array} \\right) =\\left( \\begin{array}{cc} 2 &amp; -1 \\\\ -3/2 &amp; 1 \\end{array} \\right) \\text{.} \\end{equation*}\\] Como verificación, tenemos \\[\\begin{equation*} \\mathbf{A}\\mathbf{A}^{-1}=\\left( \\begin{array}{cc} 2 &amp; 2 \\\\ 3 &amp; 4 \\end{array} \\right) \\left( \\begin{array}{cc} 2 &amp; -1 \\\\ -3/2 &amp; 1 \\end{array} \\right) =\\left( \\begin{array}{cc} 2(2)-2(3/2) &amp; 2(-1)+2(1) \\\\ 3(2)-4(3/2) &amp; 3(-1)+4(1) \\end{array} \\right) =\\left( \\begin{array}{cc} 1 &amp; 0 \\\\ 0 &amp; 1 \\end{array} \\right) =\\mathbf{I}\\text{.} \\end{equation*}\\] Ejemplo Básico de Regresión Lineal de Inversas de Matrices. Con \\[\\begin{equation*} \\mathbf{X}^{\\prime }\\mathbf{X}=\\left( \\begin{array}{cc} n &amp; \\sum\\limits_{i=1}^{n}x_i \\\\ \\sum\\limits_{i=1}^{n}x_i &amp; \\sum\\limits_{i=1}^{n}x_i^2 \\end{array} \\right), \\end{equation*}\\] tenemos \\[\\begin{equation*} \\left( \\mathbf{X}^{\\prime }\\mathbf{X}\\right)^{-1}=\\frac{1}{n\\sum_{i=1}^{n}x_i^2-\\left( \\sum_{i=1}^{n}x_i\\right) ^2}\\left( \\begin{array}{cc} \\sum\\limits_{i=1}^{n}x_i^2 &amp; -\\sum\\limits_{i=1}^{n}x_i \\\\ -\\sum\\limits_{i=1}^{n}x_i &amp; n \\end{array} \\right). \\end{equation*}\\] Para simplificar esta expresión, recuerda que \\(\\overline{x}=n^{-1} \\sum_{i=1}^{n}x_i\\). Así, \\[\\begin{equation} \\left( \\mathbf{X}^{\\prime }\\mathbf{X}\\right)^{-1}=\\frac{1}{ \\sum_{i=1}^{n}x_i^2-n\\overline{x}^2}\\left( \\begin{array}{cc} n^{-1}\\sum\\limits_{i=1}^{n}x_i^2 &amp; -\\overline{x} \\\\ -\\overline{x} &amp; 1 \\end{array} \\right) . \\tag{2.9} \\end{equation}\\] La Sección 3.1 discutirá la relación \\(\\mathbf{b}=\\left( \\mathbf{X}^{\\prime}\\mathbf{X}\\right)^{-1}\\mathbf{X}^{\\prime}\\mathbf{y}\\). Para ilustrar el cálculo, tenemos \\[\\begin{eqnarray*} \\mathbf{b} &amp;=&amp;\\left( \\mathbf{X}^{\\prime }\\mathbf{X}\\right)^{-1}\\mathbf{X} ^{\\prime }\\mathbf{y}=\\frac{1}{\\sum_{i=1}^{n}x_i^2-n\\overline{x}^2} \\left( \\begin{array}{cc} n^{-1}\\sum\\limits_{i=1}^{n}x_i^2 &amp; -\\overline{x} \\\\ -\\overline{x} &amp; 1 \\end{array} \\right) \\left( \\begin{array}{c} \\sum\\limits_{i=1}^{n}y_i \\\\ \\sum\\limits_{i=1}^{n}x_iy_i \\end{array} \\right) \\\\ &amp;=&amp;\\frac{1}{\\sum_{i=1}^{n}x_i^2-n\\overline{x}^2}\\left( \\begin{array}{c} \\sum\\limits_{i=1}^{n}\\left( \\overline{y}x_i^2-\\overline{x} x_iy_i\\right) \\\\ \\sum\\limits_{i=1}^{n}x_iy_i-n\\overline{x}\\overline{y} \\end{array} \\right) =\\left( \\begin{array}{c} b_0 \\\\ b_1 \\end{array} \\right) . \\end{eqnarray*}\\] De esta expresión, podemos ver \\[\\begin{equation*} b_1=\\frac{\\sum\\limits_{i=1}^{n}x_iy_i-n\\overline{x}\\overline{y}}{\\sum\\limits_{i=1}^{n}x_i^2-n\\overline{x}^2} \\end{equation*}\\] y \\[\\begin{equation*} b_0=\\frac{\\overline{y}\\sum\\limits_{i=1}^{n}x_i^2-\\overline{x} \\sum\\limits_{i=1}^{n}x_iy_i}{\\sum\\limits_{i=1}^{n}x_i^2-n\\overline{x}^2}=\\frac{\\overline{y}\\left( \\sum\\limits_{i=1}^{n}x_i^2-n\\overline{x} ^2\\right) -\\overline{x}\\left( \\sum\\limits_{i=1}^{n} x_i y_i - n\\overline{x} \\overline{y}\\right) }{\\sum\\limits_{i=1}^{n}x_i^2-n\\overline{x}^2}=\\overline{y}-b_1\\overline{x}. \\end{equation*}\\] Estas son las expresiones usuales para la pendiente \\(b_1\\) (Ejercicio 2A.8) y el intercepto \\(b_0\\). 2.11.4 Matrices Aleatorias Esperanzas. Consideremos una matriz de variables aleatorias \\[\\begin{equation*} \\mathbf{U=}\\left( \\begin{array}{cccc} u_{11} &amp; u_{12} &amp; \\cdots &amp; u_{1c} \\\\ u_{21} &amp; u_{22} &amp; \\cdots &amp; u_{2c} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ u_{n1} &amp; u_{n2} &amp; \\cdots &amp; u_{nc} \\end{array} \\right). \\end{equation*}\\] Cuando escribimos la esperanza de una matriz, esto es una forma abreviada para la matriz de esperanzas. Específicamente, supongamos que la función de probabilidad conjunta de \\({u_{11}, u_{12}, ..., u_{1c}, ..., u_{n1}, ..., u_{nc}}\\) está disponible para definir el operador de esperanza. Entonces definimos \\[\\begin{equation*} \\mathrm{E} ~ \\mathbf{U} = \\left( \\begin{array}{cccc} \\mathrm{E }u_{11} &amp; \\mathrm{E }u_{12} &amp; \\cdots &amp; \\mathrm{E }u_{1c} \\\\ \\mathrm{E }u_{21} &amp; \\mathrm{E }u_{22} &amp; \\cdots &amp; \\mathrm{E }u_{2c} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ \\mathrm{E }u_{n1} &amp; \\mathrm{E }u_{n2} &amp; \\cdots &amp; \\mathrm{E }u_{nc} \\end{array} \\right). \\end{equation*}\\] Como un caso especial importante, consideremos la función de probabilidad conjunta para las variables aleatorias \\(y_1, \\ldots, y_n\\) y el operador de expectativas correspondiente. Entonces \\[\\begin{equation*} \\mathrm{E}~ \\mathbf{y=} \\mathrm{E } \\left( \\begin{array}{cccc} y_1 \\\\ \\vdots \\\\ y_n \\end{array} \\right) = \\left( \\begin{array}{cccc} \\mathrm{E }y_1 \\\\ \\vdots \\\\ \\mathrm{E }y_n \\end{array} \\right). \\end{equation*}\\] Por la linealidad de las esperanzas, para una matriz no aleatoria A y un vector , tenemos \\(\\mathrm{E} (\\textbf{A y} + \\textbf{B}) = \\textbf{A} \\mathrm{E} \\textbf{y + B}\\). Varianzas. También podemos trabajar con los segundos momentos de vectores aleatorios. La varianza de un vector de variables aleatorias se llama matriz de varianza-covarianza. Se define como \\[\\begin{equation} \\mathrm{Var} ~ \\mathbf{y} = \\mathrm{E} ( (\\mathbf{y} - \\mathrm{E} \\mathbf{y})(\\mathbf{y} - \\mathrm{E} \\mathbf{y})^{\\prime} ). \\tag{2.10} \\end{equation}\\] Es decir, podemos expresar \\[\\begin{equation*} \\mathrm{Var}~\\mathbf{y=} \\mathrm{E } \\left( \\left( \\begin{array}{c} y_1 -\\mathrm{E } y_1 \\\\ \\vdots \\\\ y_n -\\mathrm{E } y_n \\end{array}\\right) \\left(\\begin{array}{ccc} y_1 - \\mathrm{E } y_1 &amp; \\cdots &amp; y_n - \\mathrm{E } y_n \\end{array}\\right) \\right) \\end{equation*}\\] \\[\\begin{equation*} = \\left( \\begin{array}{cccc} \\mathrm{Var}~y_1 &amp; \\mathrm{Cov}(y_1, y_2) &amp; \\cdots &amp;\\mathrm{Cov}(y_1, y_n) \\\\ \\mathrm{Cov}(y_2, y_1) &amp; \\mathrm{Var}~y_2 &amp; \\cdots &amp; \\mathrm{Cov}(y_2, y_n) \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots\\\\ \\mathrm{Cov}(y_n, y_1) &amp; \\mathrm{Cov}(y_n, y_2) &amp; \\cdots &amp; \\mathrm{Var}~y_n \\\\ \\end{array}\\right), \\end{equation*}\\] porque \\(\\mathrm{E} ( (y_i - \\mathrm{E} y_i)(y_j - \\mathrm{E} y_j) ) = \\mathrm{Cov}(y_i, y_j)\\) para \\(i \\neq j\\) y \\(\\mathrm{Cov}(y_i, y_i) = \\mathrm{Var}~y_i\\). En el caso de que \\(y_1, \\ldots, y_n\\) sean mutuamente no correlacionados, tenemos que \\(\\mathrm{Cov}(y_i, y_j)=0\\) para \\(i \\neq j\\) y así \\[\\begin{equation*} \\mathrm{Var}~\\mathbf{y=} \\left( \\begin{array}{cccc} \\mathrm{Var}~y_1 &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; \\mathrm{Var}~y_2 &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots\\\\ 0 &amp; 0 &amp; \\cdots &amp; \\mathrm{Var}~y_n \\\\ \\end{array}\\right). \\end{equation*}\\] Además, si las varianzas son idénticas, de modo que \\(\\mathrm{Var}~y_i=\\sigma ^2\\), entonces podemos escribir \\(\\mathrm{Var} ~\\mathbf{y} = \\sigma ^2 \\mathbf{I}\\), donde I es la matriz identidad \\(n \\times n\\). Por ejemplo, si \\(y_1, \\ldots, y_n\\) son i.i.d., entonces \\(\\mathrm{Var} ~\\mathbf{y} = \\sigma ^2 \\mathbf{I}\\). A partir de la ecuación (2.10), se puede demostrar que \\[\\begin{equation} \\mathrm{Var}\\left( \\mathbf{Ay +B} \\right) = \\mathrm{Var}\\left( \\mathbf{Ay} \\right) = \\mathbf{A} \\left( \\mathrm{Var}~\\mathbf{y} \\right) \\mathbf{A}^{\\prime}. \\tag{2.11} \\end{equation}\\] Por ejemplo, si \\(\\mathbf{A} = (a_1, a_2, \\ldots,a_n)= \\mathbf{a}^{\\prime}\\) y B = 0, entonces la ecuación (2.11) se reduce a \\[\\begin{equation*} \\mathrm{Var}\\left( \\sum_{i=1}^n a_i y_i \\right) = \\mathrm{Var} \\left( \\mathbf{a^{\\prime} y} \\right) = \\mathbf{a^{\\prime}} \\left( \\mathrm{Var} ~\\mathbf{y} \\right) \\mathbf{a} = (a_1, a_2, \\ldots,a_n) \\left( \\mathrm{Var} ~\\mathbf{y} \\right) \\left(\\begin{array}{c} a_1 \\\\ \\vdots \\\\ a_n \\end{array}\\right) \\end{equation*}\\] \\[\\begin{equation*} = \\sum_{i=1}^n a_i^2 \\mathrm{Var} ~y_i ~+~2 \\sum_{i=2}^n \\sum_{j=1}^{i-1} a_i a_j \\mathrm{Cov}(y_i, y_j). \\end{equation*}\\] Definición - Distribución Normal Multivariante. Un vector de variables aleatorias \\(\\mathbf{y} = \\left(y_1, \\ldots, y_n \\right)^{\\prime}\\) se dice que es normal multivariante si todas las combinaciones lineales de la forma \\(\\sum_{i=1}^n a_i y_i\\) están distribuidas normalmente. En este caso, escribimos \\(\\mathbf{y} \\sim N (\\mathbf{\\boldsymbol \\mu}, \\mathbf{\\Sigma} )\\), donde \\(\\mathbf{\\boldsymbol \\mu} = \\mathrm{E}~ \\mathbf{y}\\) es el valor esperado de y y \\(\\mathbf{\\Sigma}= \\mathrm{Var}~\\mathbf{y}\\) es la matriz de varianza-covarianza de y. Según la definición, tenemos que \\(\\mathbf{y}\\sim N (\\mathbf{\\boldsymbol \\mu}, \\mathbf{\\Sigma} )\\) implica que \\(\\mathbf{a^{\\prime}y}\\sim N (\\mathbf{a^{\\prime} \\boldsymbol \\mu}, \\mathbf{a^{\\prime}\\Sigma a})\\). Así, si \\(y_i\\) son i.i.d., entonces \\(\\sum_{i=1}^n a_i y_i\\) está distribuido normalmente con media \\(\\mu \\sum_{i=1}^n a_i\\) y varianza \\(\\sigma ^2 \\sum_{i=1}^n a_i ^2\\). "],["C3BasicMLR.html", "Chapter 3 Regresión Lineal Múltiple - I 3.1 Método de Mínimos Cuadrados 3.2 Modelo de Regresión Lineal y Propiedades de los Estimadores 3.3 Estimación y Bondad de Ajuste 3.4 Inferencia Estadística para un Coeficiente Único 3.5 Algunas Variables Explicativas Especiales 3.6 Lectura Adicional y Referencias 3.7 Ejercicios", " Chapter 3 Regresión Lineal Múltiple - I Vista previa del capítulo. Este capítulo introduce la regresión lineal en el caso de varios variables explicativas, conocida como regresión lineal múltiple. Muchos conceptos básicos de la regresión lineal se extienden directamente, incluyendo medidas de bondad de ajuste como \\(R^2\\) y la inferencia usando estadísticas \\(t\\). Los modelos de regresión lineal múltiple proporcionan un marco para resumir datos altamente complejos y multivariados. Debido a que este marco solo requiere linealidad en los parámetros, podemos ajustar modelos que son funciones no lineales de las variables explicativas, proporcionando así un amplio alcance de aplicaciones potenciales. 3.1 Método de Mínimos Cuadrados El Capítulo 2 trató sobre el problema de una respuesta que depende de una sola variable explicativa. Ahora extendemos el enfoque de ese capítulo y estudiamos cómo una respuesta puede depender de varias variables explicativas. Ejemplo: Seguro de Vida Temporal. Como todas las empresas, las compañías de seguros de vida buscan continuamente nuevas formas de llevar productos al mercado. Aquellos involucrados en el desarrollo de productos desean saber “¿quién compra seguro y cuánto compran?” En economía, esto se conoce como el lado de la demanda de un mercado de productos. Los analistas pueden obtener fácilmente información sobre las características de los clientes actuales a través de las bases de datos de la empresa. Los clientes potenciales, aquellos que no tienen seguro con la compañía, son a menudo el principal objetivo para expandir la cuota de mercado. En este ejemplo, examinamos la Encuesta de Finanzas del Consumidor (SCF), una muestra representativa a nivel nacional que contiene información extensa sobre activos, pasivos, ingresos y características demográficas de los encuestados (potenciales clientes en EE. UU.). Estudiamos una muestra aleatoria de 500 hogares con ingresos positivos que fueron entrevistados en la encuesta de 2004. Inicialmente, consideramos el subconjunto de \\(n=275\\) familias que compraron seguro de vida temporal. Deseamos abordar la segunda parte de la pregunta de la demanda y determinar las características de la familia que influyen en la cantidad de seguro comprado. El Capítulo 11 considerará la primera parte, es decir, si un hogar compra o no un seguro, a través de modelos donde la respuesta es una variable aleatoria binaria. Para el seguro de vida temporal, la cantidad de seguro se mide por el valor nominal de la póliza, FACE, la cantidad que la compañía pagará en caso de la muerte del asegurado. Las características que resultarán importantes incluyen los ingresos anuales, INCOME, el número de años de EDUCATION del encuestado y el número de miembros del hogar, NUMHH. En general, consideraremos conjuntos de datos donde hay \\(k\\) variables explicativas y una variable de respuesta en una muestra de tamaño \\(n\\). Es decir, los datos consisten en: \\[ \\left\\{ \\begin{aligned} x_{11},x_{12},\\ldots,x_{1k},y_1 \\\\ x_{21},x_{22},\\ldots,x_{2k},y_2 \\\\ \\vdots \\\\ x_{n1},x_{n2},\\ldots,x_{nk},y_n \\end{aligned} \\right\\}. \\] La \\(i\\)-ésima observación corresponde a la \\(i\\)-ésima fila, que consiste en \\((x_{i1},x_{i2},\\ldots,x_{ik},y_i)\\). Para este caso general, tomamos \\(k+1\\) mediciones en cada entidad. Para el ejemplo de demanda de seguros, \\(k=3\\) y los datos consisten en \\((x_{11},x_{12},x_{13}, y_1), \\ldots , (x_{275,1},x_{275,2},x_{275,3},y_{275})\\). Es decir, usamos cuatro mediciones de cada uno de los \\(n=275\\) hogares. Resumiendo los Datos Comenzamos el análisis de los datos examinando cada variable por separado. La Tabla 3.1 proporciona estadísticas descriptivas básicas de las cuatro variables. Para FACE e INCOME, vemos que la media es mucho mayor que la mediana, lo que sugiere que la distribución está sesgada hacia la derecha. Los histogramas (no reportados aquí) muestran que este es el caso. Será útil considerar también sus transformaciones logarítmicas, LNFACE y LNINCOME, respectivamente, que también se informan en la Tabla 3.1. Tabla 3.1: Estadísticas Descriptivas del Seguro de Vida Temporal Media Mediana Desviación Estándar Mínimo Máximo FACE 747,581 150,000 1,674,362 800 14,000,000 INCOME 208,975 65,000 824,010 260 10,000,000 EDUCATION 14.524 16 2.549 2 17 NUMHH 2.96 3 1.493 1 9 LNFACE 11.99 11.918 1.871 6.685 16.455 LNINCOME 11.149 11.082 1.295 5.561 16.118 El siguiente paso es medir la relación entre cada \\(x\\) sobre \\(y\\), comenzando con los diagramas de dispersión en la Figura 3.1. El panel de la izquierda es un gráfico de FACE versus INCOME; en este panel, vemos una gran concentración en la esquina inferior izquierda que corresponde a hogares con ingresos y cantidades de seguro pequeños. Ambas variables tienen distribuciones sesgadas y su efecto conjunto es altamente no lineal. El panel derecho presenta las mismas variables, pero utilizando transformaciones logarítmicas. Aquí, vemos una relación que se puede aproximar más fácilmente con una línea. Figura 3.1: Ingresos versus Monto Nominal del Seguro de Vida Temporal. El panel de la izquierda es un gráfico de monto nominal versus ingresos, mostrando un patrón altamente no lineal. En el panel derecho, el monto nominal versus ingresos está en unidades logarítmicas naturales, sugiriendo un patrón lineal (aunque variable). Código R para producir la Tabla 3.1 y la Figura 3.1 Term &lt;- read.csv(&quot;CSVData/TermLife.csv&quot;, header=TRUE) # SELECCIONAR EL SUBCONJUNTO DE DATOS CORRESPONDIENTE A LA COMPRA DE SEGURO Term2 &lt;-subset(Term, FACE &gt; 0) # TABLA 3.1 ESTADÍSTICAS DESCRIPTIVAS BookSummStats &lt;- function(Xymat){ meanSummary &lt;- sapply(Xymat, mean, na.rm=TRUE) sdSummary &lt;- sapply(Xymat, sd, na.rm=TRUE) minSummary &lt;- sapply(Xymat, min, na.rm=TRUE) maxSummary &lt;- sapply(Xymat, max, na.rm=TRUE) medSummary &lt;- sapply(Xymat, median,na.rm=TRUE) tableMat &lt;- cbind(meanSummary, medSummary, sdSummary, minSummary, maxSummary) return(tableMat) } LNFACE &lt;- log(Term2$FACE) LNINCOME &lt;- log(Term2$INCOME) Xymat &lt;- data.frame(cbind(Term2$FACE, Term2$INCOME,Term2$EDUCATION, Term2$NUMHH,LNFACE, LNINCOME) ) tableMat &lt;- BookSummStats(Xymat) colnames(tableMat) &lt;- c(&quot;Media&quot; , &quot;Mediana&quot; , &quot;Desviación Estándar&quot; , &quot;Mínimo&quot; , &quot;Máximo&quot;) rownames(tableMat) &lt;- c(&quot;FACE&quot;, &quot;INCOME&quot;, &quot;EDUCATION&quot;, &quot;NUMHH&quot;, &quot;LNFACE&quot;, &quot;LNINCOME&quot;) tableMat1 &lt;- tableMat tableMat1[3:6,] &lt;- round(tableMat1[3:6,], digits = 3) tableMat1[1:2,] &lt;- format(round(tableMat[1:2,], digits=0), big.mark = &#39;,&#39;) TableGen1(TableData=tableMat1, TextTitle=&#39;Estadísticas Descriptivas del Seguro de Vida Temporal&#39;, Align=&#39;r&#39;, Digits=3, ColumnSpec=1:5, ColWidth = ColWidth5) Term &lt;- read.csv(&quot;CSVData/TermLife.csv&quot;, header=TRUE) # SELECCIONAR EL SUBCONJUNTO DE DATOS CORRESPONDIENTE A LA COMPRA DE SEGURO Term2 &lt;-subset(Term, FACE &gt; 0) Term2$LNFACE &lt;- log(Term2$FACE) Term2$LNINCOME &lt;- log(Term2$INCOME) # FIGURA 3.1 par(mfrow=c(1, 2), cex=1.1, mar=c(4.1,4,1.5,1)) plot(Term2$INCOME, Term2$FACE, ylab=&quot;&quot;, las=1, yaxt=&quot;n&quot;, xaxt=&quot;n&quot;, xlab=&quot;INCOME (en Millones)&quot;) mtext(&quot;FACE (en Millones)&quot;, side=2, at=15200000, las=1, cex=1.1, adj=.4) axis(2,at=seq(0,14000000,2000000), labels=c(&quot;0&quot;, &quot;2&quot;, &quot;4&quot;, &quot;6&quot;, &quot;8&quot;,&quot;10&quot;,&quot;12&quot;,&quot;14&quot;), las=1) axis(1,at=seq(0,11000000,1000000), labels=c(&quot;0&quot;,&quot;1&quot;, &quot;2&quot;,&quot;3 &quot;, &quot;4&quot;,&quot;5&quot;, &quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;,&quot;11&quot;)) plot(Term2$LNINCOME, Term2$LNFACE, ylab=&quot;&quot;, xlab = &quot;LNINCOME&quot;, las=1) mtext(&quot;LNFACE&quot;, side=2, at=16.8, las=1, cex=1.1, adj=1.1) Los datos de Seguro de Vida Temporal son multivariados en el sentido de que se toman varias mediciones en cada hogar. Es difícil producir un gráfico de observaciones en tres o más dimensiones en una plataforma bidimensional, como una hoja de papel, que no sea confuso, engañoso o ambos. Para resumir gráficamente datos multivariados en aplicaciones de regresión, considere usar una matriz de diagramas de dispersión como en la Figura 3.2. Cada cuadrado de esta figura representa un gráfico simple de una variable contra otra. Para cada cuadrado, la variable de la fila da las unidades del eje vertical y la variable de la columna da las unidades del eje horizontal. La matriz a veces se llama una matriz de dispersión parcial porque solo se presentan los elementos en la parte inferior izquierda. Figura 3.2: Matriz de diagramas de dispersión de cuatro variables. Cada cuadrado es un diagrama de dispersión. La matriz de diagramas de dispersión se puede resumir numéricamente usando una matriz de correlación. Cada correlación en la Tabla 3.2 corresponde a un cuadrado de la matriz de diagramas de dispersión en la Figura 3.2. Los analistas a menudo presentan tablas de correlaciones porque son fáciles de interpretar. Sin embargo, recuerde que un coeficiente de correlación solo mide la magnitud de las relaciones lineales. Por lo tanto, una tabla de correlaciones proporciona una idea de las relaciones lineales, pero puede pasar por alto una relación no lineal que se puede revelar en una matriz de diagramas de dispersión. Tabla 3.2: Correlaciones del Seguro de Vida Temporal NUMHH EDUCATION LNINCOME EDUCATION -0.064 LNINCOME 0.179 0.343 LNFACE 0.288 0.383 0.482 La matriz de diagramas de dispersión y la correspondiente matriz de correlación son herramientas útiles para resumir datos multivariados. Son fáciles de producir e interpretar. Sin embargo, cada una captura solo relaciones entre pares de variables y no puede cuantificar relaciones entre varias variables. Código R para producir la Tabla 3.2 y la Figura 3.2 tableCor &lt;- cor(Term1) tableCor &lt;- round(tableCor, digits = 3) tableCor[upper.tri(tableCor, diag = TRUE)] &lt;- &quot;&quot; tablePrint &lt;- tableCor[-1,] tablePrint &lt;- tablePrint[,-4] TableGen1(TableData=tablePrint, TextTitle=&#39;Correlaciones del Seguro de Vida Temporal&#39;, Align=&#39;r&#39;, Digits=3, ColumnSpec=1:3, ColWidth = ColWidth5) # FIGURA 3.2 par(mar=c(4.1,2.1,2.1,2.1), cex=1.1) varTerm &lt;- c(&quot;NUMHH&quot;,&quot;EDUCATION&quot;, &quot;LNINCOME&quot;, &quot;LNFACE&quot;) Term1 &lt;- Term2[varTerm] pairs(Term1,upper.panel=NULL, gap=0,cex.labels=1.25, las=1) Método de Mínimos Cuadrados Consideremos la pregunta: “¿Puede el conocimiento de la educación, el tamaño del hogar y el ingreso ayudarnos a entender la demanda de seguros?” Las correlaciones en la Tabla 3.2 y los gráficos en las Figuras 3.1 y 3.2 sugieren que cada variable, EDUCATION, NUMHH y LNINCOME, puede ser una variable explicativa útil de LNFACE cuando se consideran individualmente. Parece razonable investigar el efecto conjunto de estas variables en una respuesta. El concepto geométrico de un plano se utiliza para explorar la relación lineal entre una respuesta y varias variables explicativas. Recuerde que un plano extiende el concepto de una línea a más de dos dimensiones. Un plano puede definirse mediante una ecuación algebraica como \\[ y = b_0 + b_1 x_1 + \\ldots + b_k x_k. \\] Esta ecuación define un plano en \\(k+1\\) dimensiones. La Figura 3.3 muestra un plano en tres dimensiones. En esta figura, hay una variable de respuesta, LNFACE, y dos variables explicativas, EDUCATION y LNINCOME (NUMHH se mantiene fijo). Es difícil graficar más de tres dimensiones de una manera significativa. Figura 3.3: Un ejemplo de un plano tridimensional Necesitamos una manera de determinar un plano basado en los datos. La dificultad es que en la mayoría de las aplicaciones de análisis de regresión, el número de observaciones, \\(n\\), excede con creces el número de observaciones requeridas para ajustar un plano, \\(k+1\\). Por lo tanto, generalmente no es posible encontrar un solo plano que pase por todas las \\(n\\) observaciones. Como en el Capítulo 2, utilizamos el método de mínimos cuadrados para determinar un plano a partir de los datos. El método de mínimos cuadrados se basa en determinar los valores de \\(b_0^{\\ast},b_1^{\\ast},\\ldots,b_k^{\\ast}\\) que minimizan la cantidad \\[\\begin{equation} SS(b_0^{\\ast},b_1^{\\ast},\\ldots,b_k^{\\ast})=\\sum_{i=1}^{n}\\left( y_i-\\left( b_0^{\\ast}+b_1^{\\ast}x_{i1}+\\ldots+b_k^{\\ast}x_{ik}\\right) \\right) ^2. \\tag{3.1} \\end{equation}\\] Dejamos de usar la notación con asterisco, o estrella, y usamos \\(b_0, b_1, \\ldots, b_k\\) para denotar los mejores valores, conocidos como las estimaciones de mínimos cuadrados. Con las estimaciones de mínimos cuadrados, definimos el plano de regresión de mínimos cuadrados, o ajustado, como \\[ \\widehat{y} = b_0 + b_1 x_1 + \\ldots + b_k x_k. \\] Las estimaciones de mínimos cuadrados se determinan minimizando \\(SS(b_0^{\\ast},b_1^{\\ast},\\ldots,b_k^{\\ast})\\). Es difícil escribir los estimadores de mínimos cuadrados resultantes utilizando una fórmula simple a menos que se recurra a la notación matricial. Debido a su importancia en los modelos estadísticos aplicados, se proporciona una fórmula explícita para los estimadores a continuación. Sin embargo, estas fórmulas han sido programadas en una gran variedad de paquetes de software estadístico y de hojas de cálculo. La disponibilidad de estos paquetes permite a los analistas de datos concentrarse en las ideas del procedimiento de estimación en lugar de enfocarse en los detalles de los procedimientos de cálculo. Como ejemplo, se ajustó un plano de regresión a los datos de Seguro de Vida Temporal donde se utilizaron tres variables explicativas, \\(x_1\\) para EDUCATION, \\(x_2\\) para NUMHH y \\(x_3\\) para LNINCOME. El plano de regresión ajustado resultante es \\[\\begin{equation} \\widehat{y} = 2.584 + 0.206 x_1 + 0.306 x_2 + 0.494 x_3. \\tag{3.2} \\end{equation}\\] Notación Matricial Supongamos que los datos son de la forma \\((x_{i0}, x_{i1}, \\ldots, x_{ik}, y_i)\\), donde \\(i = 1, \\ldots, n\\). Aquí, la variable \\(x_{i0}\\) está asociada con el término “intercepto”. En la mayoría de las aplicaciones, suponemos que \\(x_{i0}\\) es idénticamente igual a 1 y, por lo tanto, no es necesario representarlo explícitamente. Sin embargo, hay aplicaciones importantes donde este no es el caso, y por lo tanto, para expresar el modelo en notación general, se incluye aquí. Los datos se representan en notación matricial usando: \\[ \\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_n \\end{pmatrix} ~~~~ \\mathbf{X} = \\begin{pmatrix} x_{10} &amp; x_{11} &amp; \\cdots &amp; x_{1k} \\\\ x_{20} &amp; x_{21} &amp; \\cdots &amp; x_{2k} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ x_{n0} &amp; x_{n1} &amp; \\cdots &amp; x_{nk} \\end{pmatrix}. \\] Aquí, \\(\\mathbf{y}\\) es el vector de respuestas de \\(n \\times 1\\) y \\(\\mathbf{X}\\) es la matriz de variables explicativas de \\(n \\times (k+1)\\). Usamos la convención de álgebra matricial de que las letras minúsculas y mayúsculas en negrita representan vectores y matrices, respectivamente. (Si necesita repasar sobre matrices, revise la Sección 2.11). Ejemplo: Seguro de Vida Temporal - Continuación. Recuerde que \\(y\\) representa el valor logarítmico del seguro, \\(x_1\\) para los años de educación, \\(x_2\\) para el número de miembros del hogar, y \\(x_3\\) para el ingreso logarítmico. Por lo tanto, hay \\(k = 3\\) variables explicativas y \\(n = 275\\) hogares. El vector de respuestas y la matriz de variables explicativas son: \\[ \\small{ \\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_{275} \\end{pmatrix} = \\begin{pmatrix} 9.904 \\\\ 11.775 \\\\ \\vdots \\\\ 9.210 \\end{pmatrix} \\\\ \\mathbf{X} = \\begin{pmatrix} 1 &amp; x_{11} &amp; x_{12} &amp; x_{13} \\\\ 1 &amp; x_{21} &amp; x_{22} &amp; x_{23} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\\\ 1 &amp; x_{275,1} &amp; x_{275,2} &amp; x_{275,3} \\end{pmatrix} = \\begin{pmatrix} 1 &amp; 16 &amp; 3 &amp; 10.669 \\\\ 1 &amp; 9 &amp; 3 &amp; 9.393 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\\\ 1 &amp; 12 &amp; 1 &amp; 10.545 \\end{pmatrix}. } \\] Por ejemplo, para la primera observación en el conjunto de datos, la variable dependiente es \\(y_1 = 9.904\\) (correspondiente a \\(\\exp(9.904) = \\$20,000\\)), para un encuestado con 16 años de educación que vive en un hogar con 3 personas y un ingreso logarítmico de 10.669 (\\(\\exp(10.669) = \\$43,000\\)). Bajo el principio de estimación de mínimos cuadrados, nuestro objetivo es elegir los coeficientes \\(b_0^{\\ast}, b_1^{\\ast}, \\ldots, b_k^{\\ast}\\) para minimizar la función de suma de cuadrados \\(SS(b_0^{\\ast}, b_1^{\\ast}, \\ldots, b_k^{\\ast})\\). Usando cálculo, regresamos a la ecuación (3.1), tomamos derivadas parciales con respecto a cada coeficiente y establecemos estas cantidades igual a cero: \\[ \\begin{array}{ll} \\frac{\\partial }{\\partial b_j^{\\ast}}SS(b_0^{\\ast}, b_1^{\\ast}, \\ldots, b_k^{\\ast}) &amp;= \\sum_{i=1}^{n}\\left( -2x_{ij}\\right) \\left( y_i-\\left( b_0^{\\ast}+b_1^{\\ast}x_{i1}+\\ldots+b_k^{\\ast}x_{ik}\\right) \\right) \\\\ &amp;= 0, ~~~ \\text{para} ~ j=0,1,\\ldots,k. \\end{array} \\] Este es un sistema de \\(k+1\\) ecuaciones y \\(k+1\\) incógnitas que se puede resolver fácilmente usando notación matricial, como sigue. Podemos expresar el vector de parámetros a minimizar como \\(\\mathbf{b}^{\\ast}=(b_0^{\\ast}, b_1^{\\ast}, \\ldots, b_k^{\\ast})^{\\prime}\\). Usando esto, la suma de cuadrados se puede escribir como \\(SS(\\mathbf{b}^{\\ast}) = (\\mathbf{y-Xb}^{\\ast})^{\\prime}(\\mathbf{y-Xb}^{\\ast})\\). Así, en forma matricial, la solución al problema de minimización se puede expresar como \\(\\frac{\\partial}{\\partial \\mathbf{b}^{\\ast}} SS(\\mathbf{b}^{\\ast}) = \\mathbf{0}\\). Esta solución satisface las ecuaciones normales: \\[\\begin{equation} \\mathbf{X^{\\prime}Xb} = \\mathbf{X}^{\\prime}\\mathbf{y}. \\tag{3.3} \\end{equation}\\] Aquí, se ha eliminado la notación de asterisco (*) para denotar el hecho de que \\(\\mathbf{b} = (b_0, b_1, \\ldots, b_k)^{\\prime}\\) representa el mejor vector de valores en el sentido de minimizar \\(SS(\\mathbf{b}^{\\ast})\\) sobre todas las opciones de \\(\\mathbf{b}^{\\ast}\\). El estimador de mínimos cuadrados \\(\\mathbf{b}\\) no necesita ser único. Sin embargo, suponiendo que las variables explicativas no son combinaciones lineales entre sí, tenemos que \\(\\mathbf{X^{\\prime}X}\\) es invertible. En este caso, podemos escribir la solución única como: \\[\\begin{equation} \\mathbf{b} = \\left( \\mathbf{X^{\\prime}X} \\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{y}. \\tag{3.4} \\end{equation}\\] Para ilustrar, para el ejemplo de Seguro de Vida Temporal, la ecuación (3.4) produce: \\[ \\small{ \\mathbf{b} = \\begin{pmatrix} b_0 \\\\ b_1 \\\\ b_2 \\\\ b_3 \\\\ \\end{pmatrix} = \\begin{pmatrix} 2.584 \\\\ 0.206 \\\\ 0.306 \\\\ 0.494 \\\\ \\end{pmatrix}. } \\] 3.2 Modelo de Regresión Lineal y Propiedades de los Estimadores En la sección anterior, aprendimos cómo utilizar el método de mínimos cuadrados para ajustar un plano de regresión con un conjunto de datos. Esta sección describe los supuestos que sustentan el modelo de regresión y algunas de las propiedades resultantes de los estimadores de los coeficientes de regresión. Con el modelo y los datos ajustados, podremos hacer inferencias sobre el conjunto de datos de la muestra a una población más grande. Además, más adelante utilizaremos estos supuestos del modelo de regresión para ayudarnos a mejorar la especificación del modelo en el Capítulo 5. 3.2.1 Función de Regresión La mayoría de los supuestos del modelo de regresión lineal múltiple se trasladarán directamente de los supuestos del modelo de regresión lineal básico introducidos en la Sección 2.2. La principal diferencia es que ahora resumimos la relación entre la variable respuesta y las variables explicativas a través de la función de regresión: \\[\\begin{equation} \\mathrm{E~}y = \\beta_0 x_0 + \\beta_1 x_1 + \\ldots + \\beta_k x_k, \\tag{3.5} \\end{equation}\\] que es lineal en los parámetros \\(\\beta_0,\\ldots,\\beta_k\\). De aquí en adelante, usaremos \\(x_0 = 1\\) para la variable asociada con el parámetro \\(\\beta_0\\); esto es lo predeterminado en la mayoría de los paquetes estadísticos, y la mayoría de las aplicaciones de regresión incluyen el término de intercepto \\(\\beta_0\\). El intercepto es el valor esperado de \\(y\\) cuando todas las variables explicativas son iguales a cero. Aunque rara vez es de interés, el término \\(\\beta_0\\) sirve para establecer la altura del plano de regresión ajustado. En cambio, los otros betas son típicamente parámetros importantes en un estudio de regresión. Para ayudar a interpretarlos, inicialmente asumimos que \\(x_j\\) varía de manera continua y no está relacionado con las otras variables explicativas. Entonces, podemos interpretar \\(\\beta_j\\) como el cambio esperado en \\(y\\) por unidad de cambio en \\(x_j\\) asumiendo que todas las demás variables explicativas se mantienen fijas. Es decir, desde el cálculo, reconocerás que \\(\\beta_j\\) puede interpretarse como una derivada parcial. Específicamente, usando la ecuación anterior, tenemos que \\[ \\beta_j = \\frac{\\partial }{\\partial x_j}\\mathrm{E}~y. \\] 3.2.2 Interpretación del Coeficiente de Regresión Examinemos las estimaciones de los coeficientes de regresión del ejemplo de Seguro de Vida Temporal y enfoquémonos inicialmente en el signo de los coeficientes. Por ejemplo, en la ecuación (3.4), el coeficiente asociado con NUMHH es \\(b_2 = 0.306 &gt; 0\\). Si consideramos dos hogares que tienen el mismo ingreso y el mismo nivel de educación, entonces se espera que el hogar más grande (en términos de NUMHH) demande más seguro de vida temporal bajo el modelo de regresión. Esta es una interpretación sensata; los hogares más grandes tienen más dependientes para los cuales el seguro de vida temporal puede proporcionar activos financieros necesarios en caso de la muerte prematura de un sostén de la familia. El coeficiente positivo asociado con el ingreso (\\(b_3 = 0.494\\)) también es plausible; los hogares con mayores ingresos tienen más dinero disponible para comprar seguros. El signo positivo asociado con EDUCATION (\\(b_1 = 0.206)\\) también es razonable; más educación sugiere que los encuestados son más conscientes de sus necesidades de seguro, otras cosas iguales. También necesitas interpretar la cantidad del coeficiente de regresión. Consideremos primero el coeficiente de EDUCATION. Usando la ecuación (3.4), se calcularon los valores ajustados de \\(\\widehat{\\mathrm{LNFACE}}\\) permitiendo que EDUCATION variara y manteniendo NUMHH y LNINCOME fijos en los promedios de la muestra. Los resultados son: Efectos de Pequeños Cambios en la Educación EDUCATION 14 14.1 14.2 14.3 \\(\\widehat{\\mathit{LNFACE}}\\) 11.883 11.904 11.924 11.945 \\(\\widehat{\\mathit{FACE}}\\) 144,803 147,817 150,893 154,034 \\(\\widehat{\\mathit{FACE}}\\) % Cambio 2.081 2.081 2.081 A medida que EDUCATION aumenta, \\(\\widehat{\\mathrm{LNFACE}}\\) también aumenta. Además, la cantidad de incremento en \\(\\widehat{\\mathrm{LNFACE}}\\) es un 0.0206 constante. Esto viene directamente de la ecuación (3.4); a medida que EDUCATION aumenta en 0.1 años, se espera que la demanda de seguros aumente en 0.0206 dólares logarítmicos, manteniendo NUMHH y LNINCOME fijos. Esta interpretación es correcta, pero la mayoría de los directores de desarrollo de productos no son muy partidarios de los dólares logarítmicos. Para volver a dólares, los valores ajustados pueden calcularse a través de la exponenciación como \\(\\widehat{\\mathrm{FACE}} = \\exp(\\widehat{\\mathrm{LNFACE}})\\). Además, se puede calcular el cambio porcentual; por ejemplo, \\(100 \\times (147,817/144,803 - 1) \\approx 2.08\\%\\). Esto proporciona otra interpretación del coeficiente de regresión; a medida que EDUCATION aumenta en 0.1 años, se espera que la demanda de seguros aumente en un 2.08%. Esta es una simple consecuencia del cálculo usando \\(\\partial \\ln y / \\partial x = \\left(\\partial y / \\partial x \\right) / y\\); es decir, un pequeño cambio en el valor logarítmico de \\(y\\) equivale a un pequeño cambio en \\(y\\) como una proporción de \\(y\\). Es debido a este resultado del cálculo que utilizamos logaritmos naturales en lugar de logaritmos comunes en el análisis de regresión. Dado que esta tabla utiliza un cambio discreto en EDUCATION, el 2.08% difiere ligeramente del resultado continuo \\(0.206 \\times (\\mathrm{cambio~en~EDUCATION}) = 2.06\\%\\). Sin embargo, esta proximidad generalmente se considera adecuada para fines de interpretación. Continuando con esta lógica, consideremos pequeños cambios en el ingreso logarítmico. Efectos de Pequeños Cambios en el Ingreso Logarítmico LNINCOME 11 11.1 11.2 11.3 INCOME 59,874 66,171 73,130 80,822 INCOME % Cambio 10.52 10.52 10.52 \\(\\widehat{\\mathit{LNFACE}}\\) 11.957 12.006 12.055 12.105 \\(\\widehat{\\mathit{FACE}}\\) 155,831 163,722 172,013 180,724 \\(\\widehat{\\mathit{FACE}}\\) % Cambio 5.06 5.06 5.06 \\(\\widehat{\\mathit{FACE}}\\) % Cambio / INCOME % Cambio 0.482 0.482 0.482 Podemos usar la misma lógica para interpretar el coeficiente LNINCOME en la ecuación (3.4). A medida que el ingreso logarítmico aumenta en 0.1 unidades, se espera que la demanda de seguros aumente en un 5.06%. Esto se refiere a las unidades logarítmicas en \\(y\\) pero no en \\(x\\). Podemos usar la misma lógica para decir que a medida que el ingreso logarítmico aumenta en 0.1 unidades, el INCOME aumenta en un 10.52%. Por lo tanto, un cambio del 10.52% en el INCOME corresponde a un cambio del 5.06% en el FACE. Resumiendo, decimos que, manteniendo NUMHH y EDUCATION fijos, esperamos que un aumento del 1% en el INCOME esté asociado con un aumento del 0.482% en \\(\\widehat{\\mathrm{FACE}}\\) (como antes, esto es cercano a la estimación del parámetro \\(b_3 = 0.494\\)). El coeficiente asociado con el ingreso se conoce como elasticidad en economía. En economía, la elasticidad es la relación entre el cambio porcentual en una variable y el cambio porcentual en otra variable. Matemáticamente, resumimos esto como: \\[ \\frac{\\partial \\ln y}{\\partial \\ln x} = \\left(\\frac{\\partial y}{y}\\right)/\\left(\\frac{\\partial x}{x}\\right). \\] 3.2.3 Suposiciones del Modelo Como en la Sección 2.2 para una sola variable explicativa, existen dos conjuntos de suposiciones que se pueden utilizar para la regresión lineal múltiple. Son conjuntos equivalentes, cada uno con ventajas comparativas a medida que avanzamos en nuestro estudio de la regresión. La representación de “observables” se centra en las variables de interés \\((x_{i1}, \\ldots, x_{ik}, y_i)\\). La “representación del error” proporciona una base para motivar nuestras medidas de bondad de ajuste y el estudio del análisis de residuales. Sin embargo, el segundo conjunto de suposiciones se centra en el caso de errores aditivos y oscurece la base de muestreo del modelo. \\[ \\textbf{Suposiciones de Muestreo del Modelo de Regresión Lineal Múltiple} \\\\ \\small{ \\begin{array}{ll} \\text{Representación de Observables} &amp; \\text{Representación de Error} \\\\ \\hline F1.~ \\mathrm{E}~y_i=\\beta_0+\\beta_1 x_{i1}+\\ldots+\\beta_k x_{ik}. &amp; E1.~ y_i=\\beta_0+\\beta_1 x_{i1}+\\ldots+\\beta_k x_{ik}+\\varepsilon_i. \\\\ F2.~ \\{x_{i1},\\ldots ,x_{ik}\\} &amp; E2.~ \\{x_{i1},\\ldots ,x_{ik}\\} \\\\ \\ \\ \\ \\ \\ \\ \\ \\ \\text{son variables no estocásticas.} &amp; \\ \\ \\ \\ \\ \\ \\ \\ \\text{son variables no estocásticas.} \\\\ F3.~ \\mathrm{Var}~y_i=\\sigma^2. &amp; E3.~ \\mathrm{E}~\\varepsilon_i=0 \\text{ y } \\mathrm{Var}~\\varepsilon_i=\\sigma^2. \\\\ F4.~ \\{y_i\\} \\text{ son variables aleatorias independientes.} &amp; E4.~ \\{\\varepsilon_i\\} \\text{ son variables aleatorias independientes.} \\\\ F5.~ \\{y_i\\} \\text{ están distribuidos normalmente.} &amp; E5.~ \\{\\varepsilon_i\\} \\text{ están distribuidos normalmente.} \\\\ \\hline \\end{array} } \\] Para motivar aún más las Suposiciones F2 y F4, generalmente asumimos que nuestros datos han sido obtenidos como resultado de un esquema de muestreo estratificado, donde cada valor único de \\(\\{x_{i1}, \\ldots, x_{ik}\\}\\) se trata como un estrato. Es decir, para cada valor de \\(\\{x_{i1}, \\ldots, x_{ik}\\}\\), tomamos una muestra aleatoria de respuestas de una población. Así, las respuestas dentro de cada estrato son independientes entre sí, al igual que las respuestas de diferentes estratos. El Capítulo 6 discutirá esta base de muestreo en mayor detalle. 3.2.4 Propiedades de los Estimadores de los Coeficientes de Regresión La Sección 3.1 describió el método de mínimos cuadrados para estimar los coeficientes de regresión. Con las suposiciones del modelo de regresión, podemos establecer algunas propiedades básicas de estos estimadores. Para hacerlo, de la Sección 2.11.4, tenemos que la esperanza de un vector es el vector de esperanzas, de modo que \\[ \\small{ \\mathrm{E}~\\mathbf{y} = \\left( \\begin{array}{l} \\mathrm{E}~y_1 \\\\ \\mathrm{E}~y_2 \\\\ \\vdots \\\\ \\mathrm{E}~y_n \\end{array} \\right) . } \\] Además, la multiplicación básica de matrices muestra que \\[ \\small{ \\mathbf{X} \\boldsymbol \\beta = \\left( \\begin{array}{cccc} 1 &amp; x_{11} &amp; \\cdots &amp; x_{1k} \\\\ 1 &amp; x_{21} &amp; \\cdots &amp; x_{2k} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 1 &amp; x_{n1} &amp; \\cdots &amp; x_{nk} \\end{array} \\right) \\left( \\begin{array}{c} \\beta_0 \\\\ \\beta_1 \\\\ \\vdots \\\\ \\beta_k \\end{array} \\right) = \\left( \\begin{array}{c} \\beta_0 + \\beta_1 x_{11} + \\cdots + \\beta_k x_{1k} \\\\ \\beta_0 + \\beta_1 x_{21} + \\cdots + \\beta_k x_{2k} \\\\ \\vdots \\\\ \\beta_0 + \\beta_1 x_{n1} + \\cdots + \\beta_k x_{nk} \\end{array} \\right) . } \\] Dado que la \\(i\\)-ésima fila de la suposición F1 es \\(\\mathrm{E}~y_i = \\beta_0 + \\beta_1 x_{i1} + \\cdots + \\beta_k x_{ik}\\), podemos reescribir esta suposición en forma matricial como \\(\\mathrm{E}~\\mathbf{y} = \\mathbf{X} \\boldsymbol \\beta\\). Ahora estamos en condiciones de enunciar la primera propiedad importante de los estimadores de regresión por mínimos cuadrados. Propiedad 1. Consideremos un modelo de regresión y que se cumplan las Suposiciones F1-F4. Entonces, el estimador \\(\\mathbf{b}\\) definido en la ecuación (3.4) es un estimador insesgado del vector de parámetros \\(\\boldsymbol \\beta\\). Para establecer la Propiedad 1, tenemos que \\[ \\begin{array}{ll} \\mathrm{E}~\\mathbf{b} &amp; = \\mathrm{E}~\\left((\\mathbf{X^{\\prime}X)}^{-1}\\mathbf{X}^{\\prime}\\mathbf{y}\\right) = (\\mathbf{X^{\\prime}X)}^{-1}\\mathbf{X}^{\\prime}\\mathrm{E}~\\mathbf{y} \\\\ &amp;= (\\mathbf{X^{\\prime}X)}^{-1} \\mathbf{X}^{\\prime} \\left( \\mathbf{X} \\boldsymbol \\beta \\right) = \\boldsymbol \\beta, \\end{array} \\] utilizando reglas de multiplicación de matrices. Este capítulo asume que \\(\\mathbf{X^{\\prime}X}\\) es invertible. También se puede mostrar que el estimador de mínimos cuadrados solo necesita ser una solución de las ecuaciones normales para ser insesgado (sin requerir que \\(\\mathbf{X^{\\prime}X}\\) sea invertible, ver Sección 4.7.3). Así, se dice que \\(\\mathbf{b}\\) es un estimador insesgado de \\(\\boldsymbol \\beta\\). En particular, \\(\\mathrm{E}~b_j = \\beta_j\\) para \\(j = 0,1,\\ldots,k\\). Dado que la independencia implica covarianza cero, de la Suposición F4 tenemos que \\(\\mathrm{Cov}(y_i,y_j) = 0\\) para \\(i \\neq j\\). A partir de esto, de la Suposición F3 y de la definición de la varianza de un vector, tenemos que \\[ \\small{ \\begin{array}{ll} \\mathrm{Var~}\\mathbf{y} &amp;= \\left( \\begin{array}{cccc} \\mathrm{Var~}y_1 &amp; \\mathrm{Cov}(y_1,y_2) &amp; \\cdots &amp; \\mathrm{Cov}(y_1,y_n) \\\\ \\mathrm{Cov}(y_2,y_1) &amp; \\mathrm{Var~}y_2 &amp; \\cdots &amp; \\mathrm{Cov}(y_2,y_n) \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ \\mathrm{Cov}(y_n,y_1) &amp; \\mathrm{Cov}(y_n,y_2) &amp; \\cdots &amp; \\mathrm{Var~}y_n \\end{array} \\right) \\\\ &amp;= \\left( \\begin{array}{cccc} \\sigma^2 &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; \\sigma^2 &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; \\cdots &amp; \\sigma^2 \\end{array} \\right) = \\sigma^2 \\mathbf{I}, \\end{array} } \\] donde \\(\\mathbf{I}\\) es una matriz identidad de \\(n \\times n\\). Ahora estamos en condiciones de enunciar la segunda propiedad importante de los estimadores de regresión por mínimos cuadrados. Propiedad 2. Consideremos un modelo de regresión y que se cumplan las Suposiciones F1-F4. Entonces, el estimador \\(\\mathbf{b}\\) definido en la ecuación (3.4) tiene una varianza de \\(\\mathrm{Var~}\\mathbf{b} = \\sigma^2(\\mathbf{X^{\\prime}X)}^{-1}\\). Para establecer la Propiedad 2, a partir de la propiedad de la matriz de varianza, tenemos que \\[ \\small{ \\begin{array}{ll} \\mathrm{Var~}\\mathbf{b} &amp; = \\mathrm{Var~}\\left((\\mathbf{X^{\\prime}X)}^{-1}\\mathbf{X}^{\\prime}\\mathbf{y}\\right) = (\\mathbf{X^{\\prime}X)}^{-1} \\mathbf{X}^{\\prime} \\mathrm{Var~}\\mathbf{y} \\mathbf{X} (\\mathbf{X^{\\prime}X)}^{-1} \\\\ &amp;= (\\mathbf{X^{\\prime}X)}^{-1} \\mathbf{X}^{\\prime} \\sigma^2 \\mathbf{I} \\mathbf{X} (\\mathbf{X^{\\prime}X)}^{-1} = \\sigma^2 (\\mathbf{X^{\\prime}X)}^{-1}, \\end{array} } \\] como se requiere. Esta propiedad importante nos permitirá medir la precisión del estimador \\(\\mathbf{b}\\) cuando discutamos la inferencia estadística. Específicamente, por la definición de la varianza de un vector (ver Sección 2.11.4), \\[\\begin{equation} \\small{ \\mathrm{Var~}\\mathbf{b}= \\begin{pmatrix} \\mathrm{Var~}b_0 &amp; \\mathrm{Cov}(b_0,b_1) &amp; \\cdots &amp; \\mathrm{Cov}(b_0,b_k) \\\\ \\mathrm{Cov}(b_1,b_0) &amp; \\mathrm{Var~}b_1 &amp; \\cdots &amp; \\mathrm{Cov}(b_1,b_k) \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ \\mathrm{Cov}(b_k,b_0) &amp; \\mathrm{Cov}(b_k,b_1) &amp; \\cdots &amp; \\mathrm{Var~}b_k \\end{pmatrix} = \\sigma^2 (\\mathbf{X^{\\prime}X)}^{-1}. } \\tag{3.6} \\end{equation}\\] Así, por ejemplo, \\(\\mathrm{Var~}b_j\\) es \\(\\sigma^2\\) veces la entrada diagonal \\((j+1)\\) de \\((\\mathbf{X^{\\prime}X)}^{-1}\\). Como otro ejemplo, \\(\\mathrm{Cov}(b_0,b_j)\\) es \\(\\sigma^2\\) veces el elemento en la primera fila y la columna \\((j+1)\\) de \\((\\mathbf{X^{\\prime}X)}^{-1}\\). Aunque existen métodos alternativos que son preferibles para aplicaciones específicas, los estimadores de mínimos cuadrados han demostrado ser efectivos para muchos análisis de datos rutinarios. Una característica deseable de los estimadores de regresión por mínimos cuadrados se resume en el siguiente resultado bien conocido. Teorema de Gauss-Markov: Consideremos el modelo de regresión y supongamos que se cumplen las Suposiciones F1-F4. Entonces, dentro de la clase de estimadores que son funciones lineales de las respuestas, el estimador de mínimos cuadrados \\(\\mathbf{b}\\) definido en la ecuación (3.4) es el estimador insesgado con la varianza mínima del vector de parámetros \\(\\boldsymbol{\\beta}\\). El teorema de Gauss-Markov establece que el estimador de mínimos cuadrados es el más preciso en el sentido de que tiene la menor varianza. Ya hemos visto en la Propiedad 1 que los estimadores de mínimos cuadrados son insesgados. El teorema de Gauss-Markov afirma que el estimador de mínimos cuadrados es el más preciso en el sentido de que tiene la menor varianza. (En un contexto matricial, “varianza mínima” significa que si \\(\\mathbf{b}^{\\ast}\\) es cualquier otro estimador, entonces la diferencia de las matrices de varianza, \\(\\mathrm{Var~} \\mathbf{b}^{\\ast} - \\mathrm{Var~}\\mathbf{b}\\), es semidefinida no negativa.) Una propiedad adicional importante se refiere a la distribución de los estimadores de regresión por mínimos cuadrados. Propiedad 3: Consideremos un modelo de regresión y supongamos que se cumplen las Suposiciones F1-F5. Entonces, el estimador de mínimos cuadrados \\(\\mathbf{b}\\) definido en la ecuación (3.4) está distribuido normalmente. Para establecer la Propiedad 3, definimos los vectores de peso, \\(\\mathbf{w}_i = (\\mathbf{X^{\\prime}X)}^{-1}(1, x_{i1}, \\ldots, x_{ik})^{\\prime}\\). Con esta notación, observamos que \\[ \\mathbf{b} = (\\mathbf{X^{\\prime}X)}^{-1}\\mathbf{X}^{\\prime}\\mathbf{y} = \\sum_{i=1}^{n} \\mathbf{w}_i y_i, \\] de modo que \\(\\mathbf{b}\\) es una combinación lineal de respuestas. Con la Suposición F5, las respuestas están distribuidas normalmente. Debido a que las combinaciones lineales de variables aleatorias normalmente distribuidas también están distribuidas normalmente, tenemos la conclusión de la Propiedad 3. Este resultado sustenta gran parte de la inferencia estadística que se presentará en las Secciones 3.4 y 4.2. 3.3 Estimación y Bondad de Ajuste Desviación Estándar Residual Se discutirán propiedades adicionales de los estimadores de los coeficientes de regresión cuando nos enfoquemos en la inferencia estadística. Ahora continuamos nuestra discusión sobre la estimación proporcionando un estimador del otro parámetro en el modelo de regresión lineal, \\(\\sigma^2\\). Nuestro estimador para \\(\\sigma^2\\) puede desarrollarse utilizando el principio de reemplazar expectativas teóricas por promedios muestrales. Examinando \\(\\sigma^2 = \\mathrm{E}\\left( y-\\mathrm{E~}y\\right)^2\\), al reemplazar la expectativa externa por un promedio muestral, se sugiere utilizar el estimador \\(n^{-1}\\sum_{i=1}^{n}(y_i-\\mathrm{E~}y_i)^2\\). Dado que no observamos \\(\\mathrm{E}~y_i = \\beta_0 + \\beta_1 x_{i1} + \\cdots + \\beta_k x_{ik}\\), utilizamos en su lugar la cantidad observada correspondiente \\(b_0 + b_1 x_{i1} + \\ldots + b_k x_{ik} = \\widehat{y}_i\\). Esto conduce a lo siguiente. Definición. Un estimador de \\(\\sigma^2\\), el error cuadrático medio (MSE), se define como \\[\\begin{equation} s^2 = \\frac{1}{n-(k+1)}\\sum_{i=1}^{n}\\left( y_i - \\widehat{y}_i \\right)^2. \\tag{3.7} \\end{equation}\\] La raíz cuadrada positiva, \\(s = \\sqrt{s^2}\\), se llama la desviación estándar residual. Esta expresión generaliza la definición en la ecuación (2.3), que es válida para \\(k=1\\). Resulta que, al usar \\(n-(k+1)\\) en lugar de \\(n\\) en el denominador de la ecuación (3.7), \\(s^2\\) es un estimador insesgado de \\(\\sigma^2\\). Esencialmente, al usar \\(\\widehat{y}_i\\) en lugar de \\(\\mathrm{E~}y_i\\) en la definición, hemos introducido algunas pequeñas dependencias entre las desviaciones de las respuestas \\(y_i - \\widehat{y}_i\\), reduciendo así la variabilidad total. Para compensar esta menor variabilidad, también reducimos el denominador en la definición de \\(s^2\\). Para proporcionar más intuición sobre la elección de \\(n-(k+1)\\) en la definición de \\(s^2\\), introducimos el concepto de residuales en el contexto de la regresión lineal múltiple. A partir de la Suposición E1, recordemos que los errores aleatorios pueden expresarse como \\(\\varepsilon_i = y_i - (\\beta_0 + \\beta_1 x_{i1} + \\cdots + \\beta_k x_{ik})\\). Dado que los parámetros \\(\\beta_0, \\ldots, \\beta_k\\) no se observan, los errores en sí mismos no se observan. En su lugar, examinamos los “errores estimados”, o residuales, definidos por \\(e_i = y_i - \\widehat{y}_i\\). A diferencia de los errores, existen ciertas dependencias entre los residuales. Una dependencia se debe al hecho algebraico de que el residual promedio es cero. Además, debe haber al menos \\(k+2\\) observaciones para que haya variación en el ajuste del plano. Si solo tenemos \\(k+1\\) observaciones, podríamos ajustar un plano a los datos perfectamente, resultando en ninguna variación en el ajuste. Por ejemplo, si \\(k=1\\), dado que dos observaciones determinan una línea, se requieren al menos tres observaciones para observar cualquier desviación de la línea. Debido a estas dependencias, solo tenemos \\(n-(k+1)\\) residuales libres, o no restringidos, para estimar la variabilidad en torno al plano de regresión. La raíz cuadrada positiva de \\(s^2\\) es nuestro estimador de \\(\\sigma\\). Usando los residuales, se puede expresar como \\[\\begin{equation} s = \\sqrt{\\frac{1}{n-(k+1)}\\sum_{i=1}^{n}e_i^2}. \\tag{3.8} \\end{equation}\\] Debido a que se basa en residuales, nos referimos a \\(s\\) como la desviación estándar residual. La cantidad \\(s\\) es una medida de nuestro “error típico”. Por esta razón, \\(s\\) también se llama el error estándar de la estimación. El Coeficiente de Determinación: \\(R^2\\) Para resumir la bondad de ajuste del modelo, como en el Capítulo 2, particionamos la variabilidad en partes que son “explicadas” y “no explicadas” por el ajuste de la regresión. Algebraicamente, los cálculos para la regresión utilizando muchas variables son similares al caso de usar solo una variable. Desafortunadamente, cuando se trata de muchas variables, perdemos la fácil interpretación gráfica como en la Figura 2.4. Comenzamos con la suma total de desviaciones cuadradas, \\(Total~SS = \\sum_{i=1}^{n}\\left( y_i - \\overline{y} \\right)^2\\), como nuestra medida de la variación total en el conjunto de datos. Como en la ecuación (2.1), podemos interpretar la ecuación \\[ \\small{ \\begin{array}{ccccc} \\underbrace{y_i - \\overline{y}} &amp; = &amp; \\underbrace{y_i - \\widehat{y}_i} &amp; + &amp; \\underbrace{\\widehat{y}_i - \\overline{y}} \\\\ \\text{desviación total} &amp; = &amp; \\text{desviación no explicada} &amp; + &amp; \\text{desviación explicada} \\\\ \\end{array} } \\] como “la desviación sin conocimiento de las variables explicativas es igual a la desviación no explicada por las variables explicativas más la desviación explicada por las variables explicativas”. Al cuadrar cada lado y sumar sobre todas las observaciones se obtiene \\[ Total~SS = Error~SS + Regression~SS \\] donde \\(Error~SS = \\sum_{i=1}^{n}\\left( y_i - \\widehat{y}_i \\right)^2\\) y \\(Regression~SS = \\sum_{i=1}^{n}\\left( \\widehat{y}_i - \\overline{y} \\right)^2\\). Como en la Sección 2.3 para el caso de una variable explicativa, la suma de los términos de producto cruzado resulta ser cero. Una estadística que resume esta relación es el coeficiente de determinación, \\[ R^2 = \\frac{Regression~SS}{Total~SS}. \\] Interpretamos \\(R^2\\) como la proporción de variabilidad explicada por la función de regresión. Si el modelo es adecuado para los datos, se esperaría una fuerte relación entre las respuestas observadas y las “esperadas” bajo el modelo, los valores ajustados. Un hecho algebraico interesante es el siguiente. Si uno eleva al cuadrado el coeficiente de correlación entre las respuestas y los valores ajustados, obtenemos el coeficiente de determinación, es decir, \\[ R^2 = \\left[ r \\left(y, \\widehat{y} \\right) \\right]^2. \\] Como resultado, \\(R\\), la raíz cuadrada positiva de \\(R^2\\), se llama el coeficiente de correlación múltiple. Se puede interpretar como la correlación entre la respuesta y la mejor combinación lineal de las variables explicativas, los valores ajustados. (Esta relación se desarrolla utilizando álgebra matricial en el apéndice técnico Sección 5.10.1.) La descomposición de la variabilidad también se resume utilizando la tabla de análisis de varianza, o ANOVA, como sigue. \\[ \\small{ \\begin{array}{l|lcl} \\hline \\text{Fuente} &amp; \\text{Suma de Cuadrados} &amp; df &amp; \\text{Cuadrado Medio} \\\\ \\hline \\text{Regresión} &amp; Regression~SS &amp; k &amp; Regression~MS \\\\ \\text{Error} &amp; Error~SS &amp; n - (k + 1) &amp; MSE \\\\ \\text{Total} &amp; Total~SS &amp; n - 1 &amp; \\\\ \\hline \\end{array} } \\] Las cifras de la columna de cuadrados medios se definen como las cifras de suma de cuadrados divididas por sus respectivos grados de libertad. Los grados de libertad del error denotan el número de residuales no restringidos. Es este número el que utilizamos en nuestra definición del “promedio” o error cuadrático medio. Es decir, definimos \\[ MSE = Error~MS = \\frac{Error~SS}{n - (k + 1)} = s^2. \\] De manera similar, los grados de libertad de la regresión son el número de variables explicativas. Esto da como resultado \\[ Regression~MS = \\frac{Regression~SS}{k}. \\] Al hablar del coeficiente de determinación, se puede establecer que siempre que se añade una variable explicativa al modelo, \\(R^2\\) nunca disminuye. Esto es cierto, independientemente de si la variable adicional es útil o no. Nos gustaría una medida de ajuste que disminuyera cuando se introducen variables inútiles en el modelo como variables explicativas. Para evitar esta anomalía, una estadística ampliamente utilizada es el coeficiente de determinación ajustado por grados de libertad, definido por \\[\\begin{equation} R_{a}^2 = 1 - \\frac{(Error~SS) / [n - (k + 1)]}{(Total~SS) / (n - 1)} = 1 - \\frac{s^2}{s_{y}^2}. \\tag{3.9} \\end{equation}\\] Para interpretar esta estadística, observe que \\(s_y^2\\) no depende del modelo ni de las variables del modelo. Por lo tanto, \\(s^2\\) y \\(R_a^2\\) son medidas equivalentes de ajuste del modelo. A medida que el ajuste del modelo mejora, \\(R_{a}^2\\) se hace más grande y \\(s^2\\) se hace más pequeño, y viceversa. Dicho de otro modo, elegir un modelo con el menor \\(s^2\\) es equivalente a elegir un modelo con el mayor \\(R_a^2\\). Ejemplo: Seguro de Vida a Término - Continuación. Para ilustrar, la Tabla 3.3 muestra las estadísticas resumen para la regresión de LNFACE sobre EDUCATION, NUMHH y LNINCOME. A partir de la columna de grados de libertad, recordamos que hay tres variables explicativas y 275 observaciones. Como medidas de ajuste del modelo, el coeficiente de determinación es \\(R^2 = 34.3\\%\\) (=\\(328.47 / 958.90\\)) y la desviación estándar residual es \\(s = 1.525\\) (=\\(\\sqrt{2.326}\\)). Si intentáramos estimar el monto nominal logarítmico sin conocimiento de las variables explicativas EDUCATION, NUMHH y LNINCOME, entonces el tamaño del error típico sería \\(s_y = 1.871\\) (=\\(\\sqrt{958.90 / 274}\\)). Así, al aprovechar nuestro conocimiento de las variables explicativas, hemos podido reducir el tamaño del error típico. La medida de ajuste del modelo que compara estas dos estimaciones de variabilidad es el coeficiente de determinación ajustado, \\(R_a^2 = 1 - 2.326 / 1.871^2 = 33.6\\%\\). Tabla 3.3: Tabla ANOVA para Seguro de Vida a Término Suma de Cuadrados \\(df\\) Cuadrado Medio Regresión 328.47 3 109.49 Error 630.43 271 2.326 Total 958.9 274 Ejemplo: ¿Por qué las Mujeres Viven Más que los Hombres? En un artículo con este título, Lemaire (2002) examinó lo que llamó la “ventaja femenina”, la diferencia en la esperanza de vida entre mujeres y hombres. Las esperanzas de vida son de interés porque se utilizan ampliamente como medidas de la salud de una nación. Lemaire examinó datos de \\(n = 169\\) países y encontró que la ventaja femenina promedio era de 4.51 años en todo el mundo. Buscó explicar esta diferencia basándose en 45 medidas de comportamiento, variables que capturan el grado de modernización económica de una nación, normas sociales/culturales/religiosas, posición geográfica y calidad de la atención médica disponible. Después de un análisis detallado, Lemaire reporta los coeficientes de un modelo de regresión que aparecen en la Tabla 3.4. Este modelo de regresión explica \\(R^2 = 61\\%\\) de la variabilidad. Es un modelo parsimonioso que consiste en solo \\(k = 4\\) de las 45 variables originales. Tabla 3.4. Coeficientes de Regresión de un Modelo de la Ventaja Femenina \\[ \\small{ \\begin{array}{l|rr} \\hline \\text{Variable} &amp; \\text{Coeficiente} &amp; t\\text{-estadística} \\\\ \\hline \\text{Intercepto} &amp; 9.904 &amp; 12.928 \\\\ \\text{Número Logarítmico de Personas por Médico} &amp; -0.473 &amp; -3.212 \\\\ \\text{Fertilidad} &amp; -0.444 &amp; -3.477 \\\\ \\text{Porcentaje de Hindúes y Budistas} &amp; -0.018 &amp; -3.196 \\\\ \\text{Indicador de la Unión Soviética} &amp; 4.922 &amp; 7.235 \\\\ \\hline \\end{array} } \\] Fuente: Lemaire (2002) Todas las variables fueron estadísticamente significativas. El número de personas por médico también estaba correlacionado con otras variables que capturan el grado de modernización económica de un país, como la urbanización, el número de automóviles y el porcentaje de personas que trabajan en la agricultura. La fertilidad, el número de nacimientos por mujer, estaba altamente correlacionada con las variables de educación en el estudio, incluyendo el analfabetismo femenino y la matriculación escolar femenina. El porcentaje de hindúes y budistas es una variable social/cultural/religiosa. El indicador de la Unión Soviética es una variable geográfica: caracteriza a los países de Europa del Este que pertenecían anteriormente a la Unión Soviética. Debido al alto grado de colinealidad entre las 45 variables candidatas, otros analistas podrían fácilmente elegir un conjunto alternativo de variables. No obstante, el punto importante de Lemaire fue que este modelo simple explica aproximadamente el 61% de la variabilidad basada únicamente en variables de comportamiento, no relacionadas con las diferencias biológicas entre sexos. 3.4 Inferencia Estadística para un Coeficiente Único 3.4.1 La Prueba t En muchas aplicaciones, una sola variable es de interés principal, y otras variables se incluyen en la regresión para controlar fuentes adicionales de variabilidad. Para ilustrar, un agente de ventas podría estar interesado en el efecto que tiene el ingreso sobre la cantidad de seguros demandados. En un análisis de regresión, también se podrían incluir otras variables explicativas como el género de un individuo, tipo de ocupación, edad, tamaño del hogar, nivel educativo, etc. Al incluir estas variables explicativas adicionales, esperamos obtener una mejor comprensión de la relación entre el ingreso y la demanda de seguros. Para llegar a conclusiones sensatas, necesitaremos algunas reglas para decidir si una variable es importante o no. Respondemos a la pregunta “¿Es \\(x_j\\) importante?” investigando si el parámetro de pendiente correspondiente, \\(\\beta_j\\), es igual a cero. La pregunta de si \\(\\beta_j\\) es cero se puede replantear en el marco de la prueba de hipótesis como “¿Es válida \\(H_0:\\beta_j=0\\)?” Examinamos la proximidad de \\(b_j\\) a cero para determinar si \\(\\beta_j\\) es cero o no. Dado que las unidades de \\(b_j\\) dependen de las unidades de \\(y\\) y \\(x_j\\), necesitamos estandarizar esta cantidad. A partir de la Propiedad 2 y la ecuación (3.6), vimos que \\(\\mathrm{Var~}b_j\\) es \\(\\sigma^2\\) multiplicado por el elemento diagonal \\((j+1)^{st}\\) de \\((\\mathbf{X^{\\prime}X})^{-1}\\). Reemplazando \\(\\sigma^2\\) por el estimador \\(s^2\\) y tomando raíces cuadradas, tenemos lo siguiente. Definición. El error estándar de \\(b_j\\) se puede expresar como \\[ se(b_j) = s \\sqrt{\\text{elemento diagonal (j+1)st de } (\\mathbf{X^{\\prime}X})^{-1}}. \\] Recuerda que un error estándar es una desviación estándar estimada. Para probar \\(H_0:\\beta_j=0\\), examinamos la razón \\(t\\), \\(t(b_j) = \\frac{b_j}{se(b_j)}\\). Interpretamos \\(t(b_j)\\) como el número de errores estándar que \\(b_j\\) está alejado de cero. Esta es la cantidad adecuada porque se puede demostrar que la distribución de muestreo de \\(t(b_j)\\) es la distribución \\(t\\) con \\(df=n-(k+1)\\) grados de libertad, bajo la hipótesis nula y con los supuestos del modelo de regresión lineal F1-F5. Esto nos permite construir pruebas de la hipótesis nula como el siguiente procedimiento: Procedimiento. La Prueba t para un Coeficiente de Regresión (\\(\\beta\\)). La hipótesis nula es \\(H_0:\\beta_j=0\\). La hipótesis alternativa es \\(H_{a}:\\beta_j \\neq 0\\). Establecer un nivel de significancia \\(\\alpha\\) (típicamente, pero no necesariamente, 5%). Construir la estadística, \\(t(b_j) = \\frac{b_j}{se(b_j)}\\). Procedimiento: Rechazar la hipótesis nula a favor de la alternativa si \\(|t(b_j)|\\) excede un valor \\(t\\). Aquí, este valor \\(t\\) es el percentil \\((1-\\alpha /2)^{th}\\) de la distribución \\(t\\) con \\(df=n-(k+1)\\) grados de libertad, denotado como \\(t_{n-(k+1),1-\\alpha /2}\\). En muchas aplicaciones, el tamaño de la muestra será lo suficientemente grande como para que podamos aproximar el valor \\(t\\) por el percentil correspondiente de la curva normal estándar. Al nivel de significancia del 5%, este percentil es 1.96. Así, como regla general, podemos interpretar que una variable es importante si su razón \\(t\\) excede dos en valor absoluto. Aunque es la más común, probar \\(H_0:\\beta_j=0\\) frente a \\(H_{a}:\\beta_j \\neq 0\\) es solo una de las muchas pruebas de hipótesis que se pueden realizar. Tabla 3.5 describe procedimientos alternativos para la toma de decisiones. Estos procedimientos son para probar \\(H_0:\\beta_j = d\\). Aquí, \\(d\\) es un valor prescrito por el usuario que puede ser igual a cero o cualquier otro valor conocido. Tabla 3.5. Procedimientos de Toma de Decisiones para Probar \\(H_0: \\beta_j = d\\) \\[ \\small{ \\begin{array}{cc} \\hline \\text{Hipótesis Alternativa }(H_{a}) &amp; \\text{Procedimiento: Rechazar } H_0 \\text{ en favor de } H_a \\text{ si }\\\\ \\hline \\beta_j &gt; d &amp; t-\\mathrm{razón}&gt;t_{n-(k+1),1-\\alpha } \\\\ \\beta_j &lt; d &amp; t-\\mathrm{razón}&lt;-t_{n-(k+1),1-\\alpha } \\\\ \\beta_j\\neq d &amp; |t-\\mathrm{razón}\\mathit{|}&gt;t_{n-(k+1),1-\\alpha/2} \\end{array} \\\\ \\begin{array}{ll}\\hline \\textit{Notas:} &amp;\\text{ El nivel de significancia es } \\alpha. \\text{ Aquí, } t_{n-(k+1),1-\\alpha}\\text{ es el }(1-\\alpha)^{th}\\text{ percentil} \\\\ &amp;~~\\text{de la distribución }t-\\text{utilizando } df=n-(k+1)\\text{ grados de libertad.} \\\\ &amp;~~\\text{La estadística de prueba es }t-\\mathrm{razón} = (b_j -d)/se(b_j) . \\\\ \\hline \\end{array} } \\] Alternativamente, se pueden construir valores \\(p\\) y compararlos con niveles de significancia dados. El valor \\(p\\) permite al lector del informe entender la fuerza de la desviación de la hipótesis nula. Tabla 3.6 resume el procedimiento para calcular los valores \\(p\\). Tabla 3.6. Valores de Probabilidad para Probar \\(H_0:\\beta_j =d\\) \\[ \\small{ \\begin{array}{cccc} \\hline \\text{Hipótesis} &amp; &amp; &amp; \\\\ \\text{Alternativa} (H_a ) &amp; \\beta_j &gt; d &amp; \\beta_j &lt; d &amp; \\beta_j \\neq d \\\\ \\hline p-valor &amp; \\Pr(t_{n-(k+1)}&gt;t-ratio) &amp; \\Pr(t_{n-(k+1)}&lt;t-ratio) &amp; \\Pr(|t_{n-(k+1)}|&gt;|t-ratio|) \\\\ \\end{array} \\\\ \\begin{array}{ll}\\hline \\textit{Notas:} &amp; \\text{ Aquí, } t_{n-(k+1)} \\text{ es una variable aleatoria con distribución }t\\text{ con }df=n-(k+1)\\text{ grados de libertad.} \\\\ &amp;~~\\text{La estadística de prueba es }t-\\mathrm{ratio} = (b_j -d)/se(b_j) . \\\\ \\hline \\end{array} } \\] Ejemplo: Seguro de Vida Temporal - Continuación. Una convención útil al reportar los resultados de un análisis estadístico es colocar el error estándar de una estadística entre paréntesis debajo de esa estadística. Así, por ejemplo, en nuestra regresión de LNFACE sobre EDUCATION, NUMHH, y LNINCOME, la ecuación de regresión estimada es: \\[ \\begin{array}{lccccc} \\widehat{LNFACE} = &amp;2.584 ~ + &amp;0.206~ \\text{EDUCATION} + &amp;0.306 ~\\text{NUMHH} + &amp;0.494 ~\\text{LNINCOME}. \\\\ \\text{error estándar} &amp;(0.846) &amp;(0.039) &amp;(0.063) &amp;(0.078). \\end{array} \\] Para ilustrar el cálculo de los errores estándar, primero notemos que, según la Tabla 3.3, tenemos que la desviación estándar residual es \\(s=1.525\\). Usando un paquete estadístico, tenemos \\[ \\small{ (\\mathbf{X^{\\prime}X})^{-1} = \\begin{pmatrix} 0.307975 &amp; -0.004633 &amp; -0.002131 &amp; -0.020697 \\\\ -0.004633 &amp; 0.000648 &amp; 0.000143 &amp; -0.000467 \\\\ -0.002131 &amp; 0.000143 &amp; 0.001724 &amp; -0.000453 \\\\ -0.020697 &amp; -0.000467 &amp; -0.000453 &amp; 0.002585 \\end{pmatrix}. } \\] Para ilustrar, podemos calcular \\(se(b_3)=s \\times \\sqrt{0.002585} = 0.078\\), como se indicó antes. El cálculo de los errores estándar, así como las correspondientes estadísticas \\(t\\), es parte del resultado estándar de los programas estadísticos y no necesita ser realizado por los usuarios. Nuestro objetivo aquí es ilustrar las ideas subyacentes a los cálculos rutinarios. Con esta información, podemos calcular inmediatamente las razones \\(t\\) para verificar si un coeficiente asociado con una variable individual es significativamente diferente de cero. Por ejemplo, la razón \\(t\\) para la variable LNINCOME es \\(t(b_3) = \\frac{0.494}{0.078} = 6.3\\). La interpretación es que \\(b_3\\) está más de cuatro errores estándar por encima de cero, y por lo tanto LNINCOME es una variable importante en el modelo. Más formalmente, podemos estar interesados en probar la hipótesis nula de que \\(H_0:\\beta_3 = 0\\) frente a \\(H_0:\\beta_3 \\neq 0\\). A un nivel de significancia del 5%, el valor \\(t\\) es 1.96, porque \\(df=275-(1+3)=271\\). Por lo tanto, rechazamos la hipótesis nula en favor de la hipótesis alternativa, que el ingreso logarítmico (LNINCOME) es importante para determinar el monto logarítmico del seguro. 3.4.2 Intervalos de Confianza Los intervalos de confianza para los parámetros son otra forma de describir la fuerza de la contribución de la \\(j\\)-ésima variable explicativa. La estadística \\(b_j\\) se llama una estimación puntual del parámetro \\(\\beta_j\\). Para proporcionar un rango de confianza, usamos el intervalo de confianza: \\[\\begin{equation} b_j \\pm t_{n-(k+1),1-\\alpha /2}~se(b_j). \\tag{3.10} \\end{equation}\\] Aquí, el valor \\(t\\) \\(t_{n-(k+1),1-\\alpha /2}\\) es un percentil de la distribución \\(t\\) con \\(df=n-(k+1)\\) grados de libertad. Usamos el mismo valor \\(t\\) que en la prueba de hipótesis bilateral. De hecho, hay una dualidad entre el intervalo de confianza y la prueba de hipótesis bilateral. Por ejemplo, no es difícil comprobar que si un valor hipotético cae fuera del intervalo de confianza, entonces \\(H_0\\) será rechazado en favor de \\(H_{a}\\). Además, el conocimiento del \\(p\\)-valor, la estimación puntual y el error estándar se puede utilizar para determinar un intervalo de confianza. 3.4.3 Gráficos de Variables Añadidas Para representar datos multivariados de forma gráfica, hemos visto que una matriz de dispersión es una herramienta útil. Sin embargo, la principal limitación de la matriz de dispersión es que solo captura relaciones entre pares de variables. Cuando los datos se pueden resumir utilizando un modelo de regresión, una herramienta gráfica que no tiene esta limitación es el gráfico de variables añadidas. El gráfico de variables añadidas también se llama gráfico de regresión parcial porque, como veremos, se construye en términos de los residuos de ciertos ajustes de regresión. También veremos que el gráfico de variables añadidas se puede resumir en términos de un coeficiente de correlación parcial, proporcionando así un vínculo entre correlación y regresión. Para introducir estas ideas, trabajamos en el contexto del siguiente ejemplo. Ejemplo: Precios de Refrigeradores. ¿Qué características de un refrigerador son importantes para determinar su precio (PRICE)? Aquí consideramos varias características de un refrigerador, incluyendo el tamaño del refrigerador en pies cúbicos (RSIZE), el tamaño del compartimento del congelador en pies cúbicos (FSIZE), la cantidad promedio de dinero gastado por año para operar el refrigerador (ECOST, por “costo de energía”), el número de estantes en las puertas del refrigerador y del congelador (SHELVES), y el número de características (FEATURES). La variable de características incluye estantes para latas, cajones transparentes, fabricantes de hielo, portahuevos, y así sucesivamente. Tanto los consumidores como los fabricantes están interesados en modelos de precios de refrigeradores. Otras cosas iguales, los consumidores generalmente prefieren refrigeradores más grandes con menores costos de energía y que tengan más características. Debido a las fuerzas de la oferta y la demanda, esperaríamos que los consumidores paguen más por estos refrigeradores. Un refrigerador más grande con menores costos de energía y que tiene más características a un precio similar se considera una ganga para el consumidor. ¿Cuánto estaría dispuesto a pagar el consumidor por este espacio adicional? Un modelo de precios para refrigeradores en el mercado proporciona algo de información sobre esta cuestión. Para este fin, analizamos datos de \\(n=37\\) refrigeradores. La Tabla 3.7 proporciona las estadísticas descriptivas básicas para la variable de respuesta PRICE y las cinco variables explicativas. De esta tabla, vemos que el precio promedio de los refrigeradores es \\(\\overline{y} = \\$626.40\\), con una desviación estándar de \\(s_{y} = \\$139.80\\). De manera similar, la cantidad promedio anual para operar un refrigerador, o ECOST promedio, es $70.51. knitr::kable(2, caption = &quot;Silly. Create a table just to update the counter...&quot;) Tabla 3.4: Silly. Create a table just to update the counter… x 2 knitr::kable(2, caption = &quot;Silly.&quot;) Tabla 3.5: Silly. x 2 knitr::kable(2, caption = &quot;Silly.&quot;) Tabla 3.6: Silly. x 2 Tabla 3.7: Estadísticas Descriptivas para cada variable para 37 Refrigeradores Media Mediana Desviación Estándar Mínimo Máximo ECOST 70.514 68.0 9.140 60.0 94.0 RSIZE 13.400 13.2 0.600 12.6 14.7 FSIZE 5.184 5.1 0.938 4.1 7.4 SHELVES 2.514 2.0 1.121 1.0 5.0 FEATURES 3.459 3.0 2.512 1.0 12.0 PRICE 626.351 590.0 139.790 460.0 1200.0 Para analizar las relaciones entre pares de variables, la Tabla 3.8 proporciona una matriz de coeficientes de correlación. En la tabla, vemos que hay relaciones lineales fuertes entre PRICE y tanto el espacio del congelador (FSIZE) como el número de FEATURES. Sorprendentemente, también hay una fuerte correlación positiva entre PRICE y ECOST. Recordemos que ECOST es el costo de energía; uno podría esperar que los refrigeradores de mayor precio deberían tener menores costos de energía. Tabla 3.8: Matriz de Coeficientes de Correlación ECOST RSIZE FSIZE SHELVES FEATURES RSIZE -0.033 FSIZE 0.855 -0.235 SHELVES 0.188 -0.363 0.251 FEATURES 0.334 -0.096 0.439 0.16 PRICE 0.522 -0.024 0.72 0.4 0.697 R Code to Produce Tables 3.7 and 3.8 Refrig &lt;- read.csv(&quot;CSVData/Refrigerator.csv&quot;, header=TRUE) # TABLE 3.7 SUMMARY STATISTICS varFrig &lt;- c(&quot;ECOST&quot;, &quot;RSIZE&quot;, &quot;FSIZE&quot;, &quot;SHELVES&quot;, &quot;FEATURES&quot;, &quot;PRICE&quot;) Refrig1 &lt;- Refrig[varFrig] tableMat &lt;- BookSummStats(Refrig1) colnames(tableMat) &lt;- c(&quot;Media&quot; , &quot;Mediana&quot; , &quot;Desviación Estándar&quot; , &quot;Mínimo&quot; , &quot;Máximo&quot;) rownames(tableMat) &lt;- varFrig # tableMat1[1:2,] &lt;- format(round(tableMat[1:2,], digits=0), big.mark = &#39;,&#39;) TableGen1(TableData=tableMat, TextTitle=&#39;Estadísticas Descriptivas para cada variable para 37 Refrigeradores&#39;, Align=&#39;r&#39;, Digits=3, ColumnSpec=1:5, ColWidth = ColWidth5) tableCor &lt;- cor(Refrig1) tableCor &lt;- round(tableCor, digits = 3) tableCor[upper.tri(tableCor, diag = TRUE)] &lt;- &quot;&quot; tablePrint &lt;- tableCor[-1,] tablePrint &lt;- tablePrint[,-6] TableGen1(TableData=tablePrint, TextTitle=&#39;Matriz de Coeficientes de Correlación&#39;, Align=&#39;r&#39;, Digits=3, ColumnSpec=1:5, ColWidth = ColWidth5) Se ajustó un modelo de regresión a los datos. La ecuación de regresión ajustada aparece en la Tabla 3.9, con \\(s=60.65\\) y \\(R^2=83.8\\%\\). Tabla 3.9: Modelo Ajustado de Precio de Refrigeradores Coeficiente Desviación Estándar \\(t\\)-Ratio Intercepto 798.00 271.400 -2.9 ECOST -6.96 2.275 -3.1 RSIZE 76.50 19.440 3.9 FSIZE 137.00 23.760 5.8 SHELVES 37.90 9.886 3.8 FEATURES 23.80 4.512 5.3 De la Tabla 3.9, las variables explicativas parecen ser buenos predictores de los precios de los refrigeradores. Juntas, estas variables explican el 83.8% de la variabilidad. Para entender los precios, el error típico ha disminuido de \\(s_{y} = \\$139.80\\) a \\(s = \\$60.65\\). Los \\(t\\)-ratios para cada una de las variables explicativas superan el valor absoluto de dos, lo que indica que cada variable es importante de manera individual. Lo que sorprende del ajuste de la regresión es el coeficiente negativo asociado con el costo de energía. Recordemos que podemos interpretar \\(b_{ECOST} = -6.96\\) como que, por cada aumento de un dólar en ECOST, esperamos que el PRICE disminuya en $6.96. Esta relación negativa está conforme con nuestra intuición económica. Sin embargo, es sorprendente que el mismo conjunto de datos nos haya mostrado que existe una relación positiva entre PRICE y ECOST. Esta aparente anomalía se debe a que la correlación solo mide las relaciones entre pares de variables, mientras que el ajuste de la regresión puede considerar varias variables simultáneamente. Para proporcionar más información sobre esta aparente anomalía, ahora introducimos el gráfico de variables añadidas. Producción de un Gráfico de Variables Añadidas El gráfico de variables añadidas proporciona vínculos adicionales entre la metodología de regresión y herramientas más fundamentales como los diagramas de dispersión y las correlaciones. Trabajamos en el contexto del Ejemplo del Precio de los Refrigeradores para demostrar la construcción de este gráfico. Procedimiento para producir un gráfico de variables añadidas. Realiza una regresión de PRICE sobre RSIZE, FSIZE, SHELVES y FEATURES, omitiendo ECOST. Calcula los residuos de esta regresión, los cuales etiquetamos como \\(e_1\\). Realiza una regresión de ECOST sobre RSIZE, FSIZE, SHELVES y FEATURES. Calcula los residuos de esta regresión, los cuales etiquetamos como \\(e_2\\). Grafica \\(e_1\\) versus \\(e_2\\). Este es el gráfico de variables añadidas de PRICE versus ECOST, controlando por los efectos de RSIZE, FSIZE, SHELVES y FEATURES. Este gráfico aparece en la Figura 3.4. Figura 3.4: Un gráfico de variables añadidas. Los residuos de la regresión de PRICE sobre las variables explicativas, omitiendo ECOST, están en el eje horizontal. En el eje vertical están los residuos de la regresión de ECOST sobre las demás variables explicativas. El coeficiente de correlación es -0.48. Código en R para producir la Figura 3.4 model.refrig1 &lt;- lm(PRICE ~ RSIZE + FSIZE + SHELVES + FEATURES, data = Refrig1) #summary(model.refrig1) model.refrig2 &lt;- lm(ECOST ~ RSIZE + FSIZE + SHELVES + FEATURES, data = Refrig1) #summary(model.refrig2) par(mar=c(4.1,4,.1,1), cex=1.1) plot(residuals(model.refrig2),residuals(model.refrig1), xlab=expression(e[1]),ylab=&quot;&quot;, las=1) mtext(expression(e[2]), side=2, at=0, line=3, las=1, cex=1.1) El error \\(\\varepsilon\\) puede interpretarse como la variación natural en una muestra. En muchas situaciones, esta variación natural es pequeña en comparación con los patrones evidentes en el componente de regresión no aleatorio. Por lo tanto, es útil pensar en el error, \\(\\varepsilon_i = y_i - \\left( \\beta_0 + \\beta_1 x_{i1} + \\ldots + \\beta_k x_{ik} \\right)\\), como la respuesta después de controlar por los efectos de las variables explicativas. En la Sección 3.3, vimos que un error aleatorio puede aproximarse mediante un residuo, \\(e_i = y_i - \\left( b_0 + b_1 x_{i1} + \\cdots + b_k x_{ik} \\right)\\). De la misma manera, podemos pensar en un residuo como la respuesta después de “controlar” los efectos de las variables explicativas. Con esto en mente, podemos interpretar el eje vertical de la Figura 3.4 como el precio del refrigerador (PRICE) controlado por los efectos de RSIZE, FSIZE, SHELVES y FEATURES. De manera similar, podemos interpretar el eje horizontal como ECOST controlado por los efectos de RSIZE, FSIZE, SHELVES y FEATURES. El gráfico proporciona entonces una representación gráfica de la relación entre PRICE y ECOST, después de controlar por las demás variables explicativas. En comparación, un diagrama de dispersión de PRICE y ECOST (no mostrado aquí) no controla por las demás variables explicativas. Por lo tanto, es posible que la relación positiva entre PRICE y ECOST no se deba a una relación causal, sino más bien a una o más variables adicionales que hacen que ambas variables sean grandes. Por ejemplo, de la Tabla 3.8, vemos que el tamaño del congelador (FSIZE) está positivamente correlacionado tanto con ECOST como con PRICE. Ciertamente parece razonable que aumentar el tamaño de un congelador cause que tanto el costo de energía como el precio aumenten. Más bien, la correlación positiva puede deberse al hecho de que valores grandes de FSIZE significan valores grandes tanto de ECOST como de PRICE. Las variables omitidas en una regresión se llaman variables omitidas. Esta omisión podría causar un problema serio en el ajuste del modelo de regresión; los coeficientes de regresión podrían no solo ser significativamente fuertes cuando no deberían serlo, sino que también podrían tener el signo incorrecto. Seleccionar el conjunto adecuado de variables para incluir en el modelo de regresión es una tarea importante; es el tema de los Capítulos 5 y 6. 3.4.4 Coeficientes de Correlación Parcial Como vimos en el Capítulo 2, una estadística de correlación es una cantidad útil para resumir gráficos. La correlación en el gráfico de variables añadidas se llama coeficiente de correlación parcial. Se define como la correlación entre los residuos \\(e_1\\) y \\(e_2\\) y se denota por \\(r(y,x_j | x_1, \\ldots, x_{j-1}, x_{j+1}, \\ldots, x_k)\\). Debido a que resume un gráfico de variables añadidas, podemos interpretar \\(r(y,x_j | x_1, \\ldots, x_{j-1}, x_{j+1}, \\ldots, x_k)\\) como la correlación entre \\(y\\) y \\(x_j\\), en presencia de las otras variables explicativas. Por ejemplo, la correlación entre PRICE y ECOST en presencia de las otras variables explicativas es -0.48. El coeficiente de correlación parcial también se puede calcular utilizando \\[\\begin{equation} r(y,x_j | x_1, \\ldots, x_{j-1}, x_{j+1}, \\ldots, x_k) = \\frac{t(b_j)}{\\sqrt{t(b_j)^2 + n - (k + 1)}}. \\tag{3.11} \\end{equation}\\] Aquí, \\(t(b_j)\\) es el \\(t\\)-ratio para \\(b_j\\) de una regresión de \\(y\\) sobre \\(x_1, \\ldots, x_k\\) (incluyendo la variable \\(x_j\\)). Un aspecto importante de esta ecuación es que nos permite calcular coeficientes de correlación parcial ejecutando solo una regresión. Por ejemplo, en la Tabla 3.9, la correlación parcial entre PRICE y ECOST en presencia de las otras variables explicativas es \\(\\frac{-3.1}{\\sqrt{(-3.1)^2 + 37 - (5 + 1)}} \\approx -0.48\\). El cálculo de coeficientes de correlación parcial es más rápido cuando se usa la relación con el \\(t\\)-ratio, pero puede fallar en detectar relaciones no lineales. La información en la Tabla 3.9 nos permite calcular los cinco coeficientes de correlación parcial en el Ejemplo del Precio de los Refrigeradores después de ejecutar solo una regresión. El procedimiento de tres pasos para producir gráficos de variables añadidas requiere diez regresiones, dos para cada una de las cinco variables explicativas. Por supuesto, al producir gráficos de variables añadidas, podemos detectar relaciones no lineales que son omitidas por los coeficientes de correlación. Los coeficientes de correlación parcial proporcionan otra interpretación para los \\(t\\)-ratios. La ecuación muestra cómo calcular una estadística de correlación a partir de un \\(t\\)-ratio, proporcionando así otro vínculo entre la correlación y el análisis de regresión. Además, de la ecuación vemos que cuanto mayor es el \\(t\\)-ratio, mayor es el coeficiente de correlación parcial. Es decir, un \\(t\\)-ratio alto significa que existe una gran correlación entre la respuesta y la variable explicativa, controlando por las otras variables explicativas. Esto proporciona una respuesta parcial a la pregunta que suelen hacer los consumidores de análisis de regresión: “¿Cuál es la variable más importante?” 3.5 Algunas Variables Explicativas Especiales El modelo de regresión lineal es la base de una rica familia de modelos. Esta sección ofrece varios ejemplos para ilustrar la riqueza de esta familia. Estos ejemplos demuestran el uso de (i) variables binarias, (ii) transformación de variables explicativas y (iii) términos de interacción. Esta sección también sirve para subrayar el significado del adjetivo lineal en la frase “regresión lineal”; la función de regresión es lineal en los parámetros pero puede ser una función altamente no lineal de las variables explicativas. 3.5.1 Variables Binarias Las variables categóricas proporcionan una etiqueta numérica para mediciones de observaciones que caen en grupos distintos, o categorías. Debido a la agrupación, las variables categóricas son discretas y generalmente toman un número finito de valores. Comenzamos nuestra discusión con una variable categórica que puede tomar uno de solo dos valores, una variable binaria. Una discusión más detallada sobre las variables categóricas es el tema del Capítulo 4. Ejemplo: Seguro de Vida a Término - Continuación. Ahora consideramos el estado civil del encuestado. En la Encuesta de Finanzas del Consumidor, los encuestados pueden seleccionar entre varias opciones que describen su estado civil, incluyendo “casado”, “viviendo con una pareja”, “divorciado”, y así sucesivamente. El estado civil no se mide de manera continua, sino que toma valores que caen en grupos distintos. En este capítulo, agrupamos a los encuestados de acuerdo a si están solteros o no, definidos para incluir a aquellos que están separados, divorciados, viudos, nunca casados, y que no están casados ni viviendo con una pareja. El Capítulo 4 presentará un análisis más completo del estado civil incluyendo categorías adicionales. La variable binaria SINGLE se define como uno si el encuestado está soltero y 0 en caso contrario. La variable SINGLE también se conoce como una variable indicadora porque indica si el encuestado está soltero o no. Otro nombre para este tipo importante de variable es una variable dummy. Podríamos usar 0 y 100, o 20 y 36, o cualquier otro par de valores distintos. Sin embargo, 0 y 1 son convenientes para la interpretación de los valores de los parámetros, discutidos a continuación. Para simplificar la discusión, presentamos ahora un modelo utilizando solo LNINCOME y SINGLE como variables explicativas. Para nuestra muestra de \\(n = 275\\) hogares, 57 son solteros y los otros 218 no lo son. Para ver las relaciones entre LNFACE, LNINCOME y SINGLE, la Figura 3.5 introduce un gráfico de letras de LNFACE versus LNINCOME, con SINGLE como la variable de código. Podemos ver que la Figura 3.5 es un diagrama de dispersión de LNFACE versus LNINCOME, usando 50 hogares seleccionados aleatoriamente de nuestra muestra de 275 (para mayor claridad del gráfico). Sin embargo, en lugar de usar el mismo símbolo de gráfico para cada observación, hemos codificado los símbolos para que podamos entender fácilmente el comportamiento de una tercera variable, SINGLE. En otras aplicaciones, puede optar por usar otros símbolos de gráfico como \\(\\clubsuit\\), \\(\\heartsuit\\), \\(\\spadesuit\\), y así sucesivamente, o usar diferentes colores, para codificar información adicional. Para esta aplicación, se seleccionaron los códigos de letras “S” para solteros y “o” para otros porque recuerdan al lector la naturaleza del esquema de codificación. Independientemente del esquema de codificación, el punto importante es que un gráfico de letras es un dispositivo útil para representar gráficamente tres o más variables en dos dimensiones. La principal restricción es que la información adicional debe estar categorizada, como con las variables binarias, para que el esquema de codificación funcione. Figura 3.5: Gráfico de letras de LNFACE versus LNINCOME, con el código de letra ‘S’ para solteros y ‘o’ para otros. Las líneas de regresión ajustadas han sido superpuestas. La línea inferior es para solteros y la línea superior es para otros. La Figura 3.5 sugiere que LNFACE es más bajo para aquellos solteros que para otros para un nivel dado de ingreso. Por lo tanto, ahora consideramos un modelo de regresión, LNFACE = β_0 + β_1 LNINCOME + β_2 SINGLE + ϵ. La función de regresión se puede escribir como: \\[ \\text{E } y = \\begin{cases} \\beta_0 + \\beta_1 \\text{LNINCOME} &amp; \\text{para otros encuestados} \\\\ \\beta_0 + \\beta_2 + \\beta_1 \\text{LNINCOME} &amp; \\text{para encuestados solteros} \\end{cases} \\] La interpretación de los coeficientes del modelo difiere del caso de variables continuas. Para variables continuas como LNINCOME, interpretamos \\(\\beta_1\\) como el cambio esperado en \\(y\\) por unidad de cambio en el ingreso logarítmico, manteniendo fijas otras variables. Para variables binarias como SINGLE, interpretamos \\(\\beta_2\\) como el aumento esperado en \\(y\\) al pasar del nivel base de SINGLE (=0) al nivel alternativo. Así, aunque tenemos un modelo para ambos estados civiles, podemos interpretar el modelo usando dos ecuaciones de regresión, una para cada tipo de estado civil. Al escribir una ecuación separada para cada estado civil, hemos simplificado una complicada ecuación de regresión múltiple. A veces, es más fácil comunicar una serie de relaciones simples en comparación con una sola relación compleja. Aunque la interpretación para variables explicativas binarias difiere de la continua, el método de estimación de mínimos cuadrados ordinarios sigue siendo válido. Para ilustrar, la versión ajustada del modelo anterior es \\[ \\small{ \\begin{array}{cclll} \\widehat{LNFACE} &amp; = &amp; 5.09 &amp; + 0.634 \\text{LNINCOME} &amp; - 0.800 \\text{SINGLE} .\\\\ \\text{error estándar} &amp; &amp; (0.89) &amp; ~~(0.078) &amp; ~(0.248) \\\\ \\end{array} } \\] Para interpretar \\(b_2 = -0.800\\), decimos que esperamos que el logaritmo de la cara sea menor en 0.80 para un encuestado que es soltero en comparación con la otra categoría. Esto asume que otras cosas, como el ingreso, permanecen constantes. Para una interpretación gráfica, las dos líneas de regresión ajustadas están superpuestas en la Figura 3.5. 3.5.2 Transformación de Variables Explicativas Los modelos de regresión tienen la capacidad de representar relaciones complejas y no lineales entre la respuesta esperada y las variables explicativas. Por ejemplo, los textos tempranos sobre regresión, como Plackett (1960, Capítulo 6), dedican un capítulo completo al modelo de regresión polinómica, \\[\\begin{equation} \\text{E } y = \\beta_0 + \\beta_1 x + \\beta_2 x^2 + \\ldots + \\beta_p x^p. \\tag{3.12} \\end{equation}\\] Aquí, la idea es que un polinomio de orden \\(p\\) en \\(x\\) puede usarse para aproximar funciones generales y desconocidas no lineales de \\(x\\). El tratamiento moderno de la regresión polinómica no requiere un capítulo completo porque el modelo en la ecuación (3.12) puede expresarse como un caso especial del modelo de regresión lineal. Es decir, con la función de regresión en la ecuación (3.5), \\(\\text{E } y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\ldots + \\beta_k x_k\\), podemos elegir \\(k = p\\) y \\(x_1 =x\\), \\(x_2 = x^2\\), \\(\\ldots\\), \\(x_p = x^p\\). Así, con estas elecciones de variables explicativas, podemos modelar una función altamente no lineal de \\(x\\). No estamos restringidos a potencias de \\(x\\) en nuestra elección de transformaciones. Por ejemplo, el modelo \\(\\text{E } y = \\beta_0 + \\beta_1 \\ln x\\), proporciona otra forma de representar una curva suavemente inclinada en \\(x\\). Este modelo puede escribirse como un caso especial del modelo de regresión lineal básico usando \\(x^{\\ast} = \\ln x\\) como la versión transformada de \\(x\\). Las transformaciones de las variables explicativas no tienen que ser funciones suaves. Para ilustrar, en algunas aplicaciones, es útil categorizar una variable explicativa continua. Por ejemplo, supongamos que \\(x\\) representa el número de años de educación, que varía de 0 a 17. Si nos basamos en información auto-reportada por nuestra muestra de personas mayores, puede haber una cantidad considerable de error en la medición de \\(x\\). Podríamos optar por usar una transformación menos informativa, pero más confiable, de \\(x\\) como \\(x^{\\ast}\\), una variable binaria para haber completado 13 años de escolaridad (terminar la secundaria). Formalmente, codificaríamos $x^{} = 1$ si \\(x \\geq 13\\) y \\(x^{\\ast} = 0\\) si \\(x &lt; 13\\). Así, hay varias formas en que las funciones no lineales de las variables explicativas pueden usarse en el modelo de regresión. Un ejemplo de un modelo de regresión no lineal es \\(y = \\beta_0 + \\exp (\\beta_1 x) + \\varepsilon.\\) Estos típicamente surgen en aplicaciones científicas de regresiones donde hay principios científicos fundamentales que guían el desarrollo del modelo complejo. 3.5.3 Términos de Interacción Hasta ahora hemos discutido cómo las variables explicativas, digamos \\(x_1\\) y \\(x_2\\), afectan la respuesta media de manera aditiva, es decir, \\(\\mathrm{E}~y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2\\). Aquí, esperamos que \\(y\\) aumente en \\(\\beta_1\\) por cada unidad que aumente \\(x_1\\), manteniendo \\(x_2\\) fijo. ¿Qué pasa si la tasa marginal de aumento de \\(\\mathrm{E}~y\\) difiere para valores altos de \\(x_2\\) en comparación con valores bajos de \\(x_2\\)? Una forma de representar esto es crear una variable de interacción \\(x_3 = x_1 \\times x_2\\) y considerar el modelo \\(\\mathrm{E}~y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_3\\). Con este modelo, el cambio en el esperado \\(y\\) por cada unidad de cambio en \\(x_1\\) ahora depende de \\(x_2\\). Formalmente, podemos evaluar pequeños cambios en la función de regresión como: \\[ \\frac{\\partial \\mathrm{E}~y}{\\partial x_1} = \\frac{\\partial}{\\partial x_1} \\left(\\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_1 x_2 \\right) = \\beta_1 + \\beta_3 x_2 . \\] De esta manera, podemos permitir funciones más complicadas de \\(x_1\\) y \\(x_2\\). La Figura 3.6 ilustra esta estructura compleja. A partir de esta figura y los cálculos anteriores, vemos que los cambios parciales de \\(\\mathrm{E}~y\\) debido al movimiento de \\(x_1\\) dependen del valor de \\(x_2\\). De esta manera, decimos que los cambios parciales debidos a cada variable no son independientes, sino que “se mueven juntos.” Figura 3.6: Gráfico de \\(\\mathrm{E}~y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_1 x_2\\) versus \\(x_1\\) y \\(x_2\\). De manera más general, un término de interacción es una variable que se crea como una función no lineal de dos o más variables explicativas. Estos términos especiales, aunque nos permiten explorar una familia rica de funciones no lineales, pueden considerarse casos especiales del modelo de regresión lineal. Para hacer esto, simplemente creamos la variable de interés y tratamos este nuevo término como otra variable explicativa. Por supuesto, no todas las variables que creamos serán útiles. En algunos casos, la variable creada será tan similar a las variables ya presentes en nuestro modelo que no nos proporcionará nueva información. Afortunadamente, podemos usar pruebas \\(t\\) para verificar si la nueva variable es útil. Además, el Capítulo 4 presentará una prueba para decidir si un grupo de variables es útil. La función que usamos para crear una variable de interacción debe ser más que una combinación lineal de otras variables explicativas. Por ejemplo, si usamos \\(x_3 = x_1 + x_2\\), no podremos estimar todos los parámetros. El Capítulo 5 presentará algunas técnicas para ayudar a evitar situaciones en las que una variable es una combinación lineal de las demás. Para darles una idea de la amplia variedad de aplicaciones potenciales de variables explicativas especiales, ahora presentamos una serie de ejemplos breves. Ejemplo: Seguro de Vida a Término - Continuación. ¿Cómo interpretamos la interacción de una variable binaria con una variable continua? Para ilustrar, consideremos un modelo de regresión para Seguro de Vida a Término, \\[ \\mathrm{LNFACE} = \\beta_0 + \\beta_1 \\mathrm{LNINCOME} + \\beta_2 \\mathrm{SINGLE} + \\beta_3 \\mathrm{LNINCOME*SINGLE} + \\varepsilon . \\] En este modelo, hemos creado una tercera variable explicativa a través de la interacción de LNINCOME y SINGLE. La función de regresión se puede escribir como: \\[ \\mathrm{E}~y = \\begin{cases} \\beta_0 + \\beta_1 \\mathrm{LNINCOME}, &amp; \\text{para otros encuestados}, \\\\ \\beta_0 + \\beta_2 + (\\beta_1 + \\beta_3) \\mathrm{LNINCOME}, &amp; \\text{para encuestados solteros}. \\end{cases} \\] Así, a través de este único modelo con cuatro parámetros, podemos crear dos líneas de regresión separadas, una para los solteros y otra para los demás. La Figura 3.7 muestra las dos líneas de regresión ajustadas para nuestros datos. Figura 3.7: Gráfico de LNFACE versus LNINCOME, con el código de letra S para solteros y o para otros. Las líneas de regresión ajustadas han sido superpuestas. La línea inferior es para solteros y la línea superior es para otros. Ejemplo: Gastos de Compañías de Seguros de Vida. En una industria de seguros de vida bien desarrollada, minimizar los gastos es crucial para la posición competitiva de una compañía. Segal (2002) analizó datos contables anuales de más de 100 empresas para el período 1995-1998, inclusive, utilizando una base de datos de la Asociación Nacional de Comisionados de Seguros (NAIC) y otra información reportada. Segal modeló los gastos generales de la compañía como una función de la producción de la empresa y el precio de los insumos. La producción consiste en la producción de seguros, medida por \\(x_1\\) a \\(x_5\\), descritos en Tabla 3.10. Segal también consideró el cuadrado de cada salida, así como un término de interacción con una variable binaria \\(D\\) que indica si la empresa utiliza o no una sucursal para distribuir sus productos. (En una sucursal, los gerentes de campo son empleados de la empresa, no agentes independientes.) Tabla 3.10.Veintitrés Coeficientes de Regresión de un Modelo de Costos de Gastos \\[ \\small{ \\begin{array}{l|rrrr} \\hline &amp; \\text{Variable} &amp; &amp;\\text{Variable}&amp;\\text{ Cuadrada} \\\\ &amp; \\text{Base} &amp; \\text{Interacción} &amp; \\text{Base} &amp; \\text{Interacción} \\\\ &amp; &amp; \\text{con}~~ &amp; &amp; \\text{con}~~ \\\\ \\text{Variable} &amp; (D=0) &amp; (D=1) &amp; (D=0) &amp; (D=1)\\\\ \\hline \\text{Número de Pólizas de Vida Emitidas } (x_1) &amp; -0.454 &amp; 0.152 &amp; 0.032 &amp; -0.007 \\\\ \\text{Cantidad de Seguro de Vida a Término Vendido } (x_2) &amp; 0.112 &amp; -0.206 &amp; 0.002 &amp; 0.005 \\\\ \\text{Cantidad de Seguro de Vida Entera Vendido } (x_3) &amp; -0.184 &amp; 0.173 &amp; 0.008 &amp; -0.007 \\\\ \\text{Total de Consideraciones de Anualidades } (x_4) &amp; 0.098 &amp; -0.169 &amp; -0.003 &amp; 0.009 \\\\ \\text{Total de Primas de Accidentes y Salud } (x_5) &amp;-0.171 &amp; 0.014 &amp; 0.010 &amp; 0.002 \\\\ \\text{Intercepto } &amp; 7.726 &amp; &amp; &amp; \\\\ \\text{Precio del Trabajo (PL)} &amp; 0.553 &amp; &amp; &amp; \\\\ \\text{Precio del Capital (PC)} &amp; 0.102 &amp; &amp; &amp; \\\\ \\hline \\end{array} \\\\ \\begin{array}{l} \\textit{Nota: } x_1 \\text{ a } x_5 \\text{ están en unidades logarítmicas}.\\\\ \\textit{Fuente: Segal (2002)} \\end{array} } \\] Para los insumos de precios, el precio del trabajo (\\(PL\\)) se define como el costo total de empleados y agentes dividido por su número, en unidades logarítmicas. El precio del capital (\\(PC\\)) se aproxima por la relación del gasto en capital con el número de empleados y agentes, también en unidades logarítmicas. El precio de los materiales consiste en gastos distintos al trabajo y al capital divididos por el número de pólizas vendidas y terminadas durante el año. No aparece directamente como una variable explicativa. Más bien, Segal tomó la variable dependiente (\\(y\\)) como los gastos totales de la compañía divididos por el precio de los materiales, nuevamente en unidades logarítmicas. Con estas definiciones de variables, Segal estimó la siguiente función de regresión: \\[ \\mathrm{E~}y=\\beta_0 + \\sum_{j=1}^5 \\left( \\beta_j x_j + \\beta_{j+5} D x_j + \\beta_{j+10} x_j^2 + \\beta_{j+15}D x_j^2 \\right) + \\beta_{21} PL + \\beta_{22} PC. \\] Las estimaciones de los parámetros aparecen en Tabla 3.10. Por ejemplo, el cambio marginal en \\(\\mathrm{E}~y\\) por unidad de cambio en \\(x_1\\) es: \\[ \\frac{\\partial ~ \\mathrm{E}~y}{\\partial x_1}= \\beta_1 + \\beta_{6} D + 2 \\beta_{11} x_1 + 2 \\beta_{16}D x_1, \\] que se estima como \\(-0.454 + 0.152 D + (0.064 - 0.014 D) x_1\\). Para estos datos, el número mediano de pólizas emitidas fue \\(x_1=15,944\\). En este valor de \\(x_1\\), el cambio marginal estimado es \\(-0.454 + 0.152 D + (0.064 - 0.014 D) \\mathrm{ln}(15944) = 0.165 + 0.017 D,\\) o 0.165 para la base \\((D=0)\\) y 0.182 para compañías de sucursales \\((D=1)\\). Estas estimaciones son elasticidades, como se define en la Sección 3.2.2. Para interpretar estos coeficientes más a fondo, dejemos que \\(COST\\) represente los gastos generales totales de la compañía y \\(NUMPOL\\) represente el número de pólizas de vida emitidas. Entonces, para compañías de sucursales \\((D=1)\\), tenemos: \\[ 0.182 \\approx \\frac{\\partial y }{\\partial x_1 } = \\frac{\\partial ~ \\mathrm{ln}~COST}{\\partial ~ \\mathrm{ln}~NUMPOL}= \\frac{ \\frac{\\partial ~ COST}{\\partial ~NUMPOL}} {\\frac{COST}{NUMPOL}}, \\] o \\(\\frac{\\partial ~ COST}{\\partial ~NUMPOL} \\approx 0.182 \\frac{COST}{NUMPOL}\\). El costo mediano es $15,992,000, por lo que el costo marginal por póliza en estos valores medianos es \\(0.182 \\times (15992000/15944) =\\) $182.55. Caso Especial: Funciones de Respuesta Curvilíneas Podemos expandir las funciones polinómicas de una variable explicativa para incluir varias variables explicativas. Por ejemplo, la respuesta esperada, o función de respuesta, para un modelo de segundo orden con dos variables explicativas es: \\[ \\mathrm{E} y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_{11} x_1^2 + \\beta_{22} x_2^2 + \\beta_{12} x_1 x_2. \\] La Figura 3.8 ilustra esta función de respuesta. De manera similar, la función de respuesta para un modelo de segundo orden con tres variables explicativas es: \\[ \\mathrm{E} y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_3 + \\beta_{11} x_1^2 + \\beta_{22} x_2^2 + \\beta_{33} x_3^2 + \\beta_{12} x_1 x_2 + \\beta_{13} x_1 x_3 + \\beta_{23} x_2 x_3. \\] Cuando hay más de una variable explicativa, los modelos de tercer orden y de órdenes superiores rara vez se utilizan en aplicaciones. Figura 3.8: Gráfico de \\(\\mathrm{E}~y = \\beta_0 + \\beta_1~x_1 + \\beta_2~x_2 + \\beta_{11}~x_1^2 + \\beta_{22}~x_2^2 + \\beta_{12}~x_1~x_2\\) versus \\(x_1\\) y \\(x_2\\). Código R para producir la Figura 3.8 # FIGURA 3.8 X1 &lt;- seq(3, 16, length=15) X2 &lt;- seq(5, 15, length=15) f &lt;- function(X1,X2) {y &lt;- 50 + 2*X1 + 3*X2 + 3*(X1-10)*(X2-10)- .4*(X1-10)^2+.4*(X2-10)^2} y &lt;- outer(X1, X2, f) par(mar=c(0,2.1,0,.1)) persp(X1, X2, y, theta = 30, phi = 30, expand = 0.5, ticktype=&quot;detailed&quot;) Caso Especial: Funciones No Lineales de una Variable Continua En algunas aplicaciones, esperamos que la respuesta tenga cambios abruptos en el comportamiento en ciertos valores de una variable explicativa, incluso si la variable es continua. Por ejemplo, supongamos que estamos tratando de modelar las contribuciones benéficas de un individuo (\\(y\\)) en función de sus ingresos (\\(x\\)). Para los datos de 2007, un modelo simple que podríamos considerar es el que se muestra en la Figura 3.9. Figura 3.9: El cambio marginal en \\(\\mathrm{E}~y\\) es menor por debajo de $97,500. El parámetro \\(\\beta_2\\) representa la diferencia en las pendientes. Código R para producir la Figura 3.9 # FIGURA 3.9 x &lt;- seq(90000,105000,20) Ey &lt;- 20 + 1*x + 2*(x-97500)*(x&gt;97500) par(mar=c(4.1,3.1,.1,1), cex=1.3) plot(x,Ey, type=&quot;l&quot;,yaxt=&quot;n&quot;, ylab=&quot;&quot;, las=1) mtext(&quot;E y&quot;, side=2,las=1, line=1.5,cex=1.1) text(102000,102000,expression(beta[1]+beta[2]),cex=1.1) text(94000,92000,expression(beta[1]),cex=1.1) Una justificación para este modelo es que, en 2007, los individuos pagaban un 7.65% de sus ingresos en impuestos de Seguridad Social hasta $97,500. No se aplican impuestos de Seguridad Social a los ingresos que superan los $97,500. Así, una teoría es que, para los ingresos superiores a $97,500, los individuos tienen más ingresos disponibles por dólar y, por lo tanto, deberían estar más dispuestos a hacer contribuciones benéficas. Para modelar esta relación, definamos la variable binaria \\(z\\) que sea cero si \\(x &lt; 97,500\\) y uno si \\(x \\ge 97,500\\). Definamos la función de regresión como \\(\\mathrm{E}~y = \\beta_0 + \\beta_1 x + \\beta_2 z (x - 97,500)\\). Esto se puede escribir como: \\[ \\mathrm{E}~y = \\begin{cases} \\beta_0 + \\beta_1 x &amp; x &lt; 97,500 \\\\ \\beta_0 - \\beta_2(97,500) + (\\beta_1+\\beta_2) x &amp; x \\geq 97,500 \\end{cases} \\] Para estimar este modelo, realizaríamos una regresión de \\(y\\) sobre dos variables explicativas, \\(x_1 = x\\) y \\(x_2 = z \\times (x - 97,500)\\). Si \\(\\beta_2 &gt; 0\\), entonces la tasa marginal de contribuciones benéficas es mayor para ingresos que superan los $97,500. La Figura 3.9 ilustra esta relación, conocida como regresión lineal por tramos o a veces un modelo de “barra rota”. El cambio abrupto en la Figura 3.9 en \\(x = 97,500\\) se llama “cambio de pendiente”. Tenemos relaciones lineales por encima y por debajo del cambio de pendiente y hemos usado una variable binaria para unir las dos partes. No estamos restringidos a un solo cambio de pendiente. Por ejemplo, supongamos que deseamos hacer un estudio histórico de los ingresos gravables federales para los contribuyentes solteros de 1992. Entonces, había tres tramos impositivos: la tasa marginal por debajo de 21,450 era del 15%, por encima de 51,900 era del 31%, y en medio era del 28%. Para este ejemplo, usaríamos dos cambios de pendiente, en 21,450 y 51,900. Además, la regresión lineal por tramos no está restringida a funciones de respuesta continuas. Por ejemplo, supongamos que estamos estudiando las comisiones pagadas a los corredores de bolsa (\\(y\\)) en función del número de acciones compradas por un cliente (\\(x\\)). Podríamos esperar ver la relación ilustrada en la Figura 3.10. Aquí, la discontinuidad en \\(x = 100\\) refleja los gastos administrativos de comerciar en lotes irregulares, ya que se llaman transacciones de menos de 100 acciones. El menor costo marginal para transacciones superiores a 100 acciones simplemente refleja las economías de escala al hacer negocios en volúmenes mayores. Un modelo de regresión para esto es \\(\\mathrm{E}~y = \\beta_0 + \\beta_1 x + \\beta_2 z + \\beta_3 z x\\) donde \\(z = 0\\) si \\(x &lt; 100\\) y \\(z = 1\\) si \\(x \\geq 100\\). La función de regresión representada en la Figura 3.10 es: \\[ \\mathrm{E}~y = \\begin{cases} \\beta_0 + \\beta_1 x_1 &amp; x &lt; 100 \\\\ \\beta_0 + \\beta_2 + (\\beta_1+\\beta_3) x_1 &amp; x \\geq 100 \\end{cases} \\] Figura 3.10: Gráfico de comisiones esperadas (\\(\\mathrm{E}~y\\)) versus número de acciones negociadas (\\(x\\)). El cambio en \\(x=100\\) refleja ahorros en gastos administrativos. La pendiente más baja para \\(x \\ge 100\\) refleja economías de escala en gastos. Código R para producir la Figura 3.10 # FIGURA 3.10 par(mar=c(4.1,4.5,.1,.1)) x &lt;- seq(50,150,.1) Ey &lt;- 20 + 2*x - 1*(x-100)*(x&gt;100) - 20*(x&gt;100) plot(x,Ey, type=&quot;p&quot;,ylab=&quot;&quot;, font.lab=1, cex.lab=1.1, cex=.25, las=1) mtext(&quot;E y&quot;, side=2,las=1, line=2.8,cex=1.1) 3.6 Lectura Adicional y Referencias Para las pruebas de los resultados del Capítulo 3, remitimos al lector a Goldberger (1991). Los modelos de regresión no lineales se discuten, por ejemplo, en Bates y Watts (1988). El Capítulo 3 ha introducido los fundamentos de la regresión lineal múltiple. El Capítulo 4 ampliará el alcance al introducir variables categóricas y métodos de inferencia estadística para manejar varios coeficientes simultáneamente. El Capítulo 5 presentará técnicas para ayudarte a seleccionar variables apropiadas en un modelo de regresión lineal múltiple. El Capítulo 6 es un capítulo de síntesis, que discute la interpretación del modelo, la selección de variables y la recolección de datos. Referencias del Capítulo Bates, Douglas M. y Watts, D. G. (1988). Nonlinear Regression Analysis and its Applications. John Wiley &amp; Sons, Nueva York. Lemaire, Jean (2002). Why do females live longer than males? North American Actuarial Journal, 6(4), 21-37. Goldberger, Arthur (1991). A Course in Econometrics. Harvard University Press, Cambridge. Plackett, R.L. (1960). Regression Analysis. Clarendon Press, Oxford, Inglaterra. Segal, Dan (2002). An economic analysis of life insurance company expenses. North American Actuarial Journal, 6(4), 81-94. 3.7 Ejercicios 3.1. Considera un conjunto de datos ficticio de \\(n = 100\\) observaciones con \\(s_y = 100\\). Realizamos una regresión con tres variables explicativas para obtener \\(s = 50\\). Calcula el coeficiente de determinación ajustado, \\(R_a^2\\). Completa la tabla de ANOVA. \\[ \\small{ \\begin{array}{|l|l|c|l|} \\hline \\text{Tabla de ANOVA} \\\\ \\hline \\text{Fuente} &amp; \\text{Suma de Cuadrados} &amp; \\text{df} &amp; \\text{Cuadrado Medio} \\\\ \\hline \\text{Regresión} &amp; &amp; &amp; \\\\ \\text{Error} &amp; &amp; &amp; \\\\ \\text{Total} &amp; &amp; &amp; \\\\ \\hline \\end{array} } \\] Calcula el coeficiente de determinación (no ajustado), \\(R^2\\). 3.2. Considera un conjunto de datos ficticio de \\(n = 100\\) observaciones con \\(s_y = 80\\). Realizamos una regresión con tres variables explicativas para obtener \\(s = 50\\). También obtenemos \\[ \\small{ \\left(\\mathbf{X^{\\prime} X} \\right)^{-1} = \\begin{pmatrix} 100 &amp; 20 &amp; 20 &amp; 20 \\\\ 20 &amp; 90 &amp; 30 &amp; 40 \\\\ 20 &amp; 30 &amp; 80 &amp; 50 \\\\ 20 &amp; 40 &amp; 50 &amp; 70 \\\\ \\end{pmatrix}. } \\] Determina el error estándar de \\(b_3\\), \\(se(b_3)\\). Determina la covarianza estimada entre \\(b_2\\) y \\(b_3\\). Determina la correlación estimada entre \\(b_2\\) y \\(b_3\\). Determina la varianza estimada de \\(4b_2 + 3b_3\\). 3.3. Considera el siguiente pequeño conjunto de datos ficticio. Ajustarás un modelo de regresión a \\(y\\) usando dos variables explicativas, \\(x_1\\) y \\(x_2\\). \\[ \\small{ \\begin{array}{c|cccc} \\hline i &amp; 1 &amp; 2 &amp; 3 &amp; 4 \\\\ \\hline x_{i,1} &amp; -1 &amp; 2 &amp; 4 &amp; 6 \\\\ x_{i,2} &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\\\ y_i &amp; 0 &amp; 1 &amp; 5 &amp; 8 \\\\ \\hline \\end{array} } \\] A partir del modelo de regresión ajustado, tenemos \\(s = 1.373\\) y \\[ \\small{ \\mathbf{b} = \\begin{pmatrix} 0.1538 \\\\ 0.6923 \\\\ 2.8846 \\end{pmatrix} ~~~\\text{y}~~~ \\left(\\mathbf{X^{\\prime} X} \\right)^{-1} = \\begin{pmatrix} 0.53846 &amp; -0.07692 &amp; -0.15385 \\\\ -0.07692 &amp; 0.15385 &amp; -0.69231 \\\\ -0.15385 &amp; -0.69231 &amp; 4.11538 \\\\ \\end{pmatrix}. } \\] Escribe el vector de variables dependientes, \\(\\mathbf{y}\\), y la matriz de variables explicativas, \\(\\mathbf{X}\\). Determina el valor numérico para \\(\\widehat{y}_3\\), el valor ajustado para la tercera observación. Determina el valor numérico para \\(se(b_2)\\). Determina el valor numérico para \\(t(b_1)\\). 3.4. Lotería de Wisconsin. La Sección 2.1 describió una muestra de \\(n=50\\) áreas geográficas (códigos postales) que contenían datos de ventas de la lotería estatal de Wisconsin (\\(y = \\text{SALES}\\)). En esa sección, las ventas se analizaron usando un modelo de regresión lineal básico con \\(x = \\text{POP}\\), la población del área, como la variable explicativa. Este ejercicio amplía ese análisis al introducir variables explicativas adicionales dadas en la Tabla 3.11. \\[ \\text{Tabla 3.11: Características de lotería, económicas y demográficas de cincuenta códigos postales de Wisconsin} \\] \\[ \\small{ \\begin{array}{ll} \\hline \\textbf{Características de la lotería} \\\\ \\hline \\text{SALES} &amp; \\text{Ventas de lotería en línea a consumidores individuales} \\\\ \\hline \\textbf{Características económicas y } \\\\ ~~~~~\\textbf{demográficas} \\\\\\hline \\text{PERPERHH} &amp; \\text{Personas por hogar} \\\\ \\text{MEDSCHYR} &amp; \\text{Años medianos de escolaridad} \\\\ \\text{MEDHVL} &amp; \\text{Valor medianos de viviendas en \\$1000s para viviendas ocupadas por sus propietarios} \\\\ \\text{PRCRENT} &amp; \\text{Porcentaje de viviendas ocupadas por arrendatarios} \\\\ \\text{PRC55P} &amp; \\text{Porcentaje de la población que tiene 55 años o más} \\\\ \\text{HHMEDAGE} &amp; \\text{Edad mediana del hogar} \\\\ \\text{MEDINC} &amp; \\text{Ingreso mediano estimado del hogar, en \\$1000s} \\\\ \\text{POP} &amp; \\text{Población} \\\\ \\hline \\end{array} } \\] Produce una tabla de estadísticas descriptivas para todas las variables. Un código postal (observación 11, código = 53211, Shorewood Wisconsin, un suburbio de Milwaukee) parece tener valores inusualmente grandes de MEDSCHYR y MEDHVL. Para esta observación, ¿cuántas desviaciones estándar está el valor de MEDSCHYR por encima de la media? Para esta observación, ¿cuántas desviaciones estándar está el valor de MEDHVL por encima de la media? Produce una tabla de correlaciones. ¿Cuáles son las tres variables más correlacionadas con SALES? Produce una matriz de gráficos de dispersión de todas las variables explicativas y SALES. En el gráfico de MEDSCHYR versus SALES, describe la posición de la observación 11. Ajusta un modelo lineal de SALES en las ocho variables explicativas. Resume el ajuste de este modelo citando la desviación estándar de los residuos, \\(s\\), el coeficiente de determinación, \\(R^2\\) y su versión ajustada, \\(R_a^2\\). Basado en el ajuste del modelo de la parte (d), ¿es MEDSCHYR una variable estadísticamente significativa? Para responder a esta pregunta, utiliza una prueba formal de hipótesis. Expón tus hipótesis nula y alternativa, criterio de decisión y regla de decisión. Ahora ajusta un modelo más parsimonioso, usando SALES como variable dependiente y MEDSCHYR, MEDHVL y POP como variables explicativas. Resume el ajuste de este modelo citando la desviación estándar de los residuos, \\(s\\), el coeficiente de determinación, \\(R^2\\) y su versión ajustada, \\(R_a^2\\). ¿Cómo se comparan estos valores con el ajuste del modelo en la parte (d)? Observa que el signo del coeficiente de regresión asociado con MEDSCHYR es negativo. Para ayudar a interpretar este coeficiente, calcula el coeficiente de correlación parcial correspondiente. ¿Cuál es la interpretación de este coeficiente? Para obtener más información sobre la relación entre MEDSCHYR y SALES, produce un gráfico de variable añadida controlando los efectos de MEDHVL y POP. Verifica que la correlación asociada con este gráfico concuerde con tu respuesta en la parte (g). Vuelve a ejecutar la regresión en la parte (f), después de eliminar la observación 11. Cita las estadísticas descriptivas básicas de esta regresión. Para este ajuste del modelo, ¿es MEDSCHYR una variable estadísticamente significativa? Para responder a esta pregunta, utiliza una prueba formal de hipótesis. Expón tus hipótesis nula y alternativa, criterio de decisión y regla de decisión. Vuelve a ejecutar la regresión en la parte (f), después de eliminar la observación 9. Cita las estadísticas descriptivas básicas de esta regresión. 3.5. Gastos de Compañías de Seguros. Este ejercicio considera los datos de compañías de seguros del NAIC y descritos en el Ejercicio 1.6. La Tabla 3.10 describe varias variables que pueden ser usadas para explicar los gastos. Al igual que en el estudio de Segal (2002) sobre los aseguradores de vida, los “outputs” de la empresa consisten en primas emitidas (para propiedad y accidentes, estas se subdividen en líneas personales y comerciales) así como pérdidas (subdivididas en líneas de corto y largo plazo). ASSETS y CASH son medidas comúnmente usadas del tamaño de una empresa. GROUP, STOCK y MUTUAL describen la estructura organizacional. Los “inputs” de la empresa se recopilaron del Bureau of Labor Statistics (BLS, del programa Occupational Employee Statistics). STAFFWAGE se calcula como el salario promedio en el estado donde está ubicada la compañía de seguros. AGENTWAGE se calcula como el salario promedio ponderado de la industria de corretaje, ponderado por el porcentaje de prima bruta escrita en cada estado. Tabla 3.10: Variables de Gastos de Aseguradoras Variable Descripción EXPENSES Gastos totales incurridos, en millones de dólares LOSSLONG Pérdidas incurridas para líneas de largo plazo, en millones de dólares LOSSSHORT Pérdidas incurridas para líneas de corto plazo, en millones de dólares GPWPERSONAL Prima bruta emitida para líneas personales, en millones de dólares GPWCOMM Prima bruta emitida para líneas comerciales, en millones de dólares ASSETS Activos netos admitidos, en millones de dólares CASH Efectivo y activos invertidos, en millones de dólares GROUP Indica si la empresa está afiliada STOCK Indica si la empresa es una compañía de acciones MUTUAL Indica si la empresa es una compañía mutua STAFFWAGE Salario promedio anual del personal administrativo de la aseguradora, en miles de dólares AGENTWAGE Salario promedio anual del agente de seguros, en miles de dólares Una inspección preliminar de los datos mostró que muchas empresas no informaron pérdidas de seguros en 2005. Para este ejercicio, consideramos las 384 compañías con algunas pérdidas en el archivo NAICExpense.csv. Produce estadísticas descriptivas de la variable de respuesta y las variables explicativas (no binarias). Nota el patrón de sesgo para cada variable. Observa que muchas variables tienen valores negativos. Transforma cada variable no binaria mediante la transformación logarítmica modificada, \\(\\ln(1+x)\\). Produce estadísticas descriptivas de estas variables explicativas no binarias modificadas. Denota LNEXPENSES (\\(= \\ln(1+\\text{EXPENSES})\\)) como la variable de gastos modificada. Para el análisis posterior, usa solo las variables modificadas descritas en la parte (b). Produce una tabla de correlaciones para las variables no binarias. ¿Cuáles son las tres variables más correlacionadas con LNEXPENSES? Proporciona un diagrama de caja de LNEXPENSES por nivel de GROUP. ¿Qué nivel de grupo tiene mayores gastos? Ajusta un modelo lineal de LNEXPENSES en las once variables explicativas. Resume el ajuste de este modelo citando la desviación estándar de los residuos, \\(s\\), el coeficiente de determinación, \\(R^2\\), y su versión ajustada, \\(R^2_a\\). Ajusta un modelo lineal de LNEXPENSES en un modelo reducido usando ocho variables explicativas, eliminando LNCASH, STOCK y MUTUAL. Para las variables explicativas, incluye ASSETS, GROUP, ambas versiones de pérdidas y primas brutas, así como las dos variables del BLS. f(i). Resume el ajuste de este modelo citando \\(s\\), \\(R^2\\), y \\(R^2_a\\). f(ii). Interpreta el coeficiente asociado con las primas brutas comerciales en la escala logarítmica. f(iii). Supón que GPWCOMM aumenta en $1, ¿cuánto esperamos que aumenten los EXPENSES? Usa tu respuesta en la parte f(ii) y los valores medianos de GPWCOMM y EXPENSES para esta pregunta. Eleva al cuadrado cada una de las dos variables de pérdidas y las dos de primas brutas. Ajusta un modelo lineal de LNEXPENSES en un modelo reducido usando doce variables explicativas, las ocho variables de la parte (f) y los cuatro términos cuadrados adicionales que acabas de crear. g(i). Resume el ajuste de este modelo citando \\(s\\), \\(R^2\\), y \\(R^2_a\\). g(ii). ¿Los términos cuadráticos parecen ser variables explicativas útiles? Ahora omite las dos variables del BLS, por lo que estás ajustando un modelo de LNEXPENSES en ASSETS, GROUP, ambas versiones de pérdidas y primas brutas, así como términos cuadráticos. Resume el ajuste de este modelo citando \\(s\\), \\(R^2\\), y \\(R^2_a\\). Comenta sobre el número de observaciones usadas para ajustar este modelo comparado con la parte (f). Términos de Interacción Elimina los términos cuadráticos de la parte (g) y agrega términos de interacción con la variable ficticia GROUP. Así, ahora hay once variables: ASSETS, GROUP, ambas versiones de pérdidas y primas brutas, así como interacciones de GROUP con ASSETS y ambas versiones de pérdidas y primas brutas. i(i). Resume el ajuste de este modelo citando \\(s\\), \\(R^2\\), y \\(R^2_a\\). i(ii). Supón que GPWCOMM aumenta en $1, ¿cuánto esperamos que aumenten los EXPENSES para las compañías GROUP=0? Usa los valores medianos de GPWCOMM y EXPENSES de las compañías GROUP=0 para esta pregunta. i(iii). Supón que GPWCOMM aumenta en $1, ¿cuánto esperamos que aumenten los EXPENSES para las compañías GROUP=1? Usa los valores medianos de GPWCOMM y EXPENSES de las compañías GROUP=1 para esta pregunta. 3.6 Expectativas de Vida Nacionales. Continuamos el análisis iniciado en los Ejercicios 1 y 2. Ahora ajusta un modelo de regresión en LIFEEXP usando tres variables explicativas: FERTILITY, PUBLICEDUCATION y lnHEALTH (la transformación logarítmica natural de PRIVATEHEALTH). Interpreta el coeficiente de regresión asociado con PUBLICEDUCATION. Interpreta el coeficiente de regresión asociado con los gastos en salud sin usar la escala logarítmica para los gastos. Basado en el ajuste del modelo, ¿es PUBLICEDUCATION una variable estadísticamente significativa? Para responder a esta pregunta, usa una prueba formal de hipótesis. Expón tus hipótesis nula y alternativa, criterio de decisión, y regla de decisión. El signo negativo del coeficiente de PUBLICEDUCATION es sorprendente, dado que el signo de la correlación entre PUBLICEDUCATION y LIFEEXP es positivo y la intuición sugiere una relación positiva. Para verificar este resultado, aparece un gráfico de variable añadida en la Figura 3.11. d(i). Para un gráfico de variable añadida, describe su propósito y un método para producirlo. d(ii). Calcula la correlación correspondiente al gráfico de variable añadida que aparece en la Figura 3.11. Figura 3.11: Gráfico de variable añadida de PUBLICEDUCATION versus LIFEEXP, controlando por FERTILITY y lnHEALTH Código R para producir la Figura 3.11 # FIGURA 3.11 LifeExp &lt;- read.csv(&quot;CSVData/UNLifeExpectancy.csv&quot;, header=TRUE) # ELIMINAR LIFEEXPs MISSING LifeExp3 &lt;- subset(LifeExp, !is.na(LIFEEXP) ) varLife &lt;- c(&quot;FERTILITY&quot;,&quot;PUBLICEDUCATION&quot;, &quot;REGION&quot;,&quot;COUNTRY&quot;,&quot;LIFEEXP&quot;, &quot;HEALTHEXPEND&quot;) LifeExp4 &lt;- LifeExp3[varLife] LifeExp4$lnHEALTH &lt;- log(LifeExp4$HEALTHEXPEND) LifeExp4.good &lt;- na.omit(LifeExp4) # GRÁFICO DE VARIABLE AÑADIDA model4a &lt;- lm(LIFEEXP ~ FERTILITY+lnHEALTH, data=LifeExp4.good) model4b &lt;- lm(PUBLICEDUCATION ~ FERTILITY+lnHEALTH, data=LifeExp4.good) plot(residuals(model4b),residuals(model4a), xlab=&quot;residuos(PUBLICEDUCATION)&quot;,ylab=&quot;residuos(LIFEEXP)&quot;) "],["C4MLRANOVA.html", "Chapter 4 Regresión Lineal Múltiple - II 4.1 El Papel de las Variables Binarias 4.2 Inferencia Estadística para Varios Coeficientes 4.3 Modelo ANOVA de Un Factor 4.4 Combinando Variables Explicativas Categóricas y Continuas 4.5 Lecturas Adicionales y Referencias 4.6 Ejercicios 4.7 Suplemento Técnico - Expresiones Matriciales", " Chapter 4 Regresión Lineal Múltiple - II Vista previa del capítulo. Este capítulo amplía la discusión sobre la regresión lineal múltiple al introducir la inferencia estadística para manejar varios coeficientes simultáneamente. Para motivar esta extensión, este capítulo considera los coeficientes asociados con variables categóricas. Estas variables nos permiten agrupar observaciones en distintas categorías. Este capítulo muestra cómo incorporar variables categóricas en funciones de regresión utilizando variables binarias, ampliando así considerablemente el alcance de las posibles aplicaciones del análisis de regresión. La inferencia estadística para varios coeficientes permite a los analistas tomar decisiones sobre variables categóricas, así como otras aplicaciones importantes. Las variables explicativas categóricas también proporcionan la base para un modelo de ANOVA, un tipo especial de modelo de regresión que permite un análisis e interpretación más sencillos. 4.1 El Papel de las Variables Binarias Las variables categóricas proporcionan etiquetas para observaciones, para denotar la pertenencia a grupos o categorías distintas. Una variable binaria es un caso especial de una variable categórica. Para ilustrar, una variable binaria puede indicarnos si alguien tiene o no seguro de salud. Una variable categórica podría indicarnos si alguien tiene: seguro privado grupal (ofrecido por empleadores y asociaciones), seguro privado individual (a través de compañías de seguros), seguro público (como Medicare o Medicaid), sin seguro de salud. Para las variables categóricas, puede o no existir un orden de los grupos. En el caso del seguro de salud, es difícil ordenar estas cuatro categorías y decir cuál es “mayor”: seguro privado grupal, seguro privado individual, seguro público o sin seguro de salud. En contraste, para la educación, podríamos agrupar a las personas en “baja,” “intermedia,” y “alta” según sus años de educación. En este caso, hay un orden entre los grupos basado en el nivel de logro educativo. Como veremos, este orden puede o no proporcionar información sobre la variable dependiente. Factor es otro término utilizado para una variable explicativa categórica no ordenada. Para las variables categóricas ordenadas, los analistas suelen asignar una puntuación numérica a cada resultado y tratar la variable como si fuera continua. Por ejemplo, si tuviéramos tres niveles de educación, podríamos emplear rangos y usar: \\[ \\small{ \\text{EDUCATION} = \\begin{cases} 1 &amp; \\text{para educación baja} \\\\ 2 &amp; \\text{para educación intermedia} \\\\ 3 &amp; \\text{para educación alta.} \\end{cases} } \\] Una alternativa sería utilizar una puntuación numérica que se aproxime a un valor subyacente de la categoría. Por ejemplo, podríamos usar: \\[ \\small{ \\text{EDUCATION} = \\begin{cases} 6 &amp; \\text{para educación baja} \\\\ 10 &amp; \\text{para educación intermedia} \\\\ 14 &amp; \\text{para educación alta.} \\end{cases} } \\] Esto da el número aproximado de años de escolaridad que completaron las personas en cada categoría. La asignación de puntuaciones numéricas y el tratamiento de la variable como continua tiene implicaciones importantes para la interpretación en la modelización de regresión. Recordemos que el coeficiente de regresión es el cambio marginal en la respuesta esperada; en este caso, el \\(\\beta\\) para EDUCATION evalúa el incremento en \\(\\mathrm{E }~y\\) por unidad de cambio en EDUCATION. Si registramos EDUCATION como un rango en un modelo de regresión, entonces el \\(\\beta\\) para EDUCATION corresponde al incremento en \\(\\mathrm{E }~y\\) al pasar de EDUCATION=1 a EDUCATION=2 (de baja a intermedia); este incremento es el mismo que al pasar de EDUCATION=2 a EDUCATION=3 (de intermedia a alta). ¿Queremos modelar este incremento como igual? Esta es una suposición que el analista hace con esta codificación de EDUCATION; puede ser o no válida, pero ciertamente necesita ser reconocida. Debido a esta interpretación de los coeficientes, los analistas rara vez usan rangos u otras puntuaciones numéricas para resumir variables categóricas no ordenadas. La forma más directa de manejar factores en la regresión es mediante el uso de variables binarias. Una variable categórica con \\(c\\) niveles puede representarse utilizando \\(c\\) variables binarias, una para cada categoría. Por ejemplo, supongamos que no estábamos seguros de la dirección del efecto de la educación y decidimos tratarla como un factor. Entonces, podríamos codificar \\(c=3\\) variables binarias: (1) una variable para indicar educación baja, (2) una para indicar educación intermedia, y (3) una para indicar educación alta. Estas variables binarias son a menudo conocidas como variables ficticias. En el análisis de regresión con un término de intercepción, utilizamos solo \\(c-1\\) de estas variables binarias; la variable restante entra implícitamente a través del término de intercepción. Al identificar una variable como un factor, la mayoría de los paquetes de software estadístico crearán automáticamente variables binarias para usted. A través del uso de variables binarias, no utilizamos el orden de las categorías dentro de un factor. Debido a que no se hace ninguna suposición sobre el orden de las categorías, para el ajuste del modelo no importa qué variable se omita con respecto al ajuste del modelo. Sin embargo, sí importa para la interpretación de los coeficientes de regresión. Consideremos el siguiente ejemplo. Ejemplo: Seguro de Vida Temporal - Continuado. Ahora volvemos al estado civil de los encuestados de la Encuesta de Finanzas del Consumidor (SCF). Recordemos que el estado civil no se mide de manera continua, sino que toma valores que caen en grupos distintos que tratamos como no ordenados. En el Capítulo 3, agrupamos a los encuestados según si eran o no “solteros”, donde ser soltero incluye nunca haberse casado, estar separado, divorciado, viudo, y no casado pero viviendo con una pareja. Ahora complementamos esto al considerar la variable categórica, MARSTAT, que representa el estado civil del encuestado. Esto puede ser: 1, para casado 2, para viviendo con una pareja 0, para otro (SCF desglosa aún más esta categoría en separado, divorciado, viudo, nunca casado, inaplicable, personas de 17 años o menos, y sin más personas). Como antes, la variable dependiente es \\(y =\\) LNFACE, la cantidad que la compañía pagará en caso de fallecimiento del asegurado nombrado (en dólares logarítmicos). La Tabla 4.1 resume la variable dependiente según el nivel de la variable categórica. Esta tabla muestra que el estado civil “casado” es el más prevalente en la muestra y que los casados eligen tener la mayor cobertura de seguro de vida. La Figura 4.1 da una visión más completa de la distribución de LNFACE para cada uno de los tres tipos de estado civil. La tabla y la figura también sugieren que aquellos que viven juntos tienen menos cobertura de seguro de vida que las otras dos categorías. Tabla 4.1: Estadísticas Resumidas de Logaritmo del Monto de Cobertura por Estado Civil MARSTAT Número Media Desviación Estándar Otro 0 57 10.958 1.566 Casado 1 208 12.329 1.822 Viviendo juntos 2 10 10.825 2.001 Total 275 11.990 1.871 Figura 4.1: Diagramas de Caja del Logaritmo del Monto de Cobertura, por Nivel de Estado Civil Código R para Producir la Tabla 4.1 y la Figura 4.1 tableout &lt;- data.frame( MARSTAT &lt;- c(0,1,2,&quot;&quot;), Número &lt;- c(57, 208, 10, 275), Media &lt;- c(10.958, 12.329, 10.825, 11.990), Desviación_Estándar &lt;- c(1.566, 1.822, 2.001, 1.871) ) colnames(tableout) &lt;- c(&quot;MARSTAT&quot;, &quot;Número&quot;, &quot;Media&quot;, &quot;Desviación Estándar&quot;) rownames(tableout) &lt;- c(&quot;Otro&quot;, &quot;Casado&quot;, &quot;Viviendo juntos&quot;, &quot;Total&quot;) TableGen1(TableData=tableout , TextTitle=&#39;Estadísticas Resumidas de Logaritmo del Monto de Cobertura por Estado Civil&#39;, Align=&#39;crrr&#39;, Digits=3, ColumnSpec=1:3, ColWidth = ColWidth4) %&gt;% kableExtra::column_spec(1, width = &quot;4cm&quot;) library(HH) Term &lt;- read.csv(&quot;CSVData/TermLife.csv&quot;, header=TRUE) Term2 &lt;- subset(Term, FACE &gt; 0) LNFACE &lt;- log(Term2$FACE) LNINCOME &lt;- log(Term2$INCOME) MAR0 &lt;- 1*(Term2$MARSTAT == 0) # FIGURA 4.1 par(mar=c(4.1,4,1,1), cex=1.1) boxplot(LNFACE ~ MARSTAT, data=Term2, ylab=&quot;&quot;, xlab=&quot;Estado Civil&quot;) mtext(&quot;LNFACE&quot;, side=2, at=17.2, las=1, cex=1.1, adj=.4) ¿Son las variables continuas y categóricas determinantes importantes de la respuesta? Para responder a esto, se realizó una regresión usando LNFACE como respuesta y cinco variables explicativas: tres continuas y dos binarias (para el estado civil). Recordemos que nuestras tres variables explicativas continuas son: LNINCOME (ingreso anual logarítmico), el número de años de EDUCATION del encuestado, y el número de miembros del hogar, NUMHH. Para las variables binarias, primero definimos MAR0 como la variable binaria que toma el valor de uno si MARSTAT=0 y cero en caso contrario. De manera similar, definimos MAR1 y MAR2 como variables binarias que indican si MARSTAT=1 y MARSTAT=2, respectivamente. Existe una dependencia lineal perfecta entre estas tres variables binarias, ya que MAR0 + MAR1 + MAR2 = 1 para cualquier encuestado. Por lo tanto, solo necesitamos dos de las tres. Sin embargo, no hay una dependencia perfecta entre cualquiera de dos de las tres. Resulta que cor(MAR0, MAR1) = -0.90, cor(MAR0, MAR2) = -0.10, y cor(MAR1, MAR2) = -0.34. Se realizó un modelo de regresión utilizando LNINCOME, EDUCATION, NUMHH, MAR0, y MAR2 como variables explicativas. La ecuación de regresión ajustada resulta ser: \\[ \\small{ \\widehat{y} = 3.395 + 0.452 \\text{ LNINCOME} + 0.205 \\text{ EDUCATION} + 0.248 \\text{ NUMHH} - 0.557 \\text{ MAR0} - 0.789 \\text{ MAR2}. } \\] Para interpretar los coeficientes de regresión asociados con el estado civil, consideremos un encuestado que está casado. En este caso, MAR0=0, MAR1=1, y MAR2=0, de manera que: \\[ \\small{ \\widehat{y}_m = 3.395 + 0.452 \\text{ LNINCOME} + 0.205 \\text{ EDUCATION} + 0.248 \\text{ NUMHH}. } \\] De manera similar, si el encuestado es codificado como viviendo juntos, entonces MAR0=0, MAR1=0, y MAR2=1, y: \\[ \\small{ \\widehat{y}_{lt} = 3.395 + 0.452 \\text{ LNINCOME} + 0.205 \\text{ EDUCATION} + 0.248 \\text{ NUMHH} - 0.789. } \\] La diferencia entre \\(\\widehat{y}_m\\) y \\(\\widehat{y}_{lt}\\) es \\(0.789.\\) Así, podemos interpretar el coeficiente de regresión asociado con MAR2, \\(-0.789\\), como la diferencia en los valores ajustados para alguien que vive juntos en comparación con una persona similar que está casada (la categoría omitida). De manera similar, podemos interpretar \\(-0.557\\) como la diferencia entre la categoría “otro” y la categoría de casados, manteniendo fijas las otras variables explicativas. Para la diferencia en los valores ajustados entre las categorías “otro” y “viviendo juntos”, podemos usar \\(-0.557 - (-0.789) = 0.232.\\) Aunque la regresión se realizó utilizando MAR0 y MAR2, cualquier dos de las tres producirían la misma Tabla ANOVA (Tabla 4.2). Sin embargo, la elección de las variables binarias sí afecta los coeficientes de regresión. La Tabla 4.3 muestra tres modelos, omitiendo MAR1, MAR2, y MAR0, respectivamente. Para cada ajuste, los coeficientes asociados con las variables continuas permanecen iguales. Como hemos visto, las interpretaciones de las variables binarias son con respecto a la categoría omitida, conocida como el nivel de referencia. Aunque cambian de un modelo a otro, su interpretación general sigue siendo la misma. Es decir, si queremos estimar la diferencia en la cobertura entre la categoría “otro” y la categoría “viviendo juntos”, la estimación sería \\(0.232\\), sin importar el modelo. Tabla 4.2: Seguro de Vida Temporal con Estado Civil - Tabla ANOVA Fuente Suma de Cuadrados \\(df\\) Cuadrado Medio Regresión 343.28 5 68.66 Error 615.62 269 2.29 Total 948.90 274 Aunque los tres modelos en la Tabla 4.3 son iguales excepto por diferentes elecciones de parámetros, parecen diferentes. En particular, los \\(t\\)-ratios difieren y muestran diferentes apariencias de significancia estadística. Por ejemplo, ambos \\(t\\)-ratios asociados con el estado civil en el Modelo 2 son menores que 2 en valor absoluto, lo que sugiere que el estado civil es poco importante. En contraste, tanto el Modelo 1 como el Modelo 3 tienen al menos una variable binaria de estado civil que supera 2 en valor absoluto, lo que sugiere significancia estadística. Por lo tanto, se puede influir en la apariencia de significancia estadística al alterar la elección del nivel de referencia. Para evaluar la importancia general del estado civil (no solo cada variable binaria), la Sección 4.2 introducirá pruebas de conjuntos de coeficientes de regresión. Tabla 4.3: Coeficientes de Regresión del Seguro de Vida Temporal con Estado Civil Coeficiente Modelo 1 Modelo 1 \\(t\\)-Ratio Coeficiente Modelo 2 Modelo 2 \\(t\\)-Ratio Coeficiente Modelo 3 Modelo 3 \\(t\\)-Ratio LNINCOME 0.452 5.74 0.452 5.74 0.452 5.74 EDUCATION 0.205 5.3 0.205 5.3 0.205 5.3 NUMHH 0.248 3.57 0.248 3.57 0.248 3.57 Intercepto 3.395 3.77 3.395 2.74 2.838 3.34 MAR0 -0.557 -2.15 0.232 0.44 MAR1 0.789 1.59 0.557 2.15 MAR2 -0.789 -1.59 -0.232 -0.44 Ejemplo: ¿Cómo afecta el Compartir Costos en Planes de Seguro Médico a los Gastos en Salud? En uno de los muchos estudios que resultaron del Experimento de Seguro de Salud de Rand (HIE) introducido en la Sección 1.5, Keeler y Rolph (1988) investigaron los efectos del compartir costos en los planes de seguro médico. Para este estudio, 14 planes de seguro médico fueron agrupados por la tasa de coaseguro (el porcentaje pagado como gastos de bolsillo que variaba en 0, 25, 50 y 95%). Uno de los planes con 95% limitaba los gastos anuales de bolsillo en atención ambulatoria a 150 por persona (450 por familia), proporcionando en efecto un deducible ambulatorio individual. Este plan se analizó como un grupo separado, de manera que había \\(c=5\\) categorías de planes de seguro. En la mayoría de los estudios de seguros, los individuos eligen planes de seguro, lo que hace difícil evaluar los efectos del compartir costos debido a la selección adversa. La selección adversa puede surgir porque los individuos con mala salud crónica son más propensos a elegir planes con menos compartir costos, lo que da la apariencia de que menos cobertura conduce a mayores gastos. En el HIE de Rand, los individuos fueron asignados aleatoriamente a los planes, eliminando así esta fuente potencial de sesgo. Keeler y Rolph (1988) organizaron los gastos de un individuo en episodios de tratamiento; cada episodio contiene gastos asociados con un determinado ataque de enfermedad, condición crónica o procedimiento. Los episodios se clasificaron como hospitalarios, dentales o ambulatorios; esta clasificación se basó principalmente en diagnósticos, no en la ubicación de los servicios. Así, por ejemplo, los servicios ambulatorios que preceden o siguen a una hospitalización, así como los medicamentos y pruebas relacionados, se incluyeron como parte de un episodio hospitalario. Para simplificar, aquí solo informamos resultados para episodios hospitalarios. Aunque las familias fueron asignadas aleatoriamente a los planes, Keeler y Rolph (1988) utilizaron métodos de regresión para controlar los atributos de los participantes y aislar los efectos del compartir costos en los planes. La Tabla 4.4 resume los coeficientes de regresión, basados en una muestra de \\(n=1,967\\) gastos por episodio. En esta regresión, el gasto logarítmico fue la variable dependiente. La variable categórica de compartir costos se descompuso en cinco variables binarias para que no se impusiera ninguna forma funcional en la respuesta al seguro. Estas variables son “Co-ins25,” “Co-ins50,” y “Co-ins95,” para tasas de coaseguro del 25, 50 y 95%, respectivamente, y “Deducible Indiv” para el plan con deducibles individuales. La variable omitida es el plan de seguro gratuito con 0% de coaseguro. El HIE se llevó a cabo en seis ciudades; una variable categórica para controlar la ubicación se representó con cinco variables binarias, Dayton, Fitchburg, Franklin, Charleston y Georgetown, siendo Seattle la variable omitida. Se utilizó un factor categórico con \\(c=6\\) niveles para la edad y el sexo; las variables binarias en el modelo consistieron en “Edad 0-2,” “Edad 3-5,” “Edad 6-17,” “Mujer edad 18-65,” y “Hombre edad 46-65,” siendo la categoría omitida “Hombre edad 18-45.” Otras variables de control incluyeron una escala de estado de salud, el estado socioeconómico, el número de visitas médicas en el año anterior al experimento en una escala logarítmica y la raza. La Tabla 4.4 resume los efectos de las variables. Como señalaron Keeler y Rolph, hubo grandes diferencias según la ubicación y la edad, aunque la regresión solo explicó \\(R^2=11\\%\\) de la variabilidad. Para las variables de compartir costos, solo “Co-ins95” fue estadísticamente significativa, y esto solo al nivel del 5%, no al nivel del 1%. El estudio de Keeler y Rolph (1988) examina otros tipos de gastos por episodio, así como la frecuencia de los gastos. Concluyeron que el compartir costos en los planes de seguro médico tiene poco efecto sobre la cantidad de gastos por episodio, aunque hay diferencias importantes en la frecuencia de episodios. Esto se debe a que un episodio de tratamiento está compuesto por dos decisiones. La cantidad de tratamiento es decidida conjuntamente entre el paciente y el médico y, en gran medida, no se ve afectada por el tipo de plan de seguro médico. La decisión de buscar tratamiento médico la toma el paciente; este proceso de toma de decisiones es más susceptible a los incentivos económicos en los aspectos de compartir costos de los planes de seguro médico. Tabla 4.4: Coeficientes de Gastos por Episodio del Rand HIE Variable Coeficiente de Regresión Variable Coeficiente de Regresión Intercepto 7.95 Dayton 0.13* Co-ins25 0.07 Fitchburg 0.12 Co-ins50 0.02 Franklin -0.01 Co-ins95 -0.13* Charleston 0.20* Deducible Indiv -0.03 Georgetown -0.18* Escala de Salud -0.02* Edad 0-2 -0.63** Estado Socioeconómico 0.03 Edad 3-5 -0.64** Visitas Médicas -0.03 Edad 6-17 -0.30** Examen -0.10* Mujer edad 18-65 0.11 Negro 0.14* Hombre edad 46-65 0.26 Nota: * significativo al 5%, ** significativo al 1% Fuente: Keeler y Rolph (1988) 4.2 Inferencia Estadística para Varios Coeficientes Puede ser útil examinar varios coeficientes de regresión al mismo tiempo. Por ejemplo, cuando se evalúa el efecto de una variable categórica con \\(c\\) niveles, necesitamos decir algo de manera conjunta sobre las \\(c-1\\) variables binarias que ingresan a la ecuación de regresión. Para hacer esto, la Sección 4.2.1 introduce un método para manejar combinaciones lineales de coeficientes de regresión. La Sección 4.2.2 muestra cómo probar varias combinaciones lineales, y la Sección 4.2.3 presenta otras aplicaciones de inferencia. 4.2.1 Conjuntos de Coeficientes de Regresión Recordemos que nuestros coeficientes de regresión se especifican como \\(\\boldsymbol{\\beta} = \\left( \\beta_0, \\beta_1, \\ldots, \\beta_k \\right)^{\\prime},\\) un vector de tamaño \\((k+1) \\times 1\\). Será conveniente expresar combinaciones lineales de los coeficientes de regresión utilizando la notación \\(\\mathbf{C} \\boldsymbol{\\beta},\\) donde \\(\\mathbf{C}\\) es una matriz de tamaño \\(p \\times (k+1)\\) que es especificada por el usuario y depende de la aplicación. Algunas aplicaciones involucran la estimación de \\(\\mathbf{C} \\boldsymbol{\\beta}\\). Otras involucran probar si \\(\\mathbf{C} \\boldsymbol{\\beta}\\) es igual a un valor específico conocido (denotado como \\(\\mathbf{d}\\)). Llamamos a \\(H_0:\\mathbf{C \\boldsymbol{\\beta} = d}\\) la hipótesis lineal general. Para demostrar la amplia variedad de aplicaciones en las que se pueden usar conjuntos de coeficientes de regresión, ahora presentamos una serie de casos especiales. Caso Especial 1: Un Coeficiente de Regresión. En la Sección 3.4, investigamos la importancia de un solo coeficiente, digamos \\(\\beta_j\\). Podemos expresar este coeficiente como \\(\\mathbf{C} \\boldsymbol{\\beta}\\) eligiendo \\(p=1\\) y \\(\\mathbf{C}\\) como un vector de \\(1 \\times (k+1)\\) con un uno en la columna \\((j+1)\\) y ceros en las demás posiciones. Estas elecciones resultan en \\[ \\mathbf{C \\boldsymbol{\\beta} =} \\left( 0~\\ldots~0~1~0~\\ldots~0\\right) \\left( \\begin{array}{c} \\beta_0 \\\\ \\vdots \\\\ \\beta_k \\end{array} \\right) = \\beta_j. \\] Caso Especial 2: Función de Regresión. Aquí, elegimos \\(p=1\\) y \\(\\mathbf{C}\\) como un vector de \\(1 \\times (k+1)\\) que representa la transpuesta de un conjunto de variables explicativas. Estas elecciones resultan en \\[ \\mathbf{C \\boldsymbol{\\beta} =} \\left( x_0, x_1, \\ldots, x_k \\right) \\left( \\begin{array}{c} \\beta_0 \\\\ \\vdots \\\\ \\beta_k \\end{array} \\right) = \\beta_0 x_0 + \\beta_1 x_1 + \\ldots + \\beta_k x_k = \\mathrm{E}~y, \\] que es la función de regresión. Caso Especial 3: Combinación Lineal de Coeficientes de Regresión. Cuando \\(p=1\\), usamos la convención de que las letras en minúscula en negrita son vectores y tomamos \\(\\mathbf{C = c^{\\prime}} = \\left( c_0, \\ldots, c_k \\right)^{\\prime}\\). En este caso, \\(\\mathbf{C} \\boldsymbol{\\beta}\\) es una combinación lineal genérica de los coeficientes de regresión \\[ \\mathbf{C} \\boldsymbol{\\beta} = \\mathbf{c}^{\\prime} {\\boldsymbol \\beta} = c_0 \\beta_0 + \\ldots + c_k \\beta_k . \\] Caso Especial 4: Prueba de Igualdad de Coeficientes de Regresión. Supongamos que el interés radica en probar \\(H_0: \\beta_1 = \\beta_2\\). Para este propósito, tomamos \\(p=1\\), \\(\\mathbf{c}^{\\prime} = \\left( 0, 1, -1, 0, \\ldots, 0\\right)\\), y \\(\\mathbf{d} = 0\\). Con estas elecciones, tenemos \\[ \\mathbf{C \\boldsymbol{\\beta} = c^{\\prime} \\boldsymbol{\\beta} =} \\left( 0, 1, -1, 0, \\ldots, 0\\right) \\left( \\begin{array}{c} \\beta_0 \\\\ \\vdots \\\\ \\beta_k \\end{array} \\right) = \\beta_1 - \\beta_2 = 0, \\] de modo que la hipótesis lineal general se reduce a \\(H_0: \\beta_1 = \\beta_2\\). Caso Especial 5: Adecuación del Modelo. Es costumbre en el análisis de regresión presentar una prueba de si alguna de las variables explicativas es útil para explicar la respuesta. Formalmente, esto es una prueba de la hipótesis nula \\(H_0:\\beta_1=\\beta_2=\\ldots=\\beta_k=0\\). Es importante notar que, como convención, no se prueba si el intercepto es cero. Para probar esto usando la hipótesis lineal general, elegimos \\(p=k\\), \\(\\mathbf{d}=\\left( 0~\\ldots~0\\right)^{\\prime}\\) como un vector de tamaño \\(k \\times 1\\) lleno de ceros y \\(\\mathbf{C}\\) como una matriz de tamaño \\(k \\times (k+1)\\) tal que \\[ \\small{ \\mathbf{C \\boldsymbol{\\beta} =}\\left( \\begin{array}{ccccc} 0 &amp; 1 &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 1 \\end{array} \\right) \\left( \\begin{array}{c} \\beta_0 \\\\ \\vdots \\\\ \\beta_k \\end{array} \\right) =\\left( \\begin{array}{c} \\beta_1 \\\\ \\vdots \\\\ \\beta_k \\end{array} \\right) =\\left( \\begin{array}{c} 0 \\\\ \\vdots \\\\ 0 \\end{array} \\right) =\\mathbf{d}. } \\] Caso Especial 6: Prueba de Partes del Modelo. Supongamos que estamos interesados en comparar una función de regresión completa \\[ \\mathrm{E~}y = \\beta_0 + \\beta_1 x_1 +\\ldots + \\beta_k x_k + \\beta_{k+1} x_{k+1} + \\ldots + \\beta_{k+p} x_{k+p} \\] con una función de regresión reducida, \\[ \\mathrm{E~}y = \\beta_0 + \\beta_1 x_1 + \\ldots + \\beta_k x_k. \\] Comenzando con la regresión completa, vemos que si se cumple la hipótesis nula \\(H_0:\\beta_{k+1} = \\ldots = \\beta_{k+p} = 0\\), entonces llegamos a la regresión reducida. Para ilustrar, las variables \\(x_{k+1}, \\ldots, x_{k+p}\\) pueden referirse a varias variables binarias que representan una variable categórica y nuestro interés radica en si la variable categórica es importante. Para probar la importancia de la variable categórica, queremos ver si las variables binarias \\(x_{k+1}, \\ldots, x_{k+p}\\) afectan conjuntamente a las variables dependientes. Para probar esto utilizando la hipótesis lineal general, elegimos \\(\\mathbf{d}\\) y \\(\\mathbf{C}\\) tal que \\[ \\small{ \\mathbf{C \\boldsymbol{\\beta} =}\\left( \\begin{array}{ccccccc} 0 &amp; \\cdots &amp; 0 &amp; 1 &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; \\cdots &amp; 0 &amp; 0 &amp; 1 &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; \\cdots &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 1 \\end{array} \\right) \\left( \\begin{array}{c} \\beta_0 \\\\ \\vdots \\\\ \\beta_k \\\\ \\beta_{k+1} \\\\ \\vdots \\\\ \\beta_{k+p} \\end{array} \\right) =\\left( \\begin{array}{c} \\beta_{k+1} \\\\ \\vdots \\\\ \\beta_{k+p} \\end{array} \\right) =\\left( \\begin{array}{c} 0 \\\\ \\vdots \\\\ 0 \\end{array} \\right) =\\mathbf{d}. } \\] De una lista de \\(k+p\\) variables \\(x_1, \\ldots, x_{k+p}\\), puedes eliminar cualquier \\(p\\) que consideres apropiado. Las variables adicionales no necesitan ser las últimas \\(p\\) en la especificación de la regresión. Eliminar \\(x_{k+1}, \\ldots, x_{k+p}\\) es solo por conveniencia notacional. 4.2.2 La Hipótesis Lineal General Para resumir, la hipótesis lineal general se puede expresar como \\(H_0:\\mathbf{C \\boldsymbol{\\beta} = d}\\). Aquí, \\(\\mathbf{C}\\) es una matriz de \\(p \\times (k+1)\\), \\(\\mathbf{d}\\) es un vector de \\(p \\times 1\\), y tanto \\(\\mathbf{C}\\) como \\(\\mathbf{d}\\) son especificados por el usuario y dependen de la aplicación en cuestión. Aunque \\(k+1\\) es el número de coeficientes de regresión, \\(p\\) es el número de restricciones bajo \\(H_0\\) sobre estos coeficientes. (Para aquellos lectores con conocimiento de álgebra matricial avanzada, \\(p\\) es el rango de \\(\\mathbf{C}\\)). Esta hipótesis nula se prueba contra la alternativa \\(H_a:\\mathbf{C \\boldsymbol{\\beta} \\neq d}\\). Esto puede ser obvio, pero requerimos que \\(p \\leq k+1\\) porque no podemos probar más restricciones que los parámetros libres. Para entender la base del procedimiento de prueba, primero recordemos algunas de las propiedades básicas de los estimadores de los coeficientes de regresión descritos en la Sección 3.3. Sin embargo, nuestro objetivo ahora es entender las propiedades de las combinaciones lineales de los coeficientes de regresión especificadas por \\(\\mathbf{C \\boldsymbol{\\beta}}\\). Un estimador natural de esta cantidad es \\(\\mathbf{Cb}\\). Es fácil ver que \\(\\mathbf{Cb}\\) es un estimador insesgado de \\(\\mathbf{C \\boldsymbol{\\beta}}\\), porque \\(\\mathrm{E~}\\mathbf{Cb = C}\\mathrm{E~}\\mathbf{b = C \\boldsymbol{\\beta}}\\). Además, la varianza es \\(\\mathrm{Var}\\left( \\mathbf{Cb}\\right) \\mathbf{= C}\\mathrm{Var}\\left( \\mathbf{b}\\right) \\mathbf{C}^{\\prime}\\) \\(=\\sigma^2 \\mathbf{C}\\left( \\mathbf{X^{\\prime}X}\\right)^{-1} \\mathbf{C}^{\\prime}\\). Para evaluar la diferencia entre \\(\\mathbf{d}\\), el valor hipotetizado de \\(\\mathbf{C \\boldsymbol{\\beta}}\\), y su valor estimado, \\(\\mathbf{Cb}\\), utilizamos la siguiente estadística: \\[ F-\\text{ratio}=\\frac{(\\mathbf{Cb-d)}^{\\prime}\\left( \\mathbf{C}\\left( \\mathbf{X^{\\prime}X} \\right)^{-1} \\mathbf{C}^{\\prime}\\right)^{-1}(\\mathbf{Cb-d)}}{ps_{full}^2}. \\tag{4.1} \\] Aquí, \\(s_{full}^2\\) es el error cuadrático medio del modelo de regresión completo. Usando la teoría de modelos lineales, se puede comprobar que la estadística \\(F\\)-ratio sigue una distribución \\(F\\) con grados de libertad del numerador \\(df_1=p\\) y grados de libertad del denominador \\(df_2=n-(k+1)\\). Tanto la estadística como la distribución teórica llevan el nombre de R. A. Fisher, un científico y estadístico renombrado que hizo mucho para avanzar la estadística como ciencia en la primera mitad del siglo XX. Al igual que la distribución normal y la distribución \\(t\\), la distribución \\(F\\) es una distribución continua. La distribución \\(F\\) es la distribución muestral para el \\(F\\)-ratio y es proporcional a la razón de dos sumas de cuadrados, cada una de las cuales es positiva o cero. Así, a diferencia de la distribución normal y la distribución \\(t\\), la distribución \\(F\\) solo toma valores no negativos. Recordemos que la distribución \\(t\\) está indexada por un único parámetro de grados de libertad. La distribución \\(F\\) está indexada por dos parámetros de grados de libertad: uno para el numerador, \\(df_1\\), y uno para el denominador, \\(df_2\\). El Apéndice A3.4 proporciona detalles adicionales. La estadística de prueba en la ecuación (4.1) es compleja en su forma. Afortunadamente, existe una alternativa que es más sencilla de implementar e interpretar; esta alternativa se basa en el principio de la suma de cuadrados adicional. Procedimiento para Probar la Hipótesis Lineal General Ejecuta la regresión completa y obtén la suma de cuadrados del error y el error cuadrático medio, los cuales etiquetamos como \\((Error~SS)_{full}\\) y \\(s_{full}^2\\), respectivamente. Considera el modelo asumiendo que la hipótesis nula es verdadera. Ejecuta una regresión con este modelo y obtén la suma de cuadrados del error, la cual etiquetamos como \\((Error~SS)_{reduced}\\). Calcula \\[ F-\\text{ratio}=\\frac{(Error~SS)_{reduced}-(Error~SS)_{full}}{ps_{full}^2}. \\tag{4.2} \\] Rechaza la hipótesis nula en favor de la alternativa si el \\(F\\)-ratio excede un valor \\(F\\). El valor \\(F\\) es un percentil de la distribución \\(F\\) con \\(df_1=p\\) y \\(df_2=n-(k+1)\\) grados de libertad. El percentil es uno menos el nivel de significancia de la prueba. Siguiendo nuestra notación con la distribución \\(t\\), denotamos este percentil como \\(F_{p,n-(k+1),1-\\alpha}\\), donde \\(\\alpha\\) es el nivel de significancia. Este procedimiento es comúnmente conocido como una prueba \\(F\\). La Sección 4.7.2 proporciona las bases matemáticas. Para entender el principio de la suma de cuadrados adicional, recordemos que la suma de cuadrados del error para el modelo completo se determina como el valor mínimo de \\[ SS(b_0^{\\ast}, \\ldots, b_k^{\\ast}) = \\sum_{i=1}^{n} \\left( y_i - \\left( b_0^{\\ast} + \\ldots + b_k^{\\ast} x_{i,k} \\right) \\right)^2. \\] Aquí, \\(SS(b_0^{\\ast}, \\ldots, b_k^{\\ast})\\) es una función de \\(b_0^{\\ast}, \\ldots, b_k^{\\ast}\\) y \\((Error~SS)_{full}\\) es el mínimo sobre todos los valores posibles de \\(b_0^{\\ast}, \\ldots, b_k^{\\ast}\\). De manera similar, \\((Error~SS)_{reduced}\\) es la mínima suma de cuadrados del error bajo las restricciones en la hipótesis nula. Debido a que hay menos posibilidades bajo la hipótesis nula, tenemos que \\[ (Error~SS)_{full} \\leq (Error~SS)_{reduced}. \\tag{4.3} \\] Para ilustrar, consideremos nuestro primer caso especial donde \\(H_0 : \\beta_j = 0\\). En este caso, la diferencia entre los modelos completo y reducido equivale a eliminar una variable. Una consecuencia de la ecuación (4.3) es que, al agregar variables a un modelo de regresión, la suma de cuadrados del error nunca aumenta (y, de hecho, generalmente disminuye). Por lo tanto, agregar variables a un modelo de regresión aumenta \\(R^2\\), el coeficiente de determinación. ¿Cuán grande debe ser una disminución en la suma de cuadrados del error para que sea estadísticamente significativa? Intuitivamente, se puede ver el cociente \\(F\\) como la diferencia en la suma de cuadrados del error dividida por el número de restricciones, \\(\\frac{(Error~SS)_{reduced}-(Error~SS)_{full}}{p}\\), y luego reescalada por la mejor estimación del término de varianza, el \\(s^2\\), del modelo completo. Bajo la hipótesis nula, esta estadística sigue una distribución \\(F\\) y podemos comparar la estadística de prueba con esta distribución para ver si es inusualmente grande. Usando la relación \\(Regression~SS = Total~SS - Error~SS\\), podemos re-expresar la diferencia en la suma de cuadrados del error como \\[ (Error~SS)_{reduced} - (Error~SS)_{full} = (Regression~SS)_{full} - (Regression~SS)_{reduced}. \\] Esta diferencia se conoce como una Suma de Cuadrados Tipo III. Al probar la importancia de un conjunto de variables explicativas, \\(x_{k+1}, \\ldots, x_{k+p}\\), en presencia de \\(x_1, \\ldots, x_k\\), encontrarás que muchos paquetes estadísticos calculan esta cantidad directamente en una sola ejecución de regresión. La ventaja de esto es que permite al analista realizar una prueba \\(F\\) usando una sola ejecución de regresión, en lugar de dos ejecuciones de regresión como en nuestro procedimiento de cuatro pasos descrito anteriormente. Ejemplo: Seguro de Vida Temporal - Continuación. Antes de discutir la lógica y las implicaciones de la prueba \\(F\\), vamos a ilustrar su uso. En el ejemplo del Seguro de Vida Temporal, supongamos que deseamos entender el impacto del estado civil. La Tabla 4.3 presentó un mensaje mixto en términos de cocientes \\(t\\); a veces eran estadísticamente significativos y otras veces no. Sería útil tener una prueba formal para dar una respuesta definitiva, al menos en términos de significancia estadística. Específicamente, consideramos un modelo de regresión utilizando LNINCOME, EDUCATION, NUMHH, MAR0, y MAR2 como variables explicativas. La ecuación del modelo es \\[ \\small{ \\begin{array}{ll} y &amp;= \\beta_0 + \\beta_1 \\text{LNINCOME} + \\beta_2 \\text{EDUCATION} + \\beta_3 \\text{NUMHH} \\\\ &amp; \\ \\ \\ \\ + \\beta_4 \\text{MAR0} + \\beta_5 \\text{MAR2}. \\end{array} } \\] Nuestro objetivo es probar \\(H_0: \\beta_4 = \\beta_5 = 0\\). Comenzamos ejecutando un modelo de regresión con todas las \\(k+p=5\\) variables. Los resultados se informaron en la Tabla 4.2, donde vimos que \\((Error~SS)_{full} = 615.62\\) y \\(s_{full}^2 = (1.513)^2 = 2.289\\). El siguiente paso es ejecutar el modelo reducido sin MAR0 y MAR2. Esto se hizo en la Tabla 3.3 del Capítulo 3, donde vimos que \\((Error~SS)_{reduced} = 630.43\\). Luego calculamos la estadística de prueba \\[ \\small{ F-\\text{ratio} = \\frac{(Error~SS)_{reduced} - (Error~SS)_{full}}{ps_{full}^2} = \\frac{630.43 - 615.62}{2 \\times 2.289} = 3.235. } \\] El cuarto paso compara la estadística de prueba con una distribución \\(F\\) con \\(df_1=p=2\\) y \\(df_2 = n-(k+p+1) = 269\\) grados de libertad. Usando un nivel de significancia del 5%, resulta que el percentil 95 es \\(F-\\text{ratio} \\approx 3.029\\). El valor \\(p\\) correspondiente es \\(\\Pr(F &gt; 3.235) = 0.0409\\). Al nivel de significancia del 5%, rechazamos la hipótesis nula \\(H_0: \\beta_4 = \\beta_5 = 0\\). Esto sugiere que es importante utilizar el estado civil para entender la cobertura de seguro de vida temporal, incluso en presencia de ingresos, educación y número de miembros del hogar. Algunos Casos Especiales La prueba de hipótesis lineales general está disponible cuando puedes expresar un modelo como un subconjunto de otro. Por esta razón, es útil pensar en ella como una herramienta para comparar modelos “más pequeños” con modelos “más grandes”. Sin embargo, el modelo más pequeño debe ser un subconjunto del modelo más grande. Por ejemplo, la prueba de hipótesis lineales general no se puede usar para comparar las funciones de regresión \\(\\mathrm{E~}y = \\beta_0 + \\beta_7 x_7\\) frente a \\(\\mathrm{E~}y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_3 + \\beta_4 x_4\\). Esto se debe a que la primera, función más pequeña, no es un subconjunto de la segunda, función más grande. La prueba de hipótesis lineales general se puede usar en muchas ocasiones, aunque no siempre es necesaria. Por ejemplo, supongamos que deseamos probar \\(H_0:\\beta_k=0\\). Ya hemos visto que esta hipótesis nula se puede examinar usando la prueba del cociente \\(t\\). En este caso especial, resulta que \\((t-\\textrm{ratio})^2=F-\\textrm{ratio}\\). Así, estas pruebas son equivalentes para probar \\(H_0:\\beta_k=0\\) frente a \\(H_a:\\beta_k \\neq 0\\). La prueba \\(F\\) tiene la ventaja de que funciona para más de un predictor, mientras que la prueba \\(t\\) tiene la ventaja de que se pueden considerar alternativas unilaterales. Por lo tanto, ambas pruebas son consideradas útiles. Dividiendo el numerador y el denominador de la ecuación (4.2) por \\(Total~SS\\), la estadística de prueba también se puede escribir como: \\[ F-\\textrm{ratio}=\\frac{\\left( R_{full}^2-R_{reduced}^2\\right) /p}{\\left( 1-R_{full}^2\\right) / (n-(k+1))}. \\tag{4.4} \\] La interpretación de esta expresión es que el cociente \\(F\\) mide la disminución en el coeficiente de determinación, \\(R^2\\). La expresión en la ecuación (4.4) es particularmente útil para probar la adecuación del modelo, nuestro Caso Especial 5. En este caso, \\(p=k\\), y la suma de cuadrados de regresión bajo el modelo reducido es cero. Así, tenemos \\[ \\small{ F-\\textrm{ratio}=\\frac{\\left( (Regression~SS)_{full}\\right) /k}{s_{full}^2} =\\frac{(Regression~MS)_{full}}{(Error~SS)_{full}}. } \\] Esta estadística de prueba es una característica regular de la tabla ANOVA para muchos paquetes estadísticos. Por ejemplo, en nuestro ejemplo de Seguro de Vida Temporal, probar la adecuación del modelo significa evaluar \\(H_0: \\beta_1 = \\beta_2 = \\beta_3 = \\beta_4 = \\beta_5 = 0\\). En la Tabla 4.2, el cociente \\(F\\) es 68.66 / 2.29 = 29.98. Con \\(df_1=5\\) y \\(df_2 = 269\\), el valor \\(F\\) es aproximadamente 2.248 y el valor \\(p\\) correspondiente es \\(\\Pr(F &gt; 29.98) \\approx 0\\). Esto nos lleva a rechazar firmemente la idea de que las variables explicativas no son útiles para entender la cobertura del seguro de vida temporal, reafirmando lo que aprendimos en el análisis gráfico y de correlación. Cualquier otro resultado sería sorprendente. Para otra expresión, dividiendo por \\(Total~SS\\), podemos escribir \\[ F-\\textrm{ratio}=\\frac{R^2}{1-R^2}\\frac{n-(k+1)}{k}. \\] Dado que tanto el cociente \\(F\\) como \\(R^2\\) son medidas del ajuste del modelo, parece intuitivamente plausible que estén relacionados de alguna manera. Una consecuencia de esta relación es que, a medida que \\(R^2\\) aumenta, también lo hace el cociente \\(F\\) y viceversa. El cociente \\(F\\) se usa porque su distribución muestral es conocida bajo una hipótesis nula, por lo que podemos hacer afirmaciones sobre significancia estadística. La medida \\(R^2\\) se usa debido a las interpretaciones fáciles asociadas con ella. 4.2.3 Estimando y Prediciendo Varios Coeficientes Estimación de Combinaciones Lineales de Coeficientes de Regresión En algunas aplicaciones, el principal interés es estimar una combinación lineal de los coeficientes de regresión. Para ilustrar, recordemos que en la Sección 3.5 desarrollamos una función de regresión para las contribuciones caritativas de un individuo (\\(y\\)) en términos de sus salarios (\\(x\\)). En esta función, hubo un cambio abrupto en la función en \\(x=97,500\\). Para modelarlo, definimos la variable binaria \\(z\\) para que sea cero si \\(x&lt;97,500\\) y uno si \\(x \\geq 97,500\\), y la función de regresión \\(\\mathrm{E~}y = \\beta_0 + \\beta_1 x + \\beta_2 z(x - 97,500)\\). Así, el cambio marginal esperado en las contribuciones por cambio en el salario para salarios superiores a \\(97,500\\) es \\(\\frac{\\partial \\left( \\mathrm{E~}y\\right)}{\\partial x} = \\beta_1 + \\beta_2\\). Para estimar \\(\\beta_1 + \\beta_2\\), un estimador razonable es \\(b_1 + b_2\\), el cual está disponible en el software estándar de regresión. Además, también nos gustaría calcular errores estándar para \\(b_1 + b_2\\) que se pueden utilizar, por ejemplo, para determinar un intervalo de confianza para \\(\\beta_1 + \\beta_2\\). Sin embargo, \\(b_1\\) y \\(b_2\\) suelen estar correlacionados, por lo que el cálculo del error estándar de \\(b_1 + b_2\\) requiere la estimación de la covarianza entre \\(b_1\\) y \\(b_2\\). La estimación de \\(\\beta_1 + \\beta_2\\) es un ejemplo de nuestro Caso Especial 3, que considera combinaciones lineales de coeficientes de regresión de la forma \\(\\mathbf{c}^{\\prime} \\boldsymbol \\beta = c_0 \\beta_0 + c_1 \\beta_1 + \\ldots + c_k \\beta_k\\). Para nuestro ejemplo de contribuciones caritativas, elegiríamos \\(c_1 = c_2 = 1\\) y los demás \\(c\\)’s igual a cero. Para estimar \\(\\mathbf{c}^{\\prime} \\boldsymbol \\beta\\), reemplazamos el vector de parámetros por el vector de estimadores y usamos \\(\\mathbf{c}^{\\prime} \\mathbf{b}\\). Para evaluar la fiabilidad de este estimador, como en la Sección 4.2.2, tenemos que \\(\\mathrm{Var}\\left( \\mathbf{c}^{\\prime} \\mathbf{b}\\right) = \\sigma^2 \\mathbf{c}^{\\prime}(\\mathbf{X^{\\prime} X})^{-1} \\mathbf{c}\\). Así, podemos definir la desviación estándar estimada, o error estándar, de \\(\\mathbf{c}^{\\prime} \\mathbf{b}\\) como \\[ se\\left( \\mathbf{c}^{\\prime} \\mathbf{b} \\right) = s \\sqrt{\\mathbf{c}^{\\prime} (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} \\mathbf{c}}. \\] Con esta cantidad, un intervalo de confianza del \\(100(1 - \\alpha) \\%\\) para \\(\\mathbf{c}^{\\prime} \\boldsymbol \\beta\\) es \\[ \\mathbf{c}^{\\prime} \\mathbf{b} \\pm t_{n - (k + 1), 1 - \\alpha / 2} ~ se(\\mathbf{c}^{\\prime} \\mathbf{b}). \\tag{4.5} \\] El intervalo de confianza en la ecuación (4.5) es válido bajo las Suposiciones F1-F5. Si elegimos que \\(\\mathbf{c}\\) tenga un “1” en la \\((j + 1)^{\\text{st}}\\) fila y ceros en los demás, entonces \\(\\mathbf{c}^{\\prime} \\boldsymbol \\beta = \\beta_j\\), \\(\\mathbf{c}^{\\prime} \\mathbf{b} = b_j\\), y \\[ se(b_j) = s \\sqrt{(j + 1)^{\\text{st}}~ \\textit{elemento diagonal de } (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1}}. \\] Por lo tanto, la ecuación (4.5) proporciona una base teórica para los intervalos de confianza de los coeficientes de regresión individuales introducidos en la ecuación (3.10) de la Sección 3.4 y lo generaliza a combinaciones lineales arbitrarias de los coeficientes de regresión. Otra aplicación importante de la ecuación (4.5) es la elección de \\(\\mathbf{c}\\) correspondiente a un conjunto de variables explicativas de interés, digamos, \\(\\mathbf{x}_{\\ast} = \\left( 1, x_{\\ast 1}, x_{\\ast 2}, \\ldots, x_{\\ast k} \\right)^{\\prime}\\). Estas pueden corresponder a una observación dentro del conjunto de datos o a un punto fuera de los datos disponibles. El parámetro de interés, \\(\\mathbf{c}^{\\prime} \\boldsymbol \\beta = \\mathbf{x}_{\\ast}^{\\prime} \\boldsymbol \\beta\\), es la respuesta esperada o la función de regresión en ese punto. Entonces, \\(\\mathbf{x}_{\\ast}^{\\prime} \\mathbf{b}\\) proporciona un estimador puntual y la ecuación (4.5) proporciona el intervalo de confianza correspondiente. Intervalos de Predicción La predicción es un objetivo inferencial que está estrechamente relacionado con la estimación de la función de regresión en un punto. Supongamos que, al considerar las contribuciones caritativas, conocemos los salarios de un individuo (y por lo tanto si los salarios superan los \\(97,500\\)) y deseamos predecir la cantidad de contribuciones caritativas. En general, asumimos que el conjunto de variables explicativas \\(\\mathbf{x}_{\\ast}\\) es conocido y deseamos predecir la respuesta correspondiente \\(y_{\\ast}\\). Esta nueva respuesta sigue las suposiciones descritas en la Sección 3.2. Específicamente, la respuesta esperada es \\(\\mathrm{E~}y_{\\ast} = \\mathbf{x}_{\\ast}^{\\prime} \\boldsymbol \\beta\\), \\(\\mathbf{x}_{\\ast}\\) es no estocástica, \\(\\mathrm{Var~}y_{\\ast} = \\sigma^2\\), \\(y_{\\ast}\\) es independiente de \\(\\{y_1, \\ldots, y_{n}\\}\\) y está distribuida normalmente. Bajo estas suposiciones, un intervalo de predicción del \\(100(1 - \\alpha)\\%\\) para \\(y_{\\ast}\\) es \\[ \\mathbf{x}_{\\ast}^{\\prime} \\mathbf{b} \\pm t_{n - (k + 1), 1 - \\alpha / 2} ~ s \\sqrt{1 + \\mathbf{x}_{\\ast}^{\\prime} (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} \\mathbf{x}_{\\ast}}. \\tag{4.6} \\] La ecuación (4.6) generaliza el intervalo de predicción introducido en la Sección 2.4. 4.3 Modelo ANOVA de Un Factor La Sección 4.1 mostró cómo incorporar variables categóricas no ordenadas, o factores, en un modelo de regresión lineal mediante el uso de variables binarias. Los factores son importantes en la investigación en ciencias sociales; pueden usarse para clasificar a las personas por género, etnia, estado civil, etc., o clasificar empresas por región geográfica, estructura organizativa, y así sucesivamente. En los estudios de seguros, las aseguradoras usan factores para categorizar a los asegurados según un “sistema de clasificación de riesgos.” Aquí, la idea es crear grupos de asegurados con características de riesgo similares que tendrán experiencias de reclamaciones similares. Estos grupos forman la base del precio del seguro, de modo que a cada asegurado se le cobra un monto adecuado a su categoría de riesgo. Este proceso a veces se conoce como “segmentación.” Aunque los factores pueden representarse como variables binarias en un modelo de regresión lineal, estudiamos los modelos de un factor como una unidad separada porque: El método de los mínimos cuadrados es mucho más simple, evitando la necesidad de invertir matrices de alta dimensión. Las interpretaciones resultantes de los coeficientes son más sencillas. El modelo de un factor sigue siendo un caso especial del modelo de regresión lineal. Por lo tanto, no se necesita teoría estadística adicional para establecer sus capacidades de inferencia estadística. Para establecer la notación para el modelo ANOVA de un factor, ahora consideramos el siguiente ejemplo. Ejemplo: Reclamaciones de Seguros de Automóviles. Examinamos la experiencia de reclamaciones de un gran asegurador de propiedades y accidentes del medio oeste de los Estados Unidos para seguros de automóviles particulares. La variable dependiente es la cantidad pagada en una reclamación cerrada, en dólares (reclamaciones que no se cerraron al final del año se manejan por separado). Las aseguradoras categorizan a los asegurados según un sistema de clasificación de riesgos. El sistema de clasificación de riesgos de esta aseguradora se basa en: Características del operador del automóvil (edad, género, estado civil y si es el conductor principal u ocasional de un automóvil). Características del vehículo (uso en la ciudad o en el campo, si el vehículo se usa para ir a la escuela o al trabajo, para negocios o placer, y si se usa para ir al trabajo, la distancia aproximada del trayecto). Estos factores se resumen en la variable categórica de clase de riesgo CLASS. La Tabla 4.5 muestra 18 clases de riesgo - no se proporciona información adicional de clasificación aquí para proteger los intereses propietarios de la aseguradora. La Tabla 4.5 resume los resultados de \\(n=6,773\\) reclamaciones para conductores de 50 años o más. Podemos ver que la reclamación mediana varía desde un mínimo de 707.40 (CLASE F7) hasta un máximo de 1,231.25 (CLASE C72). La distribución de las reclamaciones resulta ser asimétrica, por lo que consideramos \\(y\\) = reclamaciones logarítmicas. La tabla presenta medias, medianas y desviaciones estándar. Dado que la distribución de las reclamaciones logarítmicas es menos asimétrica, las medias están cerca de las medianas. La Figura 4.2 muestra la distribución de las reclamaciones logarítmicas por clase de riesgo. Tabla 4.5: Estadísticas Resumidas de Reclamaciones de Automóviles por Clase de Riesgo 1 2 3 4 5 6 Clase C1 C11 C1A C1B C1C C2 Número 726 1151 77 424 38 61 Mediana (dólares) 948.86 1,013.81 925.48 1,026.73 1,001.73 851.20 Mediana (en dólares log) 6.855 6.921 6.830 6.934 6.909 6.747 Media (en dólares log) 6.941 6.952 6.866 6.998 6.786 6.801 Desv. estándar (en dólares log) 1.064 1.074 1.072 1.068 1.110 0.948 Clase C6 C7 C71 C72 C7A C7B Número 911 913 1129 85 113 686 Mediana (dólares) 1,011.24 957.68 960.40 1,231.25 1,139.93 1,113.13 Mediana (en dólares log) 6.919 6.865 6.867 7.116 7.039 7.015 Media (en dólares log) 6.926 6.901 6.954 7.183 7.064 7.072 Desv. estándar (en dólares log) 1.115 1.058 1.038 0.988 1.021 1.103 Clase C7C F1 F11 F6 F7 F71 Número 81 29 40 157 59 93 Mediana (dólares) 1,200.00 1,078.04 774.79 1,105.04 707.40 1,118.73 Mediana (en dólares log) 7.090 6.983 6.652 7.008 6.562 7.020 Media (en dólares log) 7.244 7.004 6.804 6.910 6.577 6.935 Desv. estándar (en dólares log) 0.944 0.996 1.212 1.193 0.897 0.983 Figura 4.2: Diagramas de Caja de Reclamaciones Logarítmicas por Clase de Riesgo Código R para Producir la Tabla 4.5 y la Figura 4.2 AutoC &lt;- read.csv(&quot;CSVData/AutoClaims.csv&quot;, header=TRUE) # CREAR UNA TABLA DE MEDIAS Y DESVIACIONES ESTÁNDAR library(Hmisc) t1 &lt;- summarize(log(AutoC$PAID), AutoC$CLASS, length ) t2 &lt;- summarize(AutoC$PAID, AutoC$CLASS, median) t3 &lt;- summarize(log(AutoC$PAID), AutoC$CLASS, median) t4 &lt;- summarize(log(AutoC$PAID), AutoC$CLASS, mean) t5 &lt;- summarize(log(AutoC$PAID), AutoC$CLASS, sd) tablemat &lt;- cbind(t1, format(round(t2[2], digits = 2), big.mark = &#39;,&#39;), round(t3[2], digits = 3), round(t4[2], digits = 3), round(t5[2], digits = 3)) block1 &lt;- t(tablemat[1:6,]) block2 &lt;- t(tablemat[7:12,]) block3 &lt;- t(tablemat[13:18,]) bigblock &lt;- rbind(block1, block2, block3) temprow &lt;- c(&quot;Clase&quot;, &quot;Número&quot;, &quot;Mediana (dólares)&quot;, &quot;Mediana (en dólares log)&quot; ,&quot;Media (en dólares log)&quot;, &quot;Desv. estándar (en dólares log)&quot;) bigblock1 &lt;- cbind (c(temprow,temprow, temprow), bigblock) row.names(bigblock1) &lt;- NULL TableGen1(TableData=bigblock1 , TextTitle=&#39;Estadísticas Resumidas de Reclamaciones de Automóviles por Clase de Riesgo&#39;, Align=&#39;lrrrrrr&#39;, Digits=3, ColumnSpec=1:6, ColWidth = ColWidth4) %&gt;% kableExtra::column_spec(1, width = &quot;6cm&quot;) library(HH) AutoC &lt;- read.csv(&quot;CSVData/AutoClaims.csv&quot;, header=TRUE) # RECLAMACIONES DE AUTOMÓVILES # FIGURA 4.2 par(cex=0.6) boxplot(log(PAID) ~ CLASS,cex=.6, cex.labels=2, data = AutoC, xlab = &quot;&quot;, ylab = &quot;&quot;) Esta sección se centra en la clase de riesgo (CLASS) como la variable explicativa. Usamos la notación \\(y_{ij}\\) para referirnos a la \\(i\\)-ésima observación de la \\(j\\)-ésima clase de riesgo. Para la \\(j\\)-ésima clase de riesgo, asumimos que hay \\(n_j\\) observaciones. Existen \\(n=n_1+n_2+\\ldots +n_c\\) observaciones en total. Los datos son: \\[ \\begin{array}{cccccc} \\small{\\text{Datos para la clase de riesgo }}1 &amp; \\ \\ \\ \\ &amp; y_{11} &amp; y_{21} &amp; \\ldots &amp; y_{n_1,1} \\\\ \\small{\\text{Datos para la clase de riesgo }}2 &amp; &amp; y_{12} &amp; y_{22} &amp; \\ldots &amp; y_{n_2,1} \\\\ . &amp; &amp; . &amp; . &amp; \\ldots &amp; . \\\\ \\small{\\text{Datos para la clase de riesgo }} c &amp; &amp; y_{1c} &amp; y_{2c} &amp; \\ldots &amp; y_{n_c,c} \\end{array} \\] donde \\(c=18\\) es el número de niveles del factor CLASS. Debido a que cada nivel de un factor puede organizarse en una sola fila (o columna), otro término para este tipo de datos es una “clasificación de una vía.” Así, un modelo de una vía es otro término para un modelo de un factor. Una medida resumen importante para cada nivel del factor es el promedio de la muestra. Sea \\[ \\overline{y}_j=\\frac{1}{n_j}\\sum_{i=1}^{n_j}y_{ij} \\] el promedio de la \\(j\\)-ésima CLASS. Suposiciones del Modelo y Análisis La ecuación del modelo ANOVA de un factor es \\[ y_{ij}=\\mu_j+ \\varepsilon_{ij}\\ \\ \\ \\ \\ \\ i=1,\\ldots ,n_j,\\ \\ \\ \\ \\ j=1,\\ldots ,c. \\tag{4.7} \\] Al igual que con los modelos de regresión, se asume que las desviaciones aleatorias \\(\\{\\varepsilon_{ij} \\}\\) tienen una media cero con varianza constante (Suposición E3) y son independientes entre sí (Suposición E4). Dado que asumimos que el valor esperado de cada desviación es cero, tenemos \\(\\text{E}~y_{ij}=\\mu_j\\). Por lo tanto, interpretamos \\(\\mu_j\\) como el valor esperado de la respuesta \\(y_{ij}\\), es decir, la media \\(\\mu\\) varía según el nivel del factor \\(j\\). Para estimar los parámetros \\(\\{\\mu_j\\}\\), al igual que en la regresión, usamos el método de mínimos cuadrados, introducido en la Sección 2.1. Es decir, sea \\(\\mu^{\\ast}_j\\) una estimación “candidata” de \\(\\mu_j\\). La cantidad \\[ SS(\\mu^{\\ast}_1, \\ldots , \\mu^{\\ast}_{c}) = \\sum_{j=1}^{c} \\sum_{i=1}^{n_j} (y_{ij}-\\mu^{\\ast}_j)^2 \\] representa la suma de los cuadrados de las desviaciones de las respuestas respecto a estas estimaciones candidatas. A partir de algebra básica, el valor de \\(\\mu^{\\ast}_j\\) que minimiza esta suma de cuadrados es \\(\\bar{y}_j\\). Por lo tanto, \\(\\bar{y}_j\\) es la estimación por mínimos cuadrados de \\(\\mu_j\\). Para entender la confiabilidad de las estimaciones, podemos descomponer la variabilidad como en el caso de regresión, presentado en las Secciones 2.3.1 y 3.3. La suma mínima de los cuadrados de las desviaciones se llama suma de cuadrados del error y se define como \\[ Error ~SS = SS(\\bar{y}_1, \\ldots, \\bar{y}_{c}) = \\sum_{j=1}^{c} \\sum_{i=1}^{n_j} \\left(y_{ij}-\\bar{y}_j \\right)^2. \\] La variación total en el conjunto de datos se resume en la suma total de cuadrados, \\[ Total ~SS=\\sum_{j=1}^{c}\\sum_{i=1}^{n_j}(y_{ij}-\\bar{y})^2. \\] La diferencia, llamada suma de cuadrados del factor, se puede expresar como: \\[ \\begin{array}{ll} Factor~ SS &amp; = Total ~SS - Error ~SS \\\\ &amp; = \\sum_{j=1}^{c}\\sum_{i=1}^{n_j}(y_{ij}-\\bar{y})^2-\\sum_{j=1}^{c}\\sum_{i=1}^{n_j}(y_{ij}-\\bar{y}_j)^2 = \\sum_{j=1}^{c}\\sum_{i=1}^{n_j}(\\bar{y}_j-\\bar{y})^2 \\\\ &amp; = \\sum_{j=1}^{c}n_j(\\bar{y}_j-\\bar{y})^2. \\end{array} \\] Las dos últimas igualdades se derivan de la manipulación algebraica. El \\(Factor ~SS\\) desempeña el mismo papel que el \\(Regression ~SS\\) en los Capítulos 2 y 3. La descomposición de la variabilidad se resume en la Tabla 4.6. Tabla 4.6: Tabla ANOVA para el Modelo de Un Factor Fuente Suma de Cuadrados \\(df\\) Media Cuadrática Factor \\(Factor ~SS\\) \\(c-1\\) \\(Factor ~MS\\) Error \\(Error ~SS\\) \\(n-c\\) \\(Error ~MS\\) Total \\(Total ~SS\\) \\(n-1\\) Las convenciones para esta tabla son las mismas que en el caso de regresión. Es decir, la columna de media cuadrática (MS) se define dividiendo la columna de suma de cuadrados (SS) por la columna de grados de libertad (df). Por lo tanto, \\(Factor~MS \\equiv (Factor~SS)/(c-1)\\) y \\(Error~MS \\equiv (Error~SS)/(n-c)\\). Usamos \\[ s^2 = \\text{Error MS} = \\frac{1}{n-c} \\sum_{j=1}^{c}\\sum_{i=1}^{n_j} e_{ij}^2 \\] como nuestra estimación de \\(\\sigma^2\\), donde \\(e_{ij} = y_{ij} - \\bar{y}_j\\) es el residuo. Con este valor de \\(s\\), se puede mostrar que el intervalo de estimación para \\(\\mu_j\\) es \\[ \\bar{y}_j \\pm t_{n-c,1-\\alpha /2}\\frac{s}{\\sqrt{n_j}}. \\tag{4.8} \\] Aquí, el valor t \\(t_{n-c,1-\\alpha /2}\\) es un percentil de la distribución t con \\(df=n-c\\) grados de libertad. Ejemplo: Reclamaciones de Automóviles - Continuación. Para ilustrar, la tabla ANOVA que resume el ajuste para los datos de reclamaciones de automóviles se presenta en la Tabla 4.7. Aquí, vemos que la media cuadrática del error es \\(s^2 = 1.14.\\) Tabla 4.7: Tabla ANOVA para Reclamaciones de Automóviles Logarítmicas Fuente Suma de Cuadrados \\(df\\) Media Cuadrática CLASS 39.2 17 2.31 Error 7729.0 6755 1.14 Total 7768.2 6772 En la tarificación de automóviles, se usan los promedios de las reclamaciones para ayudar a fijar los precios de las coberturas de seguros. Como ejemplo, para la CLASS C72, el promedio de la reclamación logarítmica es 7.183. A partir de la ecuación (4.8), un intervalo de confianza del 95% es \\[ \\small{ 7.183 \\pm (1.96) \\frac{\\sqrt{1.14}}{\\sqrt{85}} = 7.183 \\pm 0.227 = (6.956 ,7.410). } \\] Cabe destacar que estas estimaciones están en unidades logarítmicas naturales. En dólares, nuestra estimación puntual es \\(e^{7.183} = 1,316.85\\) y nuestro intervalo de confianza del 95% es \\((e^{6.956} , e^{7.410}) \\text{ o } (\\$1,049.43, \\$1,652.43)\\). Una característica importante de la descomposición y estimación en un ANOVA de un factor es la facilidad de cálculo. Aunque la suma de cuadrados parece compleja, es importante señalar que no se requieren cálculos matriciales. En cambio, todos los cálculos se pueden realizar mediante promedios y sumas de cuadrados. Esto ha sido un aspecto importante históricamente, antes de la era de la computación de escritorio disponible. Además, las aseguradoras pueden segmentar sus carteras en cientos o incluso miles de clases de riesgo en lugar de las 18 utilizadas en nuestros datos de Reclamaciones de Automóviles. Por lo tanto, incluso hoy en día puede ser útil identificar una variable categórica como un factor y dejar que su software estadístico utilice técnicas de estimación ANOVA. Además, la estimación ANOVA también proporciona una interpretación directa de los resultados. Vínculo con la Regresión Esta subsección muestra cómo un modelo ANOVA de un factor se puede reescribir como un modelo de regresión. Para ello, hemos visto que tanto el modelo de regresión como el modelo ANOVA de un factor utilizan una estructura de error lineal con las Suposiciones E3 y E4 para errores idénticamente y distribuidos de manera independiente. De manera similar, ambos utilizan la suposición de normalidad E5 para resultados de inferencia seleccionados (como intervalos de confianza). Ambos emplean variables explicativas no estocásticas como en la Suposición E2. Ambos tienen un término de error aditivo (media cero), por lo que la principal diferencia aparente está en la respuesta esperada, \\(\\mathrm{E }~y\\). Para el modelo de regresión lineal, \\(\\mathrm{E }~y\\) es una combinación lineal de variables explicativas (Suposición F1). Para el modelo ANOVA de un factor, \\(\\mathrm{E}~y_] = \\mu_j\\) es una media que depende del nivel del factor. Para igualar estos dos enfoques, para el factor ANOVA con \\(c\\) niveles, definimos \\(c\\) variables binarias, \\(x_1, x_2, \\ldots, x_c\\). Aquí, \\(x_j\\) indica si una observación cae o no en el nivel \\(j\\)-ésimo. Con estas variables, podemos reescribir nuestro modelo ANOVA de un factor como \\[ y = \\mu_1 x_1 + \\mu_2 x_2 + \\ldots + \\mu_c x_c + \\varepsilon. \\tag{4.9} \\] Así, hemos reescrito la respuesta esperada del ANOVA de un factor como una función de regresión, aunque utilizando una forma sin intercepto (como en la ecuación (3.5)). El ANOVA de un factor es un caso especial de nuestro modelo de regresión habitual, utilizando variables binarias del factor como variables explicativas en la función de regresión. Como hemos visto, no se necesitan cálculos matriciales para la estimación por mínimos cuadrados. Sin embargo, siempre se pueden utilizar los procedimientos matriciales desarrollados en el Capítulo 3. La Sección 4.7.1 muestra cómo nuestra expresión matricial habitual para los coeficientes de regresión (\\(\\mathbf{b} = \\left(\\mathbf{X}^{\\prime}\\mathbf{X}\\right)^{-1}\\mathbf{X}^{\\prime}\\mathbf{y}\\)) se reduce a las estimaciones simples \\(\\bar{y}_j\\) cuando se utiliza una sola variable categórica. Reparametrización Para incluir un término de intercepto, definimos \\(\\tau_j = \\mu_j - \\mu\\), donde \\(\\mu\\) es un parámetro aún no especificado. Como cada observación debe pertenecer a una de las \\(c\\) categorías, tenemos que \\(x_1 + x_2 + \\ldots + x_{c} = 1\\) para cada observación. Así, al usar \\(\\mu_j = \\tau_j + \\mu\\) en la ecuación (4.9), obtenemos \\[ y = \\mu + \\tau_1 x_1 + \\tau_2 x_2 + \\ldots + \\tau_{c} x_{c} + \\varepsilon, \\tag{4.10} \\] Así, hemos reescrito el modelo en lo que parece ser nuestro formato usual de regresión. Usamos \\(\\tau\\) en lugar de \\(\\beta\\) por razones históricas. Los modelos ANOVA fueron inventados por R.A. Fisher en relación con experimentos agrícolas. Aquí, la configuración típica es aplicar varios tratamientos a parcelas de tierra para cuantificar las respuestas de rendimiento de los cultivos. Así, la letra griega “t”, \\(\\tau\\), sugiere la palabra tratamiento, otro término utilizado para describir los niveles del factor de interés. Una versión más simple de la ecuación (4.10) se puede dar cuando identificamos el nivel del factor. Es decir, si sabemos que una observación pertenece al nivel \\(j\\)-ésimo, entonces solo \\(x_j\\) es uno y los otros \\(x\\) son 0. Por lo tanto, una expresión más simple de la ecuación (4.10) es \\[ y_{ij} = \\mu + \\tau_j + \\varepsilon_{ij}. \\] Al comparar las ecuaciones (4.9) y (4.10), vemos que el número de parámetros ha aumentado en uno. Es decir, en la ecuación (4.9) hay \\(c\\) parámetros, \\(\\mu_1, \\ldots, \\mu_c\\), mientras que en la ecuación (4.10) hay \\(c + 1\\) parámetros, \\(\\mu\\) y \\(\\tau_1, \\ldots, \\tau_c\\). Se dice que el modelo en la ecuación (4.10) está sobreparametrizado. Es posible estimar este modelo directamente, utilizando la teoría general de modelos lineales, resumida en la Sección 4.7.3. En esta teoría, los coeficientes de regresión no necesitan ser identificables. Alternativamente, se pueden hacer equivalentes estas dos expresiones restringiendo el movimiento de los parámetros en la ecuación (4.10). A continuación, presentamos dos formas de imponer restricciones. El primer tipo de restricción, generalmente utilizado en el contexto de regresión, es requerir que uno de los \\(\\tau\\) sea cero. Esto equivale a eliminar una de las variables explicativas. Por ejemplo, podríamos usar \\[ y = \\mu + \\tau_1 x_1 + \\tau_2 x_2 + \\ldots + \\tau_{c-1} x_{c-1} + \\varepsilon, \\tag{4.11} \\] eliminando \\(x_c\\). Con esta formulación, es fácil ajustar el modelo en la ecuación (4.11) utilizando rutinas de software de regresión, porque solo se necesita ejecutar la regresión con \\(c-1\\) variables explicativas. Sin embargo, se debe tener cuidado con la interpretación de los parámetros. Para igualar los modelos en las ecuaciones (4.9) y (4.10), necesitamos definir \\(\\mu \\equiv \\mu_c\\) y \\(\\tau_j = \\mu_j - \\mu_c\\) para \\(j=1,2,\\ldots,c-1\\). Es decir, el término de intercepto de la regresión es el nivel medio de la categoría eliminada, y cada coeficiente de regresión es la diferencia entre un nivel medio y el nivel medio eliminado. No es necesario eliminar el último nivel \\(c\\), y de hecho, se podría eliminar cualquier nivel. Sin embargo, la interpretación de los parámetros depende de la variable eliminada. Con esta restricción, los valores ajustados son \\(\\hat{\\mu} = \\hat{\\mu}_c = \\bar{y}_c\\) y \\(\\hat{\\tau}_j = \\hat{\\mu}_j - \\hat{\\mu}_c = \\bar{y}_j - \\bar{y}_c.\\) Recordemos que el símbolo de sombrero (\\(\\hat{\\cdot}\\)), o “hat,” representa un valor estimado o ajustado. El segundo tipo de restricción es interpretar \\(\\mu\\) como una media para toda la población. Para ello, el requisito usual es \\(\\mu \\equiv \\frac{1}{n} \\sum_{j=1}^c n_j \\mu_j\\), es decir, \\(\\mu\\) es un promedio ponderado de medias. Con esta definición, interpretamos \\(\\tau_j = \\mu_j - \\mu\\) como diferencias de tratamiento entre un nivel medio y la media poblacional. Otra forma de expresar esta restricción es \\(\\sum_{j=1}^{c} n_j \\tau_j = 0\\), es decir, la suma (ponderada) de las diferencias de tratamiento es cero. La desventaja de esta restricción es que no se puede implementar fácilmente con una rutina de regresión, y se necesita una rutina especial. La ventaja es que hay una simetría en las definiciones de los parámetros. No es necesario preocuparse por qué variable se está eliminando de la ecuación, lo cual es una consideración importante. Con esta restricción, los valores ajustados son \\[ \\hat{\\mu} = \\frac{1}{n} \\sum_{j=1}^{c} n_j \\hat{\\mu}_j = \\frac{1}{n} \\sum_{j=1}^{c} n_j \\bar{y}_j = \\bar{y} \\] y \\[ \\hat{\\tau}_j = \\hat{\\mu}_j - \\hat{\\mu} = \\bar{y}_j - \\bar{y}. \\] 4.4 Combinando Variables Explicativas Categóricas y Continuas Existen varias formas de combinar variables explicativas categóricas y continuas. Inicialmente, presentamos el caso de solo una variable categórica y una variable continua. Luego, presentamos brevemente el caso general, llamado modelo lineal general. Cuando se combinan modelos de variables categóricas y continuas, usamos la terminología factor para la variable categórica y covariable para la variable continua. Combinando un Factor y una Covariable Comencemos con los modelos más simples que utilizan un factor y una covariable. En la Sección 4.3, introdujimos el modelo de un solo factor \\(y_{ij} = \\mu_j + \\varepsilon_{ij}\\). En el Capítulo 2, introdujimos la regresión lineal básica en términos de una variable continua, o covariable, usando \\(y_{ij} = \\beta_0 + \\beta_1 x_{ij} + \\varepsilon_{ij}\\). La Tabla 4.8 resume diferentes enfoques que podrían usarse para representar combinaciones de un factor y una covariable. Tabla 4.8: Varios Modelos que Representan Combinaciones de Un Factor y Una Covariable Descripción del Modelo Notación ANOVA de un factor (modelo sin covariable) \\(y_{ij} = \\mu_j + \\varepsilon_{ij}\\) Regresión con intercepto y pendiente constante (modelo sin factor) \\(y_{ij} = \\beta_0 + \\beta_1 x_{ij} + \\varepsilon_{ij}\\) Regresión con intercepto variable y pendiente constante (modelo de análisis de covarianza) \\(y_{ij} = \\beta_{0j} + \\beta_1 x_{ij} + \\varepsilon_{ij}\\) Regresión con intercepto constante y pendiente variable \\(y_{ij} = \\beta_0 + \\beta_{1j} x_{ij} + \\varepsilon_{ij}\\) Regresión con intercepto y pendiente variable \\(y_{ij} = \\beta_{0j} + \\beta_{1j} x_{ij} + \\varepsilon_{ij}\\) Podemos interpretar la regresión con intercepto variable y pendiente constante como un modelo aditivo, porque estamos sumando el efecto del factor, \\(\\beta_{0j}\\), al efecto de la covariable, \\(\\beta_1 x_{ij}\\). Nótese que también se podría usar la notación \\(\\mu_j\\) en lugar de \\(\\beta_{0j}\\) para sugerir la presencia de un efecto de factor. Este también es conocido como un modelo de análisis de covarianza (ANCOVA). La regresión con intercepto y pendiente variables puede considerarse un modelo de interacción. Aquí, tanto el intercepto, \\(\\beta_{0j}\\), como la pendiente, \\(\\beta_{1j}\\), pueden variar según el nivel del factor. En este sentido, interpretamos que el factor y la covariable están “interactuando”. El modelo con intercepto constante y pendiente variable típicamente no se usa en la práctica; se incluye aquí por completitud. Con este modelo, el factor y la covariable interactúan solo a través de la pendiente variable. Las Figuras 4.3, 4.4 y 4.5 ilustran las respuestas esperadas de estos modelos. Figura 4.3: Gráfico de la respuesta esperada frente a la covariable para el modelo de regresión con intercepto variable y pendiente constante. Figura 4.4: Gráfico de la respuesta esperada frente a la covariable para el modelo de regresión con intercepto constante y pendiente variable. Figura 4.5: Gráfico de la respuesta esperada frente a la covariable para el modelo de regresión con intercepto variable y pendiente variable. Código R para Producir las Figuras 4.3, 4.4, y 4.5 ## Figura 4.3 x &lt;- seq(0, 100, length = 101) y &lt;- 0.15 * x par(mar = c(3.2, 3, .2, .2)) plot(x, y, type = &quot;l&quot;, xlim = c(10, 90), xaxt = &quot;n&quot;, ylim = c(1.5, 25), yaxt = &quot;n&quot;, ylab = &quot;&quot;, xlab = &quot;&quot;) mtext(&quot;y&quot;, side = 2, las = 1, line = 2, cex = 1.1) mtext(&quot;x&quot;, side = 1, line = 2, cex = 1.1) lines(x, y + 6) lines(x, y + 8) arrows(40, 5.5, 55, 5.5, code = 1, lwd = 2, angle = 15, length = 0.2) text(69, 5.5, expression(y == beta[&quot;0,3&quot;] + beta[1] * x), cex = 1.1) arrows(30, 13, 30, 16, code = 1, lwd = 2, angle = 15, length = 0.2) text(30, 17, expression(y == beta[&quot;0,2&quot;] + beta[1] * x), cex = 1.1) arrows(66, 15.5, 62, 12, code = 1, lwd = 2, angle = 15, length = 0.2) text(58, 11, expression(y == beta[&quot;0,1&quot;] + beta[1] * x), cex = 1.1) ## Figura 4.4 x &lt;- seq(0, 100, length = 101) y3 &lt;- 12 + 0.1 * x y2 &lt;- 12 - 0.1 * x y1 &lt;- 12 + 0.02 * x par(mar = c(3.2, 3, .2, .2)) plot(x, y1, type = &quot;l&quot;, xlim = c(3.5, 90), xaxt = &quot;n&quot;, ylim = c(1.5, 25), yaxt = &quot;n&quot;, ylab = &quot;&quot;, xlab = &quot;&quot;) mtext(&quot;y&quot;, side = 2, las = 1, line = 2, cex = 1.1) mtext(&quot;x&quot;, side = 1, line = 2, cex = 1.1) lines(x, y2) lines(x, y3) arrows(38, 8, 35, 4, code = 1, lwd = 2, angle = 15, length = 0.2) text(35, 3.5, expression(y == beta[0] + beta[&quot;1,2&quot;] * x), cex = 1.1) arrows(26, 15, 26, 18, code = 1, lwd = 2, angle = 15, length = 0.2) text(26, 19, expression(y == beta[0] + beta[&quot;1,3&quot;] * x), cex = 1.1) arrows(62, 13.5, 66, 16, code = 1, lwd = 2, angle = 15, length = 0.2) text(70, 16.5, expression(y == beta[0] + beta[&quot;1,1&quot;] * x), cex = 1.1) ## Figura 4.5 x1 &lt;- seq(50, 90, length = 51) y1 &lt;- -5 + 0.2 * x1 x2 &lt;- seq(30, 80, length = 41) y2 &lt;- 12 + 0.02 * x2 x3 &lt;- seq(10, 50, length = 41) y3 &lt;- 15 + 0.15 * x3 par(mar = c(3.2, 3, .2, .2)) plot(x1, y1, type = &quot;l&quot;, xlim = c(3.5, 90), xaxt = &quot;n&quot;, ylim = c(1.5, 25), ylab = &quot;&quot;, xlab = &quot;&quot;, yaxt = &quot;n&quot;) mtext(&quot;y&quot;, side = 2, las = 1, line = 2, cex = 1.1) mtext(&quot;x&quot;, side = 1, line = 2, cex = 1.1) lines(x2, y2) lines(x3, y3) arrows(68, 8, 65, 4, code = 1, lwd = 2, angle = 5, length = 0.2) text(65, 3.5, expression(y == beta[&quot;0,1&quot;] + beta[&quot;1,1&quot;] * x), cex = 1.1) arrows(50, 12.5, 30, 11.5, code = 1, lwd = 2, angle = 5, length = 0.2) text(30, 10.5, expression(y == beta[&quot;0,3&quot;] + beta[&quot;1,3&quot;] * x), cex = 1.1) arrows(30, 20, 20, 22, code = 1, lwd = 2, angle = 5, length = 0.2) text(20, 23, expression(y == beta[&quot;0,2&quot;] + beta[&quot;1,2&quot;] * x), cex = 1.1) Para cada modelo presentado en la Tabla 4.8, las estimaciones de los parámetros pueden calcularse utilizando el método de mínimos cuadrados. Como es habitual, esto significa escribir la respuesta esperada, \\(\\mathrm{E }~y_{ij}\\), como una función de variables conocidas y parámetros desconocidos. Para el modelo de regresión con intercepto variable y pendiente constante, las estimaciones de mínimos cuadrados pueden expresarse de manera compacta como: \\[ b_1 = \\frac{\\sum_{j=1}^{c}\\sum_{i=1}^{n_j} (x_{ij} - \\bar{x}_j) (y_{ij} - \\bar{y}_j)}{\\sum_{j=1}^{c}\\sum_{i=1}^{n_j} (x_{ij} - \\bar{x}_j)^2} \\] y \\(b_{0j} = \\bar{y}_j - b_1 \\bar{x}_j\\). De manera similar, las estimaciones de mínimos cuadrados para el modelo de regresión con intercepto y pendiente variables pueden expresarse como: \\[ b_{1j} = \\frac{\\sum_{i=1}^{n_j} (x_{ij} - \\bar{x}_j) (y_{ij} - \\bar{y}_j)}{\\sum_{i=1}^{n_j} (x_{ij} - \\bar{x}_j)^2} \\] y \\(b_{0j} = \\bar{y}_j - b_{1j} \\bar{x}_j\\). Con estas estimaciones de los parámetros, se pueden calcular los valores ajustados. Para cada modelo, los valores ajustados se definen como la respuesta esperada con los parámetros desconocidos reemplazados por sus estimaciones de mínimos cuadrados. Por ejemplo, para el modelo de regresión con intercepto variable y pendiente constante, los valores ajustados son \\(\\hat{y}_{ij} = b_{0j} + b_1 x_{ij}.\\) Ejemplo: Costos Hospitalarios en Wisconsin. Ahora estudiamos el impacto de varios predictores en los costos hospitalarios en el estado de Wisconsin. Identificar predictores de los costos hospitalarios puede proporcionar dirección a los hospitales, al gobierno, a las aseguradoras y a los consumidores en el control de estas variables, lo que a su vez lleva a un mejor control de los costos hospitalarios. Los datos para el año 1989 fueron obtenidos de la Oficina de Información de Salud, del Departamento de Salud y Servicios Humanos de Wisconsin. Se utilizan datos transversales, que detallan los costos de alta de 20 grupos relacionados con el diagnóstico (DRG) para hospitales en el estado de Wisconsin, desglosados en nueve áreas principales de servicios de salud y tres tipos de pagador (Pago por servicio, HMO y otros). Aunque hay 540 combinaciones potenciales de DRG, área y pagador (\\(20 \\times 9 \\times 3 = 540\\)), solo 526 combinaciones se realizaron realmente en el conjunto de datos de 1989. Otros predictores incluidos fueron el logaritmo del número total de altas (NO DSCHG) y el número total de camas hospitalarias (NUM BEDS) para cada combinación. La variable de respuesta es el logaritmo de los costos hospitalarios totales por número de altas (CHGNUM). Para simplificar la presentación, ahora consideramos solo los costos asociados con tres grupos relacionados con el diagnóstico (DRG): DRG #209, DRG #391, y DRG #430. La covariable, \\(x\\), es el logaritmo natural del número de altas. En entornos ideales, los hospitales con más pacientes disfrutan de menores costos debido a economías de escala. En entornos no ideales, los hospitales pueden no tener capacidad excedente y, por lo tanto, los hospitales con más pacientes tienen costos más altos. Uno de los propósitos de este análisis es investigar la relación entre los costos hospitalarios y la utilización hospitalaria. Recuerde que nuestra medida de los costos hospitalarios es el logaritmo de los costos por alta (\\(y\\)). El diagrama de dispersión en la Figura 4.6 da una idea preliminar de la relación entre \\(y\\) y \\(x\\). Notamos que parece haber una relación negativa entre \\(y\\) y \\(x\\). La relación negativa entre \\(y\\) y \\(x\\) sugerida por la Figura 4.6 es engañosa y está inducida por una variable omitida, la categoría del costo (DRG). Para ver el efecto conjunto de la variable categórica DRG y la variable continua \\(x\\), en la Figura 4.7 se muestra un gráfico de \\(y\\) versus \\(x\\) donde los símbolos de trazado son códigos para el nivel de la variable categórica. En este gráfico, vemos que el nivel de costo varía según el nivel del factor DRG. Además, para cada nivel de DRG, la pendiente entre \\(y\\) y \\(x\\) es cero o positiva. Las pendientes no son negativas, como sugiere la Figura 4.6. Figura 4.6: Gráfico del logaritmo natural del costo por alta versus logaritmo natural del número de altas. Este gráfico sugiere una relación negativa engañosa. Figura 4.7: Gráfico con letras del logaritmo natural del costo por alta versus logaritmo natural del número de altas según DRG. Aquí, A es para DRG #209, B es para DRG #391, y C es para DRG #430. Código R para Producir las Figuras 4.6 y 4.7 ## C5_HOSP.txt HospitalCosts &lt;- read.csv(&quot;CSVData/WiscHospCosts.csv&quot;, header=TRUE) # attach(HospitalCosts) # LNCHGNUM&lt;-log(CHG_NUM) ## Figura 4.6 par(mar=c(4.1,4,1,1), cex=1.1) plot(log(CHG_NUM) ~ log(NO_DSCHG), data=HospitalCosts, subset=DRG==209|DRG==391|DRG==430,type=&quot;p&quot;,pch=1,cex=0.6, xlim=c(2,9.2),xaxp=c(1.5,9,5),xlab=&quot;Número de Altas&quot;,ylim=c(5.9,9.8), yaxp=c(6.0,9.6,3),ylab=&quot;&quot;,las=1) mtext(&quot;CHGNUM&quot;, side=2, at=10.1, las=1, cex=1.1, adj=.4) ## Figura 4.7 DRGabc&lt;-character(length=length(HospitalCosts$DRG)) for (i in 1:length(HospitalCosts$DRG)) {DRGabc[i]&lt;-if (HospitalCosts$DRG[i]==209) &quot;A&quot; else if (HospitalCosts$DRG[i]==391) &quot;B&quot; else if (HospitalCosts$DRG[i]==430) &quot;C&quot; else &quot;D&quot;} par(mar=c(4.1,4,1,1), cex=1.1) plot(log(CHG_NUM) ~ log(NO_DSCHG), data=HospitalCosts, subset=DRG==209|DRG==391|DRG==430,type=&quot;p&quot;, pch=as.character(DRGabc),cex=0.8, xlim=c(2,9.2), xaxp=c(1.5,9,5),xlab=&quot;Número de Altas&quot;,ylim=c(5.9,9.8), yaxp=c(6.0,9.6,3),ylab=&quot;&quot;,las=1) mtext(&quot;CHGNUM&quot;, side=2, at=10.1, las=1, cex=1.1, adj=.4) Tabla 4.9: Bondad de Ajuste de los Modelos de Costos Hospitalarios en Wisconsin Descripción del Modelo Grados de libertad del modelo Grados de libertad del error Suma de cuadrados del error R-cuadrado (%) Media Cuadrática ANOVA de un factor 2 76 9.396 93.3 0.124 Regresión con intercepto y pendiente constantes 1 77 115.059 18.2 1.222 Regresión con intercepto variable y pendiente constante 3 75 7.482 94.7 0.100 Regresión con intercepto constante y pendiente variable 3 75 14.048 90.0 0.187 Regresión con intercepto y pendiente variables 5 73 5.458 96.1 0.075 Cada uno de los cinco modelos definidos en la Tabla 4.8 fue ajustado a este subconjunto del estudio de caso hospitalario. Las estadísticas resumen se encuentran en la Tabla 4.9. Para este conjunto de datos, hay \\(n = 79\\) observaciones y \\(c = 3\\) niveles del factor DRG. Para cada modelo, los grados de libertad del modelo son el número de parámetros del modelo menos uno. Los grados de libertad del error son el número de observaciones menos el número de parámetros del modelo. Usando variables binarias, cada uno de los modelos en la Tabla 4.8 puede escribirse en un formato de regresión. Como hemos visto en la Sección 4.2, cuando un modelo puede escribirse como un subconjunto de otro modelo más grande, tenemos procedimientos formales de prueba disponibles para decidir cuál modelo es más apropiado. Para ilustrar este procedimiento de prueba con nuestro ejemplo de DRG, a partir de la Tabla 4.9 y los gráficos asociados, parece claro que el factor DRG es importante. Además, una prueba \\(t\\), que no se presenta aquí, muestra que la covariable \\(x\\) es importante. Por lo tanto, comparemos el modelo completo \\(\\mathrm{E}~y_{ij} = \\beta_{0,j} + \\beta_{1,j}x\\) con el modelo reducido \\(\\mathrm{E}~y_{ij} = \\beta_{0,j} + \\beta_1x\\). En otras palabras, ¿hay una pendiente diferente para cada DRG? Usando la notación de la Sección 4.2, llamamos al intercepto y la pendiente variables el modelo completo. Bajo la hipótesis nula, \\(H_0: \\beta_{1,1} = \\beta_{1,2} = \\beta_{1,3}\\), obtenemos el modelo con intercepto variable y pendiente constante. Así, usando el cociente \\(F\\) en la ecuación (4.2), tenemos: \\[ \\small{ F\\text{-ratio} = \\frac{(Error~SS)_{reduced} - (Error~SS)_{full}}{ps_{full}^2} = \\frac{7.482 - 5.458}{2 \\times 0.075} = 13.535. } \\] El percentil 95 de la distribución \\(F\\) con \\(df_1 = p = 2\\) y \\(df_2 = (df)_{full} = 73\\) es aproximadamente 3.13. Por lo tanto, esta prueba nos lleva a rechazar la hipótesis nula y a declarar válida la alternativa, el modelo de regresión con intercepto variable y pendiente variable. Combinación de Dos Factores Hemos visto cómo combinar covariables, así como una covariable y un factor, tanto de manera aditiva como con interacciones. De la misma manera, supongamos que tenemos dos factores, como sexo (dos niveles: masculino/femenino) y edad (tres niveles: joven/mediana/anciana). Las variables binarias correspondientes serían \\(x_1\\) para indicar si la observación representa a una mujer, \\(x_2\\) para indicar si la observación representa a una persona joven, y \\(x_3\\) para indicar si la observación representa a una persona de mediana edad. Un modelo aditivo para estos dos factores puede usar la función de regresión \\[ \\mathrm{E }~y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_3. \\] Como hemos visto, este modelo es sencillo de interpretar. Por ejemplo, podemos interpretar \\(\\beta_1\\) como el efecto del sexo, manteniendo constante la edad. También podemos incorporar dos términos de interacción, \\(x_1 x_2\\) y \\(x_1 x_3\\). Usando las cinco variables explicativas, obtenemos la función de regresión \\[ \\mathrm{E }~y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_3 + \\beta_4 x_1 x_2 + \\beta_5 x_1 x_3. \\tag{4.12} \\] Aquí, las variables \\(x_1\\), \\(x_2\\), y \\(x_3\\) se conocen como los efectos principales. La Tabla 4.10 ayuda a interpretar esta ecuación. Específicamente, hay seis tipos de personas que podríamos encontrar: hombres y mujeres que son jóvenes, de mediana edad o ancianos. Tenemos seis parámetros en la ecuación (4.12). La Tabla 4.10 proporciona el enlace entre los parámetros y los tipos de personas. Al usar los términos de interacción, no imponemos ninguna especificación previa sobre los efectos aditivos de cada factor. De la Tabla 4.10, vemos que la interpretación de los coeficientes de regresión en la ecuación (4.12) no es directa. Sin embargo, usar el modelo aditivo con términos de interacción es equivalente a crear una nueva variable categórica con seis niveles, uno para cada tipo de persona. Si los términos de interacción son críticos en su estudio, puede ser conveniente crear un nuevo factor que incorpore los términos de interacción simplemente para facilitar la interpretación. Tabla 4.10: Función de Regresión para un Modelo de Dos Factores con Interacciones Sexo Edad \\(x_1\\) \\(x_2\\) \\(x_3\\) \\(x_4\\) \\(x_5\\) Función de Regresión Masculino Joven 0 1 0 0 0 \\(\\beta_0 + \\beta_2\\) Masculino Mediana 0 0 1 0 0 \\(\\beta_0 + \\beta_3\\) Masculino Anciana 0 0 0 0 0 \\(\\beta_0\\) Femenino Joven 1 1 0 1 0 \\(\\beta_0 + \\beta_1 + \\beta_2 + \\beta_4\\) Femenino Mediana 1 0 1 0 1 \\(\\beta_0 + \\beta_1 + \\beta_3 + \\beta_5\\) Femenino Anciana 1 0 0 0 0 \\(\\beta_0 + \\beta_1\\) Las extensiones a más de dos factores siguen de manera similar. Por ejemplo, supongamos que está examinando el comportamiento de empresas con sede en diez regiones geográficas, dos estructuras organizativas (con fines de lucro versus sin fines de lucro) con cuatro años de datos. Si decide tratar cada variable como un factor y desea modelar todos los términos de interacción, entonces esto es equivalente a un factor con \\(10 \\times 2 \\times 4 = 80\\) niveles. Los modelos con términos de interacción pueden tener un número considerable de parámetros y el analista debe ser prudente al especificar las interacciones a considerar. Modelo Lineal General El modelo lineal general extiende el modelo de regresión lineal de dos maneras. Primero, las variables explicativas pueden ser continuas, categóricas o una combinación. La única restricción es que entren linealmente de tal manera que la función de regresión resultante \\[ \\mathrm{E}~y = \\beta_0 + \\beta_1 x_1 + \\ldots + \\beta_k x_k \\tag{4.13} \\] sea una combinación lineal de coeficientes. Como hemos visto, podemos elevar al cuadrado las variables continuas o tomar otras transformaciones no lineales (como logaritmos) así como usar variables binarias para representar variables categóricas, por lo que esta “restricción”, como su nombre lo indica, permite una amplia clase de funciones generales para representar los datos. La segunda extensión es que las variables explicativas pueden ser combinaciones lineales unas de otras en el modelo lineal general. Debido a esto, en el caso del modelo lineal general, las estimaciones de los parámetros no tienen por qué ser únicas. Sin embargo, una característica importante del modelo lineal general es que los valores ajustados resultantes resultan ser únicos, utilizando el método de mínimos cuadrados. Por ejemplo, en la Sección 4.3 vimos que el modelo ANOVA de un factor podía expresarse como un modelo de regresión con \\(c\\) variables indicadoras. Sin embargo, si hubiéramos intentado estimar el modelo en la ecuación (4.10), el método de mínimos cuadrados no habría llegado a un conjunto único de estimaciones de los coeficientes de regresión. La razón es que, en la ecuación (4.10), cada variable explicativa puede expresarse como una combinación lineal de las otras. Por ejemplo, observe que \\(x_c = 1 - (x_1 + x_2 + \\ldots + x_{c-1})\\). El hecho de que las estimaciones de los parámetros no sean únicas es una desventaja, pero no una insuperable. La suposición de que las variables explicativas no sean combinaciones lineales unas de otras significa que podemos calcular estimaciones únicas de los coeficientes de regresión utilizando el método de mínimos cuadrados. En términos de matrices, porque las variables explicativas no son combinaciones lineales unas de otras, la matriz \\(\\mathbf{X}^{\\prime}\\mathbf{X}\\) no es invertible. Específicamente, supongamos que estamos considerando la función de regresión en la ecuación (4.13) y, utilizando el método de mínimos cuadrados, nuestras estimaciones de los coeficientes de regresión son \\(b_0^{o}, b_1^{o}, \\ldots, b_k^{o}\\). Este conjunto de estimaciones de los coeficientes de regresión minimiza nuestra suma de cuadrados de los errores, pero puede haber otros conjuntos de coeficientes que también minimicen la suma de cuadrados de los errores. Los valores ajustados se calculan como \\(\\hat{y}_i = b_0^{o} + b_1^{o} x_{i1} + \\ldots + b_k^{o} x_{ik}\\). Se puede demostrar que los valores ajustados resultantes son únicos, en el sentido de que cualquier conjunto de coeficientes que minimice la suma de cuadrados de los errores produce los mismos valores ajustados (ver Sección 4.7.3). Por lo tanto, para un conjunto de datos y un modelo lineal general especificado, los valores ajustados son únicos. Debido a que los residuos se calculan como las respuestas observadas menos los valores ajustados, tenemos que los residuos son únicos. Debido a que los residuos son únicos, tenemos que las sumas de cuadrados de los errores son únicas. Por lo tanto, parece razonable, y es cierto, que podemos usar la prueba general de hipótesis descrita en la Sección 4.2 para decidir si las colecciones de variables explicativas son importantes. En resumen, para los modelos lineales generales, las estimaciones de los parámetros pueden no ser únicas y, por lo tanto, no significativas. Una parte importante de los modelos de regresión es la interpretación de los coeficientes de regresión. Esta interpretación no está necesariamente disponible en el contexto del modelo lineal general. Sin embargo, para los modelos lineales generales, todavía podemos discutir la importancia de una variable individual o colección de variables a través de pruebas parciales F. Además, los valores ajustados, y el correspondiente ejercicio de predicción, funcionan en el contexto del modelo lineal general. La ventaja del contexto del modelo lineal general es que no necesitamos preocuparnos por el tipo de restricciones a imponer en los parámetros. Aunque no es el tema de este texto, esta ventaja es particularmente importante en los diseños experimentales complicados utilizados en las ciencias de la vida. El lector encontrará que las rutinas de estimación del modelo lineal general están ampliamente disponibles en los paquetes de software estadístico disponibles en el mercado hoy en día. 4.5 Lecturas Adicionales y Referencias Hay varios buenos libros sobre modelos lineales que se enfocan en variables categóricas y técnicas de análisis de variables. Hocking (2003) y Searle (1987) son buenos ejemplos. Referencias del Capítulo Hocking, Ronald R. (2003). Methods and Applications of Linear Models: Regression and the Analysis of Variance John Wiley and Sons, New York. Keeler, Emmett B., and John E. Rolph (1988). The demand for episodes of treatment in the Health Insurance Experiment. Journal of Health Economics 7: 337-367. Searle, Shayle R. (1987). Linear Models for Unbalanced Data. John Wiley &amp; Sons, New York. 4.6 Ejercicios 4.1. En este ejercicio, consideramos la relación entre dos estadísticas que resumen qué tan bien se ajusta un modelo de regresión, la razón \\(F\\) y \\(R^2\\), el coeficiente de determinación. (Aquí, la razón \\(F\\) es la estadística utilizada para probar la adecuación del modelo, no una estadística parcial \\(F\\)). Escribe \\(R^2\\) en términos de \\(Error ~SS\\) y \\(Regression ~SS\\). Escribe la razón \\(F\\) en términos de \\(Error ~SS\\), \\(Regression ~SS\\), \\(k\\), y \\(n\\). Establece la relación algebraica \\[ F\\text{-ratio} = \\frac{R^2}{1-R^2} \\frac{n-(k+1)}{k}. \\] Supongamos que \\(n = 40\\), \\(k = 5\\), y \\(R^2 = 0.20\\). Calcula la razón \\(F\\). Realiza la prueba habitual de adecuación del modelo para determinar si las cinco variables explicativas afectan significativamente de manera conjunta a la variable de respuesta. Supongamos que \\(n = 400\\) (no 40), \\(k = 5\\), y \\(R^2 = 0.20\\). Calcula la razón \\(F\\). Realiza la prueba habitual de adecuación del modelo para determinar si las cinco variables explicativas afectan significativamente de manera conjunta a la variable de respuesta. 4.2. Costos Hospitalarios. Este ejercicio considera los datos de gastos hospitalarios proporcionados por la Agencia de Investigación y Calidad de la Atención Médica de EE. UU. (AHRQ) y descritos en el Ejercicio 1.4. Produce un diagrama de dispersión, una correlación, y una regresión lineal de LNTOTCHG en función de AGE. ¿Es AGE un predictor significativo de LNTOTCHG? Te preocupa que los recién nacidos sigan un patrón diferente al de otras edades. Crea una variable binaria que indique si AGE es igual a cero o no. Ejecuta una regresión utilizando esta variable binaria y AGE como variables explicativas. ¿Es la variable binaria estadísticamente significativa? Ahora examina el efecto del género, usando la variable binaria FEMALE que es uno si el paciente es mujer y cero en caso contrario. Ejecuta una regresión utilizando AGE y FEMALE como variables explicativas. Realiza una segunda regresión que incluya estas dos variables con un término de interacción. Comenta si el efecto del género es importante en alguno de los modelos. Ahora considera el tipo de admisión, APRDRG, un acrónimo de “grupo de diagnóstico refinado para todos los pacientes”. Esta es una variable categórica explicativa que proporciona información sobre el tipo de admisión hospitalaria. Hay varios cientos de niveles de esta categoría. Por ejemplo, el nivel 640 representa la admisión de un recién nacido normal, con un peso neonatal mayor o igual a 2.5 kilogramos. Como otro ejemplo, el nivel 225 representa una admisión que resulta en una apendicectomía. d(i). Ejecuta un modelo ANOVA de un factor, utilizando APRDRG para predecir LNTOTCHG. Examina el \\(R^2\\) de este modelo y compáralo con el coeficiente de determinación del modelo de regresión lineal de LNTOTCHG en función de AGE. Basándote en esta comparación, ¿qué modelo crees que es preferido? d(ii). Para el modelo de un factor en la parte d(i), proporciona un intervalo de confianza del 95% para la media de LNTOTCHG para el nivel 225 correspondiente a una apendicectomía. Convierte tu respuesta final de dólares logarítmicos a dólares mediante exponenciación. d(iii). Ejecuta un modelo de regresión de APRDRG, FEMALE, y AGE en LNTOTCHG. Indica si AGE es un predictor estadísticamente significativo de LNTOTCHG. Indica si FEMALE es un predictor estadísticamente significativo de LNTOTCHG. 4.3. Utilización de Hogares de Ancianos. Este ejercicio considera los datos de hogares de ancianos proporcionados por el Departamento de Servicios de Salud y Familia de Wisconsin (DHFS) y descritos en los Ejercicios 1.2, 2.10, y 2.20. Además de las variables de tamaño, también tenemos información sobre varias variables binarias. La variable URBAN se utiliza para indicar la ubicación de la instalación. Es uno si la instalación se encuentra en un entorno urbano y cero en caso contrario. La variable MCERT indica si la instalación está certificada por Medicare. La mayoría, pero no todos, los hogares de ancianos están certificados para proporcionar atención financiada por Medicare. Hay tres estructuras organizativas para los hogares de ancianos: gobierno (estado, condados, municipios), empresas con fines de lucro y organizaciones exentas de impuestos. Periódicamente, las instalaciones pueden cambiar de propietario y, con menos frecuencia, de tipo de propiedad. Creamos dos variables binarias PRO y TAXEXEMPT para denotar empresas con fines de lucro y organizaciones exentas de impuestos, respectivamente. Algunos hogares de ancianos optan por no comprar cobertura de seguro privado para sus empleados. En cambio, estas instalaciones proporcionan directamente seguros y beneficios de pensión a sus empleados; esto se conoce como “auto-financiamiento del seguro”. Usamos la variable binaria SELFFUNDINS para denotarlo. Decides examinar la relación entre LOGTPY (\\(y\\)) y las variables explicativas. Usa los datos del año 2001 del informe de costos y realiza el siguiente análisis. Hay tres niveles de estructuras organizativas, pero solo utilizamos dos variables binarias (PRO y TAXEXEMPT). Explica por qué. Realiza un análisis de varianza de un factor usando TAXEXEMPT como el factor. Decide si exento de impuestos es o no un factor importante para determinar LOGTPY. Establece tu hipótesis nula, hipótesis alternativa y todos los componentes de la regla de toma de decisiones. Utiliza un nivel de significancia del 5%. Realiza un análisis de varianza de un factor usando MCERT como el factor. Decide si MCERT es o no un factor importante para determinar LOGTPY. c(i). Proporciona una estimación puntual de LOGTPY para una instalación de enfermería que no está certificada por Medicare. c(ii). Proporciona un intervalo de confianza del 95% para tu estimación puntual en la parte (i). Ejecuta un modelo de regresión usando las variables binarias, URBAN, PRO, TAXEXEMPT, SELFFUNDINS, y MCERT. Encuentra \\(R^2\\). ¿Qué variables son estadísticamente significativas? Ejecuta un modelo de regresión usando todas las variables explicativas, LOGNUMBED, LOGSQRFOOT, URBAN, PRO, TAXEXEMPT, SELFFUNDINS, y MCERT. Encuentra \\(R^2\\). ¿Qué variables son estadísticamente significativas? e(i). Calcula la correlación parcial entre LOGTPY y LOGSQRFOOT. Compárala con la correlación entre LOGTPY y LOGSQRFOOT. Explica por qué la correlación parcial es pequeña. e(ii). Compara el bajo nivel de los \\(t\\)-ratios (para probar la importancia de los coeficientes de regresión individuales) y el alto nivel de la razón \\(F\\) (para probar la adecuación del modelo). Describe la aparente inconsistencia y proporciona una explicación para esta inconsistencia. 4.4. Reclamaciones de Seguros de Automóviles. Consulta el Ejercicio 1.3. Ejecuta una regresión de LNPAID en AGE. ¿Es AGE una variable estadísticamente significativa? Para responder a esta pregunta, usa una prueba formal de hipótesis. Establece tu hipótesis nula y alternativa, el criterio de toma de decisiones y tu regla de toma de decisiones. También comenta sobre la bondad del ajuste de esta variable. Considera usar la clase como una sola variable explicativa. Usa el factor único para estimar el modelo y responde a las siguientes preguntas. b(i). ¿Cuál es la estimación puntual de las reclamaciones en la clase C7, conductores de 50-69 años, que conducen al trabajo o la escuela, menos de 30 millas por semana con un kilometraje anual inferior a 7500, en unidades logarítmicas naturales? b(ii). Determina el intervalo de confianza del 95% correspondiente de las reclamaciones esperadas, en unidades logarítmicas naturales. b(iii). Convierte el intervalo de confianza del 95% de las reclamaciones esperadas que determinaste en la parte b(ii) a dólares. Ejecuta una regresión de LNPAID en AGE, GENDER, y las variables categóricas STATE CODE y CLASS. c(i). ¿Es GENDER una variable estadísticamente significativa? Para responder a esta pregunta, usa una prueba formal de hipótesis. Establece tu hipótesis nula y alternativa, el criterio de toma de decisiones y tu regla de toma de decisiones. c(ii). ¿Es CLASS una variable estadísticamente significativa? Para responder a esta pregunta, usa una prueba formal de hipótesis. Establece tu hipótesis nula y alternativa, el criterio de toma de decisiones y tu regla de toma de decisiones. c(iii). Usa el modelo para proporcionar una estimación puntual de las reclamaciones en dólares (no en dólares logarítmicos) para un hombre de 60 años en el STATE 2 en la CLASS C7. c(iv). Escribe el coeficiente asociado con la CLASS C7 e interpreta este coeficiente. 4.5. Ventas de la Lotería de Wisconsin. Este ejercicio considera los datos de ventas de lotería del Estado de Wisconsin que se describieron en la Sección 2.1 y se examinaron en el Ejercicio 3.4. Parte 1: Decides examinar la relación entre SALES (\\(y\\)) y las ocho variables explicativas (PERPERHH, MEDSCHYR, MEDHVL, PRCRENT, PRC55P, HHMEDAGE, MEDINC, y POP). Ajusta un modelo de regresión de SALES en las ocho variables explicativas. Encuentra \\(R^2\\). b(i). Utilízalo para calcular el coeficiente de correlación entre los valores observados y los valores ajustados. b(ii). Quieres usar \\(R^2\\) para probar la adecuación del modelo en la parte (a). Usa una prueba formal de hipótesis. Establece tu hipótesis nula y alternativa, el criterio de toma de decisiones y tus reglas de toma de decisiones. Prueba si POP, MEDSCHYR, y MEDHVL son variables explicativas importantes de forma conjunta para comprender SALES. Parte 2: Después del análisis preliminar en la Parte 1, decides examinar la relación entre SALES (\\(y\\)) y POP, MEDSCHYR, y MEDHVL. Ajusta un modelo de regresión de SALES en estas tres variables explicativas. ¿Ha disminuido el coeficiente de determinación del modelo de regresión de ocho variables al modelo de tres variables? ¿Significa esto que el modelo no ha mejorado o proporciona poca información? Explica tu respuesta. Para determinar formalmente si se debe usar el modelo de tres o de ocho variables, utiliza una prueba parcial \\(F\\). Establece tu hipótesis nula y alternativa, el criterio de toma de decisiones y tus reglas de toma de decisiones. 4.6. Gastos de Compañías de Seguros. Este ejercicio considera los datos de compañías de seguros del NAIC y descritos en los Ejercicios 1.6 y 3.5. ¿Son importantes los términos cuadrados? Considera un modelo lineal de LNEXPENSES con doce variables explicativas. Para las variables explicativas, incluye ASSETS, GROUP, ambas versiones de pérdidas y primas brutas, así como las dos variables BLS. También incluye el cuadrado de cada una de las dos pérdidas y las dos primas brutas. Prueba si los cuatro términos cuadrados son conjuntamente estadísticamente significativos, usando una prueba parcial \\(F\\). Establece tus hipótesis nula y alternativa, el criterio de toma de decisiones y tus reglas de toma de decisiones. ¿Son importantes los términos de interacción con GROUP? Omite las dos variables BLS, de manera que ahora hay once variables: ASSETS, GROUP, ambas versiones de pérdidas y primas brutas, así como las interacciones de GROUP con ASSETS y ambas versiones de pérdidas y primas brutas. Prueba si los cinco términos de interacción son conjuntamente estadísticamente significativos, usando una prueba parcial \\(F\\). Establece tus hipótesis nula y alternativa, el criterio de toma de decisiones y tus reglas de toma de decisiones. Estás examinando una compañía que no está en la muestra con valores LONGLOSS = 0.025, SHORTLOSS = 0.040, GPWPERSONAL = 0.050, GPWCOMM = 0.120, ASSETS = 0.400, CASH = 0.350, y GROUP = 1. Usa el modelo de interacción de once variables de la parte (b) para producir un intervalo de predicción del 95% para esta compañía. 4.7. Expectativas de Vida Nacionales. Continuamos el análisis iniciado en los Ejercicios 1.7, 2.22, y 3.6. Considera la regresión utilizando tres variables explicativas, FERTILITY, PUBLICEDUCATION, y ln(HEALTH) que hiciste en el Ejercicio 3.6. Prueba si PUBLICEDUCATION y ln(HEALTH) son conjuntamente estadísticamente significativos, usando una prueba parcial \\(F\\). Establece tus hipótesis nula y alternativa, el criterio de toma de decisiones y tus reglas de toma de decisiones. (Sugerencia: Usa la forma del coeficiente de determinación para calcular el estadístico de la prueba.) Proporciona un valor aproximado de \\(p\\) para la prueba. Ahora introducimos la variable REGION, resumida en la Tabla 4.11. Un diagrama de caja de las expectativas de vida versus REGION se muestra en la Figura 4.8. Describe lo que aprendemos de la Tabla y el diagrama de caja sobre el efecto de REGION en LIFEEXP. Figura 4.8: Diagramas de Caja de LIFEEXP por REGION La Tabla 4.11 resume la esperanza de vida promedio por región. REGIÓN Descripción de la Región Número Media 1 Estados Árabes 13 71.9 2 Asia Oriental y Pacífico 17 69.1 3 América Latina y el Caribe 25 72.8 4 Asia Meridional 7 65.1 5 Europa Meridional 3 67.4 6 África Subsahariana 38 52.2 7 Europa Central y Oriental 24 71.6 8 OECD de Altos Ingresos 23 79.6 Todos 150 67.4 Ajusta un modelo de regresión utilizando solo el factor REGION. ¿Es REGION un determinante estadísticamente significativo de LIFEEXP? Establece tus hipótesis nula y alternativa, el criterio de toma de decisiones y tus reglas de toma de decisiones. Ajusta un modelo de regresión utilizando tres variables explicativas, FERTILITY, PUBLICEDUCATION, y ln(HEALTH), así como la variable categórica REGION. d(i). Estás examinando un país que no está en la muestra con valores FERTILITY = 2.0, PUBLICEDUCATION = 5.0, y ln(HEALTH) = 1.0. Produce dos valores predichos de esperanza de vida asumiendo que el país es de (1) un estado árabe y (2) África Subsahariana. d(ii). Proporciona un intervalo de confianza del 95% para la diferencia en expectativas de vida entre un estado árabe y un país de África Subsahariana. d(iii). Proporciona la estimación puntual (usualmente de mínimos cuadrados ordinarios) para la diferencia en expectativas de vida entre un país de África Subsahariana y un país de altos ingresos de la OECD (Organización para la Cooperación y el Desarrollo Económico). 4.7 Suplemento Técnico - Expresiones Matriciales 4.7.1 Expresión de Modelos con Variables Categóricas en Forma Matricial El Capítulo 3 mostró cómo escribir la ecuación del modelo de regresión en la forma \\(\\mathbf{y = X} \\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}\\) donde \\(\\mathbf{X}\\) es una matriz de variables explicativas. Esta forma permite el cálculo directo de los coeficientes de regresión, \\(\\mathbf{b} = \\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{y}\\). Esta sección muestra cómo el modelo y los cálculos se reducen a expresiones más simples cuando las variables explicativas son categóricas. Modelo con una Variable Categórica. Considera el modelo con una variable categórica introducido en la Sección 4.3 con \\(c\\) niveles de la variable categórica. A partir de la ecuación (4.9), este modelo se puede escribir como \\[ \\mathbf{y} = \\begin{bmatrix} y_{1,1} \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\ y_{n_1,1} \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\ y_{1,c} \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\ y_{n_{c},c} \\end{bmatrix} = \\begin{bmatrix} 1 &amp; 0 &amp; \\cdots &amp; 0 \\\\ \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ 1 &amp; 0 &amp; \\cdots &amp; \\cdots \\\\ \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ 0 &amp; 0 &amp; \\cdots &amp; 1 \\\\ \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ 0 &amp; 0 &amp; \\cdots &amp; 1 \\\\ \\end{bmatrix} \\begin{bmatrix} \\mu_1 \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\ \\mu_c \\end{bmatrix} + \\begin{bmatrix} \\varepsilon_{1,1} \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\ \\varepsilon_{n_1,1} \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\ \\varepsilon_{1,c} \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\ \\varepsilon_{n_{c},c} \\end{bmatrix} = \\mathbf{X} \\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon} \\] Para hacer la notación más compacta, escribimos \\(\\mathbf{0}\\) y \\(\\mathbf{1}\\) para una columna de ceros y unos, respectivamente. Con esta convención, otra forma de expresarlo es \\[ \\mathbf{y} = \\begin{bmatrix} \\mathbf{1}_1 &amp; \\mathbf{0}_1 &amp; \\cdots &amp; \\mathbf{0}_1 \\\\ \\mathbf{0}_2 &amp; \\mathbf{1}_2 &amp; \\cdots &amp; \\mathbf{0}_2 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ \\mathbf{0}_c &amp; \\mathbf{0}_c &amp; \\cdots &amp; \\mathbf{1}_c \\end{bmatrix} \\begin{bmatrix} \\mu_1 \\\\ \\mu_2 \\\\ \\vdots \\\\ \\mu_c \\end{bmatrix} + \\boldsymbol{\\varepsilon} = \\mathbf{X} \\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon} \\tag{4.14} \\] Aquí, \\(\\mathbf{0}_1\\) y \\(\\mathbf{1}_1\\) representan columnas de vectores de longitud \\(n_1\\) de ceros y unos, respectivamente, y de manera similar para \\(\\mathbf{0}_2, \\mathbf{1}_2, \\ldots, \\mathbf{0}_c, \\mathbf{1}_c\\). La ecuación (4.14) nos permite aplicar la maquinaria desarrollada para el modelo de regresión al modelo con una variable categórica. Como cálculo intermedio, tenemos \\[ \\begin{array}{ll} (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} &amp;= \\left( \\begin{bmatrix} \\mathbf{1}_1 &amp; \\mathbf{0}_2 &amp; \\cdots &amp; \\mathbf{0}_c \\\\ \\mathbf{0}_1 &amp; \\mathbf{1}_2 &amp; \\cdots &amp; \\mathbf{0}_c \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ \\mathbf{0}_1 &amp; \\mathbf{0}_2 &amp; \\cdots &amp; \\mathbf{1}_c \\end{bmatrix}^{\\prime} \\begin{bmatrix} \\mathbf{1}_1 &amp; \\mathbf{0}_1 &amp; \\cdots &amp; \\mathbf{0}_1 \\\\ \\mathbf{0}_2 &amp; \\mathbf{1}_2 &amp; \\cdots &amp; \\mathbf{0}_2 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ \\mathbf{0}_c &amp; \\mathbf{0}_c &amp; \\cdots &amp; \\mathbf{1}_c \\end{bmatrix} \\right)^{-1}\\\\ &amp;= \\begin{bmatrix} n_1 &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; n_2 &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; \\cdots &amp; n_c \\end{bmatrix}^{-1} = \\begin{bmatrix} \\frac{1}{n_1} &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; \\frac{1}{n_2} &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; \\cdots &amp; \\frac{1}{n_c} \\end{bmatrix} . \\tag{4.15} \\end{array} \\] Así, las estimaciones de los parámetros son \\[ \\mathbf{b} = \\begin{bmatrix} \\hat{\\mu}_1 \\\\ \\vdots \\\\ \\hat{\\mu}_c \\end{bmatrix} = (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} \\mathbf{X}^{\\prime} \\mathbf{y} = \\begin{bmatrix} \\frac{1}{n_1} &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; \\frac{1}{n_2} &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; \\cdots &amp; \\frac{1}{n_c} \\end{bmatrix} \\begin{bmatrix} \\mathbf{1}_1 &amp; \\mathbf{0}_2 &amp; \\cdots &amp; \\mathbf{0}_c \\\\ \\mathbf{0}_1 &amp; \\mathbf{1}_2 &amp; \\cdots &amp; \\mathbf{0}_c \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ \\mathbf{0}_1 &amp; \\mathbf{0}_2 &amp; \\cdots &amp; \\mathbf{1}_c \\end{bmatrix}^{\\prime} \\begin{bmatrix} y_{1,1} \\\\ \\vdots \\\\ y_{n_1,1} \\\\ \\vdots \\\\ y_{1,c} \\\\ \\vdots \\\\ y_{n_{c},c} \\end{bmatrix} \\] \\[ = \\begin{bmatrix} \\frac{1}{n_1} &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; \\frac{1}{n_2} &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; \\cdots &amp; \\frac{1}{n_c} \\end{bmatrix} \\begin{bmatrix} \\sum_{i=1}^{n_1} y_{i1} \\\\ \\vdots \\\\ \\sum_{i=1}^{n_c} y_{ic} \\end{bmatrix} = \\begin{bmatrix} \\bar{y}_1 \\\\ \\vdots \\\\ \\bar{y}_c \\end{bmatrix} \\tag{4.16} \\] Hemos visto que la estimación por mínimos cuadrados de \\(\\mu_j\\), \\(\\bar{y}_j\\), se puede obtener directamente de la ecuación (4.9). Al reescribir el modelo en notación de regresión matricial, podemos recurrir a los resultados del modelo de regresión y no necesitamos probar las propiedades de los modelos con variables categóricas desde los principios básicos. Es decir, dado que este modelo está en formato de regresión, tenemos inmediatamente todas las propiedades del modelo de regresión. Indicar a tu software que una variable es categórica puede significar cálculos más eficientes, como en los cálculos de las estimaciones de regresión por mínimos cuadrados en la ecuación (4.16). Además, el cálculo de otras cantidades también se puede hacer de manera más directa. Como otro ejemplo, tenemos que el error estándar de \\(\\hat{\\mu}_j\\) es \\[ se(\\hat{\\mu}_j) = s ~ \\sqrt{j \\text{ th } \\textit{ diagonal element of } \\mathbf{(X}^{\\prime}\\mathbf{X)}^{-1}} = s/\\sqrt{n_j}. \\] Modelo con Una Variable Categórica y Una Continua Como otra ilustración, consideramos el modelo de intercepto variable y pendiente constante. Este modelo se resume como \\(\\mathbf{y} = \\mathbf{X} \\boldsymbol \\beta + \\boldsymbol \\varepsilon\\) donde \\[ \\mathbf{X} = \\begin{bmatrix} \\mathbf{1}_1 &amp; \\mathbf{0}_1 &amp; \\cdots &amp; \\mathbf{0}_1 &amp; \\mathbf{x}_1 \\\\ \\mathbf{0}_2 &amp; \\mathbf{1}_2 &amp; \\cdots &amp; \\mathbf{0}_2 &amp; \\mathbf{x}_2 \\\\ \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\ \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\ \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\ \\mathbf{0}_{c} &amp; \\mathbf{0}_{c} &amp; \\cdots &amp; \\mathbf{1}_c &amp; \\mathbf{x}_{c} \\end{bmatrix} \\text{ y } \\boldsymbol \\beta = \\begin{bmatrix} \\beta_{01} \\\\ \\beta_{02} \\\\ \\cdots \\\\ \\cdots \\\\ \\cdots \\\\ \\beta_{0c} \\\\ \\beta_1 \\end{bmatrix}. \\tag{4.17} \\] Aquí, \\(\\mathbf{0}_j\\) y \\(\\mathbf{1}_j\\) representan columnas de vectores de longitud \\(n_j\\) de ceros y unos, respectivamente, y \\(\\mathbf{x}_j = (x_{1j}, x_{2j}, \\ldots, x_{n_j, j})^{\\prime}\\) es la columna de la variable continua en el nivel \\(j\\). Técnicas de álgebra matricial sencillas proporcionan las estimaciones por mínimos cuadrados. 4.7.2 Cálculo Recursivo de Mínimos Cuadrados Cuando se calculan los coeficientes de regresión utilizando mínimos cuadrados, \\(\\mathbf{b} = \\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{y}\\), para algunas aplicaciones, la dimensión de \\(\\mathbf{X}^{\\prime} \\mathbf{X}\\) puede ser grande, lo que causa dificultades computacionales. Afortunadamente, para algunos problemas, los cálculos se pueden dividir en problemas más pequeños que se pueden resolver de forma recursiva. Cálculo Recursivo de Mínimos Cuadrados. Supongamos que la función de regresión se puede escribir como \\[ \\mathrm{E}~\\mathbf{y} = \\mathbf{X} \\boldsymbol \\beta = \\left( \\mathbf{X}_1 : \\mathbf{X}_2 \\right) \\left( \\begin{array}{c} \\boldsymbol \\beta_1 \\\\ \\boldsymbol \\beta_2 \\\\ \\end{array} \\right), \\tag{4.18} \\] donde \\(\\mathbf{X}_1\\) tiene dimensiones \\(n \\times k_1\\), \\(\\mathbf{X}_2\\) tiene dimensiones \\(n \\times k_2\\), \\(k_1 + k_2 = k\\), \\(\\boldsymbol \\beta_1\\) tiene dimensiones \\(k_1 \\times 1\\), y \\(\\boldsymbol \\beta_2\\) tiene dimensiones \\(k_2 \\times 1\\). Definimos \\(\\mathbf{Q}_1 = \\mathbf{I} - \\mathbf{X}_1 \\left(\\mathbf{X}_1^{\\prime} \\mathbf{X}_1\\right)^{-1} \\mathbf{X}_1^{\\prime}\\). Entonces, el estimador por mínimos cuadrados se puede calcular como: \\[ \\mathbf{b} = \\left( \\begin{array}{c} \\mathbf{b}_1 \\\\ \\mathbf{b}_2 \\\\ \\end{array} \\right) = \\left( \\begin{array}{c} (\\mathbf{X}_1^{\\prime} \\mathbf{X}_1)^{-1} \\mathbf{X}_1^{\\prime} \\left( \\mathbf{y} - \\mathbf{X}_2 \\mathbf{b}_2 \\right) \\\\ \\left(\\mathbf{X}_2^{\\prime} \\mathbf{Q}_1 \\mathbf{X}_2\\right)^{-1} \\mathbf{X}_2^{\\prime} \\mathbf{Q}_1 \\mathbf{y} \\\\ \\end{array} \\right). \\tag{4.19} \\] La ecuación (4.19) proporciona el primer paso en la recursión. Puede ser iterada fácilmente para permitir una descomposición más detallada de \\(\\mathbf{X}\\). Caso Especial: Modelo con Una Variable Categórica y Una Continua. Para ilustrar la relevancia de la ecuación (4.19), consideremos el modelo resumido en la ecuación (4.17). Aquí, la dimensión de \\(\\mathbf{X}\\) es \\(n \\times (c+1)\\) y, por lo tanto, la dimensión de \\(\\mathbf{X}^{\\prime} \\mathbf{X}\\) es \\((c+1) \\times (c+1)\\). Tomar la inversa de esta matriz podría ser difícil si \\(c\\) es grande. Para aplicar la ecuación (4.19), definimos \\[ \\mathbf{X}_1 = \\begin{bmatrix} \\mathbf{1}_1 &amp; \\mathbf{0}_1 &amp; \\cdots &amp; \\mathbf{0}_1 \\\\ \\mathbf{0}_2 &amp; \\mathbf{1}_2 &amp; \\cdots &amp; \\mathbf{0}_2 \\\\ \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\ \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\ \\cdots &amp; \\cdots &amp; \\cdots &amp; \\cdots \\\\ \\mathbf{0}_c &amp; \\mathbf{0}_c &amp; \\cdots &amp; \\mathbf{1}_c \\end{bmatrix} \\text{ y } \\mathbf{X}_2 = \\begin{bmatrix} \\mathbf{x}_1 \\\\ \\mathbf{x}_2 \\\\ \\cdots \\\\ \\cdots \\\\ \\cdots \\\\ \\mathbf{x}_c \\end{bmatrix}. \\] En este caso, hemos visto en la ecuación (4.15) cómo es sencillo calcular \\(\\left(\\mathbf{X}_1^{\\prime} \\mathbf{X}_1\\right)^{-1}\\) sin necesidad de invertir matrices. Esto hace que el cálculo de \\(\\mathbf{Q}_1\\) sea directo. Con esto, podemos calcular \\(\\mathbf{X}_2^{\\prime} \\mathbf{Q}_1 \\mathbf{X}_2\\) y, dado que es un escalar, obtener inmediatamente su inversa. Esto proporciona \\(\\mathbf{b}_2\\), que luego se usa para calcular \\(\\mathbf{b}_1\\). Aunque este procedimiento no es tan directo como \\(\\mathbf{b} = \\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{y}\\), puede ser computacionalmente eficiente. Resultados de Matrices Particionadas Para establecer la ecuación (4.19), utilizamos resultados estándar en álgebra matricial respecto a las inversas de matrices particionadas. Resultados de Matrices Particionadas. Supongamos que podemos particionar la matriz \\((p+q) \\times (p+q)\\) \\(\\mathbf{B}\\) como \\[ \\mathbf{B} = \\begin{bmatrix} \\mathbf{B}_{11} &amp; \\mathbf{B}_{12} \\\\ \\mathbf{B}_{12}^{\\prime} &amp; \\mathbf{B}_{22} \\end{bmatrix}, \\] donde \\(\\mathbf{B}_{11}\\) es una matriz \\(p \\times p\\) invertible, \\(\\mathbf{B}_{22}\\) es una matriz \\(q \\times q\\) invertible, y \\(\\mathbf{B}_{12}\\) es una matriz \\(p \\times q\\). Entonces \\[ \\mathbf{B}^{-1} = \\begin{bmatrix} \\mathbf{C}_{11}^{-1} &amp; - \\mathbf{B}_{11}^{-1} \\mathbf{B}_{12} \\mathbf{C}_{22}^{-1} \\\\ - \\mathbf{C}_{22}^{-1} \\mathbf{B}_{12}^{\\prime} \\mathbf{B}_{11}^{-1} &amp; \\mathbf{C}_{22}^{-1} \\end{bmatrix}, \\tag{4.20} \\] donde \\(\\mathbf{C}_{11} = \\mathbf{B}_{11} - \\mathbf{B}_{12} \\mathbf{B}_{22}^{-1} \\mathbf{B}_{12}^{\\prime}\\) y \\(\\mathbf{C}_{22} = \\mathbf{B}_{22} - \\mathbf{B}_{12}^{\\prime} \\mathbf{B}_{11}^{-1} \\mathbf{B}_{12}.\\) Para verificar la ecuación (4.20), multiplique \\(\\mathbf{B}^{-1}\\) por \\(\\mathbf{B}\\) para obtener la matriz identidad \\(\\mathbf{I}\\). Además, \\[ \\mathbf{C}_{11}^{-1} = \\mathbf{B}_{11}^{-1} + \\mathbf{B}_{11}^{-1} \\mathbf{B}_{12} \\mathbf{C}_{22}^{-1} \\mathbf{B}_{12}^{\\prime} \\mathbf{B}_{11}^{-1}. \\tag{4.21} \\] Ahora, primero escribimos el estimador de mínimos cuadrados como \\[ \\begin{array}{ll} \\mathbf{b} &amp;= \\left( \\mathbf{X}^{\\prime}\\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{y} = \\left( \\left( \\begin{array}{c} \\mathbf{X}_1^{\\prime} \\\\ \\mathbf{X}_2^{\\prime} \\\\ \\end{array} \\right) \\left( \\mathbf{X}_1 : \\mathbf{X}_2 \\right)\\right)^{-1} \\left( \\begin{array}{c} \\mathbf{X}_1^{\\prime} \\\\ \\mathbf{X}_2^{\\prime} \\\\ \\end{array} \\right) \\mathbf{y} \\\\ &amp; = \\left( \\begin{array}{cc} \\mathbf{X}_1^{\\prime} \\mathbf{X}_1 &amp; \\mathbf{X}_1^{\\prime} \\mathbf{X}_2 \\\\ \\mathbf{X}_2^{\\prime} \\mathbf{X}_1 &amp; \\mathbf{X}_2^{\\prime} \\mathbf{X}_2 \\\\ \\end{array} \\right)^{-1} \\left( \\begin{array}{c} \\mathbf{X}_1^{\\prime} \\mathbf{y} \\\\ \\mathbf{X}_2^{\\prime} \\mathbf{y} \\\\ \\end{array} \\right) = \\left( \\begin{array}{c} \\mathbf{b}_1 \\\\ \\mathbf{b}_2 \\\\ \\end{array} \\right). \\end{array} \\] Para aplicar los resultados de matrices particionadas, definimos \\[ \\mathbf{Q}_j = \\mathbf{I} - \\mathbf{X}_j \\left(\\mathbf{X}_j^{\\prime}\\mathbf{X}_j \\right)^{-1} \\mathbf{X}_j^{\\prime}, \\] donde \\(j=1,2\\), y \\(\\mathbf{B}_{j,k} = \\mathbf{X}_j^{\\prime}\\mathbf{X}_k\\) para \\(j,k=1,2.\\) Esto significa que \\(\\mathbf{C}_{11}=\\mathbf{X}_1^{\\prime}\\mathbf{X}_1 - \\mathbf{X}_1^{\\prime}\\mathbf{X}_2 (\\mathbf{X}_2^{\\prime}\\mathbf{X}_2)^{-1} \\mathbf{X}_2^{\\prime}\\mathbf{X}_1^{\\prime }\\) \\(= \\mathbf{X}_1^{\\prime} \\mathbf{Q}_2 \\mathbf{X}_1\\) y de manera similar \\(\\mathbf{C}_{22} = \\mathbf{X}_2^{\\prime} \\mathbf{Q}_1 \\mathbf{X}_2\\). A partir de la segunda fila, tenemos \\[ \\begin{array}{ll} \\mathbf{b}_2 &amp;= \\mathbf{C}_{22}^{-1} \\left( -\\mathbf{B}_{12}^{\\prime} \\mathbf{B}_{11}^{-1}\\mathbf{X}_1^{\\prime} \\mathbf{y} + \\mathbf{X}_2^{\\prime} \\mathbf{y} \\right) \\\\ &amp;= \\left(\\mathbf{X}_2^{\\prime} \\mathbf{Q}_1 \\mathbf{X}_2 \\right)^{-1} \\left( - \\mathbf{X}_2^{\\prime} \\mathbf{X}_1 (\\mathbf{X}_1^{\\prime}\\mathbf{X}_1)^{-1} \\mathbf{X}_1^{\\prime} \\mathbf{y} + \\mathbf{X}_2^{\\prime}\\mathbf{y} \\right) \\\\ &amp;= \\left(\\mathbf{X}_2^{\\prime} \\mathbf{Q}_1 \\mathbf{X}_2 \\right)^{-1} \\mathbf{X}_2^{\\prime} \\mathbf{Q}_1\\mathbf{y}. \\end{array} \\] A partir de la primera fila, \\[ \\begin{array}{ll} \\mathbf{b}_1 &amp;= \\mathbf{C}_{11}^{-1} \\mathbf{X}_1^{\\prime}\\mathbf{y} - \\mathbf{B}_{11}^{-1}\\mathbf{B}_{12}\\mathbf{C}_{22}^{-1} \\mathbf{X}_2^{\\prime}\\mathbf{y} \\\\ &amp;= \\left( \\mathbf{B}_{11}^{-1} + \\mathbf{B}_{11}^{-1} \\mathbf{B}_{12} \\mathbf{C}_{22}^{-1} \\mathbf{B}_{21} \\mathbf{B}_{11}^{-1} \\right) \\mathbf{X}_1^{\\prime}\\mathbf{y} - \\mathbf{B}_{11}^{-1}\\mathbf{B}_{12}\\mathbf{C}_{22}^{-1} \\mathbf{X}_2^{\\prime}\\mathbf{y} \\\\ &amp;= \\mathbf{B}_{11}^{-1}\\mathbf{X}_1^{\\prime}\\mathbf{y} - \\mathbf{B}_{11}^{-1} \\mathbf{B}_{12} \\mathbf{C}_{22}^{-1} \\left( -\\mathbf{B}_{21} \\mathbf{B}_{11}^{-1} \\mathbf{X}_1^{\\prime}\\mathbf{y} + \\mathbf{X}_2^{\\prime}\\mathbf{y} \\right)\\\\ &amp;= \\mathbf{B}_{11}^{-1}\\mathbf{X}_1^{\\prime}\\mathbf{y} - \\mathbf{B}_{11}^{-1} \\mathbf{B}_{12} \\mathbf{b}_2 \\\\ &amp;= (\\mathbf{X}_1^{\\prime}\\mathbf{X}_1)^{-1}\\mathbf{X}_1^{\\prime}\\mathbf{y} - (\\mathbf{X}_1^{\\prime}\\mathbf{X}_1)^{-1} \\mathbf{X}_1^{\\prime}\\mathbf{X}_2 \\mathbf{b}_2 \\\\ &amp;= (\\mathbf{X}_1^{\\prime}\\mathbf{X}_1)^{-1}\\mathbf{X}_1^{\\prime} \\left( \\mathbf{y} - \\mathbf{X}_2 \\mathbf{b}_2 \\right). \\end{array} \\] Esto establece la ecuación (4.19). Modelo Reparametrizado. Para la función de regresión particionada en la ecuación (4.18), definimos \\(\\mathbf{A}= \\left( \\mathbf{X}_1^{\\prime} \\mathbf{X}_1 \\right)^{-1} \\mathbf{X}_1^{\\prime} \\mathbf{X}_2\\) y \\(\\mathbf{E}_2 = \\mathbf{X}_2 - \\mathbf{X}_1 \\mathbf{A}\\). Si se realizara una regresión “multivariada” usando \\(\\mathbf{X}_2\\) como la respuesta y \\(\\mathbf{X}_1\\) como variables explicativas, entonces las estimaciones de parámetros serían \\(\\mathbf{A}\\) y los residuos \\(\\mathbf{E}_2\\). Con estas definiciones, use la ecuación (4.18) para definir el modelo de regresión reparametrizado \\[ \\begin{array}{ll} \\mathbf{y} &amp; = \\mathbf{X}_1 \\boldsymbol \\beta_1 + \\mathbf{X}_2 \\boldsymbol \\beta_2 + \\boldsymbol \\varepsilon = \\mathbf{X}_1 \\boldsymbol \\beta_1 + (\\mathbf{E}_2 + \\mathbf{X}_1 \\mathbf{A})\\boldsymbol \\beta_2 + \\boldsymbol \\varepsilon \\\\ &amp; = \\mathbf{X}_1 \\boldsymbol \\alpha_1 + \\mathbf{E}_2 \\boldsymbol \\beta_2 + \\boldsymbol \\varepsilon, \\end{array} \\tag{4.22} \\] donde \\(\\boldsymbol \\alpha_1 = \\boldsymbol \\beta_1 + \\mathbf{A}\\boldsymbol \\beta_2\\) es un nuevo vector de parámetros. La razón para introducir esta nueva parametrización es que ahora el vector de variables explicativas es ortogonal a las otras variables explicativas, es decir, el álgebra directa muestra que \\(\\mathbf{X}_1^{\\prime }\\mathbf{E}_2=\\mathbf{0}\\). Según la ecuación (4.19), el vector de estimaciones de mínimos cuadrados es \\[ \\begin{array}{ll} \\mathbf{a} = \\begin{bmatrix} \\mathbf{a}_1 \\\\ \\mathbf{b}_2 \\end{bmatrix} = \\left( \\begin{bmatrix} \\mathbf{X}_1^{\\prime} \\\\ \\mathbf{E}_2^{\\prime} \\end{bmatrix} \\begin{bmatrix} \\mathbf{X}_1 &amp; \\mathbf{E}_2 \\end{bmatrix} \\right) ^{-1} \\begin{bmatrix} \\mathbf{X}_1^{\\prime} \\\\ \\mathbf{E}_2^{\\prime} \\end{bmatrix} \\mathbf{y} = \\begin{bmatrix} \\left( \\mathbf{X}_1^{\\prime} \\mathbf{X}_1 \\right)^{-1} \\mathbf{X}_1^{\\prime} \\mathbf{y} \\\\ \\left( \\mathbf{E}_2^{\\prime}\\mathbf{E}_2\\right) ^{-1} \\mathbf{E}_2^{\\prime}\\mathbf{y} \\end{bmatrix}. \\end{array} \\tag{4.23} \\] Suma Extra de Cuadrados. Supongamos que queremos considerar el aumento en la suma de cuadrados del error al pasar de un modelo reducido \\[ \\mathbf{y} = \\mathbf{X}_1 \\boldsymbol \\beta_1 + \\boldsymbol \\varepsilon \\] a un modelo completo \\[ \\mathbf{y} = \\mathbf{X}_1 \\boldsymbol \\beta_1 + \\mathbf{X}_2 \\boldsymbol \\beta_2 + \\boldsymbol \\varepsilon. \\] Para el modelo reducido, la suma de cuadrados del error es \\[ (Error ~ SS)_{reduced} = \\mathbf{y}^{\\prime} \\mathbf{y} - \\mathbf{y}^{\\prime} \\mathbf{X}_1 (\\mathbf{X}_1^{\\prime} \\mathbf{X}_1)^{-1} \\mathbf{X}_1^{\\prime} \\mathbf{y}. \\tag{4.24} \\] Usando la versión reparametrizada del modelo completo, la suma de cuadrados del error es \\[ \\begin{array}{ll} (Error ~ SS)_{full} &amp;= \\mathbf{y}^{\\prime} \\mathbf{y} - \\mathbf{a}^{\\prime} \\begin{bmatrix} \\mathbf{X}_1^{\\prime} \\\\ \\mathbf{E}_2^{\\prime} \\end{bmatrix} \\mathbf{y} = \\mathbf{y}^{\\prime}\\mathbf{y} - \\begin{bmatrix} \\left( \\mathbf{X}_1^{\\prime} \\mathbf{X}_1 \\right)^{-1} \\mathbf{X}_1^{\\prime} \\mathbf{y} \\\\ \\left( \\mathbf{E}_2^{\\prime}\\mathbf{E}_2\\right)^{-1} \\mathbf{E}_2^{\\prime} \\mathbf{y} \\end{bmatrix}^{\\prime} \\begin{bmatrix} \\mathbf{X}_1^{\\prime} \\mathbf{y} \\\\ \\mathbf{E}_2^{\\prime}\\mathbf{y} \\end{bmatrix} \\\\ &amp;= \\mathbf{y}^{\\prime} \\mathbf{y} - \\mathbf{y}^{\\prime} \\mathbf{X}_1 (\\mathbf{X}_1^{\\prime} \\mathbf{X}_1)^{-1} \\mathbf{X}_1^{\\prime} \\mathbf{y} - \\mathbf{y}^{\\prime} \\mathbf{E}_2 (\\mathbf{E}_2^{\\prime} \\mathbf{E}_2)^{-1} \\mathbf{E}_2^{\\prime} \\mathbf{y}. \\tag{4.25} \\end{array} \\] Así, la reducción en la suma de cuadrados del error al agregar \\(\\mathbf{X}_2\\) al modelo es \\[ (Error ~SS)_{reduced} - (Error ~SS)_{full} = \\mathbf{y}^{\\prime} \\mathbf{E}_2 (\\mathbf{E}_2^{\\prime} \\mathbf{E}_2)^{-1} \\mathbf{E}_2^{\\prime} \\mathbf{y}. \\tag{4.26} \\] Como se mencionó en la Sección 4.3, la cantidad \\((Error ~SS)_{reduced} - (Error ~SS)_{full}\\) se llama suma extra de cuadrados, o suma de cuadrados Tipo III. Esto se produce automáticamente por algunos paquetes de software estadístico, evitando así la necesidad de ejecutar regresiones separadas. 4.7.3 Modelo Lineal General Recuerda el modelo lineal general de la Sección 4.4. Es decir, usamos \\[ y_i = \\beta_0 x_{i0} + \\beta_1 x_{i1} + \\ldots + \\beta_k x_{ik} + \\varepsilon_i, \\] o, en notación de matrices, \\(\\mathbf{y} = \\mathbf{X} \\boldsymbol \\beta + \\boldsymbol \\varepsilon\\). Como antes, utilizamos las Suposiciones F1-F4 (o E1-E4) para que los términos de perturbación sean i.i.d. con media cero y varianza común \\(\\sigma^2\\), y las variables explicativas \\(\\{x_{i0},x_{i1},x_{i2},\\ldots,x_{ik}\\}\\) sean no estocásticas. En el modelo lineal general, no requerimos que \\(\\mathbf{X}^{\\prime}\\mathbf{X}\\) sea invertible. Como hemos visto en el Capítulo 4, una razón importante para esta generalización se relaciona con el manejo de variables categóricas. Es decir, para usar variables categóricas, generalmente se recodifican utilizando variables binarias. Para esta recodificación, generalmente se deben hacer algunos tipos de restricciones en el conjunto de parámetros asociados con las variables indicadoras. Sin embargo, no siempre está claro qué tipo de restricciones son las más intuitivas. Al expresar el modelo sin requerir que \\(\\mathbf{X}^{\\prime}\\mathbf{X}\\) sea invertible, las restricciones pueden imponerse después de que se realice la estimación, no antes. Ecuaciones Normales. Incluso cuando \\(\\mathbf{X}^{\\prime}\\mathbf{X}\\) no es invertible, las soluciones a las ecuaciones normales aún proporcionan estimaciones de mínimos cuadrados de \\(\\boldsymbol \\beta\\). Es decir, la suma de cuadrados es \\[ SS(\\mathbf{b}^{\\ast}) = \\mathbf{(y - Xb}^{\\ast}\\mathbf{)}^{\\prime}\\mathbf{(y - Xb}^{\\ast}\\mathbf{)}, \\] donde \\(\\mathbf{b}^{\\ast} = (b_0^{\\ast}, b_1^{\\ast}, \\ldots, b_k^{\\ast})^{\\prime}\\) es un vector de estimaciones candidatas. Las soluciones de las ecuaciones normales son aquellos vectores \\(\\mathbf{b}^{\\circ }\\) que satisfacen las ecuaciones normales \\[ \\mathbf{X}^{\\prime}\\mathbf{Xb}^{\\circ } = \\mathbf{X}^{\\prime}\\mathbf{y}. \\tag{4.27} \\] Usamos la notación \\(^{\\circ }\\) para recordarnos que \\(\\mathbf{b}^{\\circ }\\) no tiene que ser único. Sin embargo, es un minimizador de la suma de cuadrados. Para ver esto, considera otro vector candidato \\(\\mathbf{b}^{\\ast}\\) y nota que \\[ SS(\\mathbf{b}^{\\ast}) = \\mathbf{y}^{\\prime}\\mathbf{y} - 2\\mathbf{b}^{\\ast \\prime }\\mathbf{X}^{\\prime}\\mathbf{y} + \\mathbf{b}^{\\ast \\prime }\\mathbf{X}^{\\prime}\\mathbf{Xb}^{\\ast}. \\] Luego, usando la ecuación (4.27), tenemos \\[ SS(\\mathbf{b}^{\\ast}) - SS(\\mathbf{b}^{\\circ }) = -2\\mathbf{b}^{\\ast \\prime }\\mathbf{X}^{\\prime}\\mathbf{y} + \\mathbf{b}^{\\ast \\prime }\\mathbf{X}^{\\prime}\\mathbf{Xb}^{\\ast} - (-2\\mathbf{b}^{\\circ \\prime }\\mathbf{Xy} + \\mathbf{b}^{\\circ \\prime }\\mathbf{X}^{\\prime}\\mathbf{Xb}^{\\circ }) \\] \\[ = -2\\mathbf{b}^{\\ast \\prime }\\mathbf{Xb}^{\\circ } + \\mathbf{b}^{\\ast \\prime }\\mathbf{X}^{\\prime}\\mathbf{Xb}^{\\ast} + \\mathbf{b}^{\\circ \\prime }\\mathbf{X}^{\\prime}\\mathbf{Xb}^{\\circ } \\] \\[ = \\mathbf{(b}^{\\ast} - \\mathbf{b}^{\\circ})^{\\prime} \\mathbf{X}^{\\prime} \\mathbf{X} (\\mathbf{b}^{\\ast} - \\mathbf{b}^{\\circ}) = \\mathbf{z}^{\\prime} \\mathbf{z} \\geq 0, \\] donde \\(\\mathbf{z} = \\mathbf{X} (\\mathbf{b}^{\\ast} - \\mathbf{b}^{\\circ})\\). Así, cualquier otro candidato \\(\\mathbf{b}^{\\ast}\\) produce una suma de cuadrados al menos tan grande como \\(SS(\\mathbf{b}^{\\circ})\\). Valores Ajustados Únicos A pesar de que puede haber (infinitas) soluciones a las ecuaciones normales, los valores ajustados resultantes, \\(\\mathbf{\\hat{y}} = \\mathbf{Xb}^{\\circ}\\), son únicos. Para ver esto, supongamos que \\(\\mathbf{b}_1^{\\circ}\\) y \\(\\mathbf{b}_2^{\\circ}\\) son dos soluciones diferentes de la ecuación (4.27). Sea \\(\\mathbf{\\hat{y}}_1 = \\mathbf{Xb}_1^{\\circ}\\) y \\(\\mathbf{\\hat{y}}_2 = \\mathbf{Xb}_2^{\\circ}\\) los vectores de valores ajustados generados por estas estimaciones. Entonces, \\[ \\mathbf{(\\hat{y}}_1 - \\mathbf{\\hat{y}}_2)^{\\prime} (\\mathbf{\\hat{y}}_1 - \\mathbf{\\hat{y}}_2) = \\mathbf{(b}_1^{\\circ} - \\mathbf{b}_2^{\\circ})^{\\prime} \\mathbf{X}^{\\prime} \\mathbf{X} (\\mathbf{b}_1^{\\circ} - \\mathbf{b}_2^{\\circ}) = 0 \\] porque \\(\\mathbf{X}^{\\prime} \\mathbf{X} (\\mathbf{b}_1^{\\circ} - \\mathbf{b}_2^{\\circ}) = \\mathbf{X}^{\\prime} \\mathbf{y} - \\mathbf{X}^{\\prime} \\mathbf{y} = \\mathbf{0}\\), de la ecuación (4.27). Por lo tanto, tenemos que \\(\\mathbf{\\hat{y}}_1 = \\mathbf{\\hat{y}}_2\\) para cualquier elección de \\(\\mathbf{b}_1^{\\circ}\\) y \\(\\mathbf{b}_2^{\\circ}\\), estableciendo así la unicidad de los valores ajustados. Debido a que los valores ajustados son únicos, los residuos también son únicos. Por lo tanto, la suma de cuadrados de los errores y las estimaciones de la variabilidad (como \\(s^2\\)) también son únicas. Inversas Generalizadas Una inversa generalizada de una matriz \\(\\mathbf{A}\\) es una matriz \\(\\mathbf{B}\\) tal que \\(\\mathbf{ABA = A}\\). Usamos la notación \\(\\mathbf{A}^{\\mathbf{-}}\\) para denotar la inversa generalizada de \\(\\mathbf{A}\\). En el caso de que \\(\\mathbf{A}\\) sea invertible, entonces \\(\\mathbf{A}^{\\mathbf{-}}\\) es única e igual a \\(\\mathbf{A}^{\\mathbf{-1}}\\). Aunque existen varias definiciones de inversas generalizadas, la definición anterior es suficiente para nuestros propósitos. Ver Searle (1987) para una discusión más profunda sobre definiciones alternativas de inversas generalizadas. Con esta definición, se puede mostrar que una solución a la ecuación \\(\\mathbf{Ab = c}\\) puede expresarse como \\(\\mathbf{b = A}^{-} \\mathbf{c}\\). Así, podemos expresar una estimación de mínimos cuadrados de \\(\\boldsymbol \\beta\\) como \\(\\mathbf{b}^{\\circ} = (\\mathbf{X}^{\\prime} \\mathbf{X})^{-} \\mathbf{X}^{\\prime} \\mathbf{y}\\). Los paquetes de software estadístico pueden calcular versiones de \\((\\mathbf{X}^{\\prime} \\mathbf{X})^{-}\\) y así generar \\(\\mathbf{b}^{\\circ}\\). Funciones Estimables Anteriormente, vimos que cada valor ajustado \\(\\hat{y}_i\\) es único. Dado que los valores ajustados son simplemente combinaciones lineales de estimaciones de parámetros, parece razonable preguntar qué otras combinaciones lineales de estimaciones de parámetros son únicas. Con este fin, decimos que \\(\\mathbf{C \\boldsymbol \\beta}\\) es una función estimable de los parámetros si \\(\\mathbf{Cb}^{\\circ}\\) no depende (es invariante) de la elección de \\(\\mathbf{b}^{\\circ}\\). Debido a que los valores ajustados son invariantes a la elección de \\(\\mathbf{b}^{\\circ}\\), tenemos que \\(\\mathbf{C = X}\\) produce un tipo de función estimable. Curiosamente, resulta que todas las funciones estimables son de la forma \\(\\mathbf{LXb}^{\\circ}\\), es decir, \\(\\mathbf{C} = \\mathbf{LX}\\). Ver Searle (1987, página 284) para una demostración de esto. Así, todas las funciones estimables son combinaciones lineales de valores ajustados, es decir, \\(\\mathbf{LXb}^{\\circ} = \\mathbf{L\\hat{y}}\\). Las funciones estimables son insesgadas y tienen una varianza que no depende de la elección de la inversa generalizada. Es decir, se puede mostrar que \\(\\text{E } \\mathbf{Cb}^{\\circ} = \\mathbf{C \\boldsymbol \\beta}\\) y \\(\\text{Var } \\mathbf{Cb}^{\\circ} = \\sigma^2 \\mathbf{C(X}^{\\prime} \\mathbf{X})^{-} \\mathbf{C}^{\\prime}\\) no depende de la elección de \\(\\mathbf{(X}^{\\prime} \\mathbf{X})^{-}\\). Hipótesis Comprobables Como se describe en la Sección 4.2, a menudo interesa probar \\(H_0\\): \\(\\mathbf{C \\boldsymbol \\beta} = \\mathbf{d}\\), donde \\(\\mathbf{d}\\) es un vector especificado. Esta hipótesis se dice que es comprobable si \\(\\mathbf{C \\boldsymbol \\beta}\\) es una función estimable, \\(\\mathbf{C}\\) es de rango completo en filas, y el rango de \\(\\mathbf{C}\\) es menor que el rango de \\(\\mathbf{X}\\). Para ser consistentes con la notación de la Sección 4.2, sea \\(p\\) el rango de \\(\\mathbf{C}\\) y \\(k + 1\\) el rango de \\(\\mathbf{X}\\). Recordemos que el rango de una matriz es el menor entre el número de filas linealmente independientes y el número de columnas linealmente independientes. Cuando decimos que \\(\\mathbf{C}\\) tiene rango completo en filas, nos referimos a que hay \\(p\\) filas en \\(\\mathbf{C}\\), de modo que el número de filas es igual al rango. Hipótesis Lineal General Como en la Sección 4.2, la estadística de prueba para examinar \\(H_0\\): \\(\\mathbf{C \\boldsymbol \\beta} = \\mathbf{d}\\) es \\[ F\\text{-ratio} = \\frac{\\mathbf{(Cb}^{\\circ} - \\mathbf{d})^{\\prime} \\mathbf{(C(X}^{\\prime} \\mathbf{X})^{-} \\mathbf{C}^{\\prime})^{-1} \\mathbf{(Cb}^{\\circ} - \\mathbf{d})}{ps_{full}^2}. \\] Note que la estadística \\(F\\)-ratio no depende de la elección de \\(\\mathbf{b}^{\\circ}\\) porque \\(\\mathbf{C b}^{\\circ}\\) es invariante a \\(\\mathbf{b}^{\\circ}\\). Si \\(H_0\\): \\(\\mathbf{C \\boldsymbol \\beta} = \\mathbf{d}\\) es una hipótesis comprobable y los errores \\(\\varepsilon_i\\) son i.i.d. \\(\\text{N}(0, \\sigma^2)\\), entonces el \\(F\\)-ratio tiene una distribución \\(F\\) con \\(df_1 = p\\) y \\(df_2 = n - (k + 1)\\). Modelo de Una Variable Categórica Ahora ilustramos el modelo lineal general considerando una versión sobre-parametr izada del modelo de un factor que aparece en la ecuación (4.10) usando \\[ y_{ij} = \\mu + \\tau_j + e_{ij} = \\mu + \\tau_1 x_{i1} + \\tau_2 x_{i2} + \\ldots + \\tau_c x_{ic} + \\varepsilon_{ij}. \\] En este punto, no imponemos restricciones adicionales en los parámetros. Como en la ecuación (4.13), esto se puede escribir en forma matricial como \\[ \\mathbf{y} = \\begin{bmatrix} \\mathbf{1}_1 &amp; \\mathbf{1}_1 &amp; \\mathbf{0}_1 &amp; \\cdots &amp; \\mathbf{0}_1 \\\\ \\mathbf{1}_2 &amp; \\mathbf{0}_2 &amp; \\mathbf{1}_{\\mathbf{2}} &amp; \\cdots &amp; \\mathbf{0}_2 \\\\ \\cdot &amp; \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ \\mathbf{1}_c &amp; \\mathbf{0}_c &amp; \\mathbf{0}_c &amp; \\cdots &amp; \\mathbf{1}_c \\end{bmatrix} \\begin{bmatrix} \\mu \\\\ \\tau_1 \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\ \\tau_c \\end{bmatrix} + \\boldsymbol \\varepsilon = \\mathbf{X \\boldsymbol \\beta + \\boldsymbol \\varepsilon}. \\] Así, la matriz \\(\\mathbf{X}^{\\prime} \\mathbf{X}\\) es \\[ \\mathbf{X}^{\\prime} \\mathbf{X} = \\begin{bmatrix} n &amp; n_1 &amp; n_2 &amp; \\cdots &amp; n_c \\\\ n_1 &amp; n_1 &amp; 0 &amp; \\cdots &amp; 0 \\\\ n_2 &amp; 0 &amp; n_2 &amp; \\cdots &amp; 0 \\\\ \\cdot &amp; \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ \\cdot &amp; \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ \\cdot &amp; \\cdot &amp; \\cdot &amp; \\cdots &amp; \\cdot \\\\ n_c &amp; 0 &amp; 0 &amp; \\cdots &amp; n_c \\end{bmatrix}. \\] donde \\(n = n_1 + n_2 + \\ldots + n_{c}\\). Esta matriz no es invertible. Para ver esto, note que al sumar las últimas \\(c\\) filas juntas se obtiene la primera fila. Por lo tanto, las últimas \\(c\\) filas son una combinación lineal exacta de la primera fila, lo que significa que la matriz no tiene rango completo. Las estimaciones (no únicas) de mínimos cuadrados se pueden expresar como \\[ \\mathbf{b}^{\\circ} = \\begin{bmatrix} \\mu^{\\circ} \\\\ \\tau_1^{\\circ} \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\ \\tau_c^{\\circ} \\end{bmatrix} = (\\mathbf{X}^{\\prime} \\mathbf{X})^{-} \\mathbf{X}^{\\prime} \\mathbf{y}. \\] Las funciones estimables son combinaciones lineales de los valores ajustados. Dado que los valores ajustados son \\(\\hat{y}_{ij} = \\bar{y}_j\\), las funciones estimables pueden expresarse como \\(L = \\sum_{j=1}^{c} a_j \\bar{y}_j\\) donde \\(a_1, \\ldots, a_{c}\\) son constantes. Esta combinación lineal de los valores ajustados es un estimador insesgado de \\(\\text{E } L = \\sum_{i=1}^{c} a_i (\\mu + \\tau_i)\\). Por lo tanto, por ejemplo, eligiendo \\(a_1 = 1\\) y los otros \\(a_i = 0\\), vemos que \\(\\mu + \\tau_1\\) es estimable. Como otro ejemplo, eligiendo \\(a_1 = 1\\), \\(a_2 = -1\\), y los otros \\(a_i = 0\\), vemos que \\(\\tau_1 - \\tau_2\\) es estimable. Se puede demostrar que \\(\\mu\\) no es un parámetro estimable sin restricciones adicionales sobre \\(\\tau_1, \\ldots, \\tau_c\\). "],["C5VarSelect.html", "Chapter 5 Selección de Variables 5.1 Un Enfoque Iterativo para el Análisis de Datos y Modelado 5.2 Procedimientos Automáticos de Selección de Variables 5.3 Análisis de Residuales 5.4 Puntos Influyentes 5.5 Colinealidad 5.6 Criterios de Selección 5.7 Heterocedasticidad 5.8 Lectura Adicional y Referencias 5.9 Ejercicios 5.10 Suplementos Técnicos para el Capítulo 5", " Chapter 5 Selección de Variables Vista previa del capítulo. Este capítulo describe herramientas y técnicas para ayudar a seleccionar las variables a incluir en un modelo de regresión lineal, comenzando con un proceso iterativo de selección de modelos. En aplicaciones con muchas variables explicativas potenciales, los procedimientos automáticos de selección de variables ayudan a evaluar rápidamente muchos modelos. Sin embargo, los procedimientos automáticos tienen serias limitaciones, incluida la incapacidad de manejar adecuadamente las no linealidades como el impacto de puntos inusuales; este capítulo amplía la discusión del Capítulo 2 sobre puntos inusuales. También se describe la colinealidad, una característica común de los datos de regresión donde las variables explicativas están linealmente relacionadas entre sí. Otros temas que afectan la selección de variables, como la heterocedasticidad y la validación fuera de muestra, también se introducen. 5.1 Un Enfoque Iterativo para el Análisis de Datos y Modelado En nuestra introducción a la regresión lineal básica en el Capítulo 2, examinamos los datos gráficamente, formulamos una hipótesis sobre la estructura del modelo y comparamos los datos con un modelo candidato para formular un modelo mejorado. Box (1980) describe esto como un proceso iterativo, que se muestra en la Figura 5.1. Figura 5.1: El proceso iterativo de especificación del modelo Este proceso iterativo proporciona una receta útil para estructurar la tarea de especificar un modelo que represente un conjunto de datos. El primer paso, la etapa de formulación del modelo, se realiza examinando los datos gráficamente y utilizando el conocimiento previo de las relaciones, como de la teoría económica o de la práctica estándar de la industria. El segundo paso en la iteración se basa en los supuestos del modelo especificado. Estos supuestos deben ser consistentes con los datos para hacer un uso válido del modelo. El tercer paso, verificación diagnóstica, también se conoce como crítica de datos y modelo; los datos y el modelo deben ser consistentes entre sí antes de que se puedan hacer inferencias adicionales. La verificación diagnóstica es una parte importante de la formulación del modelo; puede revelar errores cometidos en pasos anteriores y proporcionar formas de corregir estos errores. 5.2 Procedimientos Automáticos de Selección de Variables Las relaciones en negocios y economía son complicadas; típicamente hay muchas variables que podrían servir como predictores útiles de la variable dependiente. Al buscar una relación adecuada, hay una gran cantidad de modelos potenciales que se basan en combinaciones lineales de variables explicativas y un número infinito de modelos que pueden formarse a partir de combinaciones no lineales. Para buscar entre los modelos basados en combinaciones lineales, existen varios procedimientos automáticos para seleccionar las variables que se incluirán en el modelo. Estos procedimientos automáticos son fáciles de usar y sugerirán uno o más modelos que se pueden explorar con mayor detalle. Para ilustrar cuán grande es el número potencial de modelos lineales, supongamos que solo hay cuatro variables, \\(x_{1}, x_2, x_3\\) y \\(x_4\\), bajo consideración para ajustar un modelo a \\(y\\). Sin considerar la multiplicación u otras combinaciones no lineales de las variables explicativas, ¿cuántos modelos posibles hay? La Tabla 5.1 muestra que la respuesta es 16. Tabla 5.1: Dieciséis Modelos Posibles Expression Combinations Models E \\(y=\\beta_0\\) 1 modelo sin variables independientes E \\(y=\\beta_0+\\beta_1x_i\\) \\(i\\) = 1,2,3,4 4 modelos con una variable independiente E \\(y = \\beta_0 + \\beta_1 x_i + \\beta_2 x_j\\) (\\(i,j\\)) = (1,2),(1,3),(1,4),(2,3),(2,4),(3,4) 6 modelos con dos variables independientes E \\(y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_j +\\beta_3x_{k}\\) (\\(i,j,k\\)) = (1,2,3),(1,2,4),(1,3,4),(2,3,4) 4 modelos con tres variables independientes E \\(y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 +\\beta_3 x_3 + \\beta_4 x_4\\) 1 modelo con todas las variables independientes Si solo hubiera tres variables explicativas, entonces se puede usar la misma lógica para verificar que hay ocho modelos posibles. Extrapolando a partir de estos dos ejemplos, ¿cuántos modelos lineales habrá si hay diez variables explicativas? La respuesta es 1,024, lo cual es bastante. En general, la respuesta es \\(2^k\\), donde \\(k\\) es el número de variables explicativas. Por ejemplo, \\(2^3\\) es 8, \\(2^4\\) es 16, y así sucesivamente. En cualquier caso, para un número moderadamente grande de variables explicativas, hay muchos modelos potenciales que se basan en combinaciones lineales de variables explicativas. Nos gustaría tener un procedimiento para buscar rápidamente entre estos modelos potenciales y darnos más tiempo para pensar en otros aspectos interesantes de la selección de modelos. La regresión por pasos son procedimientos que emplean pruebas \\(t\\) para verificar la “significancia” de las variables explicativas que se incluyen o eliminan del modelo. Para comenzar, en la versión de selección hacia adelante de la regresión por pasos, las variables se agregan una a la vez. En la primera etapa, de todas las variables candidatas, se agrega al modelo la que es más estadísticamente significativa. En la siguiente etapa, con la variable de la primera etapa ya incluida, se agrega la siguiente variable más estadísticamente significativa. Este procedimiento se repite hasta que se hayan agregado todas las variables estadísticamente significativas. Aquí, la significancia estadística generalmente se evalúa utilizando el cociente \\(t\\) de una variable; el umbral para la significancia estadística es típicamente un valor \\(t\\) predefinido (como dos, que corresponde a un nivel de significancia aproximado del 95%). La versión de selección hacia atrás funciona de manera similar, excepto que todas las variables se incluyen en la etapa inicial y luego se eliminan una a la vez (en lugar de agregarse). Más generalmente, un algoritmo que agrega y elimina variables en cada etapa a veces se conoce como el algoritmo de regresión por pasos. Algoritmo de Regresión por Pasos. Suponga que el analista ha identificado una variable como la respuesta, \\(y\\), y \\(k\\) variables explicativas potenciales, \\(x_1, x_2, \\ldots, x_k\\). Considere todas las regresiones posibles usando una variable explicativa. Para cada una de las \\(k\\) regresiones, calcule \\(t(b_1)\\), el cociente \\(t\\) para la pendiente. Elija la variable con el cociente \\(t\\) más grande. Si el cociente \\(t\\) no supera un valor \\(t\\) predefinido (como dos), entonces no elija ninguna variable y detenga el procedimiento. Agregue una variable al modelo del paso anterior. La variable a ingresar es la que hace la contribución más significativa. Para determinar el tamaño de la contribución, use el valor absoluto del cociente \\(t\\) de la variable. Para ingresar, el cociente \\(t\\) debe superar un valor \\(t\\) especificado en valor absoluto. Elimine una variable del modelo del paso anterior. La variable a eliminar es la que hace la menor contribución. Para determinar el tamaño de la contribución, use el valor absoluto del cociente \\(t\\) de la variable. Para ser eliminada, el cociente \\(t\\) debe ser menor que un valor \\(t\\) especificado en valor absoluto. Repita los pasos (ii) y (iii) hasta que se realicen todas las posibles adiciones y eliminaciones. Al implementar esta rutina, algunos paquetes de software estadístico usan una prueba \\(F\\) en lugar de pruebas \\(t\\). Recuerde que, cuando solo se considera una variable, \\((t\\text{-cociente})^2 = F\\)-cociente, y por lo tanto, estos procedimientos son equivalentes. Este algoritmo es útil porque busca rápidamente entre varios modelos candidatos. Sin embargo, presenta varias desventajas: El procedimiento “husmea” entre un gran número de modelos y puede ajustar los datos “demasiado bien.” No hay garantía de que el modelo seleccionado sea el mejor. El algoritmo no considera modelos que se basan en combinaciones no lineales de variables explicativas. También ignora la presencia de valores atípicos y puntos de alta influencia. Además, el algoritmo no busca todos los \\(2^{k}\\) regresiones lineales posibles. El algoritmo utiliza un criterio, un cociente \\(t\\), y no considera otros criterios como \\(s\\), \\(R^2\\), \\(R_a^2\\), y así sucesivamente. Hay una secuencia de pruebas de significancia involucradas. Por lo tanto, el nivel de significancia que determina el valor \\(t\\) no es significativo. Al considerar cada variable por separado, el algoritmo no toma en cuenta el efecto conjunto de las variables explicativas. Los procedimientos puramente automáticos pueden no tener en cuenta el conocimiento especial de un investigador. Muchas de las críticas al algoritmo básico de regresión paso a paso pueden abordarse con software de computación moderno que ahora está ampliamente disponible. Ahora consideraremos cada inconveniente, en orden inverso. Para responder a la desventaja número (7), muchas rutinas de software estadístico tienen opciones para forzar la inclusión de variables en una ecuación de modelo. De esta manera, si otras evidencias indican que una o más variables deben incluirse en el modelo, el investigador puede forzar la inclusión de estas variables. Para la desventaja número (6), en la Sección 5.5.4 sobre variables supresoras, proporcionaremos ejemplos de variables que no tienen efectos individuales importantes pero son importantes cuando se consideran en conjunto. Estas combinaciones de variables pueden no ser detectadas con el algoritmo básico, pero serán detectadas con el algoritmo de selección hacia atrás. Dado que el procedimiento de selección hacia atrás comienza con todas las variables, detectará y conservará las variables que son importantes en conjunto. La desventaja número (5) es realmente una sugerencia sobre la forma de utilizar la regresión paso a paso. Bendel y Afifi (1977) sugirieron usar un valor de corte más pequeño del que normalmente se usaría. Por ejemplo, en lugar de usar un \\(t\\)-valor = 2 que corresponde aproximadamente a un nivel de significancia del 5%, considere usar un \\(t\\)-valor = 1.645 que corresponde aproximadamente a un nivel de significancia del 10%. De esta manera, hay menos posibilidad de excluir variables que pueden ser importantes. Un límite inferior, pero aún una buena opción para trabajo exploratorio, es un corte tan pequeño como \\(t\\)-valor = 1. Esta elección está motivada por un resultado algebraico: cuando una variable entra en un modelo, \\(s\\) disminuirá si el \\(t\\)-ratio excede uno en valor absoluto. Para abordar las desventajas número (3) y (4), ahora introducimos la rutina de mejores regresiones. Las mejores regresiones es un algoritmo útil que ahora está ampliamente disponible en paquetes de software estadístico. El algoritmo de mejor regresión busca en todas las combinaciones posibles de variables explicativas, a diferencia de la regresión paso a paso, que agrega y elimina una variable a la vez. Por ejemplo, suponga que hay cuatro posibles variables explicativas, \\(x_1\\), \\(x_2\\), \\(x_3\\) y \\(x_4\\), y el usuario desea saber cuál es el mejor modelo de dos variables. El algoritmo de mejor regresión busca entre los seis modelos de la forma \\(\\mathrm{E}~y = \\beta_0 + \\beta_1 x_i + \\beta_2 x_j\\). Típicamente, una rutina de mejor regresión recomienda uno o dos modelos para cada modelo con coeficiente \\(p\\), donde p es un número especificado por el usuario. Debido a que se ha especificado el número de coeficientes que entrarán en el modelo, no importa qué criterio usemos: \\(R^2\\), \\(R_a^2\\) o \\(s\\). El algoritmo de mejor regresión realiza su búsqueda mediante un uso ingenioso del hecho algebraico de que, cuando se añade una variable al modelo, la suma de cuadrados del error no aumenta. Debido a este hecho, ciertas combinaciones de variables incluidas en el modelo no necesitan ser calculadas. Un inconveniente importante de este algoritmo es que puede tomar mucho tiempo cuando el número de variables consideradas es grande. Los usuarios de la regresión no siempre aprecian la profundidad del inconveniente número (1), data-snooping (exploración de datos). La exploración de datos ocurre cuando el analista ajusta un gran número de modelos a un conjunto de datos. Abordaremos el problema de la exploración de datos en la Sección 5.6.2 sobre validación de modelos. Aquí, ilustraremos el efecto de la exploración de datos en la regresión paso a paso. Ejemplo: Exploración de Datos en Regresión Paso a Paso. La idea de esta ilustración es de Rencher y Pun (1980). Considere \\(n = 100\\) observaciones de \\(y\\) y cincuenta variables explicativas, \\(x_1, x_2, \\ldots, x_{50}\\). Los datos que consideramos aquí se simularon usando variables aleatorias normales estándar independientes. Debido a que las variables se simularon de manera independiente, estamos trabajando bajo la hipótesis nula de que no hay relación entre la respuesta y las variables explicativas, es decir, \\(H_0: \\beta_1 = \\beta_2 = \\ldots = \\beta_{50} = 0\\). De hecho, cuando se ajustó el modelo con las cincuenta variables explicativas, resultó que \\(s = 1.142\\), \\(R^2 = 46.2\\%\\), y el \\(F\\)-ratio = \\(\\frac{Regression~MS}{Error~MS} = 0.84\\). Usando una distribución \\(F\\) con \\(df_1 = 50\\) y \\(df_2 = 49\\), el percentil 95 es 1.604. De hecho, 0.84 es el percentil 27 de esta distribución, lo que indica que el valor \\(p\\) es 0.73. Por lo tanto, como era de esperar, los datos están en congruencia con \\(H_0\\). A continuación, se realizó una regresión paso a paso con \\(t\\)-valor = 2. Dos variables fueron retenidas por este procedimiento, lo que resultó en un modelo con \\(s = 1.05\\), \\(R^2 = 9.5\\%\\) y \\(F\\)-ratio = 5.09. Para una distribución \\(F\\) con \\(df_1 = 2\\) y \\(df_2 = 97\\), el percentil 95 es un \\(F\\)-valor = 3.09. Esto indica que las dos variables son predictores estadísticamente significativos de \\(y\\). A primera vista, este resultado es sorprendente. Los datos se generaron de manera que \\(y\\) no estuviera relacionado con las variables explicativas. Sin embargo, debido a que \\(F\\)-ratio \\(&gt;\\) \\(F\\)-valor, la prueba \\(F\\) indica que dos variables explicativas están significativamente relacionadas con \\(y\\). La razón es que la regresión paso a paso ha realizado muchas pruebas de hipótesis en los datos. Por ejemplo, en el Paso 1, se realizaron cincuenta pruebas para encontrar variables significativas. Recuerde que un nivel del 5% significa que esperamos cometer aproximadamente un error en 20. Por lo tanto, con cincuenta pruebas, esperamos encontrar \\(50 \\times 0.05 = 2.5\\) variables “significativas”, incluso bajo la hipótesis nula de que no hay relación entre \\(y\\) y las variables explicativas. Para continuar, se realizó una regresión paso a paso con \\(t\\)-valor = 1.645. Seis variables fueron retenidas por este procedimiento, lo que resultó en un modelo con \\(s = 0.99\\), \\(R^2 = 22.9\\%\\) y \\(F\\)-ratio = 4.61. Como antes, una prueba \\(F\\) indica una relación significativa entre la respuesta y estas seis variables explicativas. Para resumir, utilizando simulación, construimos un conjunto de datos de manera que las variables explicativas no tuvieran relación con la respuesta. Sin embargo, al utilizar la regresión paso a paso para examinar los datos, “encontramos” relaciones aparentemente significativas entre la respuesta y ciertos subconjuntos de las variables explicativas. Este ejemplo ilustra una advertencia general en la selección de modelos: cuando las variables explicativas se seleccionan utilizando los datos, los \\(t\\)-ratios y los \\(F\\)-ratios serán demasiado grandes, exagerando así la importancia de las variables en el modelo. La regresión paso a paso y las mejores regresiones son ejemplos de procedimientos automáticos de selección de variables. En su trabajo de modelado, encontrará que estos procedimientos son útiles porque pueden buscar rápidamente entre varios modelos candidatos. Sin embargo, estos procedimientos ignoran alternativas no lineales, así como el efecto de los valores atípicos y los puntos de alta influencia. El objetivo principal de estos procedimientos es mecanizar ciertas tareas rutinarias. Este enfoque de selección automática se puede extender, y de hecho, hay varios “sistemas expertos” disponibles en el mercado. Por ejemplo, hay algoritmos disponibles que manejan “automáticamente” puntos inusuales como valores atípicos y puntos de alta influencia. Un modelo sugerido por los procedimientos automáticos de selección de variables debe estar sujeto a los mismos procedimientos cuidadosos de verificación diagnóstica que un modelo obtenido por cualquier otro medio. 5.3 Análisis de Residuales Recuerde el papel de un residual en el modelo de regresión lineal introducido en la Sección 2.6. Un residual es una respuesta menos el valor ajustado correspondiente bajo el modelo. Dado que el modelo resume el efecto lineal de varias variables explicativas, podemos pensar en un residual como una respuesta controlada por los valores de las variables explicativas. Si el modelo es una representación adecuada de los datos, entonces los residuales deberían aproximarse a errores aleatorios. Los errores aleatorios se utilizan para representar la variación natural en el modelo; representan el resultado de un mecanismo impredecible. Por lo tanto, en la medida en que los residuales se parezcan a errores aleatorios, no debería haber patrones discernibles en los residuales. Los patrones en los residuales indican la presencia de información adicional que esperamos incorporar en el modelo. La ausencia de patrones en los residuales indica que el modelo parece explicar las relaciones principales en los datos. 5.3.1 Residuales Hay al menos cuatro tipos de patrones que pueden descubrirse a través del análisis de residuales. En esta sección, discutimos los dos primeros: residuales que son inusuales y aquellos que están relacionados con otras variables explicativas. Luego introducimos el tercer tipo, residuales que muestran un patrón heterocedástico, en la Sección 5.7. En nuestro estudio de datos de series temporales que comienza en el Capítulo 7, introduciremos el cuarto tipo, residuales que muestran patrones a lo largo del tiempo. Al examinar los residuales, generalmente es más fácil trabajar con un residual estandarizado, un residual que ha sido reescalado para no tener dimensiones. Generalmente trabajamos con residuales estandarizados porque así logramos transferir cierta experiencia de un conjunto de datos a otro y podemos enfocarnos en relaciones de interés. Al usar residuales estandarizados, podemos entrenarnos para observar una variedad de gráficos de residuales y reconocer inmediatamente un punto inusual al trabajar en unidades estándar. Hay varias formas de definir un residual estandarizado. Usando \\(e_i = y_i - \\hat{y}_i\\) como el \\(i\\)-ésimo residual, aquí hay tres definiciones comúnmente usadas: \\[\\begin{equation} \\text{(a) }\\frac{e_i}{s}, \\quad \\text{(b) }\\frac{e_i}{s\\sqrt{1 - h_{ii}}}, \\quad \\text{(c) }\\frac{e_i}{s_{(i)}\\sqrt{1 - h_{ii}}}. \\tag{5.1} \\end{equation}\\] Aquí, \\(h_{ii}\\) es la influencia del \\(i\\)-ésimo punto. Se calcula en función de los valores de las variables explicativas y se definirá en la Sección 5.4.1. Recuerde que \\(s\\) es la desviación estándar de los residuales (definida en la ecuación 3.8). De manera similar, definimos \\(s_{(i)}\\) como la desviación estándar de los residuales al ejecutar una regresión después de eliminar la \\(i\\)-ésima observación. Ahora, la primera definición en (a) es simple y fácil de explicar. Un cálculo simple muestra que la desviación estándar de la muestra de los residuales es aproximadamente \\(s\\) (una razón por la que \\(s\\) a menudo se denomina desviación estándar de los residuales). Por lo tanto, parece razonable estandarizar los residuales dividiendo por \\(s\\). La segunda opción presentada en (b), aunque más compleja, es más precisa. La varianza del \\(i\\)-ésimo residual es \\[ \\text{Var}(e_i) = \\sigma^2(1 - h_{ii}). \\] Este resultado se establecerá en la ecuación (5.15) de la Sección 5.10. Tenga en cuenta que esta varianza es menor que la varianza del término de error, Var\\((\\varepsilon_i) = \\sigma^2\\). Ahora, podemos reemplazar \\(\\sigma\\) por su estimación, \\(s\\). Entonces, este resultado lleva a usar la cantidad \\(s\\sqrt{1 - h_{ii}}\\) como una desviación estándar estimada, o error estándar, para \\(e_i\\). Por lo tanto, definimos el error estándar de \\(e_i\\) como \\[ \\text{se}(e_i) = s \\sqrt{1 - h_{ii}}. \\] Siguiendo las convenciones introducidas en la Sección 2.6, en este texto usamos \\(e_i / \\text{se}(e_i)\\) como nuestro residual estandarizado. La tercera opción presentada en (c) es una modificación de (b) y se conoce como un residual studentizado. Como se enfatiza en la Sección 5.3.2, un uso importante de los residuales es identificar respuestas inusualmente grandes. Ahora, supongamos que la \\(i\\)-ésima respuesta es inusualmente grande y que esto se mide a través de su residual. Este residual inusualmente grande también hará que el valor de \\(s\\) sea grande. Debido a que el efecto grande aparece tanto en el numerador como en el denominador, el residual estandarizado puede no detectar esta respuesta inusual. Sin embargo, esta respuesta grande no inflará \\(s_{(i)}\\) porque se construye después de eliminar la \\(i\\)-ésima observación. Por lo tanto, al usar residuales studentizados, obtenemos una mejor medida de las observaciones que tienen residuales inusualmente grandes. Al omitir esta observación de la estimación de \\(\\sigma\\), el tamaño de la observación solo afecta al numerador \\(e_i\\) y no al denominador \\(s_{(i)}\\). Como otra ventaja, los residuales studentizados siguen una distribución \\(t\\) con \\(n - (k + 1)\\) grados de libertad, asumiendo que los errores están distribuidos normalmente (suposición E5). Este conocimiento de la distribución precisa nos ayuda a evaluar el grado de ajuste del modelo y es particularmente útil en muestras pequeñas. Es esta relación con la distribución \\(t\\) de “Student” la que sugiere el nombre de “residuales studentizados”. 5.3.2 Uso de los Residuales para Identificar Valores Atípicos Una función importante del análisis de residuales es identificar valores atípicos. Un valor atípico es una observación que no se ajusta bien al modelo; son observaciones donde el residual es inusualmente grande. Una regla general utilizada por muchos paquetes estadísticos es que una observación se marca como un valor atípico si el residual estandarizado excede dos en valor absoluto. En la medida en que la distribución de los residuales estandarizados imite la curva normal estándar, esperamos que solo una de cada 20 observaciones, o el 95%, exceda dos en valor absoluto y muy pocas observaciones excedan tres. Los valores atípicos proporcionan una señal de que una observación debe investigarse para entender las causas especiales asociadas con este punto. Un valor atípico es una observación que parece inusual con respecto al resto del conjunto de datos. A menudo sucede que la razón de este comportamiento atípico puede descubrirse después de una investigación adicional. De hecho, este puede ser el propósito principal del análisis de regresión de un conjunto de datos. Consideremos un ejemplo simple de lo que se llama análisis de desempeño. Supongamos que tenemos disponible una muestra de \\(n\\) vendedores y estamos tratando de entender las ventas de cada persona en el segundo año en función de sus ventas en el primer año. Hasta cierto punto, esperamos que las ventas más altas en el primer año estén asociadas con ventas más altas en el segundo año. Las altas ventas pueden deberse a la habilidad natural del vendedor, ambición, buen territorio, etc. Las ventas del primer año pueden considerarse como una variable proxy que resume estos factores. Esperamos variación en el desempeño de ventas tanto de manera transversal como a lo largo de los años. Es interesante cuando un vendedor tiene un desempeño inusualmente bueno (o malo) en el segundo año en comparación con su desempeño en el primer año. Los residuales proporcionan un mecanismo formal para evaluar las ventas del segundo año después de controlar los efectos de las ventas del primer año. Hay varias opciones disponibles para manejar valores atípicos. Opciones para Manejar Valores Atípicos Incluir la observación en las estadísticas resumen habituales pero comentar sobre sus efectos. Un valor atípico puede ser grande pero no tan grande como para sesgar los resultados de todo el análisis. Si no se pueden determinar causas especiales para esta observación inusual, entonces esta observación puede simplemente reflejar la variabilidad en los datos. Eliminar la observación del conjunto de datos. Puede determinarse que la observación no es representativa de la población de la cual se extrae la muestra. Si este es el caso, entonces puede haber poca información contenida en la observación que pueda usarse para hacer afirmaciones generales sobre la población. Esta opción implica que omitiríamos la observación de las estadísticas resumen de la regresión y la discutiríamos en nuestro informe como un caso separado. Crear una variable binaria para indicar la presencia de un valor atípico. Si se han identificado una o varias causas especiales para explicar un valor atípico, entonces estas causas podrían introducirse formalmente en el procedimiento de modelado mediante la introducción de una variable que indique la presencia (o ausencia) de estas causas. Este enfoque es similar a la eliminación de puntos, pero permite que el valor atípico se incluya formalmente en la formulación del modelo, de modo que, si surgen observaciones adicionales afectadas por las mismas causas, se puedan manejar de forma automática. 5.3.3 Uso de los Residuales para Seleccionar Variables Explicativas Otra función importante del análisis de residuales es ayudar a identificar variables explicativas adicionales que puedan usarse para mejorar la formulación del modelo. Si hemos especificado el modelo correctamente, entonces los residuales deberían parecerse a errores aleatorios y no contener patrones discernibles. Por lo tanto, al comparar residuales con variables explicativas, no esperamos ninguna relación. Si detectamos una relación, esto sugiere la necesidad de controlar esta variable adicional. Esto se puede lograr introduciendo la variable adicional en el modelo de regresión. Las relaciones entre los residuales y las variables explicativas pueden establecerse rápidamente utilizando estadísticas de correlación. Sin embargo, si una variable explicativa ya está incluida en el modelo de regresión, entonces la correlación entre los residuales y una variable explicativa será cero (ver Sección 5.10.1 para la demostración algebraica). Es una buena idea reforzar esta correlación con un diagrama de dispersión. Un gráfico de residuales frente a variables explicativas no solo reforzará gráficamente la estadística de correlación, sino que también servirá para detectar posibles relaciones no lineales. Por ejemplo, una relación cuadrática puede detectarse utilizando un diagrama de dispersión, no una estadística de correlación. Si detecta una relación entre los residuales de un ajuste de modelo preliminar y una variable explicativa adicional, introducir esta variable adicional no siempre mejorará la especificación de su modelo. La razón es que la variable adicional puede estar relacionada linealmente con las variables que ya están en el modelo. Si desea una garantía de que agregar una variable adicional mejorará su modelo, entonces construya un gráfico de variables añadidas (ver Sección 3.4.3). En resumen, después de un ajuste preliminar del modelo, debe: Calcular estadísticas resumen y mostrar la distribución de los residuales (estandarizados) para identificar valores atípicos. Calcular la correlación entre los residuales (estandarizados) y las variables explicativas adicionales para buscar relaciones lineales. Crear gráficos de dispersión entre los residuales (estandarizados) y las variables explicativas adicionales para buscar relaciones no lineales. Ejemplo: Liquidez del Mercado de Valores. La decisión de un inversor de comprar una acción generalmente se toma teniendo en cuenta varios criterios. Primero, los inversores suelen buscar un alto rendimiento esperado. Un segundo criterio es el riesgo de una acción, que puede medirse mediante la variabilidad de los rendimientos. Tercero, muchos inversores están preocupados por el tiempo que están comprometiendo su capital con la compra de un valor. Muchas acciones de ingresos, como las de servicios públicos, devuelven regularmente partes de las inversiones de capital en forma de dividendos. Otras acciones, particularmente las de crecimiento, no devuelven nada hasta la venta del valor. Por lo tanto, la duración promedio de la inversión en un valor es otro criterio. Cuarto, a los inversores les preocupa la capacidad de vender la acción en cualquier momento que sea conveniente para ellos. Nos referimos a este cuarto criterio como la liquidez de la acción. Cuanto más líquida sea la acción, más fácil será venderla. Para medir la liquidez, en este estudio utilizamos el número de acciones negociadas en una bolsa durante un período de tiempo específico (llamado VOLUME). Estamos interesados en estudiar la relación entre el volumen y otras características financieras de una acción. Comenzamos este estudio con 126 empresas cuyas opciones se negociaron el 3 de diciembre de 1984. Los datos de las acciones fueron obtenidos de Francis Emory Fitch, Inc. para el período del 3 de diciembre de 1984 al 28 de febrero de 1985. Para las variables de actividad comercial, examinamos: El volumen total de negociación de tres meses (VOLUME, en millones de acciones), El número total de transacciones de tres meses (NTRAN), y El tiempo promedio entre transacciones (AVGT, medido en minutos). Para las variables de tamaño de la empresa, utilizamos: El precio de apertura de la acción el 2 de enero de 1985 (PRICE), El número de acciones en circulación el 31 de diciembre de 1984 (SHARE, en millones de acciones), y El valor de mercado del capital (VALUE, en miles de millones de dólares) obtenido al tomar el producto de PRICE y SHARE. Finalmente, para el apalancamiento financiero, examinamos la relación deuda-capital (DEB_EQ) obtenida de la Cinta Industrial de Compustat y el manual de Moody’s. Los datos en SHARE se obtienen de la cinta mensual del Centro de Investigación en Precios de Seguridad (CRSP). Después de examinar algunas estadísticas resumen preliminares de los datos, se eliminaron tres empresas porque tenían un volumen inusualmente alto o un precio elevado. Estas son Teledyne y Capital Cities Communication, cuyos precios eran más de cuatro veces el precio promedio de las demás empresas, y American Telephone and Telegraph, cuyo volumen total era más de siete veces el volumen total promedio de las demás empresas. Basado en una investigación adicional, cuyos detalles no se presentan aquí, estas empresas fueron eliminadas porque parecían representar circunstancias especiales que no deseábamos modelar. La Tabla 5.2 resume las estadísticas descriptivas basadas en las \\(n = 123\\) empresas restantes. Por ejemplo, en la Tabla 5.2, vemos que el tiempo promedio entre transacciones es de aproximadamente cinco minutos y este tiempo varía desde un mínimo de menos de 1 minuto hasta un máximo de aproximadamente 20 minutos. Tabla 5.2: Estadísticas Resumen de las Variables de Liquidez de las Acciones Media Mediana Desviación Estándar Mínimo Máximo VOLUME 13.423 11.556 10.632 0.658 64.572 AVGT 5.441 4.284 3.853 0.590 20.772 NTRAN 6436.000 5071.000 5310.000 999.000 36420.000 PRICE 38.800 34.380 21.370 9.120 122.380 SHARE 94.730 53.830 115.100 6.740 783.050 VALUE 4.116 2.065 8.157 0.115 75.437 DEBEQ 2.697 1.105 6.509 0.185 53.628 Fuente: Francis Emory Fitch, Inc., Standard &amp; Poor’s Compustat, y el Centro de Investigación de Precios de Valores de la Universidad de Chicago. La Tabla 5.3 reporta los coeficientes de correlación y la Figura 5.2 proporciona la matriz de dispersión correspondiente. Si tienes conocimientos en finanzas, te resultará interesante notar que el apalancamiento financiero, medido por DEB_EQ, no parece estar relacionado con las otras variables. A partir del diagrama de dispersión y la matriz de correlación, vemos una fuerte relación entre VOLUME y el tamaño de la empresa, medido por SHARE y VALUE. Además, las tres variables de actividad de negociación, VOLUME, AVGT y NTRAN, están altamente relacionadas entre sí. Tabla 5.3: Matriz de Correlación de la Liquidez de las Acciones AVGT NTRAN PRICE SHARE VALUE DEB_EQ VOLUME AVGT 1.000 -0.668 -0.128 -0.429 -0.318 0.094 -0.674 NTRAN -0.668 1.000 0.190 0.817 0.760 -0.092 0.913 PRICE -0.128 0.190 1.000 0.177 0.457 -0.038 0.168 SHARE -0.429 0.817 0.177 1.000 0.829 -0.077 0.773 VALUE -0.318 0.760 0.457 0.829 1.000 -0.077 0.702 DEB_EQ 0.094 -0.092 -0.038 -0.077 -0.077 1.000 -0.052 VOLUME -0.674 0.913 0.168 0.773 0.702 -0.052 1.000 Código R para Producir las Tablas 5.2 y 5.3 liquidity &lt;- read.csv(&quot;CSVData/Liquidity.csv&quot;, header=TRUE) varLiquid &lt;- c(&quot;AVGT&quot;, &quot;NTRAN&quot;, &quot;PRICE&quot;, &quot;SHARE&quot;, &quot;VALUE&quot;, &quot;DEBEQ&quot;, &quot;VOLUME&quot;) liquidMat &lt;- data.frame(liquidity[varLiquid]) names(liquidMat)[names(liquidMat) == &quot;DEBEQ&quot;] &lt;- &quot;DEB_EQ&quot; # TABLA 5.2 ESTADÍSTICAS RESUMEN BookSummStats &lt;- function(Xymat){ meanSummary &lt;- sapply(Xymat, mean, na.rm=TRUE) sdSummary &lt;- sapply(Xymat, sd, na.rm=TRUE) minSummary &lt;- sapply(Xymat, min, na.rm=TRUE) maxSummary &lt;- sapply(Xymat, max, na.rm=TRUE) medSummary &lt;- sapply(Xymat, median,na.rm=TRUE) tableMat &lt;- cbind(meanSummary, medSummary, sdSummary, minSummary, maxSummary) return(tableMat) } liquidMat1 &lt;- liquidMat[,c(7,1:6)] tableMat &lt;- BookSummStats(liquidMat1) colnames(tableMat) &lt;- c(&quot;Media&quot;, &quot;Mediana&quot;, &quot;Desviación Estándar&quot;, &quot;Mínimo&quot;, &quot;Máximo&quot;) rownames(tableMat) &lt;- varLiquid[c(7,1:6)] tableMat &lt;- round(tableMat, digits = 3) tableMat[3,] &lt;- round(tableMat[3,], digits = 0) tableMat[4:5,] &lt;- round(tableMat[4:5,], digits = 2) TableGen1(TableData=tableMat, TextTitle=&#39;Estadísticas Resumen de las Variables de Liquidez de las Acciones&#39;, Align=&#39;r&#39;, Digits=3, ColumnSpec=1:5, ColWidth = ColWidth5) cor_matrix &lt;- cor(liquidMat) rownames(cor_matrix) &lt;- colnames(cor_matrix) &lt;- c(&quot;AVGT&quot;, &quot;NTRAN&quot;, &quot;PRICE&quot;, &quot;SHARE&quot;, &quot;VALUE&quot;, &quot;DEB_EQ&quot;, &quot;VOLUME&quot;) TableGen1(TableData=cor_matrix, TextTitle=&#39;Matriz de Correlación de la Liquidez de las Acciones&#39;, Align=&#39;r&#39;, Digits=3, ColumnSpec=1:6, ColWidth = ColWidth6) La Figura 5.2 muestra que la variable AVGT está inversamente relacionada con VOLUME y NTRAN está inversamente relacionada con AVGT. De hecho, resultó que la correlación entre el tiempo promedio entre transacciones y el recíproco del número de transacciones fue del \\(99.98\\%!\\) Esto no es tan sorprendente cuando se piensa en cómo se podría calcular AVGT. Por ejemplo, en la Bolsa de Valores de Nueva York, el mercado está abierto de 10:00 A.M. a 4:00 P.M. Para cada acción en un día particular, el tiempo promedio entre transacciones multiplicado por el número de transacciones es casi igual a 360 minutos (= 6 horas). Por lo tanto, excepto por errores de redondeo porque las transacciones solo se registran al minuto más cercano, hay una relación lineal perfecta entre AVGT y el recíproco de NTRAN. Figura 5.2: Matriz de dispersión para las variables de liquidez de las acciones. La variable del número de transacciones (NTRAN) parece estar fuertemente relacionada con el VOLUME de acciones negociadas e inversamente relacionada con AVGT. Para comenzar a entender la medida de liquidez VOLUME, primero ajustamos un modelo de regresión utilizando NTRAN como una variable explicativa. El modelo de regresión ajustado es: \\[ \\small{ \\begin{array}{lcc} \\text{VOLUME} &amp;= 1.65 &amp;+ 0.00183 \\text{ NTRAN} \\\\ \\text{errores estándar} &amp; (0.6173) &amp; (0.000074) \\end{array} } \\] con \\(R^2 = 83.4\\%\\) y \\(s = 4.35\\). Note que el cociente \\(t\\) para la pendiente asociada con NTRAN es \\[ t(b_1) = \\frac{b_1}{se(b_1)} = \\frac{0.00183}{0.000074} = 24.7 \\] indicando una fuerte significancia estadística. Los residuos se calcularon utilizando este modelo estimado. Para ver si los residuos están relacionados con otras variables explicativas, la Tabla 5.4 muestra las correlaciones. Tabla 5.4: Primera Tabla de Correlaciones Variable AVGT PRICE SHARE VALUE DEB_EQ RESID -0.159 -0.014 0.064 0.018 0.078 Nota: Los residuos se crearon a partir de una regresión de VOLUME sobre NTRAN. La correlación entre el residuo y AVGT y el diagrama de dispersión (no mostrado aquí) indica que puede haber alguna información en la variable AVGT en el residuo. Por lo tanto, parece razonable usar AVGT directamente en el modelo de regresión. Recuerde que estamos interpretando el residuo como el valor de VOLUME habiendo controlado el efecto de NTRAN. A continuación, ajustamos un modelo de regresión utilizando NTRAN y AVGT como variables explicativas. El modelo de regresión ajustado es: \\[ \\small{ \\begin{array}{lccc} \\text{VOLUME} &amp;= 4.41 &amp;- 0.322 \\text{ AVGT} &amp;+ 0.00167 \\text{ NTRAN} \\\\ \\text{errores estándar} &amp; (1.30)&amp; (0.135)&amp; (0.000098) \\end{array} } \\] con \\(R^2 = 84.2\\%\\) y \\(s = 4.26\\). Basado en el cociente \\(t\\) para AVGT, \\(t(b_{AVGT}) = \\frac{-0.322}{0.135} = -2.39\\), parece que AVGT es una variable explicativa útil en el modelo. Note también que \\(s\\) ha disminuido, lo que indica que \\(R_a^2\\) ha aumentado. La Tabla 5.5 proporciona correlaciones entre los residuos del modelo y otras posibles variables explicativas e indica que no parece haber mucha información adicional en las variables explicativas. Esto se reafirma por la tabla correspondiente de diagramas de dispersión en la Figura 5.3. Los histogramas en la Figura 5.3 sugieren que, aunque la distribución de los residuos es bastante simétrica, la distribución de cada variable explicativa está sesgada. Debido a esto, se exploraron transformaciones de las variables explicativas. Esta línea de pensamiento no proporcionó mejoras reales y, por lo tanto, no se proporcionan detalles aquí. Figura 5.3: Matriz de dispersión de los residuos de la regresión de VOLUME sobre NTRAN y AVGT en el eje vertical y las variables predictoras restantes en los ejes horizontales. Tabla 5.5: Segunda Tabla de Correlaciones Variable PRICE SHARE VALUE DEB_EQ RESID -0.015 0.100 0.074 0.089 Nota: Los residuos se crearon a partir de una regresión de VOLUME sobre NTRAN y AVGT. 5.4 Puntos Influyentes No todos los puntos son creados iguales; en esta sección veremos que ciertas observaciones pueden tener un efecto desproporcionado en el ajuste general de la regresión. A estos puntos los llamaremos “influyentes.” Esto no es tan sorprendente; ya hemos visto que las estimaciones de los coeficientes de regresión son sumas ponderadas de respuestas (ver Sección 3.2.4). Algunas observaciones tienen pesos mayores que otras y, por lo tanto, tienen una mayor influencia en las estimaciones de los coeficientes de regresión. Por supuesto, el hecho de que una observación sea influyente no significa que sea incorrecta o que su impacto en el modelo sea engañoso. Como analistas, simplemente nos gustaría saber si nuestro modelo ajustado es sensible a cambios leves, como la eliminación de un solo punto, para sentirnos cómodos al generalizar nuestros resultados de la muestra a una población más grande. Para evaluar la influencia, pensamos en observaciones como respuestas inusuales, dadas un conjunto de variables explicativas, o que tienen un conjunto inusual de valores de variables explicativas. Ya hemos visto en la Sección 5.3 cómo evaluar respuestas inusuales utilizando residuos. Esta sección se centra en conjuntos inusuales de valores de variables explicativas. 5.4.1 Apalancamiento Introdujimos este tema en la Sección 2.6, donde llamamos a una observación con una variable explicativa inusual un “punto de alto apalancamiento.” Con más de una variable explicativa, determinar si una observación es un punto de alto apalancamiento no es tan sencillo. Por ejemplo, es posible que una observación “no sea inusual” para ninguna variable individual y, sin embargo, sea inusual en el espacio de variables explicativas. Considere el conjunto de datos ficticio representado en la Figura 5.4. Visualmente, parece claro que el punto marcado en la esquina superior derecha es inusual. Sin embargo, no es inusual cuando se examina el histograma de \\(x_1\\) o de \\(x_2\\). Es inusual solo cuando se consideran las variables explicativas de manera conjunta. Figura 5.4: El elipsoide representa la mayoría de los datos. La flecha marca un punto inusual. Para dos variables explicativas, esto es evidente al examinar los datos gráficamente. Debido a que es difícil examinar gráficamente los datos con más de dos variables explicativas, necesitamos un procedimiento numérico para evaluar el apalancamiento. Para definir el concepto de apalancamiento en la regresión lineal múltiple, utilizamos algunos conceptos de álgebra matricial. Específicamente, en la Sección 3.1 mostramos que el vector de coeficientes de regresión de mínimos cuadrados se puede calcular usando \\(\\mathbf{b} = (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} \\mathbf{X}^{\\prime} \\mathbf{y}\\). Así, podemos expresar el vector de valores ajustados \\(\\hat{\\mathbf{y}} = (\\hat{y}_1, \\ldots, \\hat{y}_n)^{\\prime}\\) como \\[\\begin{equation} \\mathbf{\\hat{y}} = \\mathbf{Xb} . \\tag{5.2} \\end{equation}\\] De manera similar, el vector de residuos es el vector de respuesta menos el vector de valores ajustados, es decir, \\(\\mathbf{e} = \\mathbf{y - \\hat{y}}\\). A partir de la expresión para los coeficientes de regresión \\(\\mathbf{b}\\) en la ecuación (3.4), tenemos \\[ \\mathbf{\\hat{y}} = \\mathbf{X} (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} \\mathbf{X}^{\\prime} \\mathbf{y} \\] Esta ecuación sugiere definir \\[ \\mathbf{H} = \\mathbf{X} (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} \\mathbf{X}^{\\prime} \\] de modo que \\[ \\mathbf{\\hat{y}} = \\mathbf{Hy} \\] A partir de esto, se dice que la matriz \\(\\mathbf{H}\\) proyecta el vector de respuestas \\(\\mathbf{y}\\) en el vector de valores ajustados \\(\\mathbf{\\hat{y}}\\). Alternativamente, puede pensar en \\(\\mathbf{H}\\) como la matriz que pone el “sombrero,” o circunflejo, en \\(\\mathbf{y}\\). A partir de la \\(i\\)-ésima fila de la ecuación vectorial \\(\\mathbf{\\hat{y}} = \\mathbf{Hy}\\), tenemos \\[ \\hat{y}_i = h_{i1} y_1 + h_{i2} y_2 + \\cdots + h_{ii} y_i + \\cdots + h_{in} y_n \\] Aquí, \\(h_{ij}\\) es el número en la \\(i\\)-ésima fila y \\(j\\)-ésima columna de \\(\\mathbf{H}\\). A partir de esta expresión, vemos que cuanto mayor sea \\(h_{ii}\\), mayor será el efecto que la \\(i\\)-ésima respuesta \\((y_i)\\) tiene en el valor ajustado correspondiente \\((\\hat{y}_i)\\). Por lo tanto, llamamos a \\(h_{ii}\\) el apalancamiento para la \\(i\\)-ésima observación. Debido a que \\(h_{ii}\\) es el elemento diagonal \\(i\\)-ésimo de \\(\\mathbf{H}\\), una expresión directa para \\(h_{ii}\\) es \\[\\begin{equation} h_{ii} = \\mathbf{x}_i^{\\prime} (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} \\mathbf{x}_i \\tag{5.3} \\end{equation}\\] donde \\(\\mathbf{x}_i = (x_{i0}, x_{i1}, \\ldots, x_{ik})^{\\prime}\\). Debido a que los valores de \\(h_{ii}\\) se calculan en base a las variables explicativas, los valores de la variable de respuesta no afectan el cálculo de los apalancamientos. Los valores altos de apalancamiento indican que una observación puede tener un efecto desproporcionado en el ajuste, esencialmente porque está distante de las otras observaciones (al observar el espacio de variables explicativas). ¿Qué tan grande es grande? Existen algunas pautas de álgebra matricial, donde tenemos que \\[ \\frac{1}{n} \\leq h_{ii} \\leq 1 \\] y \\[ \\bar{h} = \\frac{1}{n} \\sum_{i=1}^{n} h_{ii} = \\frac{k+1}{n}. \\] Por lo tanto, cada apalancamiento está limitado por \\(n^{-1}\\) y \\(1\\), y el apalancamiento promedio es igual al número de coeficientes de regresión dividido por el número de observaciones. A partir de estos y argumentos relacionados, utilizamos una convención ampliamente adoptada y declaramos que una observación es un punto de alto apalancamiento si el apalancamiento supera tres veces el promedio, es decir, si \\[ h_{ii} &gt; \\frac{3(k+1)}{n}. \\] Una vez identificados los puntos de alto apalancamiento, al igual que con los valores atípicos, es importante que el analista busque causas especiales que puedan haber producido estos puntos inusuales. Para ilustrar, en la Sección 2.7 identificamos el colapso del mercado de 1987 como la razón detrás del punto de alto apalancamiento. Además, los puntos de alto apalancamiento a menudo se deben a errores administrativos al codificar los datos, que pueden o no ser fáciles de rectificar. En general, las opciones para manejar puntos de alto apalancamiento son similares a las disponibles para tratar con valores atípicos. Opciones para Manejar Puntos de Alto Apalancamiento Incluir la observación en las estadísticas resumidas pero comentar sobre su efecto. Por ejemplo, una observación puede apenas superar un límite y su efecto puede no ser importante en el análisis general. Eliminar la observación del conjunto de datos. Nuevamente, la justificación básica para esta acción es que se considera que la observación no es representativa de una población más grande. Una opción intermedia entre (1) y (2) es presentar el análisis tanto con como sin el punto de alto apalancamiento. De esta manera, se demuestra completamente el impacto del punto y el lector de su análisis puede decidir cuál opción es más adecuada. Elegir otra variable para representar la información. En algunos casos, otra variable explicativa estará disponible para servir como reemplazo. Por ejemplo, en un ejemplo de alquileres de apartamentos, podríamos usar el número de habitaciones para reemplazar una variable de metros cuadrados como medida del tamaño del apartamento. Aunque los metros cuadrados de un apartamento pueden ser inusualmente grandes, lo que lo convierte en un punto de alto apalancamiento, puede tener una, dos o tres habitaciones, dependiendo de la muestra examinada. Usar una transformación no lineal de una variable explicativa. Para ilustrar, con nuestro ejemplo de Liquidez de Acciones en la Sección 5.5.3, podemos transformar la variable continua de razón deuda a capital DEB_EQ en una variable que indique la presencia de “alta” razón deuda a capital. Por ejemplo, podríamos codificar DE_IND = 1 si DEB_EQ &gt; 5 y DE_IND = 0 si DEB_EQ ≤ 5. Con esta recodificación, aún conservamos información sobre el apalancamiento financiero de una empresa sin permitir que los valores grandes de DEB_EQ influyan en el ajuste de la regresión. Algunos analistas usan metodologías de estimación “robustas” como alternativa a la estimación de mínimos cuadrados. La idea básica de estas técnicas es reducir el efecto de cualquier observación en particular. Estas técnicas son útiles para reducir el efecto tanto de valores atípicos como de puntos de alto apalancamiento. Esta táctica puede considerarse intermedia entre un procedimiento extremo, ignorando el efecto de puntos inusuales, y otro extremo, dando plena credibilidad a los puntos inusuales al eliminarlos del conjunto de datos. La palabra robusto sugiere que estas metodologías de estimación son “saludables” incluso cuando son atacadas por una observación ocasionalmente mala (un germen). Hemos visto que esto no es cierto para la estimación de mínimos cuadrados. 5.4.2 Distancia de Cook Para cuantificar la influencia de un punto, una medida que considera tanto las variables de respuesta como las explicativas es la Distancia de Cook. Esta distancia, \\(D_i\\), se define como \\[\\begin{equation} \\begin{array}{ll} D_i &amp;= \\frac{\\sum_{j=1}^{n} (\\hat{y}_j - \\hat{y}_{j(i)})^2}{(k+1) s^2} \\tag{5.4} \\\\ &amp;= \\left( \\frac{e_i}{se(e_i)} \\right)^2 \\frac{h_{ii}}{(k+1)(1 - h_{ii})}. \\end{array} \\end{equation}\\] La primera expresión proporciona una definición. Aquí, \\(\\hat{y}_{j(i)}\\) es la predicción de la \\(j\\)-ésima observación, calculada excluyendo la \\(i\\)-ésima observación del ajuste de regresión. Para medir el impacto de la \\(i\\)-ésima observación, comparamos los valores ajustados con y sin la \\(i\\)-ésima observación. Cada diferencia se eleva al cuadrado y se suma en todas las observaciones para resumir el impacto. La segunda ecuación proporciona otra interpretación de la distancia \\(D_i\\). La primera parte, \\(\\left( \\frac{e_i}{se(e_i)} \\right)^2\\), es el cuadrado del residuo estandarizado \\(i\\)-ésimo. La segunda parte, \\(\\frac{h_{ii}}{(k+1)(1 - h_{ii})}\\), se atribuye únicamente al apalancamiento. Así, la distancia \\(D_i\\) se compone de una medida para valores atípicos multiplicada por una medida de apalancamiento. De esta manera, la distancia de Cook tiene en cuenta tanto las variables de respuesta como las explicativas. La Sección 5.10.3 establece la validez de la ecuación (5.4). Para tener una idea del tamaño esperado de \\(D_i\\) para un punto que no es inusual, recuerde que esperamos que los residuos estandarizados sean aproximadamente uno y que el apalancamiento \\(h_{ii}\\) sea aproximadamente \\(\\frac{k+1}{n}\\). Por lo tanto, anticipamos que \\(D_i\\) debería ser aproximadamente \\(\\frac{1}{n}\\). Otra regla general es comparar \\(D_i\\) con una distribución \\(F\\) con \\(df_1 = k+1\\) y \\(df_2 = n - (k+1)\\) grados de libertad. Los valores de \\(D_i\\) que son grandes en comparación con esta distribución merecen atención. Ejemplo: Valores Atípicos y Puntos de Alto Apalancamiento - Continuación. Para ilustrar, volvemos a nuestro ejemplo de la Sección 2.6. En este ejemplo, consideramos 19 puntos “buenos” o base, más cada uno de los tres tipos de puntos inusuales, etiquetados como A, B y C. La Tabla 5.6 resume los cálculos. Tabla 5.6: Medidas de Tres Tipos de Puntos Inusuales Observation Standardized Residual \\(e / se(e)\\) Leverage \\(h\\) Cook’s Distance \\(D\\) A 4.00 0.067 0.577 B 0.77 0.550 0.363 C -4.01 0.550 9.832 Como se mencionó en la Sección 2.6, de la columna de residuos estandarizados vemos que tanto los puntos A como C son valores atípicos. Para juzgar el tamaño de los apalancamientos, dado que hay \\(n=20\\) puntos, los apalancamientos están limitados por 0.05 y 1.00, con el apalancamiento promedio siendo \\(\\bar{h} = \\frac{2}{20} = 0.10\\). Usando 0.3 (\\(= 3 \\times \\bar{h}\\)) como un umbral, tanto los puntos B como C son puntos de alto apalancamiento. Nótese que sus valores son los mismos. Esto se debe a que, según la Figura 2.7, los valores de las variables explicativas son los mismos y solo la variable de respuesta ha cambiado. La columna de la distancia de Cook captura ambos tipos de comportamiento inusual. Dado que el valor típico de \\(D_i\\) es \\(\\frac{1}{n}\\) o 0.05, la distancia de Cook proporciona una estadística para alertarnos de que cada punto es inusual en un aspecto u otro. En particular, el punto C tiene un \\(D_i\\) muy grande, lo que refleja el hecho de que es tanto un valor atípico como un punto de alto apalancamiento. El percentil 95 de una distribución \\(F\\) con \\(df_1 = 2\\) y \\(df_2 = 18\\) es 3.555. El hecho de que el punto C tenga un valor de \\(D_i\\) que supera con creces este umbral indica la influencia sustancial de este punto. 5.5 Colinealidad 5.5.1 ¿Qué es la Colinealidad? Colinealidad, o multicolinealidad, ocurre cuando una variable explicativa es, o casi es, una combinación lineal de las otras variables explicativas. Intuitivamente, con datos colineales, es útil pensar en las variables explicativas como altamente correlacionadas entre sí. Si una variable explicativa es colineal, surge la pregunta de si es redundante, es decir, si la variable proporciona poca información adicional sobre la información que ya está en las otras variables explicativas. Las preguntas son: ¿Es importante la colinealidad? Si es así, ¿cómo afecta el ajuste de nuestro modelo y cómo la detectamos? Para abordar la primera pregunta, considere un ejemplo algo patológico. Ejemplo: Variables Explicativas Perfectamente Correlacionadas. Joe Finance fue solicitado para ajustar el modelo \\(\\mathrm{E} ~y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2\\) a un conjunto de datos. Su modelo ajustado resultante fue \\(\\hat{y} = -87 + x_1 + 18 x_2.\\) El conjunto de datos considerado es: \\[ \\begin{array}{l|cccc} \\hline i &amp; 1 &amp; 2 &amp; 3 &amp; 4 \\\\ \\hline y_i &amp; 23 &amp; 83 &amp; 63 &amp; 103 \\\\ x_{i1} &amp; 2 &amp; 8 &amp;6 &amp; 10 \\\\ x_{i2} &amp; 6 &amp; 9 &amp; 8 &amp; 10 \\\\ \\hline \\end{array} \\] Joe verificó el ajuste para cada observación. Joe estaba muy contento porque ajustó los datos perfectamente. Por ejemplo, para la tercera observación, el valor ajustado es \\(\\hat{y}_3 = -87 + 6 + 18 \\times 8 = 63\\), que es igual a la tercera respuesta, \\(y_3\\). Debido a que la respuesta es igual al valor ajustado, el residuo es cero. Puede verificar que esto es cierto para cada observación, y así, el \\(R^2\\) resultó ser \\(100\\%\\). Sin embargo, Jane Actuary llegó y ajustó el modelo \\(\\hat{y} = -7 + 9 x_1 + 2 x_2.\\) Jane realizó las mismas comprobaciones cuidadosas que Joe hizo y también obtuvo un ajuste perfecto (\\(R^2 = 1\\)). ¿Quién tiene razón? La respuesta es ambos y ninguno. De hecho, hay un número infinito de ajustes. Esto se debe a la relación perfecta \\(x_2 = 5 + \\frac{x_1}{2}\\) entre las dos variables explicativas. Este ejemplo ilustra algunos hechos importantes sobre la colinealidad. Hechos sobre la Colinealidad La colinealidad no nos impide obtener buenos ajustes ni hacer predicciones de nuevas observaciones. Nótese que en el ejemplo anterior obtuvimos ajustes perfectos. Las estimaciones de las varianzas de error y, por lo tanto, las pruebas de adecuación del modelo, siguen siendo fiables. En casos de colinealidad severa, los errores estándar de los coeficientes de regresión individuales son mayores que en los casos en que, ceteris paribus, no existe colinealidad severa. Con errores estándar grandes, los coeficientes de regresión individuales pueden no ser significativos. Además, debido a que un error estándar grande significa que el correspondiente cociente \\(t\\) es pequeño, es difícil detectar la importancia de una variable. Para detectar la colinealidad, comience con una matriz de coeficientes de correlación de las variables explicativas. Esta matriz es fácil de crear, fácil de interpretar y captura rápidamente las relaciones lineales entre pares de variables. Una matriz de diagramas de dispersión proporciona un refuerzo visual de las estadísticas resumidas en la matriz de correlación. 5.5.2 Factores de Inflación de Varianza Las matrices de correlación y diagramas de dispersión capturan solo las relaciones entre pares de variables. Para capturar relaciones más complejas entre varias variables, introducimos el factor de inflación de varianza (VIF). Para definir un VIF, suponga que el conjunto de variables explicativas está etiquetado como \\(x_1, x_2, \\ldots, x_{k}\\). Ahora, ejecute la regresión utilizando \\(x_j\\) como la “respuesta” y los otros \\(x\\) (\\(x_1, x_2, \\ldots, x_{j-1}, x_{j+1}, \\ldots, x_{k}\\)) como las variables explicativas. Denote el coeficiente de determinación de esta regresión por \\(R_j^2\\). Interpretamos \\(R_j = \\sqrt{R_j^2}\\) como el coeficiente de correlación múltiple entre \\(x_j\\) y las combinaciones lineales de los otros \\(x\\). A partir de este coeficiente de determinación, definimos el factor de inflación de varianza \\[ VIF_j = \\frac{1}{1 - R_j^2}, \\text{ para } j = 1, 2, \\ldots, k. \\] Un mayor \\(R_j^2\\) resulta en un mayor \\(VIF_j\\); esto significa una mayor colinealidad entre \\(x_j\\) y los otros \\(x\\). Ahora, \\(R_j^2\\) por sí solo es suficiente para capturar la relación lineal de interés. Sin embargo, usamos \\(VIF_j\\) en lugar de \\(R_j^2\\) como nuestra medida de colinealidad debido a la relación algebraica \\[\\begin{equation} se(b_j) = s \\frac{\\sqrt{VIF_j}}{s_{x_j} \\sqrt{n - 1}}. \\tag{5.5} \\end{equation}\\] Aquí, \\(se(b_j)\\) y \\(s\\) son errores estándar y la desviación estándar residual de un ajuste completo de regresión de \\(y\\) sobre \\(x_1, \\ldots, x_{k}\\). Además, \\(s_{x_j} = \\sqrt{(n - 1)^{-1} \\sum_{i=1}^{n} (x_{ij} - \\bar{x}_j)^2 }\\) es la desviación estándar muestral de la \\(j\\)-ésima variable \\(x_j\\). La Sección 5.10.3 proporciona una verificación de la ecuación (5.5). Así, un mayor \\(VIF_j\\) resulta en un mayor error estándar asociado con la pendiente \\(j\\)-ésima, \\(b_j\\). Recuerde que \\(se(b_j)\\) es \\(s\\) veces la raíz cuadrada del \\((j+1)\\)-ésimo elemento diagonal de \\((\\mathbf{X}^{\\prime} \\mathbf{X})^{-1}\\). La idea es que cuando ocurre colinealidad, la matriz \\(\\mathbf{X}^{\\prime} \\mathbf{X}\\) tiene propiedades similares al número cero. Cuando intentamos calcular la inversa de \\(\\mathbf{X}^{\\prime} \\mathbf{X}\\), esto es análogo a dividir por cero en números escalares. Como regla general, cuando \\(VIF_j\\) supera 10 (lo cual es equivalente a \\(R_j^2 &gt; 90\\%\\)), decimos que existe colinealidad severa. Esto puede indicar la necesidad de acción. Tolerancia, definida como el recíproco del factor de inflación de varianza, es otra medida de colinealidad utilizada por algunos analistas. Por ejemplo, con \\(k = 2\\) variables explicativas en el modelo, entonces \\(R_1^2\\) es la correlación cuadrada entre las dos variables explicativas, digamos \\(r_{12}^2\\). Entonces, a partir de la ecuación anterior, tenemos que \\[ se(b_j) = s \\left(s_{x_j} \\sqrt{n - 1} \\right)^{-1} \\left(1 - r_{12}^2 \\right)^{-1/2}, \\text{ para } j = 1, 2. \\] A medida que la correlación se acerca a uno en valor absoluto, \\(|r_{12}| \\rightarrow 1\\), entonces el error estándar se vuelve grande, lo que significa que el estadístico \\(t\\) correspondiente se vuelve pequeño. En resumen, un alto \\(VIF\\) puede significar pequeños estadísticos \\(t\\) a pesar de que las variables sean importantes. Además, se puede verificar que la correlación entre \\(b_1\\) y \\(b_2\\) es \\(-r_{12}\\), indicando que las estimaciones de los coeficientes están altamente correlacionadas. Ejemplo: Liquidez del Mercado de Valores - Continuación. Como ejemplo, considere una regresión de VOLUME sobre PRICE, SHARE y VALUE. A diferencia de las variables explicativas consideradas en la Sección 5.5.3, estas tres variables explicativas no son medidas de actividad de trading. A partir de un ajuste de regresión, tenemos \\(R^2 = 61\\%\\) y \\(s = 6.72\\). Las estadísticas asociadas con los coeficientes de regresión están en la Tabla 5.7. Tabla 5.7: Estadísticas de una regresión de VOLUME sobre PRICE, SHARE y VALUE \\(x_j\\) \\(s_{x_j}\\) \\(b_j\\) \\(se(b_j)\\) \\(t(b_j)\\) \\(VIF_j\\) PRICE 21.370 -0.022 0.035 -0.63 1.5 SHARE 115.100 0.054 0.010 5.19 3.8 VALUE 8.157 0.313 0.162 1.94 4.7 Puede verificar que la relación en la ecuación (5.5) es válida para cada una de las variables explicativas en la Tabla 5.7. Dado que cada estadístico \\(VIF\\) es menor a diez, hay poca razón para sospechar colinealidad severa. Esto es interesante porque puede recordar que existe una relación perfecta entre PRICE, SHARE y VALUE en el sentido de que definimos el valor de mercado como VALUE = PRICE \\(\\times\\) SHARE. Sin embargo, la relación es multiplicativa y, por lo tanto, es no lineal. Debido a que las variables no están relacionadas linealmente, es válido incluir las tres en el modelo de regresión. Desde una perspectiva financiera, la variable VALUE es importante porque mide el valor de una empresa. Desde una perspectiva estadística, la variable VALUE cuantifica la interacción entre PRICE y SHARE (las variables de interacción se introdujeron en la Sección 3.5.3). Para la colinealidad, solo nos interesa detectar tendencias lineales, por lo que las relaciones no lineales entre variables no son un problema aquí. Por ejemplo, hemos visto que a veces es útil mantener tanto una variable explicativa \\(x\\) como su cuadrado \\(x^2\\), a pesar de que existe una relación perfecta (no lineal) entre las dos. Sin embargo, debemos verificar que las relaciones no lineales no sean aproximadamente lineales en la región de muestreo. Aunque la relación es teóricamente no lineal, si es cercana a lineal para nuestra muestra disponible, pueden surgir problemas de colinealidad. La Figura 5.5 ilustra esta situación. Figura 5.5: La relación entre \\(x_1\\) y \\(x_2\\) es no lineal. Sin embargo, en la región muestreada, las variables tienen una relación casi lineal. ¿Qué podemos hacer en presencia de colinealidad? Una opción es centrar cada variable, restando su promedio y dividiendo por su desviación estándar. Por ejemplo, crear una nueva variable \\(x_{ij}^{\\ast} = (x_{ij} - \\bar{x}_j) / s_{x_j}\\). A veces, una variable aparece en millones de unidades y otra en fracciones de unidades. Comparado con la primera variable, la segunda parece ser casi una columna constante de ceros (dado que las computadoras retienen típicamente un número finito de dígitos). Si esto es cierto, entonces la segunda variable se parece mucho a un desplazamiento lineal de la columna constante de unos correspondiente al intercepto. Esto es un problema porque, con las operaciones de mínimos cuadrados, estamos implícitamente elevando al cuadrado números que pueden hacer que estas columnas parezcan aún más similares. Este problema es simplemente computacional y es fácil de corregir. Simplemente recodifique las variables para que las unidades sean de magnitud similar. Algunos analistas de datos centran automáticamente todas las variables para evitar estos problemas. Este es un enfoque legítimo porque las técnicas de regresión buscan relaciones lineales; los desplazamientos en ubicación y escala no afectan las relaciones lineales. Otra opción es simplemente no tener en cuenta explícitamente la colinealidad en el análisis, pero discutir algunas de sus implicaciones al interpretar los resultados del análisis de regresión. Este enfoque es probablemente el más comúnmente adoptado. Es un hecho que, al tratar con datos de negocios y económicos, la colinealidad tiende a existir entre las variables. Dado que los datos tienden a ser observacionales en lugar de experimentales, hay poco que el analista pueda hacer para evitar esta situación. En la mejor de las situaciones, una variable auxiliar que proporcione información similar y que facilite el problema de colinealidad está disponible para reemplazar una variable. Similar a nuestra discusión sobre puntos de alta influencia, una versión transformada de la variable explicativa también puede ser un sustituto útil. En algunas situaciones, un reemplazo ideal no está disponible y nos vemos obligados a eliminar una o más variables. Decidir qué variables eliminar es una elección difícil. Al decidir entre variables, a menudo la elección estará dictada por el juicio del investigador sobre cuál es el conjunto de variables más relevante. 5.5.3 Colinealidad e Influencia Las medidas de colinealidad e influencia comparten características comunes y, sin embargo, están diseñadas para capturar diferentes aspectos de un conjunto de datos. Ambas son útiles para la crítica de datos y del modelo; se aplican después de un ajuste preliminar del modelo con el objetivo de mejorar la especificación del modelo. Además, ambas se calculan utilizando solo las variables explicativas; los valores de las respuestas no entran en ninguno de los cálculos. Nuestra medida de colinealidad, el factor de inflación de la varianza, está diseñada para ayudar con la crítica del modelo. Es una medida calculada para cada variable explicativa, diseñada para explicar la relación con otras variables explicativas. La estadística de influencia está diseñada para ayudarnos con la crítica de datos. Es una medida calculada para cada observación para ayudarnos a explicar cuán inusual es una observación con respecto a otras observaciones. La colinealidad puede estar enmascarada o inducida por puntos de alta influencia, como lo señalaron Mason y Gunst (1985) y Hadi (1988). Las Figuras 5.6 y 5.7 proporcionan ilustraciones de cada caso. Estos ejemplos simples subrayan un punto importante: la crítica de datos y la crítica del modelo no son ejercicios separados. Figura 5.6: Con la excepción del punto marcado, \\(x_1\\) y \\(x_2\\) están altamente relacionados linealmente. Figura 5.7: La relación lineal altamente entre \\(x_1\\) y \\(x_2\\) es principalmente debido al punto marcado. Los ejemplos en las Figuras 5.6 y 5.7 también nos ayudan a ver una forma en que los puntos de alta influencia pueden afectar los errores estándar de los coeficientes de regresión. Recuerde que, en la Sección 5.4.1, vimos que los puntos de alta influencia pueden afectar los valores ajustados del modelo. En las Figuras 5.6 y 5.7, vemos que los puntos de alta influencia afectan la colinealidad. Por lo tanto, a partir de la ecuación (5.5), tenemos que los puntos de alta influencia también pueden afectar nuestros errores estándar de los coeficientes de regresión. 5.5.4 Variables Suprensoras Como hemos visto, la colinealidad severa puede inflar seriamente los errores estándar de los coeficientes de regresión. Dado que dependemos de estos errores estándar para evaluar la utilidad de las variables explicativas, nuestros procedimientos de selección de modelos e inferencias pueden ser deficientes en presencia de colinealidad severa. A pesar de estos inconvenientes, la colinealidad leve en un conjunto de datos no debe considerarse una deficiencia del conjunto de datos; es simplemente una característica de las variables explicativas disponibles. Incluso si una variable explicativa es casi una combinación lineal de las demás, eso no significa necesariamente que la información que proporciona sea redundante. Para ilustrar, ahora consideramos una variable suprensora, una variable explicativa que aumenta la importancia de otras variables explicativas cuando se incluye en el modelo. Ejemplo: Variable Suprensora. La Figura 5.8 muestra una matriz de dispersión de un conjunto de datos hipotético con cincuenta observaciones. Este conjunto de datos contiene una variable dependiente y dos variables explicativas. La Tabla 5.8 proporciona la matriz de coeficientes de correlación correspondiente. Aquí, vemos que las dos variables explicativas están altamente correlacionadas. Ahora recuerde que, para una regresión con una variable explicativa, el coeficiente de correlación al cuadrado es el coeficiente de determinación. Así, usando la Tabla 5.8, para una regresión de \\(y\\) sobre \\(x_1\\), el coeficiente de determinación es \\((0.188)^2 = 3.5\\%\\). De manera similar, para una regresión de \\(y\\) sobre \\(x_2\\), el coeficiente de determinación es \\((-0.022)^2 = 0.04\\%\\). Sin embargo, para una regresión de \\(y\\) sobre \\(x_1\\) y \\(x_2\\), el coeficiente de determinación resulta ser sorprendentemente alto, \\(80.7\\%\\). La interpretación es que, individualmente, tanto \\(x_1\\) como \\(x_2\\) tienen poco impacto en \\(y\\). Sin embargo, cuando se toman conjuntamente, las dos variables explicativas tienen un efecto significativo en \\(y\\). Aunque la Tabla 5.8 muestra que \\(x_1\\) y \\(x_2\\) están fuertemente relacionados linealmente, esta relación no significa que \\(x_1\\) y \\(x_2\\) proporcionen la misma información. De hecho, en este ejemplo, las dos variables se complementan entre sí. Figura 5.8: Matriz de dispersión de una variable dependiente y dos variables explicativas para el ejemplo de variable suprensora Tabla 5.8: Matriz de Correlación para el Ejemplo de Suprensor \\(x_1\\) \\(x_2\\) \\(x_2\\) 0.972 \\(y\\) 0.188 -0.022 5.5.5 Variables Ortogonales Otra forma de entender el impacto de la colinealidad es estudiar el caso en el que no hay relaciones entre conjuntos de variables explicativas. Matemáticamente, se dice que dos matrices \\(\\mathbf{X}_1\\) y \\(\\mathbf{X}_2\\) son ortogonales si \\(\\mathbf{X}_1^{\\prime} \\mathbf{X}_2 = \\mathbf{0}\\). Intuitivamente, dado que generalmente trabajamos con variables centradas (con medias cero), esto significa que cada columna de \\(\\mathbf{X}_1\\) no está correlacionada con cada columna de \\(\\mathbf{X}_2\\). Aunque es poco probable que ocurra con datos observacionales en las ciencias sociales, al diseñar tratamientos experimentales o construir polinomios de alto grado, las aplicaciones de variables ortogonales se utilizan regularmente (véase, por ejemplo, Hocking, 2003). Para nuestros propósitos, trabajaremos con variables ortogonales simplemente para entender las consecuencias lógicas de una ausencia total de colinealidad. Supongamos que \\(\\mathbf{x}_2\\) es una variable explicativa que es ortogonal a \\(\\mathbf{X}_1\\), donde \\(\\mathbf{X}_1\\) es una matriz de variables explicativas que incluye la intersección. Entonces, es sencillo comprobar que la adición de \\(\\mathbf{x}_2\\) a la ecuación de regresión no cambia el ajuste para los coeficientes correspondientes a \\(\\mathbf{X}_1\\). Es decir, sin \\(\\mathbf{x}_2\\), los coeficientes correspondientes a \\(\\mathbf{X}_1\\) se calcularían como \\(\\mathbf{b}_1 = \\left(\\mathbf{X}_1^{\\prime} \\mathbf{X}_1 \\right)^{-1} \\mathbf{X}_1^{\\prime} \\mathbf{y}\\). Usar el ortogonal \\(\\mathbf{x}_2\\) como parte del cálculo de mínimos cuadrados no cambiaría el resultado para \\(\\mathbf{b}_1\\) (véase el cálculo recursivo de mínimos cuadrados en la Sección 4.7.2). Además, el factor de inflación de la varianza para \\(\\mathbf{x}_2\\) es 1, lo que indica que el error estándar no se ve afectado por las otras variables explicativas. De manera similar, la reducción en la suma de errores al agregar la variable ortogonal \\(\\mathbf{x}_2\\) se debe únicamente a esa variable, y no a su interacción con otras variables en \\(\\mathbf{X}_1\\). Las variables ortogonales pueden ser creadas para datos observacionales en ciencias sociales (así como otros datos colineales) utilizando el método de componentes principales. Con este método, se utiliza una transformación lineal de la matriz de variables explicativas de la forma, \\(\\mathbf{X}^{\\ast} = \\mathbf{X} \\mathbf{P}\\), de manera que la matriz resultante \\(\\mathbf{X}^{\\ast}\\) esté compuesta por columnas ortogonales. La función de regresión transformada es \\(\\mathrm{E~}\\mathbf{y} = \\mathbf{X} \\boldsymbol \\beta = \\mathbf{X} \\mathbf{P} \\mathbf{P}^{-1} \\boldsymbol \\beta = \\mathbf{X}^{\\ast} \\boldsymbol \\beta^{\\ast}\\), donde \\(\\boldsymbol \\beta^{\\ast} = \\mathbf{P}^{-1} \\boldsymbol \\beta\\) es el conjunto de nuevos coeficientes de regresión. La estimación procede como antes, con el conjunto ortogonal de variables explicativas. Al elegir la matriz \\(\\mathbf{P}\\) apropiadamente, cada columna de \\(\\mathbf{X}^{\\ast}\\) tiene una contribución identificable. Así, podemos usar técnicas de selección de variables para identificar las porciones de “componentes principales” de \\(\\mathbf{X}^{\\ast}\\) para usar en la ecuación de regresión. La regresión por componentes principales es un método ampliamente utilizado en algunas áreas de aplicación, como la psicología. Puede abordar fácilmente datos altamente colineales de manera disciplinada. La principal desventaja de esta técnica es que las estimaciones de parámetros resultantes son difíciles de interpretar. 5.6 Criterios de Selección 5.6.1 Bondad de Ajuste ¿Qué tan bien se ajusta el modelo a los datos? Los criterios que miden la proximidad entre el modelo ajustado y los datos reales se conocen como estadísticas de bondad de ajuste. Específicamente, interpretamos el valor ajustado \\(\\hat{y}_i\\) como la mejor aproximación del modelo para la \\(i\\)-ésima observación y lo comparamos con el valor real \\(y_i\\). En la regresión lineal, examinamos la diferencia a través del residuo \\(e_i = y_i - \\hat{y}_i\\); residuos pequeños implican un buen ajuste del modelo. Hemos cuantificado esto a través del tamaño del error típico \\((s)\\), incluyendo el coeficiente de determinación \\((R^2)\\) y una versión ajustada \\((R_{a}^2)\\). Para modelos no lineales, necesitaremos medidas adicionales, y es útil introducir estas medidas en este caso lineal más simple. Una de estas medidas es el Criterio de Información de Akaike que se definirá en términos de ajustes de verosimilitud en la Sección 11.9.4. Para la regresión lineal, se reduce a \\[\\begin{equation} AIC = n \\ln (s^2) + n \\ln (2 \\pi) + n + 3 + k. \\tag{5.6} \\end{equation}\\] Para la comparación de modelos, cuanto menor sea el \\(AIC\\), mejor es el ajuste. Comparar modelos con el mismo número de variables (\\(k\\)) significa que seleccionar un modelo con valores bajos de \\(AIC\\) lleva a la misma elección que seleccionar un modelo con valores bajos de la desviación estándar de los residuos \\(s\\). Además, un pequeño número de parámetros implica un valor bajo de \\(AIC\\), manteniéndose todo lo demás constante. La idea es que esta medida equilibra el ajuste (\\(n \\ln (s^2)\\)) con una penalización por complejidad (el número de parámetros, \\(k+2\\)). Los paquetes estadísticos a menudo omiten constantes como \\(n \\ln (2 \\pi)\\) y \\(n+3\\) al reportar \\(AIC\\) porque no importan al comparar modelos. La Sección 11.9.4 presentará otra medida, el Criterio de Información de Bayes (\\(BIC\\)), que da un peso menor a la penalización por complejidad. Una tercera medida de bondad de ajuste que se usa en modelos de regresión lineal es la estadística \\(C_p\\). Para definir esta estadística, supongamos que tenemos disponibles \\(k\\) variables explicativas \\(x_1, ..., x_{k}\\) y realizamos una regresión para obtener \\(s_{full}^2\\) como el error cuadrático medio. Ahora, supongamos que consideramos usar solo \\(p-1\\) variables explicativas de modo que haya \\(p\\) coeficientes de regresión. Con estas \\(p-1\\) variables explicativas, realizamos una regresión para obtener la suma de cuadrados del error \\((Error~SS)_p\\). Así, estamos en posición de definir \\[ C_{p} = \\frac{(Error~SS)_p}{s_{full}^2} - n + 2p. \\] Como criterio de selección, elegimos el modelo con un coeficiente \\(C_{p}\\) “pequeño”, donde pequeño se entiende en relación con \\(p\\). En general, los modelos con valores más pequeños de \\(C_{p}\\) son más deseables. Al igual que las estadísticas \\(AIC\\) y \\(BIC\\), la estadística \\(C_{p}\\) busca un equilibrio entre el ajuste del modelo y la complejidad. Es decir, cada estadística resume el compromiso entre el ajuste del modelo y la complejidad, aunque con diferentes pesos. Para la mayoría de los conjuntos de datos, recomiendan el mismo modelo, por lo que un analista puede reportar cualquiera o todas las tres estadísticas. Sin embargo, para algunas aplicaciones, llevan a diferentes modelos recomendados. En este caso, el analista necesita confiar más en criterios no basados en datos para la selección del modelo (los cuales siempre son importantes en cualquier aplicación de regresión). 5.6.2 Validación del Modelo La validación del modelo es el proceso de confirmar que nuestro modelo propuesto es apropiado, especialmente a la luz de los propósitos de la investigación. Recuerda el proceso iterativo de formulación y selección de modelos descrito en la Sección 5.1. Una crítica importante a este proceso iterativo es que es culpable de búsqueda de datos, es decir, ajustar un gran número de modelos a un solo conjunto de datos. Como vimos en la Sección 5.2 sobre la búsqueda de datos en la regresión paso a paso, al mirar una gran cantidad de modelos podemos sobreajustar los datos y subestimar la variación natural en nuestra representación. Podemos responder a esta crítica utilizando una técnica llamada validación fuera de muestra. La situación ideal es tener disponibles dos conjuntos de datos, uno para el desarrollo del modelo y otro para la validación del modelo. Inicialmente desarrollamos uno o varios modelos en el primer conjunto de datos. Los modelos desarrollados a partir del primer conjunto de datos se llaman nuestros modelos candidatos. Luego, el rendimiento relativo de los modelos candidatos podría medirse en un segundo conjunto de datos. De esta manera, los datos utilizados para validar el modelo no se ven afectados por los procedimientos utilizados para formular el modelo. Desafortunadamente, rara vez estarán disponibles dos conjuntos de datos para el investigador. Sin embargo, podemos implementar el proceso de validación dividiendo el conjunto de datos en dos submuestras. A estas las llamamos las submuestras de desarrollo del modelo y submuestras de validación, respectivamente. También se conocen como muestras de entrenamiento y prueba, respectivamente. Para ver cómo funciona el proceso en el contexto de la regresión lineal, considera el siguiente procedimiento. Procedimiento de Validación Fuera de Muestra Comienza con un tamaño de muestra de \\(n\\) y divídelo en dos submuestras, llamadas la submuestra de desarrollo del modelo y la submuestra de validación. Sea \\(n_1\\) y \\(n_2\\) el tamaño de cada submuestra. En regresión transversal, realiza esta división usando un mecanismo de muestreo aleatorio. Usa la notación \\(i=1,...,n_1\\) para representar las observaciones de la submuestra de desarrollo del modelo y \\(i=n_1+1,...,n_1+n_2=n\\) para las observaciones de la submuestra de validación. La Figura 5.9 ilustra este procedimiento. Usando la submuestra de desarrollo del modelo, ajusta un modelo candidato al conjunto de datos \\(i=1,...,n_1\\). Usando el modelo creado en el Paso (ii) y las variables explicativas de la submuestra de validación, “predice” las variables dependientes en la submuestra de validación, \\(\\hat{y}_i\\), donde \\(i=n_1+1,...,n_1+n_2\\). (Para obtener estas predicciones, puede que necesites transformar las variables dependientes de nuevo a la escala original.) Evalúa la proximidad de las predicciones a los datos retenidos. Una medida es la suma de errores cuadráticos de predicción \\[\\begin{equation} SSPE = \\sum_{i=n_1+1}^{n_1+n_2} (y_i - \\hat{y}_i)^2 . \\tag{5.7} \\end{equation}\\] Repite los Pasos (ii) a (iv) para cada modelo candidato. Elige el modelo con el menor SSPE. Figura 5.9: Para la validación del modelo, un conjunto de datos de tamaño \\(n\\) se divide aleatoriamente en dos submuestras Existen varias críticas a la SSPE. Primero, es evidente que calcular esta estadística para cada uno de varios modelos candidatos lleva una cantidad considerable de tiempo y esfuerzo. Sin embargo, como ocurre con muchas técnicas estadísticas, esto es simplemente una cuestión de tener disponible software estadístico especializado para realizar los pasos descritos anteriormente. Segundo, dado que la estadística en sí se basa en un subconjunto aleatorio de la muestra, su valor variará de un analista a otro. Esta objeción podría superarse utilizando las primeras \\(n_1\\) observaciones de la muestra. En la mayoría de las aplicaciones, esto no se hace por si hay una relación oculta en el orden de las observaciones. Tercero, y quizás lo más importante, es el hecho de que la elección de los tamaños relativos de los subconjuntos, \\(n_1\\) y \\(n_2\\), no está clara. Varios investigadores recomiendan diferentes proporciones para la asignación. Snee (1977) sugiere que la división de datos no se realice a menos que el tamaño de la muestra sea moderadamente grande, específicamente, \\(n \\geq 2(k+1) + 20\\). Las directrices de Picard y Berk (1990) muestran que cuanto mayor es el número de parámetros a estimar, mayor es la proporción de observaciones necesarias para la submuestra de desarrollo del modelo. Como regla general, para conjuntos de datos con 100 observaciones o menos, usa alrededor del 25-35% de la muestra para validación fuera de muestra. Para conjuntos de datos con 500 o más observaciones, usa el 50% de la muestra para validación fuera de muestra. Hastie, Tibshirani y Friedman (2001) señalan que una división típica es 50% para desarrollo/entrenamiento, 25% para validación, y el 25% restante para una tercera etapa de validación adicional que ellos llaman prueba. Debido a estas críticas, los analistas utilizan varias variantes del proceso básico de validación fuera de muestra. Aunque no existe un procedimiento teóricamente mejor, se acuerda ampliamente que la validación del modelo es una parte importante para confirmar la utilidad de un modelo. 5.6.3 Validación Cruzada La validación cruzada es una técnica de validación de modelos que divide los datos en dos conjuntos disjuntos. La Sección 5.6.2 discutió la validación fuera de muestra, donde los datos se dividieron aleatoriamente en dos subconjuntos, ambos conteniendo un porcentaje considerable de los datos. Otro método popular es la validación cruzada de dejar uno fuera, donde la muestra de validación consiste en una sola observación y la muestra de desarrollo se basa en el resto del conjunto de datos. Especialmente para tamaños de muestra pequeños, una estadística atractiva de validación cruzada de dejar uno fuera es PRESS, la Suma de Cuadrados de Residuos Predichos. Para definir la estadística, considera el siguiente procedimiento donde suponemos que hay un modelo candidato disponible. Procedimiento de Validación PRESS Desde la muestra completa, omite el \\(i\\)-ésimo punto y usa las \\(n-1\\) observaciones restantes para calcular los coeficientes de regresión. Usa los coeficientes de regresión calculados en el primer paso y las variables explicativas para la \\(i\\)-ésima observación para calcular la respuesta predicha, \\(\\hat{y}_{(i)}\\). Esta parte del procedimiento es similar al cálculo de la estadística SSPE con \\(n_1=n-1\\) y \\(n_2=1\\). Ahora, repite (i) y (ii) para \\(i=1,...,n\\). Resumiendo, define \\[\\begin{equation} PRESS = \\sum_{i=1}^{n} (y_i - \\hat{y}_{(i)})^2 . \\tag{5.8} \\end{equation}\\] Al igual que con SSPE, esta estadística se calcula para cada uno de varios modelos competidores. Bajo este criterio, elegimos el modelo con el PRESS más pequeño. Basado en esta definición, la estadística parece ser muy intensiva en cálculos ya que requiere \\(n\\) ajustes de regresión para evaluarla. Para abordar esto, los lectores interesados encontrarán que la Sección 5.10.2 establece \\[\\begin{equation} y_i - \\hat{y}_{(i)} = \\frac{e_i}{1 - h_{ii}} . \\tag{5.9} \\end{equation}\\] Aquí, \\(e_i\\) y \\(h_{ii}\\) representan el \\(i\\)-ésimo residuo y la influencia del ajuste de regresión utilizando el conjunto de datos completo. Esto da lugar a \\[\\begin{equation} PRESS = \\sum_{i=1}^{n} \\left( \\frac{e_i}{1 - h_{ii}} \\right)^2 , \\tag{5.10} \\end{equation}\\] lo cual es una fórmula computacionalmente mucho más fácil. Así, la estadística PRESS es menos intensiva en cálculos que SSPE. Otra ventaja importante de esta estadística, en comparación con SSPE, es que no necesitamos hacer una elección arbitraria sobre los tamaños relativos de los subconjuntos. De hecho, dado que estamos realizando una validación “fuera de muestra” para cada observación, se puede argumentar que este procedimiento es más eficiente, una consideración especialmente importante cuando el tamaño de la muestra es pequeño (por ejemplo, menos de 50 observaciones). Una desventaja es que, dado que el modelo se vuelve a ajustar para cada punto eliminado, PRESS no goza de la apariencia de independencia entre los aspectos de estimación y predicción, a diferencia de SSPE. 5.7 Heterocedasticidad En la mayoría de las aplicaciones de regresión, el objetivo es entender los determinantes de la función de regresión \\(\\mathrm{E~}y_i = \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta = \\mu_i\\). Nuestra capacidad para entender la media está fuertemente influenciada por la cantidad de dispersión respecto a la media, que cuantificamos usando la varianza \\(\\mathrm{E}\\left(y_i - \\mu_i\\right)^2\\). En algunas aplicaciones, como cuando me peso en una balanza, hay relativamente poca variabilidad; las mediciones repetidas dan casi el mismo resultado. En otras aplicaciones, como el tiempo que me toma volar a Nueva York, las mediciones repetidas muestran una variabilidad sustancial y están llenas de incertidumbre inherente. La cantidad de incertidumbre también puede variar de un caso a otro. Denotamos el caso de “variabilidad variable” con la notación \\(\\sigma_i^2 = \\mathrm{E}\\left(y_i - \\mu_i\\right)^2\\). Cuando la variabilidad varía según la observación, esto se conoce como heterocedasticidad, que significa “dispersión diferente”. En contraste, la suposición habitual de variabilidad común (suposición E3/F3 en la Sección 3.2) se llama homocedasticidad, lo que significa “misma dispersión”. Nuestras estrategias de estimación dependen del grado de heterocedasticidad. Para conjuntos de datos con solo una ligera heterocedasticidad, se puede usar mínimos cuadrados para estimar los coeficientes de regresión, tal vez combinado con un ajuste para los errores estándar (descritos en la Sección 5.7.2). Esto se debe a que los estimadores de mínimos cuadrados son insesgados incluso en presencia de heterocedasticidad (ver Propiedad 1 en la Sección 3.2). Sin embargo, con variables dependientes heterocedásticas, el teorema de Gauss-Markov ya no se aplica, por lo que los estimadores de mínimos cuadrados no están garantizados como óptimos. En casos de heterocedasticidad severa, se utilizan estimadores alternativos, siendo los más comunes aquellos basados en transformaciones de la variable dependiente, como se describirá en la Sección 5.7.4. 5.7.1 Detección de Heterocedasticidad Para decidir una estrategia para manejar la posible heterocedasticidad, primero debemos evaluar o detectar su presencia. Para detectar heterocedasticidad de manera gráfica, una buena idea es realizar un ajuste preliminar de regresión de los datos y trazar los residuos frente a los valores ajustados. Para ilustrar, la Figura 5.10 muestra un gráfico de un conjunto de datos ficticio con una variable explicativa donde la dispersión aumenta a medida que aumenta la variable explicativa. Se realizó una regresión por mínimos cuadrados: se calcularon los residuos y los valores ajustados. La Figura 5.11 es un ejemplo de un gráfico de residuos frente a valores ajustados. El ajuste preliminar de regresión elimina muchos de los patrones principales en los datos y deja al ojo libre para concentrarse en otros patrones que pueden influir en el ajuste. Trazamos los residuos frente a los valores ajustados porque los valores ajustados son una aproximación del valor esperado de la respuesta y, en muchas situaciones, la variabilidad crece con la respuesta esperada. Figura 5.10: El área sombreada representa los datos. Figura 5.11: Residuos trazados frente a los valores ajustados para los datos en la Figura 5.10. Más pruebas formales de heterocedasticidad también están disponibles en la literatura de regresión. Por ejemplo, consideremos una prueba de Breusch y Pagan (1980). Específicamente, esta prueba examina la hipótesis alternativa \\(H_a\\): $ y_i = ^2 + _i^{} $, donde \\(\\mathbf{z}_i\\) es un vector conocido de variables y \\(\\boldsymbol \\gamma\\) es un vector de parámetros de dimensión \\(p\\). Así, la hipótesis nula es \\(H_0:~ \\boldsymbol \\gamma = \\mathbf{0}\\), que es equivalente a homocedasticidad, \\(\\mathrm{Var~} y_i = \\sigma^2.\\) Procedimiento para la Prueba de Heterocedasticidad Ajuste un modelo de regresión y calcule los residuos del modelo, \\(e_i\\). Calcule los residuos estandarizados al cuadrado, \\(e_i^{\\ast 2} = e_i^2 / s^2\\). Ajuste un modelo de regresión de \\(e_i^{\\ast 2}\\) sobre \\(\\mathbf{z}_i\\). La estadística de la prueba es \\(LM = \\frac{\\text{Regress~SS}_z}{2}\\), donde \\(Regress~SS_z\\) es la suma de cuadrados de la regresión del ajuste del modelo en el paso (iii). Rechace la hipótesis nula si \\(LM\\) excede un percentil de una distribución chi-cuadrado con \\(p\\) grados de libertad. El percentil es uno menos el nivel de significancia de la prueba. Aquí usamos \\(LM\\) para denotar la estadística de la prueba porque Breusch y Pagan la derivaron como una estadística de multiplicador de Lagrange; consulte Breusch y Pagan (1980) para más detalles. 5.7.2 Errores Estándar Consistentes con Heterocedasticidad Para conjuntos de datos con solo una leve heterocedasticidad, una estrategia sensata es emplear estimadores de mínimos cuadrados de los coeficientes de regresión y ajustar el cálculo de errores estándar para tener en cuenta la heterocedasticidad. En la Sección 3.2 sobre propiedades, vimos que los coeficientes de regresión por mínimos cuadrados pueden escribirse como \\(\\mathbf{b} = \\sum_{i=1}^n \\mathbf{w}_i y_i,\\) donde \\(\\mathbf{w}_i = \\left( \\mathbf{X}^{\\prime}\\mathbf{X} \\right)^{-1} \\mathbf{x}_i\\). Así, con \\(\\sigma_i^2 = \\mathrm{Var~} y_i\\), tenemos \\[\\begin{equation} \\mathrm{Var~}\\mathbf{b} = \\sum_{i=1}^n \\mathbf{w}_i \\mathbf{w}_i^{\\prime} \\sigma_i^2 = \\left( \\mathbf{X}^{\\prime}\\mathbf{X} \\right)^{-1} \\left( \\sum_{i=1}^n \\sigma_i^2 \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\right) \\left( \\mathbf{X}^{\\prime}\\mathbf{X} \\right)^{-1}. \\tag{5.11} \\end{equation}\\] Esta cantidad es conocida excepto por \\(\\sigma_i^2\\). Podemos calcular los residuos usando los coeficientes de regresión por mínimos cuadrados como \\(e_i = y_i - \\mathbf{x}_i^{\\prime} \\mathbf{b}\\). Con estos, podemos definir la estimación empírica, o robusta, de la matriz varianza-covarianza como \\[ \\widehat{\\mathrm{Var~}\\mathbf{b}} = \\left( \\mathbf{X}^{\\prime}\\mathbf{X} \\right)^{-1} \\left( \\sum_{i=1}^n e_i^2 \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\right) \\left( \\mathbf{X}^{\\prime}\\mathbf{X} \\right)^{-1}. \\] Los correspondientes errores estándar “consistentes con heterocedasticidad” son \\[\\begin{equation} se_r(b_j) = \\sqrt{(j+1)^{\\text{er}}~ \\text{elemento diagonal de }\\widehat{\\mathrm{Var~}\\mathbf{b}}}. \\tag{5.12} \\end{equation}\\] La lógica detrás de este estimador es que cada residual al cuadrado, \\(e_i^2\\), puede ser una mala estimación de \\(\\sigma_i^2\\). Sin embargo, nuestro interés es estimar una (ponderada) suma de varianzas en la ecuación (5.11); estimar la suma es una tarea mucho más fácil que estimar cualquier estimación de varianza individual. Los errores estándar robustos, o consistentes con heterocedasticidad, están ampliamente disponibles en paquetes de software estadístico. Aquí, también verá definiciones alternativas de residuos empleados, como en la Sección 5.3.1. Si su paquete estadístico ofrece opciones, el estimador robusto que utiliza residuos studentizados es generalmente preferido. 5.7.3 Mínimos Cuadrados Ponderados Los estimadores de mínimos cuadrados son menos útiles para conjuntos de datos con heterocedasticidad severa. Una estrategia es usar una variación de la estimación por mínimos cuadrados mediante el ponderado de las observaciones. La idea es que, al minimizar la suma de errores cuadrados usando datos heterocedásticos, la variabilidad esperada de algunas observaciones es menor que la de otras. Intuitivamente, parece razonable que, cuanto menor es la variabilidad de la respuesta, más confiable es esa respuesta y mayor peso debería recibir en el procedimiento de minimización. Los mínimos cuadrados ponderados son una técnica que tiene en cuenta esta “variabilidad variable”. Específicamente, usamos los supuestos E1, E2 y E4 de la Sección 3.2.3, con E3 reemplazado por E \\(\\varepsilon_i = 0\\) y \\(\\text{Var} \\varepsilon_i = \\sigma^2 / w_i\\), de modo que la variabilidad es proporcional a un peso conocido \\(w_i\\). Por ejemplo, si la unidad de análisis \\(i\\) representa una entidad geográfica como un estado, podrías usar el número de personas en el estado como peso. O, si \\(i\\) representa una empresa, podrías usar los activos de la empresa para la variable de ponderación. Valores mayores de \\(w_i\\) indican una variable de respuesta más precisa a través de una menor variabilidad. En aplicaciones actuariales, se usan pesos para tener en cuenta una exposición, como el monto de la prima de seguro, el número de empleados, el tamaño de la nómina, el número de vehículos asegurados, etc. (una discusión más detallada está en el Capítulo 18). Este modelo puede convertirse fácilmente en el problema de “mínimos cuadrados ordinarios” multiplicando todas las variables de regresión por \\(\\sqrt{w_i}\\). Es decir, si definimos \\(y_i^{\\ast} = y_i \\times \\sqrt{w_i}\\) y \\(x_{ij}^{\\ast} = x_{ij} \\times \\sqrt{w_i}\\), entonces, a partir del supuesto E1, tenemos \\[ \\begin{array}{ll} y_i^{\\ast} &amp; = y_i \\times \\sqrt{w_i} = \\left( \\beta_0 x_{i0} + \\beta_1 x_{i1} + \\ldots + \\beta_k x_{ik} + \\varepsilon_i \\right) \\sqrt{w_i} \\\\ &amp;= \\beta_0 x_{i0}^{\\ast} + \\beta_1 x_{i1}^{\\ast} + \\ldots + \\beta_k x_{ik}^{\\ast} + \\varepsilon_i^{\\ast} \\end{array} \\] donde \\(\\varepsilon_i^{\\ast} = \\varepsilon_i \\times \\sqrt{w_i}\\) tiene una varianza homocedástica \\(\\sigma^2\\). Así, con las variables reescaladas, toda la inferencia puede proceder como antes. Este trabajo ha sido automatizado en paquetes estadísticos donde el usuario simplemente especifica los pesos \\(w_i\\) y el paquete hace el resto. En términos de álgebra de matrices, este procedimiento se puede llevar a cabo definiendo una matriz de pesos \\(n \\times n\\) \\(\\mathbf{W} = \\text{diag}(w_i)\\), de modo que el elemento diagonal \\(i\\)-ésimo de \\(\\mathbf{W}\\) sea \\(w_i\\). Ampliando la ecuación (3.14), por ejemplo, las estimaciones de mínimos cuadrados ponderados se pueden expresar como \\[\\begin{equation} \\mathbf{b}_{WLS} = \\left( \\mathbf{X}^{\\prime} \\mathbf{W} \\mathbf{X} \\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{W} \\mathbf{y}. \\tag{5.13} \\end{equation}\\] Discuciones adicionales sobre la estimación de mínimos cuadrados ponderados se presentarán en la Sección 15.1.1. 5.7.4 Transformaciones Otro enfoque que maneja la heterocedasticidad severa, introducido en la Sección 1.3, es transformar la variable dependiente, típicamente con una transformación logarítmica de la forma \\(y^{\\ast} = \\ln y\\). Como vimos en la Sección 1.3, las transformaciones pueden servir para “reducir” la dispersión de los datos y simetrizar una distribución. A través de un cambio de escala, una transformación también cambia la variabilidad, potencialmente alterando un conjunto de datos heterocedástico en uno homocedástico. Esta es tanto una fortaleza como una limitación del enfoque de transformación: una transformación afecta simultáneamente tanto la distribución como la heterocedasticidad. Las transformaciones de potencia, como la transformación logarítmica, son más útiles cuando la variabilidad de los datos crece con la media. En este caso, la transformación servirá para “reducir” los datos a una escala que parece ser homocedástica. Por el contrario, dado que las transformaciones son funciones monótonas, no ayudarán con patrones de variabilidad que son no monótonos. Además, si tus datos son razonablemente simétricos pero heterocedásticos, una transformación no será útil porque cualquier elección que mitigue la heterocedasticidad sesgará la distribución. Cuando los datos no son positivos, es común agregar una constante a cada observación para que todas las observaciones sean positivas antes de la transformación. Por ejemplo, la transformación \\(\\ln(1+y)\\) acomoda la presencia de ceros. También se puede multiplicar por una constante para que se mantengan las unidades originales aproximadas. Por ejemplo, la transformación \\(100 \\ln(1 + y/100)\\) puede aplicarse a datos porcentuales donde a veces aparecen porcentajes negativos. Nuestras discusiones sobre transformaciones se han centrado en transformar variables dependientes. Como se señaló en la Sección 3.5, también es posible transformar variables explicativas. Esto se debe a que los supuestos de regresión condicionan las variables explicativas (Sección 3.2.3). Algunos analistas prefieren transformar variables para aproximarse a la normalidad, considerando las distribuciones normales multivariadas como una base para el análisis de regresión. Otros son reacios a transformar variables explicativas debido a las dificultades para interpretar los modelos resultantes. El enfoque aquí es usar transformaciones que sean fácilmente interpretables, como las introducidas en la Sección 3.5. Otras transformaciones son ciertamente candidatas para incluir en un modelo seleccionado, pero deben proporcionar dividendos sustanciales en términos de ajuste o poder predictivo si son difíciles de comunicar. 5.8 Lectura Adicional y Referencias Long y Ervin (2000) reúnen pruebas convincentes sobre el uso de estimadores alternativos consistentes con la heterocedasticidad para los errores estándar que tienen un mejor rendimiento en muestras finitas que las versiones clásicas. Las propiedades de gran muestra de los estimadores empíricos han sido establecidas por Eicker (1967), Huber (1967) y White (1980) en el caso de la regresión lineal. Para el caso de la regresión lineal, MacKinnon y White (1985) sugieren alternativas que proporcionan mejores propiedades en muestras pequeñas. Para muestras pequeñas, la evidencia se basa en (1) el sesgo de los estimadores, (2) su motivación como estimadores jackknife y (3) su rendimiento en estudios de simulación. Otros métodos para medir la colinealidad basados en conceptos de álgebra de matrices que involucran valores propios, como los números de condición y los índices de condición, son utilizados por algunos analistas. Consulta a Belsey, Kuh y Welsch (1980) para un tratamiento sólido de la colinealidad y los diagnósticos de regresión. Hocking (2003) proporciona lecturas adicionales sobre colinealidad y componentes principales. Consulta a Carroll y Ruppert (1988) para más discusiones sobre transformaciones en la regresión. Hastie, Tibshirani y Friedman (2001) ofrecen una discusión avanzada sobre problemas de selección de modelos, centrándose en los aspectos predictivos de los modelos en el lenguaje del aprendizaje automático. Referencias del Capítulo Belseley, David A., Edwin Kuh and Roy E. Welsch (1980). Regression Diagnostics: Identifying Influential Data and Sources of Collinearity. Wiley, New York. Bendel, R. B. and Afifi, A. A. (1977). Comparison of stopping rules in forward “stepwise” regression. Journal of the American Statistical Association 72, 46-53. Box, George E. P. (1980). Sampling and Bayes inference in scientific modeling and robustness (with discussion). Journal of the Royal Statistical Society, Series A, 143, 383-430. Breusch, T. S. and A. R. Pagan (1980). The Lagrange multiplier test and its applications to model specification in econometrics. Review of Economic Studies, 47, 239-53. Carroll, Raymond J. and David Ruppert (1988). Transformation and Weighting in Regression, Chapman-Hall. Eicker, F. (1967). Limit theorems for regressions with unequal and dependent errors. Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability 1, LeCam, L. M. and J. Neyman, editors, University of California Press, pp, 59-82. Hadi, A. S. (1988). Diagnosing collinearity-influential observations. Computational Statistics and Data Analysis 7, 143-159. Hastie, Trevor, Robert Tibshirani and Jerome Friedman (2001). The Elements of Statistical Learning: Data Mining, Inference and Prediction. Springer-Verlag, New York. Hocking, Ronald R. (2003). Methods and Applications of Linear Models: Regression and the Analysis of Variance. Wiley, New York. Huber, P. J. (1967). The behaviour of maximum likelihood estimators under non-standard conditions. Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability 1, LeCam, L. M. and Neyman, J. editors, University of California Press, pp, 221-33. Long, J.S. and L.H. Ervin (2000). Using heteroscedasticity consistent standard errors in the linear regression model. American Statistician 54, 217-224. MacKinnon, J.G. and H. White (1985). Some heteroskedasticity consistent covariance matrix estimators with improved finite sample properties. Journal of Econometrics 29, 53-57. Mason, R. L. and Gunst, R. F. (1985). Outlier-induced collinearities. Technometrics 27, 401-407. Picard, R. R. and Berk, K. N. (1990). Data splitting. The American Statistician 44, 140-147. Rencher, A. C. and Pun, F. C. (1980). Inflation of \\(R^2\\) in best subset regression. Technometrics 22, 49-53. Snee, R. D. (1977). Validation of regression models. Methods and examples. Technometrics 19, 415-428. 5.9 Ejercicios 5.1. Estás realizando una regresión con una variable explicativa, por lo que considera el modelo de regresión lineal básico \\(y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i\\). Muestra que el apalancamiento \\(i\\)-ésimo se puede simplificar a \\[ h_{ii} = \\frac{1}{n} + \\frac{(x_i - \\overline{x})^2}{(n-1) s_x^2}. \\] Muestra que \\(\\overline{h} = 2 / n\\). Supón que \\(h_{ii} = 6/n\\). ¿Cuántas desviaciones estándar está \\(x_i\\) alejado (ya sea por encima o por debajo) de la media? 5.2. Considera los resultados de una regresión usando una variable explicativa con \\(n=3\\) observaciones. Los residuos y los apalancamientos son: \\[ \\small{ \\begin{array}{l|ccc} \\hline i &amp; 1 &amp; 2 &amp; 3 \\\\ \\hline \\text{Residuos } e_i &amp; 3.181 &amp; -6.362 &amp; 3.181 \\\\ \\text{Apalancamientos } h_{ii} &amp; 0.8333 &amp; 0.3333 &amp; 0.8333 \\\\ \\hline \\end{array} } \\] Calcula el estadístico \\(PRESS\\). 5.3. Expectativas de Vida Nacionales. Continuamos con el análisis iniciado en los Ejercicios 1.7, 2.22, 3.6 y 4.7. El enfoque de este ejercicio es la selección de variables. Comienza con los datos de \\(n=185\\) países de todo el mundo que tienen expectativas de vida válidas (no faltantes). Grafica la expectativa de vida frente al producto interno bruto y los gastos privados en salud. A partir de estos gráficos, describe por qué es deseable utilizar transformaciones logarítmicas, lnGDP y lnHEALTH, respectivamente. También grafica la expectativa de vida frente a lnGDP y lnHEALTH para confirmar tu intuición. Utiliza un algoritmo de regresión paso a paso para ayudarte a seleccionar un modelo. No consideres las variables RESEARCHERS, SMOKING y FEMALEBOSS ya que tienen muchos valores faltantes. Para las variables restantes, utiliza solo las observaciones sin valores faltantes. Hazlo dos veces, con y sin la variable categórica REGION. Regresa al conjunto de datos completo de \\(n=185\\) países y ejecuta un modelo de regresión usando FERTILITY, PUBLICEDUCATION y lnHEALTH como variables explicativas. c(i). Proporciona histogramas de residuos estandarizados y apalancamientos. c(ii). Identifica el residuo estandarizado y el apalancamiento asociados con Lesoto, anteriormente Basutolandia, un reino rodeado por Sudáfrica. ¿Es esta observación un valor atípico, un punto de alto apalancamiento, o ambos? c(iii). Repite la regresión sin Lesoto. Cita cualquier diferencia en los coeficientes estadísticos entre este modelo y el del apartado c(i). 5.4. Seguro de Vida a Término. Continuamos con nuestro estudio de la Demanda de Seguro de Vida a Término de los Capítulos 3 y 4. Específicamente, examinamos la Encuesta de Finanzas del Consumidor (SCF) de 2004, una muestra representativa a nivel nacional que contiene información extensa sobre activos, pasivos, ingresos y características demográficas de los encuestados (potenciales clientes de EE.UU.). Estudiamos una muestra aleatoria de 500 familias con ingresos positivos. De la muestra de 500, inicialmente consideramos una submuestra de \\(n=275\\) familias que compraron seguro de vida a término. Considera una regresión lineal de LNINCOME, EDUCATION, NUMHH, MARSTAT, AGE y GENDER sobre LNFACE. Colinealidad. No todas las variables resultaron ser estadísticamente significativas. Para investigar una posible explicación, calcula los factores de inflación de la varianza. a(i). Explica brevemente la idea de colinealidad y un factor de inflación de la varianza. a(ii). ¿Qué constituye un gran factor de inflación de la varianza? a(iii). Si se detecta un gran factor de inflación de la varianza, ¿qué posibles acciones podemos tomar para abordar este aspecto de los datos? a(iv). Complementa las estadísticas de los factores de inflación de la varianza con una tabla de correlaciones de las variables explicativas. Basado en estas estadísticas, ¿es la colinealidad un problema con este modelo ajustado? ¿Por qué o por qué no? Puntos Inusuales. A veces, un ajuste deficiente del modelo puede deberse a puntos inusuales. b(i). Define la idea de apalancamiento para una observación. b(ii). Para este modelo ajustado, da reglas generales para identificar puntos con apalancamiento inusual. Identifica cualquier punto inusual. b(iii). Un analista está preocupado por los valores de apalancamiento de este modelo ajustado y sugiere usar FACE como la variable dependiente en lugar de LNFACE. Describe cómo cambiarían los valores de apalancamiento usando esta variable dependiente alternativa. Análisis de Residuos. Podemos aprender cómo mejorar los ajustes del modelo a partir de los análisis de residuos. c(i). Proporciona un gráfico de residuos frente a valores ajustados. ¿Qué esperamos aprender de este tipo de gráfico? ¿Este gráfico muestra alguna inadecuación del modelo? c(ii). Proporciona un gráfico \\(qq\\) de residuos. ¿Qué esperamos aprender de este tipo de gráfico? ¿Este gráfico muestra alguna inadecuación del modelo? c(iii). Proporciona un gráfico de residuos frente a apalancamientos. ¿Qué esperamos aprender de este tipo de gráfico? ¿Este gráfico muestra alguna inadecuación del modelo? Regresión Paso a Paso. Ejecuta un algoritmo de regresión paso a paso. Supón que este algoritmo sugiere un modelo utilizando LNINCOME, EDUCATION, NUMHH y GENDER como variables explicativas para predecir la variable dependiente LNFACE. d(i). ¿Cuál es el propósito de la regresión paso a paso? d(ii). Describe dos desventajas importantes de los algoritmos de regresión paso a paso. 5.10 Suplementos Técnicos para el Capítulo 5 5.10.1 Matriz de Proyección Matriz de Sombrero. Definimos la matriz de sombrero como \\(\\mathbf{H} = \\mathbf{X(X}^{\\prime}\\mathbf{X)}^{-1} \\mathbf{X}^{\\prime}\\), de manera que \\(\\mathbf{\\hat{y}} = \\mathbf{X b} = \\mathbf{Hy}\\). De esto, se dice que la matriz \\(\\mathbf{H}\\) proyecta el vector de respuestas \\(\\mathbf{y}\\) sobre el vector de valores ajustados \\(\\mathbf{\\hat{y}}\\). Dado que \\(\\mathbf{H}^{\\prime} = \\mathbf{H}\\), la matriz de sombrero es simétrica. Además, también es una matriz idempotente debido a la propiedad de que \\(\\mathbf{HH} = \\mathbf{H}\\). Para ver esto, tenemos que \\[ \\begin{array}{ll} \\mathbf{HH} &amp;= \\mathbf{(X(\\mathbf{X}^{\\prime}X)}^{-1}\\mathbf{X}^{\\prime}\\mathbf{)(X(\\mathbf{X}^{\\prime}X)}^{-1}\\mathbf{X}^{\\prime}\\mathbf{)} \\\\ &amp;= \\mathbf{X(\\mathbf{X}^{\\prime}X)}^{-1}\\mathbf{(\\mathbf{X}^{\\prime}X)(\\mathbf{X}^{\\prime}X)}^{-1}\\mathbf{X}^{\\prime} = \\mathbf{X(\\mathbf{X}^{\\prime}X)}^{-1}\\mathbf{X}^{\\prime} = \\mathbf{H}. \\end{array} \\] De manera similar, es fácil verificar que \\(\\mathbf{I-H}\\) es idempotente. Dado que \\(\\mathbf{H}\\) es idempotente, a partir de algunos resultados en álgebra de matrices, es sencillo mostrar que \\[ \\sum_{i=1}^{n} h_{ii} = k + 1. \\] Como se discutió en la Sección 5.4.1, usamos nuestros límites y el apalancamiento promedio, \\(\\bar{h} = (k + 1)/n\\), para ayudar a identificar observaciones con apalancamiento inusualmente alto. Varianza de los Residuos. Usando la ecuación del modelo \\(\\mathbf{y} = \\mathbf{X} \\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}\\), podemos expresar el vector de residuos como \\[\\begin{equation} \\mathbf{e} = \\mathbf{y} - \\mathbf{\\hat{y}} = \\mathbf{y - Hy} = \\mathbf{(I-H)(X \\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon})} = \\mathbf{(I-H) \\boldsymbol{\\varepsilon}}. \\tag{5.14} \\end{equation}\\] La última igualdad se debe al hecho de que \\(\\mathbf{(I-H)X} = \\mathbf{X - HX} = \\mathbf{X - X} = \\mathbf{0}\\). Usando \\(\\text{Var~} \\boldsymbol{\\varepsilon} = \\sigma^2 \\mathbf{I}\\), tenemos \\[ \\begin{array}{ll} \\text{Var } \\mathbf{e} &amp;= \\text{Var }\\left[ \\mathbf{(I-H)\\boldsymbol{\\varepsilon}} \\right] = \\mathbf{(I-H)} \\text{Var } \\boldsymbol{\\varepsilon} \\mathbf{(I-H)} \\\\ &amp;= \\sigma^2 \\mathbf{(I-H)} \\mathbf{I} \\mathbf{(I-H)} = \\sigma^2 \\mathbf{(I-H)}. \\end{array} \\] La última igualdad proviene del hecho de que \\(\\mathbf{I-H}\\) es idempotente. Así, tenemos que \\[\\begin{equation} \\text{Var } e_i = \\sigma^2 (1 - h_{ii}) \\text{ y Cov } (e_i, e_j) = -\\sigma^2 h_{ij}. \\tag{5.15} \\end{equation}\\] Así, aunque los errores verdaderos \\(\\boldsymbol{\\varepsilon}\\) son no correlacionados, hay una pequeña correlación negativa entre los residuos \\(\\mathbf{e}\\). Dominio del Error en el Residuo. Examinando la fila \\(i\\)-ésima de la ecuación (5.14), tenemos que el residuo \\(i\\)-ésimo \\[\\begin{equation} e_i = \\varepsilon_i - \\sum_{j=1}^{n} h_{ij} \\varepsilon_j \\tag{5.16} \\end{equation}\\] se puede expresar como una combinación lineal de errores independientes. La relación \\(\\mathbf{H} = \\mathbf{HH}\\) da lugar a \\[\\begin{equation} h_{ii} = \\sum_{j=1}^{n} h_{ij}^2. \\tag{5.17} \\end{equation}\\] Dado que \\(h_{ii}\\) es, en promedio, \\((k + 1)/n\\), esto indica que cada \\(h_{ij}\\) es pequeño en relación con 1. Así, al interpretar la ecuación (5.16), decimos que la mayor parte de la información en \\(e_i\\) se debe a \\(\\varepsilon_i\\). Correlaciones con los Residuos. Primero define \\(\\mathbf{x}^j = (x_{1j}, x_{2j}, \\dots, x_{nj})^{\\prime}\\) como la columna que representa la \\(j\\)-ésima variable. Con esta notación, podemos particionar la matriz de variables explicativas como \\(\\mathbf{X} = \\left( \\mathbf{x}^{0}, \\mathbf{x}^{1}, \\dots, \\mathbf{x}^{k} \\right)\\). Ahora, examinando la columna \\(j\\)-ésima de la relación \\(\\mathbf{(I-H)X} = \\mathbf{0}\\), tenemos \\(\\mathbf{(I-H)x}^{j} = \\mathbf{0}\\). Con \\(\\mathbf{e} = \\mathbf{(I-H) \\boldsymbol{\\varepsilon}}\\), esto da \\[ \\mathbf{e}^{\\prime} \\mathbf{x}^{j} = \\boldsymbol{\\varepsilon}^{\\prime} \\mathbf{(I-H)x}^{j} = 0, \\] para \\(j = 0, 1, \\ldots, k.\\) Este resultado tiene varias implicaciones. Si el intercepto está en el modelo, entonces \\(\\mathbf{x}^{0} = (1, 1, \\ldots, 1)^{\\prime}\\) es un vector de unos. Aquí, \\(\\mathbf{e}^{\\prime} \\mathbf{x}^{0} = 0\\) significa que \\(\\sum_{i=1}^{n} e_i = 0\\) o, el residuo promedio es cero. Además, dado que \\(\\mathbf{e}^{\\prime} \\mathbf{x}^{j} = 0\\), es fácil verificar que la correlación muestral entre \\(\\mathbf{e}\\) y \\(\\mathbf{x}^{j}\\) es cero. En la misma línea, también tenemos que \\(\\mathbf{e}^{\\prime} \\mathbf{\\hat{y}} = \\mathbf{e}^{\\prime} \\mathbf{(I-H)Xb} = \\mathbf{0}\\). Así, usando el mismo argumento que antes, la correlación muestral entre \\(\\mathbf{e}\\) y \\(\\mathbf{\\hat{y}}\\) es cero. Coeficiente de Correlación Múltiple. Para un ejemplo de una correlación diferente de cero, considera \\(r(\\mathbf{y, \\hat{y}})\\), la correlación muestral entre \\(\\mathbf{y}\\) y \\(\\mathbf{\\hat{y}}\\). Dado que \\(\\mathbf{(I-H)x}^{0} = \\mathbf{0}\\), tenemos \\(\\mathbf{x}^{0} = \\mathbf{Hx}^{0}\\) y, por lo tanto, \\(\\mathbf{\\hat{y}}^{\\prime} \\mathbf{x}^{0} = \\mathbf{y}^{\\prime} \\mathbf{Hx}^{0} = \\mathbf{y^{\\prime} x}^{0}\\). Asumiendo que \\(\\mathbf{x}^{0} = (1, 1, \\ldots, 1)^{\\prime}\\), esto significa que \\(\\sum_{i=1}^{n} \\hat{y}_i = \\sum_{i=1}^{n} y_i\\), por lo que el valor promedio ajustado es \\(\\bar{y}\\). \\[ r(\\mathbf{y, \\hat{y}}) = \\frac{\\sum_{i=1}^{n} (y_i - \\bar{y})(\\hat{y}_i - \\bar{y})}{(n-1) s_y s_{\\hat{y}}}. \\] Recuerda que \\((n-1) s_y^2 = \\sum_{i=1}^{n} (y_i - \\bar{y})^2 = Total ~SS\\) y \\((n-1) s_{\\hat{y}}^2 = \\sum_{i=1}^{n} (\\hat{y}_i - \\bar{y})^2 = Regress ~SS\\). Además, con \\(\\mathbf{x}^0 = (1, 1, \\ldots, 1)^{\\prime}\\), \\[ \\begin{array}{ll} \\sum_{i=1}^{n} (y_i - \\bar{y})(\\hat{y}_i - \\bar{y}) &amp;= (\\mathbf{y} - \\bar{y} \\mathbf{x}^0)^{\\prime} (\\mathbf{\\hat{y}} - \\bar{y} \\mathbf{x}^0) = \\mathbf{y}^{\\prime} \\mathbf{\\hat{y}} - \\bar{y}^2 \\mathbf{x}^{0 \\prime} \\mathbf{x}^0 \\\\ &amp;= \\mathbf{y}^{\\prime} \\mathbf{Xb} - n \\bar{y}^2 = Regress ~SS. \\end{array} \\] Esto da \\[\\begin{equation} r(\\mathbf{y, \\hat{y}}) = \\frac{Regress ~SS}{\\sqrt{\\left( Total ~SS \\right) \\left( Regress ~SS \\right)}} = \\sqrt{\\frac{Regress ~SS}{Total ~SS}} = \\sqrt{R^2}. \\tag{5.18} \\end{equation}\\] Es decir, el coeficiente de determinación se puede interpretar como la raíz cuadrada de la correlación entre las respuestas observadas y las ajustadas. 5.10.2 Estadísticas Leave-One-Out Notación. Para probar la sensibilidad de las cantidades de regresión, hay varias estadísticas de interés que se basan en la noción de “dejar fuera” u omitir una observación. Con este fin, la notación de subíndice \\((i)\\) significa dejar fuera la \\(i\\)-ésima observación. Por ejemplo, omitir la fila de variables explicativas \\(\\mathbf{x}_i^{\\prime} = (x_{i0}, x_{i1}, \\dots, x_{ik})\\) de \\(\\mathbf{X}\\) da lugar a \\(\\mathbf{X}_{(i)}\\), una matriz de \\((n-1) \\times (k+1)\\) de variables explicativas. De manera similar, \\(\\mathbf{y}_{(i)}\\) es un vector de \\((n-1) \\times 1\\), basado en eliminar la \\(i\\)-ésima fila de \\(\\mathbf{y}\\). Resultado Básico de Matrices. Supongamos que \\(\\mathbf{A}\\) es una matriz invertible de \\(p \\times p\\) y \\(\\mathbf{z}\\) es un vector de \\(p \\times 1\\). El siguiente resultado de álgebra de matrices proporciona una herramienta importante para entender las estadísticas leave-one-out en el análisis de regresión lineal. \\[\\begin{equation} \\left( \\mathbf{A - zz}^{\\prime} \\right)^{-1} = \\mathbf{A}^{-1} + \\frac{\\mathbf{A}^{-1} \\mathbf{zz}^{\\prime} \\mathbf{A}^{-1}}{1 - \\mathbf{z}^{\\prime} \\mathbf{A}^{-1} \\mathbf{z}}. \\tag{5.19} \\end{equation}\\] Para verificar este resultado, simplemente multiplica \\(\\mathbf{A - zz}^{\\prime}\\) por el lado derecho de la ecuación para obtener \\(\\mathbf{I}\\), la matriz identidad. Vector de Coeficientes de Regresión. Al omitir la \\(i\\)-ésima observación, nuestro nuevo vector de coeficientes de regresión es \\(\\mathbf{b}_{(i)} = \\left( \\mathbf{X}_{(i)}^{\\prime} \\mathbf{X}_{(i)} \\right)^{-1} \\mathbf{X}_{(i)}^{\\prime} \\mathbf{y}_{(i)}.\\) Una expresión alternativa para \\(\\mathbf{b}_{(i)}\\) que resulta ser más simple de calcular es \\[\\begin{equation} \\mathbf{b}_{(i)} = \\mathbf{b} - \\frac{\\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i e_i}{1 - h_{ii}}. \\tag{5.20} \\end{equation}\\] Para verificar esto, primero usa el resultado de inversión de matrices con \\(\\mathbf{A} = \\mathbf{X}^{\\prime} \\mathbf{X}\\) y \\(\\mathbf{z} = \\mathbf{x}_i\\) para obtener \\[ \\left( \\mathbf{X}_{(i)}^{\\prime} \\mathbf{X}_{(i)} \\right)^{-1} = (\\mathbf{X}^{\\prime} \\mathbf{X} - \\mathbf{x}_i \\mathbf{x}_i^{\\prime})^{-1} = (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} + \\frac{\\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1}}{1 - h_{ii}}, \\] donde, a partir del resultado de apalancamiento, tenemos \\(h_{ii} = \\mathbf{x}_i^{\\prime} (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} \\mathbf{x}_i\\). Multiplicando cada lado por \\[ \\mathbf{X}_{(i)}^{\\prime} \\mathbf{y}_{(i)} = \\mathbf{X}^{\\prime} \\mathbf{y} - \\mathbf{x}_i y_i \\] da $$ \\[\\begin{array}{ll} \\mathbf{b}_{(i)} &amp;= \\left( \\mathbf{X}_{(i)}^{\\prime} \\mathbf{X}_{(i)} \\right)^{-1} \\mathbf{X}_{(i)}^{\\prime} \\mathbf{y}_{(i)} \\\\ &amp;= \\left( (\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} + \\frac{\\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1}}{1 - h_{ii}} \\right) \\left( \\mathbf{X}^{\\prime} \\mathbf{y} - \\mathbf{x}_i y_i \\right) \\\\ &amp;= \\mathbf{b} - \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i y_i + \\frac{\\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\mathbf{b} - \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i y_i}{1 - h_{ii}} \\\\ &amp;= \\mathbf{b} - \\frac{\\left( 1 - h_{ii} \\right) \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i y_i - \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\mathbf{b} - \\left( \\mathbf{ X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i h_{ii} y_i}{1 - h_{ii}} \\\\ &amp;= \\mathbf{b} - \\frac{\\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i y_i - \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\mathbf{b}}{1 - h_{ii}} \\\\ &amp;= \\mathbf{b} - \\frac{\\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i e_i}{1 - h_{ii}}. \\end{array}\\] $$ Esto establece el resultado. Distancia de Cook. Para medir el efecto, o influencia, de omitir la \\(i\\)-ésima observación, Cook examinó la diferencia entre los valores ajustados con y sin la observación. Definimos la Distancia de Cook como \\[ D_i = \\frac{\\left( \\mathbf{\\hat{y} - \\hat{y}}_{(i)} \\right)^{\\prime} \\left( \\mathbf{\\hat{y} - \\hat{y}}_{(i)} \\right)}{(k+1) s^2} \\] donde \\(\\mathbf{\\hat{y}}_{(i)} = \\mathbf{Xb}_{(i)}\\) es el vector de valores ajustados calculado omitiendo el punto \\(i\\)-ésimo. Usando la ecuación (5.20) y \\(\\mathbf{\\hat{y}} = \\mathbf{Xb}\\), una expresión alternativa para la Distancia de Cook es \\[ \\begin{array}{ll} D_i &amp;= \\frac{\\left( \\mathbf{b - b}_{(i)} \\right)^{\\prime} \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right) \\left( \\mathbf{b - b}_{(i)} \\right)}{(k+1) s^2} \\\\ &amp;= \\frac{e_i^2}{(1 - h_{ii})^2} \\frac{\\mathbf{x}_i^{\\prime} \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right) \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i}{(k+1) s^2} \\\\ &amp; = \\frac{e_i^2}{(1 - h_{ii})^2} \\frac{h_{ii}}{(k+1) s^2} \\\\ &amp;= \\left( \\frac{e_i}{s \\sqrt{1 - h_{ii}}} \\right)^2 \\frac{h_{ii}}{(k+1) (1 - h_{ii})}. \\end{array} \\] Este resultado no solo es útil computacionalmente, sino que también sirve para descomponer la estadística en la parte debida al residuo estandarizado, \\((e_i/(s \\sqrt{1 - h_{ii}}))^2\\), y en la parte debida al apalancamiento, \\(\\frac{h_{ii}}{(k+1) (1 - h_{ii})}\\). Residuo Leave-One-Out. El residuo leave-one-out se define como \\(e_{(i)} = y_i - \\mathbf{x}_i^{\\prime} \\mathbf{b}_{(i)}\\). Se usa en el cálculo de la estadística PRESS, descrita en la Sección 5.6.3. Una expresión computacional simple es \\(e_{(i)} = \\frac{e_i}{1 - h_{ii}}\\). Para verificar esto, usa la ecuación (5.20) para obtener \\[ e_{(i)} = y_i - \\mathbf{x}_i^{\\prime} \\mathbf{b}_{(i)} = y_i - \\mathbf{x}_i^{\\prime} \\left( \\mathbf{b} - \\frac{\\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i e_i}{1 - h_{ii}} \\right) \\] \\[ = e_i + \\frac{\\mathbf{x}_i \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i e_i}{1 - h_{ii}} = e_i + \\frac{h_{ii} e_i}{1 - h_{ii}} = \\frac{e_i}{1 - h_{ii}}. \\] Estimación de Varianza Leave-One-Out. La estimación leave-one-out de la varianza se define como \\[ s_{(i)}^2 = \\frac{((n - 1) - (k + 1))^{-1} \\sum_{j \\ne i} \\left( y_j - \\mathbf{x}_j^{\\prime} \\mathbf{b}_{(i)} \\right)^2}{(n - 1) - (k + 1)}. \\] Se usa en la definición del residuo estandarizado, definido en la Sección 5.3.1. Una expresión computacional simple está dada por \\[\\begin{equation} s_{(i)}^2 = \\frac{(n - (k + 1)) s^2 - \\frac{e_i^2}{1 - h_{ii}}}{(n - 1) - (k + 1)}. \\tag{5.21} \\end{equation}\\] Para ver esto, primero nota que, a partir de la ecuación (5.14), tenemos \\(\\mathbf{He} = \\mathbf{H(I - H) \\boldsymbol{\\varepsilon}} = \\mathbf{0}\\), porque \\(\\mathbf{H} = \\mathbf{HH}\\). En particular, desde la fila \\(i\\)-ésima de \\(\\mathbf{He} = \\mathbf{0}\\), tenemos \\(\\sum_{j=1}^{n} h_{ij} e_j = 0\\). Ahora, usando las ecuaciones (5.17) y (5.20), tenemos \\[ \\begin{array}{ll} \\sum_{j \\ne i} \\left( y_j - \\mathbf{x}_j^{\\prime} \\mathbf{b}_{(i)} \\right)^2 &amp;= \\sum_{j=1}^{n} \\left( y_j - \\mathbf{x}_j^{\\prime} \\mathbf{b}_{(i)} \\right)^2 - \\left( y_i - \\mathbf{x}_i^{\\prime} \\mathbf{b}_{(i)} \\right)^2 \\\\ &amp;= \\sum_{j=1}^{n} \\left( y_j - \\mathbf{x}_j^{\\prime} \\mathbf{b} + \\frac{\\mathbf{x}_j^{\\prime} \\left( \\mathbf{X}^{\\prime} \\mathbf{X} \\right)^{-1} \\mathbf{x}_i e_i}{1 - h_{ii}} \\right) - e_{(i)}^2 \\\\ &amp;= \\sum_{j=1}^{n} \\left( e_j + \\frac{h_{ij} e_i}{1 - h_{ii}} \\right)^2 - \\frac{e_i^2}{(1 - h_{ii})^2} \\\\ &amp;= \\sum_{j=1}^{n} e_j^2 + 0 + \\frac{e_i^2}{(1 - h_{ii})^2} h_{ii} - \\frac{e_i^2}{(1 - h_{ii})^2} \\\\ &amp;= \\sum_{j=1}^{n} e_j^2 - \\frac{e_i^2}{1 - h_{ii}} = (n - (k + 1)) s^2 - \\frac{e_i^2}{1 - h_{ii}}. \\end{array} \\] Esto establece la ecuación (5.21). 5.10.3 Omisión de Variables Notación. Para medir el efecto en las cantidades de regresión, hay una serie de estadísticas de interés basadas en la noción de omitir una variable explicativa. A tal fin, la notación de superíndice \\((j)\\) significa omitir la \\(j\\)-ésima variable, donde \\(j=0,1,\\ldots,k\\). Primero, recuerda que \\(\\mathbf{x}^{j} = (x_{1j}, x_{2j}, \\ldots, x_{nj})^{\\prime}\\) es la columna que representa la \\(j\\)-ésima variable. Además, define \\(\\mathbf{X}^{(j)}\\) como la matriz \\(n \\times k\\) de variables explicativas definida al eliminar \\(\\mathbf{x}^{j}\\) de \\(\\mathbf{X}\\). Por ejemplo, tomando \\(j=k\\), a menudo particionamos \\(\\mathbf{X}\\) como \\(\\mathbf{X} = \\left( \\mathbf{X}^{(k)}: \\mathbf{x}^k \\right)\\). Usando los resultados de la Sección 4.7.2, utilizaremos \\(\\mathbf{X}^{(k)} = \\mathbf{X}_1\\) y \\(\\mathbf{x}^k = \\mathbf{X}_2\\). Factor de Inflación de la Varianza. Primero, nos gustaría establecer la relación entre la definición del error estándar de \\(b_j\\) dada por \\[ se(b_j) = s \\sqrt{(j+1)\\text{ésimo elemento diagonal de }(\\mathbf{X}^{\\prime}\\mathbf{X})^{-1}} \\] y la relación que involucra el factor de inflación de la varianza, \\[ se(b_j) = s \\frac{\\sqrt{VIF_j}}{s_{x_j}\\sqrt{n-1}}. \\] Por simetría de las variables independientes, solo necesitamos considerar el caso donde \\(j=k\\). Así, nos gustaría establecer \\[\\begin{equation} (k+1)\\text{ésimo elemento diagonal de }(\\mathbf{X}^{\\prime}\\mathbf{X})^{-1} = \\frac{VIF_{k}}{(n-1) s_{x_{k}}^2}. \\tag{5.22} \\end{equation}\\] Primero considera el modelo reparametrizado en la ecuación (4.22). A partir de la ecuación (4.23), podemos expresar la estimación del coeficiente de regresión \\[ b_{k} = \\frac{\\mathbf{e}_1^{\\prime}\\mathbf{y}}{\\mathbf{e}_1^{\\prime}\\mathbf{e}_1}. \\] De la ecuación (4.23), tenemos que \\(\\text{Var} \\, b_{k} = \\sigma^2 (\\mathbf{E}_2^{\\prime} \\mathbf{E}_2)^{-1}\\) y así \\[\\begin{equation} se(b_{k}) = s (\\mathbf{E}_2^{\\prime} \\mathbf{E}_2)^{-1/2}. \\tag{5.23} \\end{equation}\\] Así, \\((\\mathbf{E}_2^{\\prime} \\mathbf{E}_2)^{-1}\\) es el \\((k+1)\\)-ésimo elemento diagonal de \\[ \\left( \\begin{bmatrix} \\mathbf{X}_1^{\\prime} \\\\ \\mathbf{E}_2^{\\prime} \\end{bmatrix} \\begin{bmatrix} \\mathbf{X}_1 &amp; \\mathbf{E}_2 \\end{bmatrix} \\right)^{-1} \\] y también es el \\((k+1)\\)-ésimo elemento diagonal de \\((\\mathbf{X}^{\\prime} \\mathbf{X})^{-1}\\). Alternativamente, esto se puede verificar directamente utilizando la inversa de la matriz particionada en la ecuación (4.19). Ahora, supongamos que realizamos una regresión usando \\(\\mathbf{x}^{k} = \\mathbf{X}_2\\) como el vector de respuesta y \\(\\mathbf{X}^{(k)} = \\mathbf{X}_1\\) como la matriz de variables explicativas. Como se anotó arriba en la ecuación (4.22), \\(\\mathbf{E}_2\\) representa los “residuos” de esta regresión y así \\(\\mathbf{E}_2^{\\prime} \\mathbf{E}_2\\) representa la suma de cuadrados del error. Para esta regresión, la suma total de cuadrados es \\[ \\sum_{i=1}^{n} (x_{ik} - \\bar{x}_{k})^2 = (n-1) s_{x_{k}}^2 \\] y el coeficiente de determinación es \\(R_{k}^2\\). Así, \\[ \\mathbf{E}_2^{\\prime} \\mathbf{E}_2 = Error ~SS = Total ~SS (1 - R_{k}^2) = \\frac{(n-1) s_{x_{k}}^2}{VIF_{k}}. \\] Esto establece el resultado. Estableciendo \\(t^2 = F\\). Para probar la hipótesis nula \\(H_0\\): \\(\\beta_{k} = 0\\), el material en la Sección 3.4.1 proporciona una descripción de una prueba basada en el estadístico \\(t\\), \\(t(b_{k}) = \\frac{b_{k}}{se(b_{k})}\\). Un procedimiento alternativo de prueba, descrito en las Secciones 4.2.2, utiliza el estadístico de prueba \\[ F-\\text{ratio} = \\frac{(Error ~SS)_{reducido} - (Error ~SS)_{completo}}{p \\times (Error~MS)_{completo}} = \\frac{\\left( \\mathbf{E}_2^{\\prime} \\mathbf{y} \\right)^2}{s^2 \\mathbf{E}_2^{\\prime} \\mathbf{E}_2} \\] de la ecuación (4.26). Alternativamente, a partir de las ecuaciones (4.23) y (5.23), tenemos \\[\\begin{equation} t(b_{k}) = \\frac{b_{k}}{se(b_{k})} = \\frac{\\left( \\mathbf{E}_2^{\\prime} \\mathbf{y} \\right) / \\left( \\mathbf{E}_2^{\\prime} \\mathbf{E}_2 \\right)}{s / \\sqrt{\\mathbf{E}_2^{\\prime} \\mathbf{E}_2}} = \\frac{\\left( \\mathbf{E}_2^{\\prime} \\mathbf{y} \\right)}{s \\sqrt{\\mathbf{E}_2^{\\prime} \\mathbf{E}_2}}. \\tag{5.24} \\end{equation}\\] Así, \\(t(b_{k})^2 = F\\)-ratio. Coeficientes de Correlación Parcial. A partir del modelo de regresión completo \\[ \\mathbf{y} = \\mathbf{X}^{(k)} \\boldsymbol{\\beta}^{(k)} + \\mathbf{x}_{k} \\beta_{k} + \\boldsymbol{\\varepsilon}, \\] considera dos regresiones separadas. Una regresión usando \\(\\mathbf{x}^{k}\\) como el vector de respuesta y \\(\\mathbf{X}^{(k)}\\) como la matriz de variables explicativas produce los residuos \\(\\mathbf{E}_2\\). De manera similar, una regresión con \\(\\mathbf{y}\\) como el vector de respuesta y \\(\\mathbf{X}^{(k)}\\) como la matriz de variables explicativas produce los residuos \\[ \\mathbf{E}_1 = \\mathbf{y} - \\mathbf{X}^{(k)} \\left( \\mathbf{X}^{(k)\\prime} \\mathbf{X}^{(k)} \\right)^{-1} \\mathbf{X}^{(k)} \\mathbf{y}. \\] Si \\(x^{0} = (1,1,\\ldots,1)^{\\prime}\\), entonces el promedio de \\(\\mathbf{E}_1\\) y \\(\\mathbf{E}_2\\) es cero. En este caso, la correlación muestral entre \\(\\mathbf{E}_1\\) y \\(\\mathbf{E}_2\\) es \\[ r(\\mathbf{E}_1, \\mathbf{E}_2) = \\frac{\\sum_{i=1}^{n} E_{1i} E_{2i}}{\\sqrt{\\left( \\sum_{i=1}^{n} E_{1i}^2 \\right) \\left( \\sum_{i=1}^{n} E_{2i}^2 \\right)}} = \\frac{\\mathbf{E}_1^{\\prime} \\mathbf{E}_2}{\\sqrt{\\left( \\mathbf{E}_1^{\\prime} \\mathbf{E}_1 \\right) \\left( \\mathbf{E}_2^{\\prime} \\mathbf{E}_2 \\right)}}. \\] Como \\(\\mathbf{E}_2\\) es un vector de residuos usando \\(\\mathbf{X}^{(k)}\\) como la matriz de variables explicativas, tenemos que \\(\\mathbf{E}_2^{\\prime} \\mathbf{X}^{(k)} = 0\\). Así, para el numerador, tenemos \\[ \\mathbf{E}_2^{\\prime} \\mathbf{E}_1 = \\mathbf{E}_2^{\\prime} \\left( \\mathbf{y} - \\mathbf{X}^{(k)} \\left( \\mathbf{X}^{(k)\\prime} \\mathbf{X}^{(k)} \\right)^{-1} \\mathbf{X}^{(k)} \\mathbf{y} \\right) = \\mathbf{E}_2^{\\prime} \\mathbf{y}. \\] A partir de las ecuaciones (4.24) y (4.25), tenemos que \\[ (n - (k+1)) s^2 = (Error ~SS)_{completo} = \\mathbf{E}_1^{\\prime} \\mathbf{E}_1 - \\frac{\\left( \\mathbf{E}_1^{\\prime} \\mathbf{y} \\right)^2}{\\mathbf{E}_2^{\\prime} \\mathbf{E}_2} = \\mathbf{E}_1^{\\prime} \\mathbf{E}_1 - \\frac{\\left( \\mathbf{E}_1^{\\prime} \\mathbf{E}_2 \\right)^2}{\\mathbf{E}_2^{\\prime} \\mathbf{E}_2}. \\] Así, a partir de la ecuación (5.24) \\[ \\begin{array}{ll} \\frac{t(b_{k})}{\\sqrt{t(b_{k})^2 + n - (k+1)}} &amp;= \\frac{\\mathbf{E}_2^{\\prime} \\mathbf{y} / \\left(s \\sqrt{\\mathbf{E}_2^{\\prime} \\mathbf{E}_2}\\right)}{\\sqrt{\\frac{\\left( \\mathbf{E}_2^{\\prime} \\mathbf{y} \\right)^2}{s^2 \\mathbf{E}_2^{\\prime} \\mathbf{E}_2} + n - (k+1)}} \\\\ &amp; = \\frac{\\mathbf{E}_2^{\\prime} \\mathbf{y}}{\\sqrt{\\left( \\mathbf{E}_2^{\\prime} \\mathbf{y} \\right)^2 + \\mathbf{E}_2^{\\prime} \\mathbf{E}_2 s^2 \\left(n - (k+1) \\right)}} \\\\ &amp; = \\frac{\\mathbf{E}_2^{\\prime} \\mathbf{E}_1}{\\sqrt{\\left( \\mathbf{E}_2^{\\prime} \\mathbf{E}_1 \\right)^2 + \\mathbf{E}_2^{\\prime} \\mathbf{E}_2 \\left( \\mathbf{E}_1^{\\prime} \\mathbf{E}_1 - \\frac{\\left( \\mathbf{E}_2^{\\prime} \\mathbf{E}_1 \\right)^2}{\\mathbf{E}_2^{\\prime} \\mathbf{E}_2} \\right)}} \\\\ &amp;= \\frac{\\mathbf{E}_1^{\\prime} \\mathbf{E}_2}{\\sqrt{(\\mathbf{E}_1^{\\prime} \\mathbf{E}_1) (\\mathbf{E}_2^{\\prime} \\mathbf{E}_2)}} = r(\\mathbf{E}_1, \\mathbf{E}_2). \\end{array} \\] Esto establece la relación entre el coeficiente de correlación parcial y el estadístico \\(t\\)-ratio. "],["interpretación-de-resultados-de-regresión.html", "Chapter 6 Interpretación de Resultados de Regresión 6.1 Lo que nos dice el proceso de modelado 6.2 La Importancia de la Selección de Variables 6.3 La Importancia de la Recolección de Datos 6.4 Modelos de Datos Faltantes 6.5 Aplicación: Eficiencia en el Costo de los Gestores de Riesgos 6.6 Lecturas Adicionales y Referencias 6.7 Ejercicios 6.8 Suplementos Técnicos para el Capítulo 6", " Chapter 6 Interpretación de Resultados de Regresión Vista previa del capítulo. Un analista de regresión recopila datos, selecciona un modelo y luego informa sobre los hallazgos del estudio, en ese orden. Este capítulo considera estos tres temas en orden inverso, enfatizando cómo cada etapa del estudio está influenciada por los pasos precedentes. Una aplicación, determinar las características de una empresa que influyen en su efectividad para gestionar el riesgo, ilustra el proceso de modelado de regresión de principio a fin. Estudiar un problema utilizando un proceso de modelado de regresión implica un compromiso sustancial de tiempo y energía. Primero, uno debe adoptar el concepto de pensamiento estadístico, es decir, estar dispuesto a utilizar los datos activamente como parte de un proceso de toma de decisiones. En segundo lugar, uno debe apreciar la utilidad de un modelo que se usa para aproximar una situación real. Después de hacer este compromiso sustancial, hay una tendencia natural a “sobrevender” los resultados de métodos estadísticos como el análisis de regresión. Al sobrevender cualquier conjunto de ideas, los consumidores eventualmente se sienten decepcionados cuando los resultados no cumplen con sus expectativas. Este capítulo comienza en la Sección 6.1 resumiendo lo que podemos esperar aprender razonablemente del modelado de regresión. Los modelos están diseñados para ser mucho más simples que las relaciones entre entidades que existen en el mundo real. Un modelo es simplemente una aproximación de la realidad. Como dijo George Box (1979), “Todos los modelos son incorrectos, pero algunos son útiles”. Desarrollar el modelo, el tema del Capítulo 5, es parte del arte de la estadística. Aunque los principios de la selección de variables son ampliamente aceptados, la aplicación de estos principios puede variar considerablemente entre los analistas. El producto resultante tiene ciertos valores estéticos y de ninguna manera está predeterminado. La estadística se puede considerar como el arte de razonar con datos. La Sección 6.2 subrayará la importancia de la selección de variables. La formulación del modelo y la recopilación de datos forman la primera etapa del proceso de modelado. Los estudiantes de estadística suelen sorprenderse por la dificultad de relacionar ideas sobre relaciones con los datos disponibles. Estas dificultades incluyen la falta de datos fácilmente disponibles y la necesidad de usar ciertos datos como sustitutos de la información ideal que no está disponible numéricamente. La Sección 6.3 describirá varios tipos de dificultades que pueden surgir al recopilar datos. La Sección 6.4 describirá algunos modelos para aliviar estas dificultades. 6.1 Lo que nos dice el proceso de modelado La inferencia del modelo es la etapa final del proceso de modelado. Al estudiar el comportamiento de los modelos, esperamos aprender algo sobre el mundo real. Los modelos sirven para imponer un orden en la realidad y proporcionar una base para entender la realidad a través de la naturaleza del orden impuesto. Además, los modelos estadísticos se basan en el razonamiento con los datos disponibles de una muestra. Por lo tanto, los modelos sirven como una guía importante para predecir el comportamiento de observaciones fuera de la muestra disponible. 6.1.1 Interpretación de efectos individuales Al interpretar los resultados de una regresión múltiple, el objetivo principal es a menudo transmitir la importancia de las variables individuales, o efectos, sobre un resultado de interés. La interpretación depende de si los efectos son o no significativamente sustantivos, estadísticamente significativos y causales. Significado Sustantivo. Los lectores de un estudio de regresión primero quieren entender la dirección y magnitud de los efectos individuales. ¿Las mujeres tienen más o menos reclamaciones que los hombres en un estudio de reclamaciones de seguros? Si es menos, ¿cuánto menos? Puedes responder a estas preguntas a través de una tabla de coeficientes de regresión. Además, para dar una idea de la fiabilidad de las estimaciones, también puede ser útil incluir el error estándar o un intervalo de confianza, como se introdujo en la Sección 3.4.2. Recuerda que los coeficientes de regresión son estimaciones de las derivadas parciales de la función de regresión \\[ \\mathrm{E~}y = \\beta_0 + \\beta_1 x_1 + \\ldots + \\beta_k x_k. \\] Al interpretar los coeficientes para variables explicativas continuas, es útil hacerlo en términos de cambios significativos de cada \\(x\\). Por ejemplo, si la población es una variable explicativa, podemos hablar del cambio esperado en \\(y\\) por cada cambio de 1,000 o un millón en la población. Además, al interpretar los coeficientes de regresión, comenta sobre su significado “sustantivo”. Por ejemplo, supongamos que encontramos una diferencia en las reclamaciones entre hombres y mujeres, pero la diferencia estimada es solo del 1% de las reclamaciones esperadas. Esta diferencia puede ser estadísticamente significativa pero no económicamente relevante. La significación sustantiva se refiere a la importancia en el campo de estudio; en ciencia actuarial, esto es típicamente de relevancia financiera o económica, pero también podría ser no monetaria, como los efectos sobre la esperanza de vida futura. Significado Estadístico. ¿Son los efectos debidos al azar? La maquinaria de pruebas de hipótesis introducida en la Sección 3.4.1 proporciona un mecanismo formal para responder a esta pregunta. Las pruebas de hipótesis son útiles porque proporcionan un estándar formal y acordado para decidir si una variable hace una contribución importante a una respuesta esperada. Al interpretar los resultados, los investigadores suelen citar un \\(t\\)-ratio o un \\(p\\)-valor para demostrar significación estadística. En algunas situaciones, es de interés comentar sobre las variables que no son estadísticamente significativas. Los efectos que no son estadísticamente significativos tienen errores estándar que son grandes en relación con los coeficientes de regresión. En la Sección 5.5.2, expresamos este error estándar como \\[\\begin{equation} se(b_{j}) = s \\frac{\\sqrt{VIF_{j}}}{s_{x_{j}} \\sqrt{n-1}}. \\tag{6.1} \\end{equation}\\] Una posible explicación para la falta de significancia estadística es una gran variación en el término de perturbación. Al expresar el error estándar en esta forma, vemos que cuanto mayor es la variación natural, medida por \\(s\\), más difícil es rechazar la hipótesis nula de ningún efecto (\\(H_0\\)), manteniendo todo lo demás constante. Una segunda posible explicación para la falta de significancia estadística es la alta colinealidad, medida por \\(VIF_j\\). Una variable puede estar confundida con otras variables de manera que, a partir de los datos que se están analizando, sea imposible distinguir los efectos de una variable de otra. Una tercera posible explicación es el tamaño de la muestra. Supongamos que se utiliza un mecanismo similar a extracciones de una población estable para observar las variables explicativas. Entonces, la desviación estándar de \\(x_j\\), \\(s_{x_j}\\), debería ser estable a medida que aumenta el número de extracciones. De manera similar, también deberían serlo \\(R_j^2\\) y \\(s^2\\). Entonces, el error estándar \\(se(b_j)\\) debería disminuir a medida que el tamaño de la muestra, \\(n\\), aumenta. Por el contrario, un tamaño de muestra más pequeño significa un error estándar mayor, manteniendo todo lo demás constante. Esto significa que es posible que no podamos detectar la importancia de las variables en muestras de tamaño pequeño o moderado. Por lo tanto, en un mundo ideal, si no se detecta significancia estadística donde se había hipotetizado (y completamente esperado), se podría: (i) obtener una medida más precisa de \\(y\\), reduciendo así su variabilidad natural, (ii) rediseñar el esquema de recolección de muestras para que las variables explicativas relevantes sean menos redundantes y (iii) recopilar más datos. Normalmente, estas opciones no están disponibles con datos observacionales, pero puede ser útil señalar los próximos pasos en un programa de investigación. Los analistas ocasionalmente observan relaciones estadísticamente significativas que no se anticiparon; esto podría deberse a un tamaño de muestra grande. Anteriormente, mencionamos que una muestra pequeña puede no proporcionar suficiente información para detectar relaciones significativas. La otra cara de este argumento es que, para muestras grandes, tenemos la oportunidad de detectar la importancia de variables que podrían pasar desapercibidas en muestras de tamaño pequeño o incluso moderado. Desafortunadamente, esto también significa que las variables con coeficientes de parámetro pequeños, que contribuyen poco a entender la variación en la respuesta, pueden ser juzgadas como significativas utilizando nuestros procedimientos de toma de decisiones. Esto sirve para resaltar la diferencia entre significancia sustantiva y estadística: en particular, para muestras grandes, los investigadores encuentran variables que son estadísticamente significativas pero prácticamente poco importantes. En estos casos, puede ser prudente que el investigador omita variables de la especificación del modelo cuando su presencia no esté de acuerdo con la teoría aceptada, incluso si se consideran estadísticamente significativas. Efectos Causales. Si cambiamos \\(x\\), ¿cambiaría \\(y\\)? Como estudiantes de ciencias básicas, aprendimos principios que involucran acciones y reacciones. Agregar masa a una bola en movimiento aumenta la fuerza de su impacto contra una pared. Sin embargo, en las ciencias sociales, las relaciones son probabilísticas, no deterministas, y por lo tanto más sutiles. Por ejemplo, a medida que la edad (\\(x\\)) aumenta, la probabilidad de morir en un año (\\(y\\)) aumenta para la mayoría de las curvas de mortalidad humana. Comprender la causalidad, incluso la probabilística, es la raíz de toda la ciencia y proporciona la base para la toma de decisiones informada. Es importante reconocer que los procesos causales generalmente no pueden demostrarse exclusivamente a partir de los datos; los datos solo pueden presentar evidencia empírica relevante que sirva como un eslabón en una cadena de razonamiento sobre los mecanismos causales. Para la causalidad, hay tres condiciones necesarias: (i) asociación estadística entre variables, (ii) orden temporal apropiado y (iii) la eliminación de hipótesis alternativas o el establecimiento de un mecanismo causal formal. Como ejemplo, recordemos el estudio de Galton en la Sección 1.1, que relaciona la altura de los hijos adultos (\\(y\\)) con un índice de la altura de los padres (\\(x\\)). Para este estudio, estaba claro que hay una fuerte asociación estadística entre \\(x\\) e \\(y\\). La demografía también deja claro que las mediciones de los padres (\\(x\\)) preceden a las mediciones de los hijos (\\(y\\)). Lo que no es seguro es el mecanismo causal. Por ejemplo, en la Sección 1.5, mencionamos la posibilidad de que una variable omitida, como la dieta familiar, podría estar influyendo tanto en \\(x\\) como en \\(y\\). Se necesitan evidencias y teorías de la biología humana y la genética para establecer un mecanismo causal formal. Ejemplo: Raza, Redlining y Precios del Seguro de Automóviles. En un artículo con este título, Harrington y Niehaus (1998) investigaron si las compañías de seguros participaban en conductas discriminatorias (raciales), conocidas comúnmente como redlining. La discriminación racial es ilegal y las compañías de seguros no pueden usar la raza para determinar los precios. El término redlining se refiere a la práctica de trazar líneas rojas en un mapa para indicar áreas que las aseguradoras no cubrirán, áreas que típicamente contienen una alta proporción de minorías. Para investigar si existe o no discriminación racial en los precios del seguro, Harrington y Niehaus recopilaron datos de primas y reclamaciones de seguros de automóviles de pasajeros privados del Departamento de Seguros de Missouri para el período 1988-1992. Aunque las compañías de seguros no mantienen información sobre raza/etnicidad en sus datos de primas y reclamaciones, dicha información está disponible a nivel de código postal en la Oficina del Censo de EE. UU. Al agregar las primas y las reclamaciones al nivel de código postal, Harrington y Niehaus pudieron evaluar si las áreas con un mayor porcentaje de población negra pagaban más por el seguro (PCTBLACK). Una medida de precios ampliamente utilizada es la razón de siniestralidad, definida como la relación entre reclamaciones y primas. Esta medida la rentabilidad de las aseguradoras; si existe discriminación racial en los precios, se esperaría ver una baja razón de siniestralidad en áreas con una alta proporción de minorías. Harrington y Niehaus usaron esto como la variable dependiente, después de tomar logaritmos para abordar la asimetría en la distribución de la razón de siniestralidad. Harrington y Niehaus (1998) estudiaron 270 códigos postales alrededor de seis ciudades principales en Missouri, donde había grandes concentraciones de minorías. La Tabla 6.1 presenta los hallazgos de la cobertura comprensiva, aunque los autores también investigaron la cobertura de colisión y de responsabilidad civil. Además de la variable principal de interés, PCTBLACK, se introdujeron algunas variables de control relacionadas con la distribución por edades (PCT1824 y PCT55UP), estado civil (MARRIED), población (ln TOTPOP) y empleo (PCTUNEMP). El tamaño de la póliza se midió indirectamente a través del valor promedio del automóvil (ln AVCARV). La Tabla 6.1 informa que solo el tamaño de la póliza y la población son determinantes estadísticamente significativos de las razones de siniestralidad. De hecho, el coeficiente asociado con PCTBLACK tiene un signo positivo, lo que indica que las primas son más bajas en áreas con altas concentraciones de minorías (aunque no significativo). En un mercado de seguros eficiente, esperaríamos que los precios estuvieran estrechamente alineados con las reclamaciones y que existieran pocos patrones generales. Tabla 6.1: Resultados de la Regresión de la Razón de Siniestralidad Variable Descripción Coeficiente de Regresión \\(t\\)-Estadístico Intercept 1.98 2.73 PCTBLACK Proporción de la población negra 0.11 0.63 ln TOTPOP Logaritmo de la población total -0.1 -4.43 PCT1824 Porcentaje de la población entre 18 y 24 años -0.23 -0.5 PCT55UP Porcentaje de la población de 55 años o más -0.47 -1.76 MARRIED Porcentaje de la población casada -0.32 -0.9 PCTUNEMP Porcentaje de la población desempleada 0.11 0.1 ln AVCARV Logaritmo del valor promedio del automóvil asegurado -0.87 -3.26 Fuente: Harrington y Niehaus (1998) \\(R_a^2\\) 0.11 Ciertamente, los hallazgos de Harrington y Niehaus (1998) son inconsistentes con la hipótesis de discriminación racial en los precios. Establecer una falta de significancia estadística suele ser más difícil que establecer significancia. En el artículo de Harrington y Niehaus (1998), hay muchas especificaciones de modelos alternativas que evalúan la robustez de sus hallazgos frente a diferentes procedimientos de selección de variables y diferentes subconjuntos de datos. La Tabla 6.1 presenta los estimadores de los coeficientes y los \\(t\\)-ratios calculados utilizando mínimos cuadrados ponderados, con el tamaño de la población como pesos. Los autores también utilizaron mínimos cuadrados (ordinarios) con errores estándar robustos, obteniendo resultados similares. 6.1.2 Otras Interpretaciones Cuando se toman colectivamente, las combinaciones lineales de los coeficientes de regresión pueden interpretarse como la función de regresión: \\[ \\mathrm{E~}y = \\beta_0 + \\beta_1 x_1 + \\cdots + \\beta_k x_k. \\] Al presentar los resultados de regresión, los lectores quieren saber qué tan bien el modelo se ajusta a los datos. La Sección 5.6.1 resumió varias estadísticas de bondad de ajuste que se informan rutinariamente en investigaciones de regresión. Función de Regresión y Precios. Al evaluar los datos de reclamaciones de seguros, la función de regresión representa las reclamaciones esperadas y, por lo tanto, forma la base de la función de precios. (Vea el ejemplo en el Capítulo 4). En este caso, la forma de la función de regresión y los niveles para combinaciones clave de variables explicativas son de interés. Estudios de Referencia (Benchmarking). En algunas investigaciones, el propósito principal puede ser determinar si una observación específica está “en línea” con las otras disponibles. Por ejemplo, en el Capítulo 20 examinaremos los salarios de los CEOs. El propósito principal de dicho análisis podría haber sido ver si el salario de una persona es alto o bajo en comparación con otros en la muestra, controlando por características como la industria y los años de experiencia. El residuo resume la desviación de la respuesta respecto a la esperada según el modelo. Si el residuo es inusualmente grande o pequeño, entonces interpretamos esto como que existen circunstancias inusuales asociadas con esta observación. Este análisis no sugiere la naturaleza ni las causas de estas circunstancias; simplemente indica que la observación es inusual en comparación con las demás en la muestra. Para algunas investigaciones, como en litigios relacionados con paquetes de compensación, esta es una declaración poderosa. Predicción. Muchas aplicaciones actuariales conciernen a la predicción, donde el interés radica en describir la distribución de una variable aleatoria que aún no se ha realizado. Al establecer reservas, los actuarios de compañías de seguros están estableciendo pasivos para futuras reclamaciones que predicen que se realizarán y, por lo tanto, se convertirán en gastos eventuales de la compañía. La predicción, o pronóstico, es la principal motivación de la mayoría de los análisis de datos de series temporales, que se trata en los Capítulos 7-10. La predicción de una sola variable aleatoria en el contexto de la regresión lineal múltiple se introdujo en la Sección 4.2.3. Aquí, asumimos que tenemos disponible un conjunto dado de características, \\(\\mathbf{x}_{\\ast}=(1,x_{\\ast 1},\\ldots,x_{\\ast k})^{\\prime }\\). Según nuestro modelo, la nueva respuesta es: \\[ y_{\\ast}=\\beta_0 + \\beta_1 x_{\\ast 1} + \\cdots + \\beta_k x_{\\ast k} + \\varepsilon_{\\ast}. \\] Utilizamos como nuestro predictor puntual: \\[ \\hat{y}_{\\ast}=b_{0} + b_{1} x_{\\ast 1} + \\cdots + b_{k} x_{\\ast k}. \\] Como en la Sección 2.5.3, podemos descomponer el error de predicción en el error de estimación más el error aleatorio, de la siguiente manera: \\[ \\begin{array}{ccccc} \\underbrace{y^{\\ast}-\\widehat{y}^{\\ast}} &amp; = &amp; \\underbrace{\\beta_0 - b_{0} + (\\beta_1 - b_{1})x_{\\ast 1} + \\cdots + (\\beta_k - b_{k})x_{\\ast k}} &amp; + &amp; \\underbrace{\\varepsilon ^{\\ast}} \\\\ {\\small \\text{error de predicción}} &amp; {\\small =} &amp; {\\small \\text{error en la estimación de la} } &amp; {\\small +} &amp; {\\small \\text{desviación} }\\\\ &amp; &amp; {\\small \\text{función de regresión en } x_{\\ast 1}, \\ldots, x_{\\ast k}} &amp; &amp; {\\small \\text{adicional} } \\end{array} \\] Esta descomposición nos permite proporcionar una distribución para el error de predicción. Es habitual asumir una normalidad aproximada. Con esta suposición adicional, resumimos esta distribución utilizando un intervalo de predicción \\[\\begin{equation} \\hat{y}_{\\ast} \\pm t_{n-(k+1),1-\\alpha /2} ~ se(pred), \\tag{6.2} \\end{equation}\\] donde \\[ se(pred) = s \\sqrt{1 + \\mathbf{x}_{\\ast}^{\\prime }(\\mathbf{X}^{\\prime} \\mathbf{X})^{-1} \\mathbf{x}_{\\ast}}. \\] Aquí, el valor \\(t\\) \\(t_{n-(k+1),1-\\alpha /2}\\) es un percentil de la distribución \\(t\\) con \\(df=n-(k+1)\\) grados de libertad. Esto extiende la ecuación (2.7). Comunicar el rango de resultados probables es un objetivo importante. Al analizar datos, puede haber varias técnicas alternativas de predicción disponibles. Incluso dentro de la clase de modelos de regresión, cada uno de los varios modelos candidatos producirá una predicción diferente. Es importante proporcionar una distribución o rango de posibles errores. Los consumidores ingenuos pueden desilusionarse fácilmente con los resultados de las predicciones de los modelos de regresión. A estos consumidores se les dice (correctamente) que el modelo de regresión es óptimo, basado en ciertos criterios bien definidos, y luego se les proporciona una predicción puntual, como \\(\\hat{y}_{\\ast}\\). Sin conocimiento de un intervalo, el consumidor tiene expectativas sobre el rendimiento de la predicción, generalmente más altas de lo que justifica la información disponible en la muestra. Un intervalo de predicción no solo proporciona una única predicción óptima puntual, sino también un rango de fiabilidad. Al hacer las predicciones, hay una suposición importante: la nueva observación sigue el mismo modelo que se utilizó en la muestra. Por lo tanto, las condiciones básicas sobre la distribución de los errores deben permanecer sin cambios para las nuevas observaciones. También es importante que el nivel de las variables predictoras, \\(x_{\\ast 1},\\ldots,x_{\\ast k}\\), sea similar al de las observaciones disponibles en la muestra. Si una o varias de las variables predictoras difieren drásticamente de las de la muestra disponible, entonces la predicción resultante puede ser inadecuada. Por ejemplo, sería imprudente usar el modelo desarrollado en las Secciones 2.1 a 2.3 para predecir la lotería de una región con una población de \\(x_{\\ast}=400,000\\), más de diez veces la mayor población en nuestra muestra. Aunque sería fácil introducir \\(x_{\\ast}=400,000\\) en nuestras fórmulas, el resultado tendría poco sentido intuitivo. Extrapolar relaciones más allá de los datos observados requiere experiencia tanto en la naturaleza de los datos como en la metodología estadística. En la Sección 6.3, identificaremos este problema como un sesgo potencial debido a la región de muestreo. 6.2 La Importancia de la Selección de Variables Por un lado, elegir un modelo teórico que represente exactamente los eventos del mundo real es probablemente una tarea imposible. Por otro lado, elegir un modelo que represente aproximadamente el mundo real es un asunto práctico importante. Cuanto más cerca esté nuestro modelo del mundo real, más precisas serán las afirmaciones que hagamos, sugeridas por el modelo. Aunque no podemos obtener el modelo correcto, podemos seleccionar un modelo útil o al menos adecuado. Los usuarios de la estadística, desde el principiante hasta el experto experimentado, siempre seleccionarán un modelo inadecuado de vez en cuando. La pregunta clave es: ¿Qué tan importante es seleccionar un modelo adecuado? Aunque no se puede prever cada tipo de error, hay algunos principios orientadores que son útiles tener en cuenta al seleccionar un modelo. 6.2.1 Sobreajuste del Modelo Este tipo de error ocurre cuando se añaden variables superfluas o extrañas al modelo especificado. Si solo se añaden un pequeño número de variables extrañas, como una o dos, entonces este tipo de error probablemente no distorsionará de manera significativa la mayoría de los tipos de conclusiones que puedan alcanzarse con el modelo ajustado. Por ejemplo, sabemos que cuando añadimos una variable al modelo, la suma de cuadrados de los errores no aumenta. Si la variable es extraña, entonces la suma de cuadrados de los errores tampoco disminuirá de manera apreciable. De hecho, añadir una variable extraña puede aumentar \\(s^2\\) porque el denominador es más pequeño por un grado de libertad. Sin embargo, para conjuntos de datos de tamaño de muestra moderado, el efecto es mínimo. Sin embargo, añadir varias variables extrañas puede inflar \\(s^{2}\\) de manera apreciable. Además, existe la posibilidad de que añadir variables explicativas extrañas induzca, o empeore, la presencia de colinealidad. Un punto más importante es que, al añadir variables extrañas, nuestras estimaciones de los coeficientes de regresión permanecen insesgadas. Considere el siguiente ejemplo. Ejemplo: Regresión usando una Variable Explicativa. Suponga que el modelo verdadero de las respuestas es \\[ y_i = \\beta_0 + \\varepsilon_i, \\quad i = 1, \\ldots, n. \\] Bajo este modelo, el nivel de una variable explicativa genérica \\(x\\) no afecta el valor de la respuesta \\(y\\). Si fuéramos a predecir la respuesta en cualquier nivel de \\(x\\), la predicción tendría un valor esperado de \\(\\beta_0\\). Sin embargo, supongamos que equivocadamente ajustamos el modelo \\[ y_i = \\beta_0^{\\ast} + \\beta_1^{\\ast}x_i + \\varepsilon_i^{\\ast}. \\] Con este modelo, la predicción en un nivel genérico \\(x\\) es \\(b_{0}^{\\ast} + b_{1}^{\\ast}x\\) donde \\(b_{0}^{\\ast}\\) y \\(b_{1}^{\\ast}\\) son las estimaciones de mínimos cuadrados ordinarios de \\(\\beta_0^{\\ast}\\) y \\(\\beta_1^{\\ast}\\), respectivamente. No es demasiado difícil confirmar que \\[ \\text{Sesgo} = \\text{E}(b_{0}^{\\ast} + b_{1}^{\\ast}x) - \\text{E}y = 0, \\] donde las esperanzas se calculan usando el modelo verdadero. Por lo tanto, al usar un modelo ligeramente más grande del que deberíamos, no pagamos en términos de cometer un error persistente a largo plazo, como el representado por el sesgo. El precio de cometer este error es que nuestro error estándar es ligeramente mayor de lo que sería si hubiéramos elegido el modelo correcto. 6.2.2 Subajuste del Modelo Este tipo de error ocurre cuando se omiten variables importantes en la especificación del modelo; es más grave que el sobreajuste. Omitir variables importantes puede causar cantidades apreciables de sesgo en nuestras estimaciones resultantes. Además, debido a este sesgo, las estimaciones resultantes de \\(s^{2}\\) son más grandes de lo necesario. Un \\(s\\) más grande infla nuestros intervalos de predicción y produce pruebas inexactas de hipótesis sobre la importancia de las variables explicativas. Para ver los efectos de subajustar un modelo, volvemos al ejemplo anterior. Ejemplo: Regresión usando una Variable Explicativa - Continuación. Ahora invertimos los roles de los modelos descritos antes. Supongamos que el modelo verdadero es \\[ y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i \\] y que ajustamos erróneamente el modelo, \\[ y_i = \\beta_0^{\\ast} + \\varepsilon_i^{\\ast}. \\] Por lo tanto, hemos omitido inadvertidamente los efectos de la variable explicativa \\(x\\). Con el modelo ajustado, usaríamos \\(\\bar{y}\\) para nuestra predicción en un nivel genérico de \\(x\\). A partir del modelo verdadero, tenemos \\(\\bar{y} = \\beta_0 + \\beta_1 \\bar{x} + \\bar{\\varepsilon}\\). El sesgo de la predicción en \\(x\\) es \\[ \\begin{array}{ll} \\text{Sesgo} &amp;= \\text{E} \\bar{y} - \\text{E} (\\beta_0 + \\beta_1 x + \\varepsilon) \\\\ &amp;= \\text{E} (\\beta_0 + \\beta_1 \\bar{x} + \\bar{\\varepsilon}) - (\\beta_0 + \\beta_1 x) \\\\ &amp;= \\beta_1 (\\bar{x} - x). \\end{array} \\] Si \\(\\beta_1\\) es positivo, entonces subestimamos para valores grandes de \\(x\\), resultando en un sesgo negativo, y sobreestimamos para valores pequeños de \\(x\\) (en relación con \\(\\overline{x}\\)). Así, hay un error persistente a largo plazo al omitir la variable explicativa \\(x\\). De manera similar, se puede verificar que este tipo de error produce estimaciones sesgadas de los parámetros de regresión y un valor inflado de \\(s^{2}\\). Por supuesto, nadie quiere sobreajustar o subajustar el modelo. Sin embargo, los datos de las ciencias sociales a menudo son desordenados y puede ser difícil saber si incluir o no una variable en el modelo. Al seleccionar variables, los analistas a menudo se guían por el principio de parsimonia, también conocido como la Navaja de Occam, que establece que cuando hay varias explicaciones posibles para un fenómeno, se debe usar la más simple. Hay varios argumentos para preferir modelos más simples: Una explicación más simple es más fácil de interpretar. Los modelos simples, también conocidos como modelos “parsimoniosos”, a menudo funcionan bien con datos fuera de la muestra. Las variables superfluas pueden causar problemas de colinealidad, lo que dificulta la interpretación de los coeficientes individuales. El punto de vista opuesto se puede resumir en una cita a menudo atribuida a Albert Einstein, que dice que debemos usar “el modelo más simple posible, pero no más simple”. Esta sección demuestra que subajustar un modelo, omitiendo variables importantes, es típicamente un error más grave que incluir variables superfluas que aportan poco a nuestra capacidad de explicar los datos. Incluir variables superfluas disminuye los grados de libertad y aumenta la estimación de la variabilidad, lo cual suele ser de menor preocupación en las aplicaciones actuariales. En caso de duda, deje la variable en el modelo. 6.3 La Importancia de la Recolección de Datos El proceso de modelado de regresión comienza con la recolección de datos. Habiendo estudiado los resultados y el proceso de selección de variables, ahora podemos discutir las entradas al proceso. No es sorprendente que haya una larga lista de posibles dificultades que se encuentran con frecuencia al recolectar datos para regresión. En esta sección, identificamos las principales dificultades potenciales y proporcionamos algunas vías para evitar estas dificultades. 6.3.1 Error en el Marco Muestral y Selección Adversa El error en el marco muestral ocurre cuando el marco muestral, la lista de la cual se extrae la muestra, no es una aproximación adecuada de la población de interés. Al final, una muestra debe ser un subconjunto representativo de una población más grande, o universo, de interés. Si la muestra no es representativa, tomar una muestra más grande no elimina el sesgo; simplemente repite el mismo error una y otra vez. Ejemplo: Encuesta de Literary Digest. Quizás el ejemplo más conocido de error en el marco muestral es de la encuesta de Literary Digest en 1936. Esta encuesta se realizó para predecir el ganador de las elecciones presidenciales de Estados Unidos en 1936. Los dos principales candidatos eran Franklin D. Roosevelt, el demócrata, y Alfred Landon, el republicano. Literary Digest, una revista prominente en ese momento, realizó una encuesta a diez millones de votantes. De los encuestados, 2.4 millones respondieron, prediciendo una victoria “arrolladora” de Landon por un margen de 57% a 43%. Sin embargo, la elección real resultó en una victoria abrumadora de Roosevelt, por un margen de 62% a 38%. ¿Qué salió mal? Hubo varios problemas con la encuesta de Literary Digest. Quizás el más importante fue el error en el marco muestral. Para desarrollar su marco muestral, Literary Digest utilizó direcciones de guías telefónicas y listas de membresía de clubes. En 1936, Estados Unidos estaba en el fondo de la Gran Depresión; los teléfonos y las membresías de clubes eran un lujo que solo las personas de altos ingresos podían permitirse. Así, la lista de Literary Digest incluía una cantidad no representativa de personas de altos ingresos. En elecciones presidenciales anteriores realizadas por Literary Digest, los ricos y los pobres tendían a votar de manera similar y esto no era un problema. Sin embargo, los problemas económicos fueron los principales temas políticos en las elecciones presidenciales de 1936. Como resultó ser, los pobres tendían a votar por Roosevelt y los ricos por Landon. Como resultado, los resultados de la encuesta de Literary Digest fueron gravemente erróneos. Tomar una muestra grande, incluso de tamaño 2.4 millones, no ayudó; el error básico se repitió una y otra vez. El sesgo en el marco muestral ocurre cuando la muestra no es un subconjunto representativo de la población de interés. Al analizar los datos de las compañías de seguros, este sesgo puede surgir debido a la selección adversa. En muchos mercados de seguros, las compañías diseñan y fijan los precios de los contratos y los asegurados deciden si desean o no entrar en un acuerdo contractual (de hecho, los asegurados “solicitan” un seguro, por lo que los aseguradores también tienen el derecho de no entrar en el acuerdo). Por lo tanto, alguien es más probable que entre en un acuerdo si cree que la aseguradora está subestimando su riesgo, especialmente a la luz de las características del asegurado que no son observadas por la aseguradora. Por ejemplo, es bien sabido que la experiencia de mortalidad de una muestra de compradores de rentas vitalicias no es representativa de la población en general; las personas que compran rentas vitalicias tienden a ser saludables en relación con la población general. No compraría una renta vitalicia que pague un beneficio periódico mientras esté vivo si tuviera mala salud y pensara que su probabilidad de una larga vida es baja. La selección adversa surge porque los “malos riesgos”, aquellos con reclamos mayores de los esperados, son más propensos a entrar en contratos que los “buenos riesgos” correspondientes. Aquí, la expectativa se desarrolla en función de características (variables explicativas) que pueden ser observadas por la aseguradora. Por supuesto, existe un gran mercado para las rentas vitalicias y otras formas de seguros en las que existe selección adversa. Las compañías de seguros pueden fijar precios adecuados para estos mercados redefiniendo su “población de interés” para que no sea la población general, sino la población de asegurados potenciales. Así, por ejemplo, al fijar el precio de las rentas vitalicias, las aseguradoras utilizan datos de mortalidad de rentistas, no datos de la población general. De esta manera, pueden evitar posibles desajustes entre la población y la muestra. Más generalmente, la experiencia de casi cualquier compañía difiere de la población general debido a los estándares de suscripción y las filosofías de ventas. Algunas compañías buscan “riesgos preferidos” ofreciendo descuentos educativos, bonos por buen manejo, etc., mientras que otras buscan asegurados de alto riesgo. La muestra de asegurados de la compañía diferirá de la población general y el grado de la diferencia puede ser un aspecto interesante para cuantificar en un análisis. El sesgo en el marco muestral puede ser particularmente importante cuando una compañía busca comercializar un nuevo producto para el cual no tiene datos de experiencia. Identificar un mercado objetivo y su relación con la población general es un aspecto importante de un plan de desarrollo de mercado. 6.3.2 Regiones de Muestreo Limitadas Una región de muestreo limitada puede dar lugar a un sesgo potencial cuando intentamos extrapolar fuera de la región de muestreo. Para ilustrarlo, considere la Figura 6.1. Aquí, con base en los datos de la región de muestreo, una línea puede parecer una representación apropiada. Sin embargo, si una curva cuadrática es la verdadera respuesta esperada, cualquier pronóstico que esté lejos de la región de muestreo estará seriamente sesgado. Figura 6.1: La extrapolación fuera de la región de muestreo puede estar sesgada Otro problema debido a una región de muestreo limitada, aunque no sea un sesgo, que puede surgir es la dificultad para estimar un coeficiente de regresión. En el Capítulo 5, vimos que una menor dispersión de una variable, ceteris paribus, significa una estimación menos confiable del coeficiente de pendiente asociado con esa variable. Es decir, a partir de la Sección 5.5.2 o de la ecuación (6.1), vemos que cuanto menor es la dispersión de \\(x_{j}\\), medida por \\(s_{x_{j}}\\), mayor es el error estándar de \\(b_{j},se(b_{j})\\). Llevado al extremo, donde \\(s_{x_{j}}=0\\), podríamos tener una situación como la ilustrada en la Figura 6.2. Para la situación extrema ilustrada en la Figura 6.2, no hay suficiente variación en \\(x\\) para estimar el parámetro de pendiente correspondiente. Figura 6.2: La falta de variación en \\(x\\) significa que no podemos ajustar una línea única que relacione \\(x\\) y \\(y\\). 6.3.3 Variables Dependientes Limitadas, Censura y Truncamiento En algunas aplicaciones, la variable dependiente está limitada a ciertos rangos. Para entender por qué esto es un problema, primero recordemos que bajo el modelo de regresión lineal, la variable dependiente es igual a la función de regresión más un error aleatorio. Normalmente, se supone que el error aleatorio se distribuye aproximadamente de manera normal, por lo que la respuesta varía de forma continua. Sin embargo, si los resultados de la variable dependiente están restringidos o limitados, entonces los resultados no son puramente continuos. Esto significa que nuestra suposición de errores normales no es estrictamente correcta y puede no ser una buena aproximación. Para ilustrar esto, la Figura 6.3 muestra un gráfico del ingreso de un individuo (\\(x\\)) versus la cantidad de seguro adquirido (\\(y\\)). La muestra en este gráfico representa dos submuestras: aquellos que compraron seguro, correspondientes a \\(y&gt;0\\), y aquellos que no lo hicieron, correspondientes al “precio” \\(y=0\\). Ajustar una única línea a estos datos desinformaría a los usuarios sobre los efectos de \\(x\\) sobre \\(y\\). Figura 6.3: Cuando los individuos no compran nada, se registran como ventas de \\(y=0\\). Figura 6.4: Si se omiten las respuestas por debajo de la línea horizontal en \\(y=d\\), la línea de regresión ajustada puede ser muy diferente de la verdadera línea de regresión. Si consideráramos solo a aquellos que compraron seguro, entonces todavía tendríamos un límite inferior implícito de cero (si un precio de seguro debe ser mayor que cero). Sin embargo, los precios deben estar cerca de este límite para una región de muestreo dada y, por lo tanto, no representar un problema práctico importante. Al incluir a varias personas que no compraron seguro (y, por lo tanto, gastaron $0 en seguro), nuestra región de muestreo ahora claramente incluye este límite inferior. Hay varias maneras en las que las variables dependientes pueden estar restringidas o censuradas. La Figura 6.3 ilustra el caso en el que el valor de \\(y\\) no puede ser inferior a cero. Como otro ejemplo, los siniestros de seguros a menudo están restringidos a ser menores o iguales a un límite superior especificado en la póliza de seguro. Si la censura es severa, los mínimos cuadrados ordinarios producen resultados sesgados. En el Capítulo 15 se describen enfoques especializados, conocidos como modelos de regresión censurada, para manejar este problema. La Figura 6.4 ilustra otra limitación comúnmente encontrada en el valor de la variable dependiente. Para esta ilustración, suponga que \\(y\\) representa una pérdida asegurada y que \\(d\\) representa el deducible de una póliza de seguro. En este escenario, es práctica común que las aseguradoras no registren pérdidas por debajo de \\(d\\) (generalmente no son reportadas por los asegurados). En este caso, se dice que los datos están truncados. No es sorprendente que existan modelos de regresión truncada para manejar esta situación. Como regla general, los datos truncados representan una fuente de sesgo más grave que los datos censurados. Cuando los datos están truncados, no tenemos valores de las variables dependientes y, por lo tanto, tenemos menos información que cuando los datos están censurados. Consulte el Capítulo 15 para obtener más detalles. 6.3.4 Variables Omitidas y Endógenas Por supuesto, los analistas prefieren incluir todas las variables importantes. Sin embargo, un problema común es que puede que no tengamos los recursos ni la previsión para recopilar y analizar todos los datos relevantes. Además, a veces se nos prohíbe incluir ciertas variables. Por ejemplo, en la tarificación de seguros, generalmente se nos impide usar la etnia como una variable de tarificación. Además, hay muchas tablas de mortalidad y otras tablas de decremento que son “unisex”, es decir, no distinguen entre géneros. Omitir variables importantes puede afectar nuestra capacidad para ajustar la función de regresión; esto puede afectar el rendimiento dentro de la muestra (explicación) así como fuera de la muestra (predicción). Si la variable omitida no está correlacionada con otras variables explicativas, entonces la omisión no afectará la estimación de los coeficientes de regresión. Sin embargo, típicamente este no es el caso. La Sección 3.4.3, el Ejemplo del Refrigerador, ilustra un caso grave en el que la dirección de un resultado estadísticamente significativo se invirtió con la presencia de una variable explicativa. En este ejemplo, encontramos que en una muestra transversal de refrigeradores existía una correlación significativamente positiva entre el precio y el costo anual de energía para operar el refrigerador. Esta correlación positiva era contraintuitiva porque uno esperaría que precios más altos significaran menores gastos anuales en operar un refrigerador. Sin embargo, cuando incluimos varias variables adicionales, en particular, medidas del tamaño de un refrigerador, encontramos una relación significativamente negativa entre el precio y los costos de energía. Nuevamente, al omitir estas variables adicionales, hubo un sesgo importante al usar la regresión para entender la relación entre el precio y los costos de energía. Las variables omitidas pueden llevar a la presencia de variables explicativas endógenas. Una variable exógena es aquella que se puede considerar “dada” para los propósitos en cuestión. Una variable endógena es aquella que no cumple con el requisito de exogeneidad. Una variable omitida puede afectar tanto a \\(y\\) como a \\(x\\) y, en este sentido, inducir una relación entre las dos variables. Si la relación entre \\(x\\) y \\(y\\) se debe a una variable omitida, es difícil condicionar en \\(x\\) al estimar un modelo para \\(y\\). Hasta ahora, las variables explicativas han sido tratadas como no estocásticas. Para muchas aplicaciones en ciencias sociales, es más intuitivo considerar que las \\(x\\) son estocásticas y realizar inferencias condicionales a sus realizaciones. Por ejemplo, bajo esquemas de muestreo comunes, podemos estimar la función de regresión condicional \\[ \\mathrm{E~}\\left(y|x_1, \\ldots, x_k \\right) = \\beta_0 + \\beta_1 x_1 + \\ldots + \\beta_k x_k. \\] Esto se conoce como un modelo “basado en el muestreo”. En la literatura económica, Goldberger (1972) define un modelo estructural como un modelo estocástico que representa una relación causal, no una relación que simplemente captura asociaciones estadísticas. Los modelos estructurales pueden contener fácilmente variables explicativas endógenas. Para ilustrar, consideremos un ejemplo que relaciona reclamaciones y primas. Para muchas líneas de negocio, las clases de primas son simplemente funciones no lineales de factores exógenos como la edad, el género, etc. Para otras líneas de negocio, las primas cobradas son una función del historial de reclamaciones previo. Consideremos las ecuaciones del modelo que relacionan las reclamaciones (\\(y_{it}, t=1, 2\\)) con las primas (\\(x_{it}, t=1, 2\\)): \\[\\begin{eqnarray*} y_{i2} = \\beta_{0,C} + \\beta_{1,C} y_{i1} + \\beta_{2,C} x_{i2} + \\varepsilon_{i1} \\\\ x_{i2} = \\beta_{0,P} + \\beta_{1,P} y_{i1} + \\beta_{2,P} x_{i1} + \\varepsilon_{i2}. \\end{eqnarray*}\\] En este modelo, las reclamaciones y las primas del período actual (\\(t=2\\)) se ven afectadas por las reclamaciones y primas del período anterior. Este es un ejemplo de un modelo de ecuaciones estructurales que requiere técnicas especiales de estimación. ¡Nuestros procedimientos de estimación habituales están sesgados! Ejemplo: Raza, Discriminación y Precios de Seguros de Automóviles - Continuación. Aunque Harrington y Niehaus (1998) no encontraron discriminación racial en la tarificación de seguros, sus resultados sobre el acceso al seguro fueron inconclusos. Los aseguradores ofrecen contratos de riesgo “estándar” y “preferido” a los solicitantes que cumplen con estándares restrictivos de suscripción, en comparación con los contratos de riesgo “subestándar” donde los estándares de suscripción son más relajados. Los reclamos esperados son más bajos para los contratos de riesgo estándar y preferido, y por lo tanto, las primas son más bajas, que para los contratos subestándar. Harrington y Niehaus examinaron la proporción de solicitantes a quienes se les ofrecieron contratos subestándar, NSSHARE, y encontraron que estaba significativamente relacionada positivamente con PCTBLACK, la proporción de la población negra. Esto sugiere evidencia de discriminación racial; ellos afirman que esta es una interpretación inapropiada debido al sesgo por variables omitidas. Harrington y Niehaus argumentan que la proporción de solicitantes a quienes se les ofrecieron contratos subestándar debería estar positivamente relacionada con los costos esperados de los reclamos. Además, los costos esperados de los reclamos están fuertemente relacionados con PCTBLACK, porque las minorías en la muestra tendían a tener ingresos más bajos. Así, las variables no observadas, como los ingresos, tienden a impulsar la relación positiva entre NSSHARE y PCTBLACK. Debido a que los datos se analizan a nivel de código postal y no a nivel individual, el potencial sesgo por variables omitidas hizo que el análisis fuera inconcluso. 6.3.5 Datos Faltantes En los ejemplos de datos, ilustraciones, estudios de caso y ejercicios de este texto, hay muchas instancias en las que ciertos datos están faltantes o no disponibles para el análisis. En cada caso, los datos no se perdieron de manera descuidada, sino que no estaban disponibles debido a razones sustantivas asociadas con la recolección de datos. Por ejemplo, cuando examinamos los rendimientos de acciones de una muestra de empresas, vimos que algunas empresas no tenían un promedio de ganancias por acción de cinco años. La razón era simplemente que no habían estado en existencia durante cinco años. Como otro ejemplo, al examinar las esperanzas de vida, algunos países no reportaron la tasa de fertilidad total porque les faltaban recursos administrativos para capturar estos datos. Los datos faltantes son un aspecto inescapable al analizar datos en las ciencias sociales. Cuando la razón para la falta de disponibilidad de datos no está relacionada con los valores reales de los datos, se dice que los datos están faltantes al azar. Existen varias técnicas para manejar datos faltantes al azar, ninguna de las cuales es claramente superior a las otras. Una “técnica” es simplemente ignorar el problema. Por lo tanto, faltar al azar a veces se denomina el caso ignorable de datos faltantes. Si hay solo unos pocos datos faltantes, en comparación con el número total disponible, una estrategia ampliamente empleada es eliminar las observaciones correspondientes a los datos faltantes. Suponiendo que los datos están faltantes al azar, se pierde poca información al eliminar una pequeña porción de los datos. Además, con esta estrategia, no necesitamos hacer suposiciones adicionales sobre las relaciones entre los datos. Si los datos faltantes provienen principalmente de una variable, podemos considerar omitir esta variable. Aquí, la motivación es que perdemos menos información al omitir esta variable en comparación con retener la variable pero perder las observaciones asociadas con los datos faltantes. Otra estrategia es completar, o imputar, los datos faltantes. Hay muchas variaciones de la estrategia de imputación. Todas asumen algún tipo de relaciones entre las variables además de las suposiciones del modelo de regresión. Aunque estos métodos producen resultados razonables, hay que tener en cuenta que cualquier tipo de valores imputados no presenta la misma variabilidad inherente que los datos reales. Así, los resultados de los análisis basados en valores imputados a menudo reflejan menos variabilidad que aquellos con datos reales. Ejemplo: Gastos de Compañías de Seguros - Continuación. Al examinar la información financiera de las compañías, los analistas a menudo se ven obligados a omitir una cantidad considerable de información al utilizar modelos de regresión para buscar relaciones. Para ilustrar, Segal (2002) examinó los estados financieros de seguros de vida a partir de datos proporcionados por la Asociación Nacional de Comisionados de Seguros (NAIC). Inicialmente, consideró 733 observaciones de empresas-año durante el período 1995-1998. Sin embargo, 154 observaciones fueron excluidas debido a primas, beneficios y otras variables explicativas inconsistentes o negativas. También se excluyeron las pequeñas empresas que representaban 131 observaciones. Las pequeñas empresas consisten en menos de 10 empleados y agentes, costos operativos menores a $1 millón o menos de 1,000 pólizas de vida vendidas. La muestra resultante fue de \\(n=448\\) observaciones. Las restricciones de muestra se basaron en variables explicativas; este procedimiento no necesariamente sesga los resultados. Segal argumentó que su muestra final seguía siendo representativa de la población de interés. Hubo alrededor de 110 empresas en cada uno de los años 1995-1998. En 1998, los activos agregados de las empresas en la muestra representaban aproximadamente $650 mil millones, un tercio de la industria de seguros de vida. 6.4 Modelos de Datos Faltantes Para entender los mecanismos que conducen a respuestas no planificadas, los modelamos de manera estocástica. Sea \\(r_i\\) una variable binaria para la \\(i\\)-ésima observación, con un uno indicando que esta respuesta se observa y un cero indicando que la respuesta está faltante. Sea \\(\\mathbf{r} = (r_1, \\ldots, r_n)^{\\prime}\\) que resume la disponibilidad de datos para todos los sujetos. El interés radica en si las respuestas influyen en el mecanismo de datos faltantes. Para la notación, usamos \\(\\mathbf{Y} = (y_1, \\ldots, y_n)^{\\prime}\\) para ser la colección de todas las respuestas potencialmente observadas. 6.4.1 Faltante al Azar En el caso en que \\(\\mathbf{Y}\\) no afecta la distribución de \\(\\mathbf{r}\\), seguimos a Rubin (1976) y llamamos a este caso faltante completamente al azar (MCAR). Específicamente, los datos faltantes son MCAR si \\(\\mathrm{f}(\\mathbf{r} | \\mathbf{Y}) = \\mathrm{f}(\\mathbf{r})\\), donde f(.) es una función genérica de masa de probabilidad. Una extensión de esta idea se encuentra en Little (1995), donde se añade el adjetivo “dependiente de covariables” cuando \\(\\mathbf{Y}\\) no afecta la distribución de \\(\\mathbf{r}\\), condicionado a las covariables. Si las covariables se resumen como \\(\\mathbf{X}\\), entonces la condición corresponde a la relación \\(\\mathrm{f}(\\mathbf{r} | \\mathbf{Y, X}) = \\mathrm{f}(\\mathbf{r | X})\\). Para ilustrar este punto, considere un ejemplo de Little y Rubin (1987) donde \\(\\mathbf{X}\\) corresponde a la edad y \\(\\mathbf{Y}\\) corresponde a los ingresos de todas las observaciones potenciales. Si la probabilidad de estar faltante no depende de los ingresos, entonces los datos faltantes son MCAR. Si la probabilidad de estar faltante varía según la edad pero no por ingresos entre las observaciones dentro de un grupo de edad, entonces los datos faltantes son MCAR dependientes de covariables. Bajo esta última especificación, es posible que los datos faltantes varíen según los ingresos. Por ejemplo, las personas más jóvenes pueden ser menos propensas a responder una encuesta. Esto muestra que la característica “faltante al azar” depende del propósito del análisis. Específicamente, es posible que un análisis de los efectos conjuntos de edad e ingresos pueda encontrar patrones graves de datos faltantes, mientras que un análisis de ingresos controlado por edad no sufre patrones graves de sesgo. Little y Rubin (1987) abogan por modelar los mecanismos de datos faltantes. Para ilustrar, considere un enfoque de máxima verosimilitud utilizando un modelo de selección para el mecanismo de datos faltantes. Ahora, particione \\(\\mathbf{Y}\\) en componentes observados y faltantes utilizando la notación \\(\\mathbf{Y} =\\{\\mathbf{Y}_{obs}, \\mathbf{Y}_{miss}\\}\\). Con el enfoque de máxima verosimilitud, basamos la inferencia en las variables aleatorias observadas. Por lo tanto, usamos una verosimilitud proporcional a la función conjunta \\(\\mathrm{f}(\\mathbf{r}, \\mathbf{Y}_{obs})\\). También especificamos un modelo de selección especificando la función de masa condicional \\(\\mathrm{f}(\\mathbf{r} | \\mathbf{Y})\\). Supongamos que las respuestas observadas y las distribuciones del modelo de selección se caracterizan por vectores de parámetros \\(\\boldsymbol \\theta\\) y \\(\\boldsymbol \\psi\\), respectivamente. Entonces, con la relación \\(\\mathrm{f}(\\mathbf{r}, \\mathbf{Y}_{obs},\\boldsymbol \\theta, \\boldsymbol \\psi) = \\mathrm{f}(\\mathbf{Y}_{obs}, \\boldsymbol \\theta) \\times \\mathrm{f}(\\mathbf{r} | \\mathbf{Y}_{obs}, \\boldsymbol \\psi)\\), podemos expresar la verosimilitud logarítmica de las variables aleatorias observadas como \\[ L(\\boldsymbol \\theta, \\boldsymbol \\psi) = \\mathrm{ln~} \\mathrm{f}(\\mathbf{r}, \\mathbf{Y}_{obs}, \\boldsymbol \\theta, \\boldsymbol \\psi) = \\mathrm{ln~} \\mathrm{f}(\\mathbf{Y}_{obs}, \\boldsymbol \\theta) + \\mathrm{ln~} \\mathrm{f}(\\mathbf{r} | \\mathbf{Y}_{obs}, \\boldsymbol \\psi). \\] (Véase la Sección 11.9 si desea un repaso sobre la inferencia de verosimilitud). En el caso en que los datos son MCAR, entonces \\(\\mathrm{f}(\\mathbf{r} | \\mathbf{Y}_{obs}, \\boldsymbol \\psi) = \\mathrm{f}(\\mathbf{r} | \\boldsymbol \\psi)\\) no depende de \\(\\mathbf{Y}_{obs}\\). Little y Rubin (1987) también consideran el caso en que la distribución del modelo del mecanismo de selección no depende de \\(\\mathbf{Y}_{miss}\\) pero puede depender de \\(\\mathbf{Y}_{obs}\\). En este caso, lo llaman datos faltantes al azar (MAR). En los casos tanto de MAR como de MCAR, vemos que la verosimilitud puede maximizarse sobre los parámetros, por separado para cada caso. En particular, si uno está interesado únicamente en el estimador de máxima verosimilitud de \\(\\boldsymbol \\theta\\), entonces el mecanismo del modelo de selección puede ser “ignorado”. Por lo tanto, ambas situaciones a menudo se denominan caso ignorables. Ejemplo: Gastos Dentales. Sea \\(y\\) el gasto anual en dentista de un hogar y \\(x\\) el ingreso. Considere los siguientes cinco mecanismos de selección. El hogar no es seleccionado (faltante) con una probabilidad sin tener en cuenta el nivel de gasto dental. En este caso, el mecanismo de selección es MCAR. El hogar no es seleccionado si el gasto dental es menor a $100. En este caso, el mecanismo de selección depende de la respuesta observada y faltante. El mecanismo de selección no puede ser ignorado. El hogar no es seleccionado si el ingreso es menor a $20,000. En este caso, el mecanismo de selección es MCAR, dependiente de covariables. Es decir, suponiendo que el propósito del análisis es entender los gastos dentales condicionado al conocimiento del ingreso, estratificar según el ingreso no sesga gravemente el análisis. La probabilidad de que un hogar sea seleccionado aumenta con el gasto dental. Por ejemplo, supongamos que la probabilidad de ser seleccionado es una función lineal de \\(\\exp(\\psi y_i)/(1+ \\exp(\\psi y_i))\\). En este caso, el mecanismo de selección depende de la respuesta observada y faltante. El mecanismo de selección no puede ser ignorado. El hogar es seguido durante \\(T\\) = 2 períodos. En el segundo período, un hogar no es seleccionado si el gasto del primer período es menor a $100. En este caso, el mecanismo de selección es MAR. Es decir, el mecanismo de selección se basa en una respuesta observada. Los segundos y cuartos mecanismos de selección representan situaciones donde el mecanismo de selección debe ser modelado explícitamente; estos son casos no ignorables. En estas situaciones, sin ajustes explícitos, los procedimientos que ignoran el efecto de selección pueden producir resultados gravemente sesgados. Para ilustrar una corrección para el sesgo de selección en un caso simple, presentamos un ejemplo de Little y Rubin (1987). La Sección 6.4.2 describe mecanismos adicionales. Ejemplo: Alturas Históricas. Little y Rubin (1987) discuten datos de Wachter y Trusell (1982) sobre \\(y\\), la altura de hombres reclutados para servir en el ejército. La muestra está sujeta a censura en el sentido de que se impusieron estándares mínimos de altura para la admisión en el ejército. Así, el mecanismo de selección es \\[ r_i = \\left\\{ \\begin{array}{ll} 1 &amp; y_i &gt; c_i \\\\ 0 &amp; \\mathrm{de lo contrario} \\\\ \\end{array} \\right. , \\] donde \\(c_i\\) es el estándar mínimo de altura conocido impuesto en el momento del reclutamiento. El mecanismo de selección es no ignorables porque depende de la altura del individuo, \\(y\\). Para este ejemplo, se dispone de información adicional para proporcionar inferencia de modelos confiables. Específicamente, basándonos en otros estudios de alturas masculinas, podemos suponer que la población de alturas sigue una distribución normal. Así, la verosimilitud de las observaciones puede escribirse y la inferencia puede proceder directamente. Para ilustrar, supongamos que \\(c_i = c\\) es constante. Sean \\(\\mu\\) y \\(\\sigma\\) la media y la desviación estándar de \\(y\\). Supongamos además que tenemos una muestra aleatoria de \\(n + m\\) hombres en la que \\(m\\) hombres están por debajo del estándar mínimo de altura \\(c\\) y observamos \\(\\mathbf{Y}_{obs} = (y_1, \\ldots, y_n)^{\\prime}\\). La distribución conjunta para los observables es \\[\\begin{eqnarray*} \\mathrm{f}(\\mathbf{r}, \\mathbf{Y}_{obs}, \\mu, \\sigma) &amp;=&amp; \\mathrm{f}(\\mathbf{Y}_{obs}, \\mu, \\sigma) \\times \\mathrm{f}(\\mathbf{r} | \\mathbf{Y}_{obs}) \\\\ &amp;=&amp; \\left\\{ \\prod_{i=1}^n \\mathrm{f}(y_i | y_i &gt; c) \\times \\mathrm{Pr}(y_i &gt; c) \\right\\} \\times \\left\\{\\mathrm{Pr}(y_i \\leq c)\\right\\}^m. \\end{eqnarray*}\\] Ahora, sean \\(\\phi\\) y \\(\\Phi\\) la densidad y la función de distribución para la distribución normal estándar. Así, la verosimilitud logarítmica es \\[\\begin{eqnarray*} L(\\mu, \\sigma) &amp;=&amp; \\mathrm{ln~} \\mathrm{f}(\\mathbf{r}, \\mathbf{Y}_{obs}, \\mu, \\sigma) \\\\ &amp;=&amp; \\sum_{i=1}^n \\mathrm{ln}\\left\\{ \\frac{1}{\\sigma} \\phi \\left( \\frac{y_i-\\mu}{\\sigma} \\right) \\right\\} + m~ \\mathrm{ln}\\left\\{ \\Phi \\left( \\frac{c-\\mu}{\\sigma}\\right) \\right\\} . \\end{eqnarray*}\\] Esto es fácil de maximizar en \\(\\mu\\) y \\(\\sigma\\). Si se ignoraran los mecanismos de censura, entonces se derivarían estimaciones de los datos observados a partir de la “verosimilitud logarítmica,” \\[ \\sum_{i=1}^n \\mathrm{ln}\\left\\{ \\frac{1}{\\sigma} \\phi \\left( \\frac{y_i-\\mu}{\\sigma} \\right) \\right\\}, \\] lo que daría resultados diferentes y sesgados. 6.4.2 Datos Faltantes No Ignorables Para los datos faltantes no ignorables, Little (1995) recomienda: Evitar respuestas faltantes siempre que sea posible utilizando procedimientos de seguimiento adecuados. Recoger covariables que sean útiles para predecir los valores faltantes. Recoger la mayor cantidad de información posible sobre la naturaleza del mecanismo de datos faltantes. Para el último punto, si se sabe poco sobre el mecanismo de datos faltantes, es difícil emplear un procedimiento estadístico robusto para corregir el sesgo de selección. Existen muchos modelos de mecanismos de datos faltantes. Una visión general aparece en Little y Rubin (1987). Little (1995) examina el problema de la deserción. En lugar de revisar esta literatura en desarrollo, presentamos un modelo ampliamente utilizado para datos faltantes no ignorables. Procedimiento de Dos Etapas de Heckman Heckman (1976) asume que el mecanismo de respuesta de muestreo está gobernado por la variable latente (no observada) \\(r_i^{\\ast}\\) donde \\[ r_i^{\\ast} = \\mathbf{z}_i^{\\prime} \\boldsymbol \\gamma + \\eta_i. \\] Las variables en \\(\\mathbf{z}_i\\) pueden o no incluir las variables en \\(\\mathbf{x}_i\\). Observamos \\(y_i\\) si \\(r_i^{\\ast}&gt;0\\), es decir, si \\(r_i^{\\ast}\\) cruza el umbral 0. Así, observamos \\[ r_i = \\left\\{ \\begin{array}{ll} 1 &amp; r_i^{\\ast}&gt;0 \\\\ 0 &amp; \\mathrm{de lo contrario} \\\\ \\end{array} \\right. . \\] Para completar la especificación, asumimos que {(\\(\\varepsilon_i,\\eta_i\\))} son distribuidos idénticamente e independientemente, y que la distribución conjunta de {(\\(\\varepsilon_i,\\eta_i\\))} es bivariada normal con medias cero, varianzas \\(\\sigma^2\\) y \\(\\sigma_{\\eta}^2\\), y correlación \\(\\rho\\). Note que si el parámetro de correlación \\(\\rho\\) es igual a cero, entonces los modelos de respuesta y selección son independientes. En este caso, los datos son MCAR y los procedimientos de estimación habituales son no sesgados y asintóticamente eficientes. Bajo estas suposiciones, cálculos básicos de la normal multivariada muestran que \\[ \\mathrm{E~}(y_i | r_i^{\\ast}&gt;0) = \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta + \\beta_{\\lambda} \\lambda(\\mathbf{z}_i^{\\prime} \\boldsymbol \\gamma), \\] donde \\(\\beta_{\\lambda} = \\rho \\sigma\\) y \\(\\lambda(a)=\\phi(a)/\\Phi(a)\\). Aquí, \\(\\lambda(.)\\) es la inversa de la llamada “razón de Mills.” Este cálculo sugiere el siguiente procedimiento en dos etapas para estimar los parámetros de interés. Procedimiento de Dos Etapas de Heckman Utilice los datos {(\\(r_i, \\mathbf{z}_i\\))} y un modelo de regresión probit para estimar \\(\\boldsymbol \\gamma\\). Llame a este estimador \\(\\mathbf{g}_H\\). Utilice el estimador de la etapa (1) para crear una nueva variable explicativa, \\(x_{i,K+1} = \\lambda(\\mathbf{z}_i^{\\prime}\\mathbf{g}_H)\\). Realice un modelo de regresión utilizando las \\(K\\) variables explicativas \\(\\mathbf{x}_i\\), así como la variable explicativa adicional \\(x_{i,K+1}\\). Use \\(\\mathbf{b}_H\\) y \\(b_{\\lambda,H}\\) para denotar los estimadores de \\(\\boldsymbol \\beta\\) y \\(\\beta_{\\lambda}\\), respectivamente. El Capítulo 11 introducirá las regresiones probit. También observamos que el método de dos etapas no funciona en ausencia de covariables para predecir la respuesta y, para fines prácticos, requiere variables en \\(\\mathbf{z}\\) que no están en \\(\\mathbf{x}\\) (ver Little y Rubin, 1987). Para probar el sesgo de selección, podemos probar la hipótesis nula \\(H_0:\\beta_{\\lambda}=0\\) en la segunda etapa debido a la relación \\(\\beta_{\\lambda}= \\rho \\sigma\\). Al realizar esta prueba, se deben usar errores estándar corregidos por heterocedasticidad. Esto se debe a que la varianza condicional \\(\\mathrm{Var}(y_i | r_i^{\\ast}&gt;0)\\) depende de la observación \\(i\\). Específicamente, \\(\\mathrm{Var}(y_i | r_i^{\\ast}&gt;0) = \\sigma^2 (1-\\rho^2 \\delta_i),\\) donde \\(\\delta_i= \\lambda_i(\\lambda_i + \\mathbf{z}_i^{\\prime} \\boldsymbol \\gamma)\\) y \\(\\lambda_i = \\phi(\\mathbf{z}_i^{\\prime} \\boldsymbol \\gamma)/\\Phi(\\mathbf{z}_i^{\\prime} \\boldsymbol \\gamma).\\) Este procedimiento asume normalidad para las variables latentes de selección para formar las variables aumentadas. Existen otras formas de distribución en la literatura, incluyendo las distribuciones logística y uniforme. Una crítica más profunda, planteada por Little (1985), es que el procedimiento se basa en suposiciones que no se pueden probar utilizando los datos disponibles. Esta crítica es análoga al ejemplo de alturas históricas donde nos basamos en gran medida en la curva normal para inferir la distribución de alturas por debajo del punto de censura. A pesar de estas críticas, el procedimiento de Heckman se usa ampliamente en las ciencias sociales. Algoritmo EM La Sección 6.4.2 se ha centrado en introducir modelos específicos de no respuesta no ignorables. Los modelos generales robustos de no respuesta no están disponibles. En cambio, una estrategia más apropiada es centrarse en una situación específica, recoger la mayor cantidad de información posible sobre la naturaleza del problema de selección y luego desarrollar un modelo para este problema de selección específico. El algoritmo EM es un dispositivo computacional para calcular los parámetros del modelo. Aunque es específico para cada modelo, ha encontrado aplicaciones en una amplia variedad de modelos que involucran datos faltantes. Computacionalmente, el algoritmo itera entre los pasos de “E”, para la expectativa condicional, y “M”, para la maximización. El paso E encuentra la expectativa condicional de los datos faltantes dado los datos observados y los valores actuales de los parámetros estimados. Esto es análogo a la tradición de imputar datos faltantes. Una innovación clave del algoritmo EM es que se imputan estadísticas suficientes para los valores faltantes, no los puntos de datos individuales. Para el paso M, se actualizan las estimaciones de los parámetros maximizando una log-verosimilitud observada. Tanto las estadísticas suficientes como la log-verosimilitud dependen de la especificación del modelo. Existen muchas introducciones al algoritmo EM en la literatura. Little y Rubin (1987) proporcionan un tratamiento detallado. 6.5 Aplicación: Eficiencia en el Costo de los Gestores de Riesgos Esta sección examina datos de una encuesta sobre la eficiencia en el costo de las prácticas de gestión de riesgos. Las prácticas de gestión de riesgos son actividades llevadas a cabo por una empresa para minimizar el costo potencial de futuras pérdidas, como el evento de un incendio en un almacén o un accidente que lesione a los empleados. Esta sección desarrolla un modelo que se puede utilizar para hacer afirmaciones sobre el costo de la gestión de riesgos. Un esquema del proceso de modelado de regresión es el siguiente. Comenzamos proporcionando una introducción al problema y dando un breve contexto sobre los datos. Ciertas teorías previas nos llevarán a presentar un ajuste preliminar del modelo. Usando técnicas diagnósticas, será evidente que varias suposiciones que sustentan este modelo no están en acuerdo con los datos. Esto nos llevará a volver al principio y comenzar el análisis desde cero. Lo que aprendemos de un examen detallado de los datos nos llevará a postular algunos modelos revisados. Finalmente, para comunicar ciertos aspectos del nuevo modelo, exploraremos presentaciones gráficas del modelo recomendado. Introducción Los datos para este estudio fueron proporcionados por la Profesora Joan Schmit y se discuten en más detalle en el artículo “Cost effectiveness of risk management practices,” Schmit y Roth (1990). Los datos provienen de un cuestionario enviado a 374 gestores de riesgos de grandes organizaciones con sede en EE. UU. El propósito del estudio fue relacionar la eficacia en costos con la filosofía de gestión de controlar la exposición de la empresa a diversas pérdidas por propiedad y accidentes, después de ajustar por efectos de la empresa como el tamaño y el tipo de industria. Primero, algunas advertencias. Los datos de encuestas a menudo se basan en muestras de conveniencia, no en muestras probabilísticas. Al igual que con todos los conjuntos de datos observacionales, la metodología de regresión es una herramienta útil para resumir los datos. Sin embargo, debemos ser cautelosos al hacer inferencias basadas en este tipo de conjunto de datos. Para esta encuesta en particular, 162 gestores devolvieron encuestas completas, resultando en una buena tasa de respuesta del \\(43\\%\\). Sin embargo, para las variables incluidas en el análisis (definidas más adelante), solo se completaron 73 formularios, resultando en una tasa de respuesta completa del \\(20\\%\\). ¿Por qué una diferencia tan dramática? Los gestores, al igual que la mayoría de las personas, generalmente no tienen problemas en responder a consultas sobre sus actitudes u opiniones acerca de diversos temas. Cuando se les pregunta sobre hechos concretos, en este caso el tamaño de los activos de la empresa o las primas de seguros, o bien consideran que la información es confidencial y son reacios a responder incluso cuando se les garantiza anonimato, o simplemente no están dispuestos a tomarse el tiempo para buscar la información. Desde el punto de vista del encuestador, esto es desafortunado porque, por lo general, los datos “actitudinales” son imprecisos (alta varianza en comparación con la media) en comparación con los datos financieros concretos. El inconveniente es que estos últimos datos a menudo son difíciles de obtener. De hecho, para esta encuesta, se enviaron varios cuestionarios previos para determinar la disposición de los gestores a responder preguntas específicas. A partir de los cuestionarios previos, los investigadores redujeron drásticamente el número de preguntas financieras que planeaban hacer. Una medida de la eficacia en el costo de la gestión de riesgos, FIRMCOST, es la variable dependiente. Esta variable se define como las primas totales por propiedad y accidentes y las pérdidas no aseguradas como un porcentaje de los activos totales. Es un proxy para los gastos anuales asociados con eventos asegurables, estandarizados por el tamaño de la empresa. Aquí, para las variables financieras, ASSUME es el monto de retención por ocurrencia como porcentaje de los activos totales, CAP indica si la empresa posee una compañía de seguros cautiva, SIZELOG es el logaritmo de los activos totales e INDCOST es una medida del riesgo de la industria de la empresa. Las variables actitudinales incluyen CENTRAL, una medida de la importancia de los gestores locales en la elección de la cantidad de riesgo a retener, y SOPH, una medida del grado de importancia en el uso de herramientas analíticas, como la regresión, en la toma de decisiones de gestión de riesgos. En el artículo, los investigadores describieron varias debilidades de las definiciones utilizadas, pero argumentan que estas definiciones proporcionan información útil, basada en la disposición de los gestores de riesgos a obtener información confiable. Los investigadores también describieron varias teorías sobre relaciones que podrían ser confirmadas por los datos. Específicamente, hipotetizaron: Existe una relación inversa entre la retención de riesgo (ASSUME) y el costo (FIRMCOST). La idea detrás de esta teoría es que mayores montos de retención deberían significar menores gastos para una empresa, resultando en menores costos. El uso de una compañía de seguros cautiva (CAP) resulta en menores costos. Presumiblemente, una cautiva se usa solo cuando es costo-efectiva y, en consecuencia, esta variable debería indicar menores costos si se utiliza efectivamente. Existe una relación inversa entre la medida de centralización (CENTRAL) y el costo (FIRMCOST). Presumiblemente, los gestores locales podrían tomar decisiones más costo-efectivas porque están más familiarizados con las circunstancias locales relacionadas con la gestión de riesgos que los gestores ubicados centralmente. Existe una relación inversa entre la medida de sofisticación (SOPH) y el costo (FIRMCOST). Presumiblemente, herramientas analíticas más sofisticadas ayudan a las empresas a gestionar el riesgo de manera más eficaz, resultando en menores costos. Análisis Preliminar Para probar las teorías descritas anteriormente, se puede utilizar el marco de análisis de regresión. Para ello, se plantea el modelo \\[ \\small{ \\begin{array}{ll} \\text{FIRMCOST} &amp;=&amp;\\beta_0 +\\beta_1 \\text{ ASSUME}+\\beta_{2}\\text{ CAP} +\\beta_{3}\\text{ SIZELOG}+\\beta_4\\text{ INDCOST} \\\\ &amp;&amp;+\\beta_5\\text{ CENTRAL}+\\beta_6\\text{ SOPH}+ \\varepsilon. \\end{array} } \\] Con este modelo, cada teoría se puede interpretar en términos de los coeficientes de regresión. Por ejemplo, \\(\\beta_1\\) se puede interpretar como el cambio esperado en el costo por unidad de cambio en el nivel de retención (ASSUME). Así, si la primera hipótesis es verdadera, esperamos que \\(\\beta_1\\) sea negativo. Para probar esto, podemos estimar \\(b_{1}\\) y usar nuestras pruebas de hipótesis para decidir si \\(b_{1}\\) es significativamente menor que cero. Las variables SIZELOG e INDCOST se incluyen en el modelo para controlar los efectos de estas variables. Estas variables no están directamente bajo el control del gestor de riesgos y, por lo tanto, no son de interés principal. Sin embargo, la inclusión de estas variables puede explicar una parte importante de la variabilidad. Los datos de 73 gestores fueron ajustados utilizando este modelo de regresión. La Tabla 6.2 resume el modelo ajustado. Tabla 6.2: Resultados de la Regresión del Ajuste del Modelo Preliminar Coeficiente Error Estándar \\(t\\)-Estadístico (Intercept) 59.765 19.065 3.135 ASSUME -0.300 0.222 -1.353 CAP 5.498 3.848 1.429 SIZELOG -6.836 1.923 -3.555 INDCOST 23.078 8.304 2.779 CENTRAL 0.133 1.441 0.092 SOPH -0.137 0.347 -0.394 El coeficiente de determinación ajustado es \\(R_{a}^{2}=18.8\\%\\), el ratio \\(F\\) es 3.78 y la desviación estándar residual es \\(s=14.56\\). Con base en las estadísticas resumidas del modelo de regresión, podemos concluir que las medidas de centralización y sofisticación no tienen un impacto en nuestra medida de eficacia en costos. Para ambas variables, el ratio \\(t\\) es bajo, menos de 1.0 en valor absoluto. El efecto de la retención de riesgo parece ser solo algo importante. El coeficiente tiene el signo apropiado, aunque está solo 1.35 errores estándar por debajo de cero. Esto no se consideraría estadísticamente significativo al nivel del 5%, aunque sí al nivel del 10% (el valor \\(p\\) es 9%). Quizás lo más desconcertante es el coeficiente asociado con la variable CAP. Teorizamos que este coeficiente sería negativo. Sin embargo, en nuestro análisis de los datos, el coeficiente resulta ser positivo y está 1.43 errores estándar por encima de cero. Esto no solo nos lleva a desmentir nuestra teoría, sino también a buscar nuevas ideas que estén en concordancia con la información aprendida de los datos. Schmit y Roth sugieren razones que pueden ayudarnos a interpretar los resultados de nuestras pruebas de hipótesis. Por ejemplo, sugieren que los gestores en la muestra pueden no tener las herramientas más sofisticadas disponibles cuando gestionan riesgos, lo que resulta en un coeficiente no significativo asociado con SOPH. También discutieron sugerencias alternativas, así como interpretaciones para los otros resultados de las pruebas de hipótesis. ¿Qué tan robusto es este modelo? La Sección 6.2 enfatizó algunos de los peligros de trabajar con un modelo inadecuado. Algunos lectores pueden sentirse incómodos con el modelo seleccionado anteriormente porque dos de las seis variables tienen \\(t\\)-ratios menores a 1 en valor absoluto y cuatro de las seis tienen \\(t\\)-ratios menores a 1.5 en valor absoluto. Quizás aún más importante, los histogramas de los residuos estandarizados y las palancas, en la Figura 6.5, muestran que varias observaciones son puntos atípicos y de alta influencia. Para ilustrar, el residuo más grande resulta ser \\(e_{15}=83.73\\). La suma de cuadrados del error es \\(Error~SS\\) = \\((n-(k+1))s^{2}\\) = \\((73-7)(14.56)^{2}=13,987\\). Así, la 15ª observación representa el 50.1% de la suma de cuadrados del error \\((=83.73^{2}/13,987)\\), sugiriendo que esta única observación de las 73 tiene un impacto dominante en el ajuste del modelo. Además, los gráficos de residuos estandarizados versus valores ajustados, no presentados aquí, mostraron evidencia de residuos heterocedásticos. Con base en estas observaciones, parece razonable evaluar la robustez del modelo. Figura 6.5: Histogramas de residuos estandarizados y palancas del ajuste preliminar del modelo de regresión. Código R para producir la Tabla 6.2 y la Figura 6.5 ## Análisis del Gestor de Riesgos # Tabla 6.2 survey &lt;- read.csv(&quot;CSVData/RiskSurvey.csv&quot;, header=TRUE) varSurvey &lt;- c(&quot;FIRMCOST&quot;,&quot;ASSUME&quot;,&quot;CAP&quot;,&quot;SIZELOG&quot;,&quot;INDCOST&quot;,&quot;CENTRAL&quot;,&quot;SOPH&quot;) survey1 &lt;- data.frame(survey[varSurvey]) # PRIMERA REGRESIÓN lmsurvey1&lt;-lm(FIRMCOST~ASSUME+CAP+SIZELOG+INDCOST+CENTRAL+SOPH,data=survey1) sum1 &lt;- summary(lmsurvey1) tableout &lt;- sum1$coefficients[,1:3] colnames(tableout) &lt;- c(&quot;Coeficiente&quot;, &quot;Error Estándar&quot;, &quot;$t$-Estadístico&quot;) TableGen1(TableData=tableout , TextTitle=&#39;Resultados de la Regresión del Ajuste del Modelo Preliminar&#39;, Align=&#39;r&#39;, ColumnSpec=1:3, Digits = 3, ColWidth = &quot;3cm&quot;) ri1 &lt;- rstandard(lmsurvey1) hii1 &lt;- hatvalues(lmsurvey1) # FIGURA 6.5 par(mfrow=c(1, 2),mar=c(4.1,4.5,.2,.2)) hist(ri1, nclass=16, main=&quot;&quot;, xlab=&quot;Residuos Estandarizados&quot;,las=1,cex.lab=1.5) hist(hii1, nclass=16, main=&quot;&quot;, xlab=&quot;Palancas&quot;,las=1,cex.lab=1.5) Volviendo a lo Básico Para entender mejor los datos, comenzamos examinando las estadísticas resumen básicas en la Tabla 6.3 y los histogramas correspondientes en la Figura 6.6. En la Tabla 6.3, el valor más alto de FIRMCOST es 97.55, que está más de cinco desviaciones estándar por encima de la media \\([10.97+5(16.16)=91.77]\\). Un examen de los datos muestra que este punto es la observación 15, la misma observación que fue un punto atípico en el ajuste preliminar de la regresión. Sin embargo, el histograma de FIRMCOST en la Figura 6.6 revela que este no es el único punto inusual. Otras dos observaciones tienen valores inusualmente altos de FIRMCOST, resultando en una distribución sesgada hacia la derecha. El histograma, en la Figura 6.6, de la variable ASSUME muestra que esta distribución también está sesgada hacia la derecha, posiblemente debido únicamente a dos grandes observaciones. De las estadísticas resumen básicas en la Tabla 6.3, vemos que el valor más alto de ASSUME está más de siete desviaciones estándar por encima de la media. Esta observación podría resultar influyente en el ajuste posterior del modelo de regresión. El diagrama de dispersión de FIRMCOST versus ASSUME en la Figura 6.6 nos dice que la observación con el valor más alto de FIRMCOST no es la misma que la observación con el valor más alto de ASSUME. Tabla 6.3: Estadísticas Resumen de \\(n=73\\) Encuestas sobre Gestión de Riesgos Media Mediana Desviación Estándar Mínimo Máximo FIRMCOST 10.973 6.08 16.159 0.20 97.55 ASSUME 2.574 0.51 8.445 0.00 61.82 CAP 0.342 0.00 0.478 0.00 1.00 SIZELOG 8.332 8.27 0.963 5.27 10.60 INDCOST 0.418 0.34 0.216 0.09 1.22 CENTRAL 2.247 2.00 1.256 1.00 5.00 SOPH 21.192 23.00 5.304 5.00 31.00 Fuente: Schmit y Roth, (1990) A partir de los histogramas de SIZELOG, INDCOST, CENTRAL y SOPH, vemos que estas distribuciones no están fuertemente sesgadas. Tomar logaritmos del tamaño de los activos totales de la empresa ha servido para hacer la distribución más simétrica que en las unidades originales. A partir del histograma y las estadísticas resumen, vemos que CENTRAL es una variable discreta, que toma valores del uno al cinco. La otra variable discreta es CAP, una variable binaria que toma solo valores cero y uno. El histograma y el gráfico de dispersión correspondiente a CAP no se presentan aquí. Es más informativo proporcionar una tabla de medias de cada variable por niveles de CAP, como en la Tabla 6.4. A partir de esta tabla, vemos que 25 de las 73 empresas encuestadas tienen aseguradoras cautivas. Además, por un lado, el FIRMCOST promedio para las empresas con aseguradoras cautivas \\((CAP = 1)\\) es mayor que para las que no tienen \\((CAP = 0)\\). Por otro lado, al pasar a la escala logarítmica, sucede lo contrario; es decir, el COSTLOG promedio para las empresas con aseguradoras cautivas \\((CAP = 1)\\) es mayor que para las que no tienen \\((CAP = 0)\\). Tabla 6.4: Tabla de Medias por Nivel de CAP \\(n\\) FIRMCOST ASSUME SIZELOG INDCOST CENTRAL SOPH COSTLOG CAP = 0 48 9.954 1.175 8.196 0.399 2.250 21.521 1.820 CAP = 1 25 12.931 5.258 8.592 0.455 2.240 20.560 1.595 TOTAL 73 10.973 2.574 8.332 0.418 2.247 21.192 1.743 Figura 6.6: Histogramas y gráficos de dispersión de FIRMCOST y varias variables explicativas. Las distribuciones de FIRMCOST y ASSUME están fuertemente sesgadas hacia la derecha. Hay una relación negativa entre FIRMCOST y SIZELOG, aunque no lineal. Código R para producir las Tablas 6.3 y 6.4 y la Figura 6.6 # TABLA 6.3 ESTADÍSTICAS RESUMEN BookSummStats &lt;- function(Xymat){ meanSummary &lt;- sapply(Xymat, mean, na.rm=TRUE) sdSummary &lt;- sapply(Xymat, sd, na.rm=TRUE) minSummary &lt;- sapply(Xymat, min, na.rm=TRUE) maxSummary &lt;- sapply(Xymat, max, na.rm=TRUE) medSummary &lt;- sapply(Xymat, median,na.rm=TRUE) tableMat &lt;- cbind(meanSummary, medSummary, sdSummary, minSummary, maxSummary) return(tableMat) } tableMat &lt;- BookSummStats(survey1) colnames(tableMat) &lt;- c(&quot;Media&quot;, &quot;Mediana&quot;, &quot;Desviación Estándar&quot;, &quot;Mínimo&quot;, &quot;Máximo&quot;) rownames(tableMat) &lt;- varSurvey TableGen1(TableData=tableMat, TextTitle=&#39;Estadísticas Resumen de $n=73$ Encuestas sobre Gestión de Riesgos&#39;, Align=&#39;r&#39;, Digits=3, ColumnSpec=1:5, ColWidth = ColWidth5) # Tabla 6.4 varSum &lt;-function(var){ rows12 &lt;- Hmisc::summarize(var, survey1$CAP, mean )[[2]] row3 &lt;- mean(var) return( c(rows12, row3) ) } tableout1 &lt;- cbind( varSum(survey[,1]), varSum(survey[,2]), varSum(survey[,4]), varSum(survey[,5]), varSum(survey[,6]), varSum(survey[,7]), varSum(log(survey[,1])) ) num.cap &lt;- c(Hmisc::summarize(survey[,1], survey1$CAP, length )[[2]] , length(survey[,1]) ) tableout &lt;- cbind(num.cap, tableout1) colnames(tableout) &lt;- c(&quot;$n$&quot;, &quot;FIRMCOST&quot;,&quot;ASSUME&quot;,&quot;SIZELOG&quot;,&quot;INDCOST&quot;,&quot;CENTRAL&quot;,&quot;SOPH&quot;,&quot;COSTLOG&quot;) rownames(tableout) &lt;- c(&quot;CAP = 0&quot;, &quot;CAP = 1&quot;, &quot;TOTAL&quot;) TableGen1(TableData=tableout , TextTitle=&#39;Tabla de Medias por Nivel de CAP&#39;, Align=&#39;r&#39;, ColumnSpec=1:7, Digits = 3) # FIGURA 6.6 layout(matrix(c(1,2,3,4,5,6,7,8,9,10,11,12),byrow=TRUE,ncol=6)) par(&quot;oma&quot;=c(3,3,3,3),&quot;mai&quot;=c(0,0,0.1,0)) plot.new() hist(survey1$ASSUME,breaks=18,main=&quot;ASSUME&quot;,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) hist(survey1$SIZELOG,breaks=18,main=&quot;SIZELOG&quot;,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) hist(survey1$INDCOST,breaks=18,main=&quot;INDCOST&quot;,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) hist(survey1$CENTRAL,breaks=18,main=&quot;CENTRAL&quot;,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) hist(survey1$SOPH,breaks=18,main=&quot;SOPH&quot;,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) hist(survey1$FIRMCOST,breaks=18,main=&quot;FIRMCOST&quot;,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) plot(survey1$ASSUME,survey1$FIRMCOST,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) plot(survey1$SIZELOG,survey1$FIRMCOST,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) plot(survey1$INDCOST,survey1$FIRMCOST,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) plot(survey1$CENTRAL,survey1$FIRMCOST,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) plot(survey1$SOPH,survey1$FIRMCOST,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) Al examinar las relaciones entre pares de variables, en la Figura 6.6 observamos algunas de las relaciones que fueron evidentes en el ajuste preliminar de la regresión. Hay una relación inversa entre FIRMCOST y SIZELOG, y el gráfico de dispersión sugiere que esta relación podría ser no lineal. También hay una relación positiva leve entre FIRMCOST e INDCOST y no se observan relaciones aparentes entre FIRMCOST y ninguna de las otras variables explicativas. Estas observaciones se refuerzan con la tabla de correlaciones dada en la Tabla 6.4. Nota que la tabla oculta una característica que es evidente en los gráficos de dispersión: el efecto de las observaciones inusualmente grandes. Tabla 6.5: Matriz de Correlaciones COSTLOG FIRMCOST ASSUME CAP SIZELOG INDCOST CENTRAL FIRMCOST 0.713 ASSUME 0.165 0.039 CAP -0.088 0.088 0.231 SIZELOG -0.637 -0.366 -0.209 0.196 INDCOST 0.395 0.326 0.249 0.122 -0.102 CENTRAL -0.054 0.014 -0.068 -0.004 -0.08 -0.085 SOPH 0.144 0.048 0.062 -0.087 -0.209 0.093 0.283 Debido al sesgo de la distribución y al efecto de las observaciones inusualmente grandes, una transformación de la variable de respuesta podría llevar a resultados más útiles. La Figura 6.7 muestra el histograma de COSTLOG, definido como el logaritmo de FIRMCOST. La distribución es mucho menos sesgada que la distribución de FIRMCOST. La variable COSTLOG también se incluyó en la matriz de correlaciones en la Tabla 6.4. A partir de esta tabla, la relación entre SIZELOG parece ser más fuerte con COSTLOG que con FIRMCOST. La Figura 6.8 muestra varios gráficos de dispersión que ilustran la relación entre COSTLOG y las variables explicativas. La relación entre COSTLOG y SIZELOG parece ser lineal. Es más fácil interpretar estos gráficos de dispersión que los de la Figura 6.6 debido a la ausencia de los grandes valores inusuales de la variable dependiente. Figura 6.7: Histograma de COSTLOG (el logaritmo natural de FIRMCOST). La distribución de COSTLOG es menos sesgada que la de FIRMCOST. Figura 6.8: Gráficos de dispersión de COSTLOG versus varias variables explicativas. Hay una relación negativa entre COSTLOG y SIZELOG y una relación positiva leve entre COSTLOG e INDCOST. Código R para producir la Tabla 6.5 y las Figuras 6.7 y 6.8 # Tabla 6.5 survey2 &lt;- cbind(log(survey1[,1]), survey1) names(survey2) &lt;- c(&quot;COSTLOG&quot;, varSurvey) tableCor &lt;- cor(survey2) tableCor &lt;- round(tableCor, digits = 3) tableCor[upper.tri(tableCor, diag = TRUE)] &lt;- &quot;&quot; tablePrint &lt;- tableCor[-1,] tablePrint &lt;- tablePrint[,-8] TableGen1(TableData=tablePrint, TextTitle=&#39;Matriz de Correlaciones&#39;, Align=&#39;r&#39;, Digits=3, ColumnSpec=1:3, ColWidth = ColWidth5) # FIGURA 6.7 COSTLOG &lt;- log(survey1$FIRMCOST) par(mar=c(4,4.4,.2,.2)) hist(COSTLOG, nclass=16, main=&quot;&quot;, xlab=&quot;COSTLOG&quot;,las=1,cex.lab=2) # FIGURA 6.8 layout(matrix(c(1,2,3,4,5),byrow=TRUE,ncol=5)) par(&quot;oma&quot;=c(3,5,3,3),&quot;mai&quot;=c(0,0,0.2,0)) plot(survey1$ASSUME,COSTLOG,main=&quot;ASSUME&quot;, xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;,las=1) plot(survey1$SIZELOG,COSTLOG,main=&quot;SIZELOG&quot;,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) plot(survey1$INDCOST,COSTLOG,main=&quot;INDCOST&quot;,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) plot(survey1$CENTRAL,COSTLOG,main=&quot;CENTRAL&quot;,xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) plot(survey1$SOPH,COSTLOG, main=&quot;SOPH&quot;, xaxt=&quot;n&quot;,yaxt=&quot;n&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;) Algunos Modelos Nuevos Ahora, exploramos el uso de COSTLOG como la variable dependiente. Este enfoque se basa en el trabajo de la subsección anterior y en los gráficos de residuos del ajuste preliminar de la regresión. Como primer paso, ajustamos un modelo con todas las variables explicativas. Por lo tanto, este modelo es el mismo que el ajuste preliminar de la regresión, excepto que usa COSTLOG en lugar de FIRMCOST como la variable dependiente. Este modelo sirve como un punto de referencia útil para nuestro trabajo posterior. La Tabla 6.6 resume el ajuste. Tabla 6.6: Resultados de la Regresión: COSTLOG como Variable Dependiente Coeficiente Error Estándar \\(t\\)-Estadístico (Intercept) 7.643 1.155 6.617 ASSUME -0.008 0.013 -0.609 CAP 0.015 0.233 0.064 SIZELOG -0.787 0.116 -6.752 INDCOST 1.905 0.503 3.787 CENTRAL -0.080 0.087 -0.916 SOPH 0.002 0.021 0.116 Aquí, \\(R_{a}^{2}=48\\%\\), \\(F\\)-ratio \\(=12.1\\) y \\(s=0.882\\). La Figura 6.9 muestra que la distribución de los residuos estandarizados es menos sesgada que la correspondiente en la Figura 6.5. La distribución de los apalancamientos muestra que todavía hay observaciones altamente influyentes. (De hecho, la distribución de los apalancamientos parece ser la misma que en la Figura 6.5. ¿Por qué?) Cuatro de las seis variables tienen \\(t\\)-ratios menores que uno en valor absoluto, lo que sugiere que debemos continuar buscando un mejor modelo. Figura 6.9: Histogramas de residuos estandarizados y apalancamientos utilizando COSTLOG como la variable dependiente. Para continuar con la búsqueda, se realizó una regresión por pasos (aunque la salida no se reproduce aquí). La salida de esta técnica de búsqueda, así como el modelo de regresión ajustado arriba, sugiere usar las variables SIZELOG e INDCOST para explicar la variable dependiente COSTLOG. Podemos realizar una regresión usando SIZELOG e INDCOST como variables explicativas. En la Figura 6.10, vemos que el tamaño y la forma de la distribución de los residuos estandarizados son similares a los de la Figura 6.9. Los apalancamientos son mucho menores, lo que refleja la eliminación de varias variables explicativas del modelo. Recuerda que el apalancamiento promedio es \\(\\bar{h} =(k+1)/n=3/73\\approx 0.04\\). Así, todavía tenemos tres puntos que superan tres veces el promedio y, por lo tanto, se consideran puntos de alto apalancamiento. Figura 6.10: Histogramas de residuos estandarizados y apalancamientos usando SIZELOG e INDCOST como variables explicativas. Código R para producir la Tabla 6.6 y las Figuras 6.9 y 6.10 # SEGUNDA REGRESIÓN # Tabla 6.6 lmsurvey2 &lt;- lm(COSTLOG ~ ASSUME + CAP + SIZELOG + INDCOST + CENTRAL + SOPH, data=survey2) sum2 &lt;- summary(lmsurvey2) tableout &lt;- sum2$coefficients[,1:3] colnames(tableout) &lt;- c(&quot;Coeficiente&quot;, &quot;Error Estándar&quot;, &quot;$t$-Estadístico&quot;) TableGen1(TableData=tableout, TextTitle=&#39;Resultados de la Regresión: COSTLOG como Variable Dependiente&#39;, Align=&#39;r&#39;, ColumnSpec=1:3, Digits=3, ColWidth = &quot;3cm&quot;) # FIGURA 6.9 ri2 &lt;- rstandard(lmsurvey2) hii2 &lt;- hatvalues(lmsurvey2) # FIGURA 6.9 par(mfrow=c(1, 2), mar=c(4.1, 4.5, .2, .2)) hist(ri2, nclass=16, main=&quot;&quot;, xlab=&quot;Residuos Estandarizados&quot;, las=1, cex.lab=1.5) hist(hii2, nclass=16, main=&quot;&quot;, xlab=&quot;Apalancamientos&quot;, las=1, cex.lab=1.5) # FIGURA 6.10 lmsurvey3 &lt;- lm(COSTLOG ~ SIZELOG + INDCOST, data=survey2) ri3 &lt;- rstandard(lmsurvey3) hii3 &lt;- hatvalues(lmsurvey3) # FIGURA 6.10 par(mfrow=c(1, 2), mar=c(4.1, 4.5, .2, .2)) hist(ri3, nclass=16, main=&quot;&quot;, xlab=&quot;Residuos Estandarizados&quot;, las=1, cex.lab=1.5) hist(hii3, nclass=16, main=&quot;&quot;, xlab=&quot;Apalancamientos&quot;, las=1, cex.lab=1.5) Tabla 6.7: Resultados de la Regresión con un Término Cuadrático en INDCOST Coeficiente Error Estándar \\(t\\)-Estadístico (Intercept) 6.353 0.953 6.666 SIZELOG -0.773 0.101 -7.626 INDCOST 6.264 1.610 3.889 INDCOSTSQ -3.585 1.265 -2.833 Figura 6.11: Gráfico de dispersión de residuos versus INDCOST. La curva ajustada suave (usando lowess) sugiere un término cuadrático en INDCOST. Código R para producir la Tabla 6.7 y la Figura 6.11 # TERCERA REGRESIÓN # Tabla 6.7 survey2$INDCOSTSQ &lt;- survey2$INDCOST * survey2$INDCOST lmsurvey4 &lt;- lm(COSTLOG ~ SIZELOG + INDCOST + INDCOSTSQ, data=survey2) sum4 &lt;- summary(lmsurvey4) tableout &lt;- sum4$coefficients[,1:3] colnames(tableout) &lt;- c(&quot;Coeficiente&quot;, &quot;Error Estándar&quot;, &quot;$t$-Estadístico&quot;) TableGen1(TableData=tableout, TextTitle=&#39;Resultados de la Regresión con un Término Cuadrático en INDCOST&#39;, Align=&#39;r&#39;, ColumnSpec=1:3, Digits=3, ColWidth = &quot;3cm&quot;) par(mar=c(4.1, 2.2, 1.7, .2), cex=1.2) plot(survey2$INDCOST, lmsurvey4$residuals, xlab=&quot;INDCOST&quot;, ylab=&quot;&quot;, las=1) mtext(&quot;RESIDUAL&quot;, side=2, las=1, at=3.3, cex=1.2, adj=.4) lines(lowess(survey2$INDCOST, lmsurvey4$residuals, f=.8)) Los gráficos de residuos versus las variables explicativas revelan algunos patrones sutiles. El gráfico de dispersión de residuos versus INDCOST, en la Figura 6.11, muestra una tendencia cuadrática leve en INDCOST. Para verificar si esta tendencia es importante, la variable INDCOST fue elevada al cuadrado y utilizada como una variable explicativa en un modelo de regresión. Los resultados de este ajuste están en la Tabla 6.6. A partir del \\(t\\)-ratio asociado con \\((INDCOST)^{2}\\), vemos que la variable parece ser importante. El signo es razonable, indicando que la tasa de incremento de COSTLOG disminuye a medida que INDCOST aumenta. Es decir, el cambio esperado en COSTLOG por unidad de cambio en INDCOST es positivo y disminuye a medida que INDCOST aumenta. Los chequeos diagnósticos adicionales del modelo no revelaron patrones adicionales. Por lo tanto, con los datos disponibles, no podemos afirmar ninguna de las cuatro hipótesis introducidas en la subsección de Introducción. Esto no significa que estas variables no sean importantes. Simplemente estamos diciendo que la variabilidad natural de los datos era lo suficientemente grande como para ocultar cualquier relación que pudiera existir. Sin embargo, hemos establecido la importancia del tamaño de la empresa y del riesgo industrial de la empresa. La Figura 6.12 resume gráficamente las relaciones estimadas entre estas variables. En particular, en el panel inferior derecho, vemos que para la mayoría de las empresas en la muestra, FIRMCOST fue relativamente estable. Sin embargo, para las empresas pequeñas, medida por SIZELOG, el riesgo industrial, medido por INDCOST, fue particularmente importante. Para las empresas pequeñas, vemos que el FIRMCOST ajustado aumenta a medida que la variable INDCOST aumenta, con la tasa de incremento estabilizándose. Aunque el modelo predice teóricamente que FIRMCOST disminuye con un INDCOST grande \\((&gt;1.2)\\), no había empresas pequeñas en esta área de la región de datos. Figura 6.12: Gráfico de cuatro modelos ajustados versus INDCOST y SIZELOG. 6.6 Lecturas Adicionales y Referencias Este capítulo concluye nuestra Parte I, una introducción a la regresión lineal. Para aprender más sobre la regresión lineal, en la Sección 1.7 proporcionamos referencias a libros de estadística alternativos que introducen el tema. También puedes estar interesado en una presentación más técnica, como el trabajo clásico de Seber (1977) o un trabajo más reciente de Abraham y Ledolter (2006). Para otros enfoques, textos como el de Wooldridge (2009) ofrecen una perspectiva econométrica donde se enfatiza la introducción de la regresión en el contexto de la teoría económica. Alternativamente, libros como el de Agresti y Finlay (2008) brindan una introducción desde una perspectiva más amplia de las ciencias sociales. Existen muchas explicaciones de la regresión para lectores con diferentes perspectivas y niveles de formación cuantitativa; esto proporciona evidencia adicional de que este es un tema importante para que los actuarios y otros gestores de riesgos financieros lo comprendan. Otra forma de obtener una comprensión más profunda de la regresión lineal es ver cómo se aplica en un contexto de series temporales en la Parte II de este libro o en extensiones a la modelización no lineal en la Parte III. Consulta Bollen (1989) para una introducción clásica a la modelización de ecuaciones estructurales. Referencias del Capítulo Abraham, Bova and Johannes Ledolter (2006). Introduction to Regression Modeling. Thomson Higher Education, Belmont, CA. Agresti, Alan and Barbara Finlay (2008). Statistical Methods for the Social Sciences, Fourth Edition. Prentice Hall, Upper Saddle, NJ. Bollen, Kenneth A. (1989). Structural Equations with Latent Variables. New York: Wiley. Box, George E. P. (1979). Robustness in the strategy of scientific model building. In R. Launer and G. Wilderson (editors), Robustness in Statistics, pages 201-236, Academic Press, New York. Faraway, Julian J. (2005). Linear Models with R. Chapman &amp; Hall/CRC, Boca Raton, Florida. Fienberg, S. E (1985). Insurance availability in Chicago. Chapter in Data: A Collection of Problems from Many Fields for the Student and Research Worker. Editors D.F. Andrews and A. M. Herzberg, Springer-Verlag, New York. Goldberger, Arthur S. (1972). Structural equation methods in the social sciences. Econometrica 40, 979-1001. Harrington, Scott E. and Greg Niehaus (1998). Race, redlining and automobile insurance prices. Journal of Business 71(3), 439-469. Heckman, J. J. (1976). The common structure of statistical models of truncation, sample selection and limited dependent variables, and a simple estimator for such models. Ann. Econ. Soc. Meas. 5, 475-492. Little, R. J. (1995). Modelling the drop-out mechanism in repeated-measures studies. Journal of the American Statistical Association 90, 1112-1121. Little, R. J. and Rubin, D. B. (1987). Statistical Analysis with Missing Data. John Wiley, New York. Roberts, Harry V. (1990). Business and economic statistics (with discussion). Statistical Science 4, 372-402. Rubin, D. R. (1976). Inference and missing data. Biometrika 63, 581-592. Schmit, Joan T. and K. Roth (1990). Cost effectiveness of risk management practices. The Journal of Risk and Insurance 57, No. 3, pages 455-470. Seber, G. A. F. (1977). Linear Regression Analysis. John Wiley &amp; Sons, New York. Wachter, K. W. and J. Trusell (1982). Estimating historical heights. Journal of the American Statistical Association 77, 279-301. Wooldridge, Jeffrey (2009). Introductory Econometrics: A Modern Approach, Fourth Edition. South-Western Publishing, Mason, Ohio. 6.7 Ejercicios 6.1 Segregación por Seguro. ¿Utilizan las compañías de seguros la raza como un factor determinante al ofrecer seguros? Fienberg (1985) recopiló datos de un informe emitido por la Comisión de Derechos Civiles de EE.UU. sobre el número de propietarios de viviendas y pólizas de seguro contra incendios residenciales emitidas en Chicago durante los meses de diciembre de 1977 a febrero de 1978. Las pólizas emitidas se clasificaron como parte del mercado voluntario estándar o del mercado involuntario subestándar. El mercado involuntario consiste en planes de “acceso justo a los seguros” (FAIR); estos son programas de seguros estatales a veces subsidiados por empresas privadas. Estos planes brindan seguros a personas que, de otro modo, serían rechazadas para asegurar su propiedad debido a problemas de alto riesgo. El objetivo principal es comprender la relación entre la actividad de seguros y la variable “raza”, el porcentaje de minorías. Los datos están disponibles para \\(n=47\\) códigos postales en el área de Chicago. Estos datos también han sido analizados por Faraway (2005). Para ayudar a controlar el tamaño de la pérdida esperada, Fienberg también recopiló datos de robos e incendios de los departamentos de policía y bomberos de Chicago. Otra variable que proporciona información sobre el tamaño de la pérdida es la antigüedad de la casa. El ingreso mediano, del Censo, proporciona información indirecta sobre el tamaño de la pérdida esperada así como sobre si el solicitante puede permitirse el seguro. La Tabla 6.8 proporciona más detalles sobre estas variables. Tabla 6.8: Disponibilidad de Seguros en Chicago Variable Descripción Promedio row.names Código postal race Composición racial en porcentaje de minorías 35 fire Incendios por 1,000 unidades habitacionales 12.3 theft Robos por 1,000 habitantes 32.4 age Porcentaje de unidades habitacionales construidas en o antes de 1939 60.3 volact Nuevas pólizas para propietarios más renovaciones, menos cancelaciones y no renovaciones por 100 unidades habitacionales 6.53 involact Nuevas pólizas del plan FAIR y renovaciones por 100 unidades habitacionales 0.615 income Ingreso familiar mediano 10696 Produce estadísticas descriptivas de todas las variables, observando los patrones de asimetría para cada variable. Crea una matriz de gráficos de dispersión de volact, involact y race. Comenta sobre las tres relaciones pares. ¿Son los patrones consistentes con una hipótesis de discriminación racial? Para entender las relaciones entre las variables, produce una tabla de correlaciones. Ajusta un modelo lineal usando volact como la variable dependiente y race, fire, theft, age e income como variables explicativas. d(i). Comenta sobre el signo y la significancia estadística del coeficiente asociado con race. d(ii). Dos códigos postales resultan tener alta influencia. Repite tu análisis después de eliminar estas dos observaciones. ¿Ha cambiado la significancia de la variable race? ¿Qué pasa con las otras variables explicativas? Repite el análisis en la parte (d) usando involact como la variable dependiente. Define proporción como involact/(volact+involact). Repite el análisis en la parte (d) usando proporción como la variable dependiente. Los mismos dos códigos postales tienen alta influencia en las partes (d), (e) y (f). ¿Por qué ocurre esto? Este análisis se realiza a nivel de código postal, no a nivel individual. Como enfatizan Harrington y Niehaus (1998), esto introduce un potencial sesgo por variables omitidas. ¿Qué variables se han omitido en el análisis que crees que podrían afectar la disponibilidad del seguro para propietarios y la raza? Fienberg señala que la proximidad de un código postal a otro puede afectar la dependencia de las observaciones. Describe cómo podrías incorporar relaciones espaciales en un análisis de regresión. 6.2 Equidad de Género en los Sueldos del Personal Académico. La Universidad de Wisconsin en Madison realizó un estudio titulado “Estudio de Equidad de Género en los Sueldos del Personal Académico”, fechado el 5 de junio de 1992. El propósito principal del estudio fue determinar si las mujeres son tratadas de manera injusta en la determinación de sueldos en una importante universidad de investigación en EE.UU. Para ello, el comité que emitió el informe estudió los sueldos de 1990 de 1,898 miembros de la facultad de la universidad. Es bien conocido que los hombres ganan más que las mujeres. De hecho, el sueldo promedio de 1990 para los 1,528 miembros masculinos de la facultad es 54,478, que es un 28% más alto que el sueldo promedio de 1990 para las miembros femeninas de la facultad, que es 43,315. Sin embargo, se argumenta que los miembros masculinos de la facultad son en general más experimentados (el promedio de años de experiencia es 18.8 años) que las miembros femeninas de la facultad (el promedio de años de experiencia es 11.9 años), y por lo tanto, merecen un sueldo más alto. Al comparar los sueldos de los profesores titulares (controlando así por años de experiencia), los miembros masculinos de la facultad ganaron aproximadamente un 13% más que sus contrapartes femeninas. Aun así, se acuerda en general que los campos en demanda deben ofrecer sueldos más altos para mantener una facultad de primer nivel. Por ejemplo, los sueldos en ingeniería son más altos que los sueldos en humanidades simplemente porque los académicos en ingeniería tienen muchas más oportunidades de empleo fuera de la academia que los académicos en humanidades. Por lo tanto, al considerar los sueldos, también se debe controlar por departamento. Para controlar estas variables, un estudio de la facultad reporta un análisis de regresión usando el logaritmo del sueldo como la variable dependiente. Las variables explicativas incluyeron información sobre raza, género, rango (ya sea profesor asistente/instructor, profesor asociado o profesor titular), varias medidas de años de experiencia, 98 categorías diferentes de departamentos y una medida de la diferencia de sueldo por departamento. Hubo 109 variables explicativas en total (incluyendo 97 variables binarias departamentales), de las cuales 12 eran variables no departamentales. La Tabla 6.9 reporta las definiciones de variables, estimaciones de parámetros y \\(t\\)-ratios para las 12 variables no departamentales. La Tabla de ANOVA 6.10 resume el ajuste de la regresión. Tabla 6.9: Variables No Departamentales y Estimaciones de Parámetros Variable Explicativa Descripción de la Variable Estimación del Parámetro \\(t\\)-Ratio INTERCEPT 10.746 261.1 GENDER = 1 si es hombre, 0 en caso contrario 0.016 1.86 RACE = 1 si es blanco, 0 en caso contrario -0.029 -2.44 FULL = 1 si es profesor titular, 0 en caso contrario 0.186 16.42 ASSISTANT = 1 si es profesor asistente, 0 en caso contrario -0.205 -15.93 ANYDOC = 1 si tiene un título terminal como un Ph.D.  0.022 1.11 COHORT1 = 1 si fue contratado antes de 1969, 0 en caso contrario -0.102 -4.84 COHORT2 = 1 si fue contratado entre 1969-1985, 0 en caso contrario -0.046 -3.48 FULLYEARS Número de años como profesor titular en UW 0.012 12.84 ASSOCYEARS Número de años como profesor asociado en UW -0.012 -8.65 ASSISYEARS Número de años como profesor asistente o instructor en UW 0.002 0.91 DIFYRS Número de años desde la obtención de un título terminal antes de llegar a UW 0.004 4.46 MRKTRATIO Logaritmo natural de una ‘razón de mercado’ definida como la razón del sueldo promedio en instituciones pares para una disciplina y rango dado 0.665 7.64 Fuente: “Estudio de Equidad de Género en los Sueldos del Personal Académico”, 5 de junio de 1992, Universidad de Wisconsin en Madison. Tabla 6.10: Tabla ANOVA de Sueldos del Personal Fuente Suma de Cuadrados \\(df\\) Cuadrado Medio \\(F\\)-Ratio Regresión 114.048 109 1.0463 62.943 Error 29.739 1789 0.0166 Total 143.788 1898 Suponga que una miembro femenina de la facultad en el departamento de química siente que su sueldo está por debajo de lo que debería ser. Describa brevemente cómo se puede utilizar este estudio como base para la evaluación del rendimiento. Basado en este estudio, ¿cree que los sueldos de las mujeres son significativamente más bajos que los de los hombres? b(i). Cite argumentos estadísticos que apoyen el hecho de que los hombres no reciben un sueldo significativamente más alto que las mujeres. b(ii). Cite argumentos estadísticos que apoyen el hecho de que los hombres reciben un sueldo significativamente más alto que las mujeres. b(iii). Suponga que decide que las mujeres ganan menos que los hombres. Basado en este estudio, ¿cuánto aumentaría los sueldos de las miembros femeninas de la facultad para igualarlos con los de sus contrapartes masculinas? 6.8 Suplementos Técnicos para el Capítulo 6 6.8.1 Efectos de la Especificación Incorrecta del Modelo Notación. Particiona la matriz de variables explicativas \\(\\mathbf{X}\\) en dos submatrices, cada una con \\(n\\) filas, de modo que \\(\\mathbf{X}=(\\mathbf{X}_{1} : \\mathbf{X}_{2})\\). Para simplificar, supongamos que \\(\\mathbf{X}_{1}\\) es una matriz de \\(n \\times p\\). De manera similar, particiona el vector de parámetros \\(\\boldsymbol \\beta =\\left( \\boldsymbol \\beta_{1}^{\\prime }, \\boldsymbol \\beta_{2}^{\\prime }\\right) ^{\\prime }\\) de manera que \\(\\mathbf{X \\boldsymbol \\beta }=\\mathbf{X}_{1} \\boldsymbol \\beta_{1}+ \\mathbf{X}_{2} \\boldsymbol \\beta_{2}\\). Comparamos el modelo completo, o “largo”, \\[ \\mathbf{y}=\\mathbf{X \\boldsymbol \\beta }+\\boldsymbol \\varepsilon = \\mathbf{X}_{1} \\boldsymbol \\beta_{1}+\\mathbf{X}_{2} \\boldsymbol \\beta_{2}+\\boldsymbol \\varepsilon \\] con el modelo reducido, o “corto”, \\[ \\mathbf{y}=\\mathbf{X}_{1} \\boldsymbol \\beta_{1}+\\boldsymbol \\varepsilon. \\] Esto simplemente generaliza la configuración anterior para permitir la omisión de varias variables. Efecto del Subajuste. Supongamos que la representación verdadera es el modelo largo pero accidentalmente ejecutamos el modelo corto. Nuestras estimaciones de parámetros al ejecutar el modelo corto están dadas por \\(\\mathbf{b}_{1}=\\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\mathbf{y}\\). Estas estimaciones están sesgadas porque \\[ \\begin{array}{ll} \\text{Sesgo} &amp;= \\text{E }\\mathbf{b}_{1}-\\boldsymbol \\beta_{1} = \\text{E}\\mathbf{(X}_{1}^{\\prime}\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\mathbf{y} -\\boldsymbol \\beta_{1} \\\\ &amp;= \\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\text{E }\\mathbf{y}-\\boldsymbol \\beta_{1} \\\\ &amp;= \\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\left( \\mathbf{X}_{1}\\boldsymbol \\beta_{1}+\\mathbf{X}_{2}\\boldsymbol \\beta_{2}\\right) - \\boldsymbol \\beta_{1} \\\\ &amp;= \\mathbf{(X}_{1}^{\\prime}\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\mathbf{X}_{2}\\boldsymbol \\beta_{2} = \\mathbf{A \\boldsymbol \\beta }_{2}. \\end{array} \\] Aquí, \\(\\mathbf{A}=\\mathbf{(X}_{1}^{\\prime}\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\mathbf{X}_{2}\\) se llama la matriz de alias, o matriz de sesgo. Al ejecutar el modelo corto, la varianza estimada es \\(s_{1}^{2}=(\\mathbf{y}^{\\prime }\\mathbf{y}-\\mathbf{b}_{1}^{\\prime }\\mathbf{X}_{1}^{\\prime }\\mathbf{y})/(n-p)\\). Se puede mostrar que \\[\\begin{equation} \\text{E }s_{1}^{2}=\\sigma ^{2}+(n-p)^{-1}\\boldsymbol \\beta_{2}^{\\prime }\\left( \\mathbf{X}_{2}^{\\prime }\\mathbf{X}_{2}-\\mathbf{X}_{2}^{\\prime }\\mathbf{X}_{1}\\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\mathbf{X}_{2}\\right) \\boldsymbol \\beta_{2}. \\tag{6.3} \\end{equation}\\] Así, \\(s_{1}^{2}\\) es una estimación “sobresesgada” de \\(\\sigma ^{2}\\). Sean \\(\\mathbf{x}_{1i}^{\\prime }\\) y \\(\\mathbf{x}_{2i}^{\\prime }\\) las \\(i\\)-ésimas filas de \\(\\mathbf{X}_{1}\\) y \\(\\mathbf{X}_{2}\\), respectivamente. Usando el modelo corto ajustado, el \\(i\\)-ésimo valor ajustado es \\(\\hat{y}_{1i}=\\mathbf{x}_{1i}^{\\prime }\\mathbf{b}_{1}\\). La verdadera respuesta esperada \\(i\\)-ésima es E \\(\\hat{y}_{1i}=\\mathbf{x}_{1i}^{\\prime } \\boldsymbol \\beta_{1} + \\mathbf{x}_{2i}^{\\prime } \\boldsymbol \\beta_{2}\\). Así, el sesgo del \\(i\\)-ésimo valor ajustado es \\[ \\begin{array}{ll} \\text{Sesgo}(\\hat{y}_{1i}) &amp;= \\text{E }\\hat{y}_{1i}-\\text{E }y_{i}=\\mathbf{x}_{1i}^{\\prime }\\text{E }\\mathbf{b}_{1}-\\left( \\mathbf{x}_{1i}^{\\prime }\\boldsymbol \\beta_{1}+\\mathbf{x}_{2i}^{\\prime } \\boldsymbol \\beta_{2}\\right) \\\\ &amp; =\\mathbf{x}_{1i}^{\\prime }(\\boldsymbol \\beta_{1}+\\mathbf{A \\boldsymbol \\beta }_{2})-\\left( \\mathbf{x}_{1i}^{\\prime }\\boldsymbol \\beta_{1}+\\mathbf{x}_{2i}^{\\prime }\\boldsymbol \\beta_{2}\\right) =(\\mathbf{x}_{1i}^{\\prime }\\mathbf{A}-\\mathbf{x}_{2i}^{\\prime })\\boldsymbol \\beta_{2}. \\end{array} \\] Usando esto y la ecuación (6.3), se muestra mediante álgebra directa que \\[\\begin{equation} \\text{E }s_{1}^{2}=\\sigma ^{2}+(n-p)^{-1}\\sum_{i=1}^{n}(\\text{Sesgo}(\\hat{y}_{1i}))^{2}. \\tag{6.4} \\end{equation}\\] Efecto del Sobreajuste. Supongamos ahora que la representación verdadera es el modelo corto, pero accidentalmente usamos el modelo largo. Con la matriz de alias \\(\\mathbf{A}=\\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\mathbf{X}_{2}\\), podemos reparametrizar el modelo largo \\[ \\begin{array}{ll} \\mathbf{y} &amp; =\\mathbf{X}_{1}\\boldsymbol \\beta_{1}+\\mathbf{X}_{2}\\boldsymbol \\beta_{2} + \\boldsymbol \\varepsilon = \\mathbf{X}_{1}\\left( \\boldsymbol \\beta_{1}+\\mathbf{A \\boldsymbol \\beta }_{2}\\right) + \\mathbf{E}_{1}\\boldsymbol \\beta_{2} + \\boldsymbol \\varepsilon \\\\ &amp;= \\mathbf{X}_{1}\\boldsymbol \\alpha_{1}+\\mathbf{E}_{1}\\boldsymbol \\beta_{2} + \\boldsymbol \\varepsilon \\end{array} \\] donde \\(\\mathbf{E}_{1}=\\mathbf{X}_{2}-\\mathbf{X}_{1}\\mathbf{A}\\) y \\(\\boldsymbol \\alpha_{1}=\\boldsymbol \\beta_{1}+\\mathbf{A \\boldsymbol \\beta}_{2}\\). La ventaja de esta nueva parametrización es que \\(\\mathbf{X}_{1}\\) es ortogonal a \\(\\mathbf{E}_{1}\\) porque \\(\\mathbf{X}_{1}^{\\prime }\\mathbf{E}_{1}=\\mathbf{X}_{1}^{\\prime }(\\mathbf{X}_{2}-\\mathbf{X}_{1}\\mathbf{A})=\\mathbf{0}\\). Con \\(\\mathbf{X}^{\\ast }=(\\mathbf{X}_{1}: \\mathbf{E}_{1})\\) y \\(\\boldsymbol \\alpha =(\\boldsymbol \\alpha_{1}^{\\prime }\\boldsymbol \\beta_{1}^{\\prime })^{\\prime }\\), el vector de estimaciones de mínimos cuadrados es \\[ \\begin{array}{ll} \\mathbf{a} &amp;= \\begin{bmatrix} \\mathbf{a}_{1} \\\\ \\mathbf{b}_{1} \\end{bmatrix} = \\left( \\mathbf{X}^{\\ast \\prime }\\mathbf{X}^{\\ast }\\right) ^{-1}\\mathbf{X}^{\\ast \\prime }\\mathbf{y} \\\\ &amp; = \\begin{bmatrix} \\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1} &amp; 0 \\\\ 0 &amp; \\mathbf{(E}_{1}^{\\prime }\\mathbf{E}_{1}\\mathbf{)}^{-1} \\end{bmatrix} \\begin{bmatrix} \\mathbf{X}_{1}^{\\prime }\\mathbf{y} \\\\ \\mathbf{E}_{1}^{\\prime }\\mathbf{y} \\end{bmatrix} \\\\ &amp; = \\begin{bmatrix} \\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\mathbf{y} \\\\ \\mathbf{(E}_{1}^{\\prime }\\mathbf{E}_{1}\\mathbf{)}^{-1}\\mathbf{E}_{1}^{\\prime }\\mathbf{y} \\end{bmatrix}. \\end{array} \\] Desde el modelo verdadero (corto), \\(\\mathrm{E}~\\mathbf{y}=\\mathbf{X}_{1}\\boldsymbol \\beta_{1}\\), tenemos que \\[ \\mathrm{E}~\\mathbf{b}_{2} =(\\mathbf{E}_{1}^{\\prime }\\mathbf{E}_{1})^{-1}\\mathbf{E}_{1}^{\\prime }\\mathrm{E}(\\mathbf{y}) =(\\mathbf{E}_{1}^{\\prime }\\mathbf{E}_{1})^{-1}\\mathbf{E}_{1}^{\\prime }\\mathrm{E}~ (\\mathbf{X}_{1}\\mathbf{\\beta}_{1}) =\\mathbf{0}, \\] porque \\(\\mathbf{X}_{1}^{\\prime }\\mathbf{E}_{1}=\\mathbf{0}\\). La estimación de mínimos cuadrados de \\(\\boldsymbol \\beta_{1}\\) es \\(\\mathbf{b}_{1}=\\mathbf{a}_{1}-\\mathbf{Ab}_{2}\\). Debido a que \\[ \\mathrm{E}~\\mathbf{a}_{1}=\\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\mathrm{E}~\\mathbf{y}=\\boldsymbol \\beta_{1} \\] bajo el modelo corto, tenemos que \\(\\mathrm{E}~ \\mathbf{b}_{1} = \\mathrm{E}~ \\mathbf{a}_{1}-\\mathbf{A} \\mathrm{E}~ \\mathbf{b}_{2} = \\boldsymbol \\beta_{1}-\\mathbf{0}=\\boldsymbol \\beta_{1}\\). Así, aunque accidentalmente usemos el modelo largo, \\(\\mathbf{b}_{1}\\) sigue siendo un estimador no sesgado de \\(\\boldsymbol \\beta_{1}\\) y \\(\\mathbf{b}_{2}\\) es un estimador no sesgado de \\(\\mathbf{0}\\). Por lo tanto, no hay sesgo en el valor ajustado \\(i\\)-ésimo porque \\[ \\mathrm{E}~\\hat{y}_{i}= \\mathrm{E}~(\\mathbf{x}_{1i}^{\\prime }\\mathbf{b}_{1}+\\mathbf{x}_{2i}^{\\prime }\\mathbf{b}_{2})=\\mathbf{x}_{1i}^{\\prime }\\boldsymbol \\beta_{1}= \\mathrm{E}~y_{i} . \\] Estadístico \\(C_{p}\\). Supongamos inicialmente que la representación verdadera es el modelo largo, pero usamos erróneamente el modelo corto. El valor ajustado \\(i\\)-ésimo es \\(\\hat{y}_{1i}=\\mathbf{x}_{1i}^{\\prime }\\mathbf{b}_{1}\\), que tiene un error cuadrático medio (MSE) \\[ \\text{MSE }\\hat{y}_{1i} = \\text{E}(\\hat{y}_{1i} - \\text{E }\\hat{y}_{1i})^{2} = \\text{Var }\\hat{y}_{1i} + \\left( \\text{Bias }\\hat{y}_{1i} \\right)^{2}. \\] Para la primera parte, tenemos que \\[ \\begin{array}{ll} \\mathrm{Var}~\\hat{y}_{1i}&amp; =\\mathrm{Var}\\left( \\mathbf{x}_{1i}^{\\prime }\\mathbf{b}_{1}\\right) = \\text{Var} \\left( \\mathbf{x}_{1i}^{\\prime } \\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1}\\mathbf{X}_{1}^{\\prime }\\mathbf{y}\\right) \\\\ &amp; = \\sigma^{2} \\mathbf{x}_{1i} \\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1} \\mathbf{x}_{1i}^{\\prime }. \\end{array} \\] Podemos pensar en \\(\\mathbf{x}_{1i} \\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1} \\mathbf{x}_{1i}^{\\prime }\\) como la palanca \\(i\\)-ésima, como en la ecuación (5.3). Así, \\(\\sum_{i=1}^{n} \\mathbf{x}_{1i} \\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1} \\mathbf{x}_{1i}^{\\prime } = p\\), el número de columnas de \\(\\mathbf{X}_{1}\\). Con esto, podemos definir el error total estandarizado \\[ \\begin{array}{ll} \\frac{\\sum_{i=1}^{n} \\text{MSE }\\hat{y}_{1i}}{\\sigma^{2}} &amp; = \\frac{\\sum_{i=1}^{n} \\left( \\text{Var }\\hat{y}_{1i} + \\left( \\text{Bias }\\hat{y}_{1i} \\right)^{2} \\right)}{\\sigma^{2}} \\\\ &amp; = \\frac{\\sigma^{2} \\sum_{i=1}^{n} \\left( \\mathbf{x}_{1i} \\mathbf{(X}_{1}^{\\prime }\\mathbf{X}_{1}\\mathbf{)}^{-1} \\mathbf{x}_{1i}^{\\prime } + \\left( \\text{Bias }\\hat{y}_{1i} \\right)^{2} \\right)}{\\sigma^{2}} \\\\ &amp;= p + \\sigma^{-2} \\sum_{i=1}^{n} \\left( \\text{Bias }\\hat{y}_{1i} \\right)^{2}. \\end{array} \\] Ahora, si \\(\\sigma^{2}\\) es conocido, a partir de la ecuación (6.4), una estimación no sesgada del error total estandarizado es \\(p + \\frac{(n-p)(s_{1}^{2} - \\sigma^{2})}{\\sigma^{2}}\\). Como \\(\\sigma^{2}\\) es desconocido, debe estimarse. Si no estamos seguros de si el modelo largo o el corto es la representación apropiada, una opción conservadora es usar \\(s^{2}\\) del modelo largo, o completo. Incluso si el modelo corto es el verdadero, \\(s^{2}\\) del modelo largo sigue siendo una estimación no sesgada de \\(\\sigma^{2}\\). Así, definimos \\[ C_{p} = p + \\frac{(n-p)(s_{1}^{2} - s^{2})}{s^{2}}. \\] Si el modelo corto es correcto, entonces \\(\\mathrm{E}~s_{1}^{2} = \\mathrm{E}~s^{2} = \\sigma^{2}\\) y \\(\\mathrm{E}~C_{p} \\approx p\\). Si el modelo largo es verdadero, entonces \\(\\mathrm{E}~s_{1}^{2} &gt; \\sigma^{2}\\) y \\(\\mathrm{E}~C_{p} &gt; p\\). "],["chap-7.html", "Chapter 7 Chap 7", " Chapter 7 Chap 7 "],["chap-8.html", "Chapter 8 Chap 8", " Chapter 8 Chap 8 "],["chap-9.html", "Chapter 9 Chap 9", " Chapter 9 Chap 9 "],["chap-10.html", "Chapter 10 Chap 10", " Chapter 10 Chap 10 "],["C11Binary.html", "Chapter 11 Variables Dependientes Categóricas 11.1 Variables Dependientes Binarias 11.2 Modelos de Regresión Logística y Probit 11.3 Inferencia para Modelos de Regresión Logística y Probit 11.4 Aplicación: Gastos Médicos 11.5 Variables Dependientes Nominales 11.6 Variables Dependientes Ordinales 11.7 Lecturas Adicionales y Referencias 11.8 Ejercicios 11.9 Suplementos Técnicos - Inferencia Basada en Verosimilitud", " Chapter 11 Variables Dependientes Categóricas Vista Previa del Capítulo. Un modelo con una variable dependiente categórica permite predecir si una observación pertenece a un grupo o categoría distinta. Las variables binarias representan un caso especial importante; pueden indicar si un evento de interés ha ocurrido o no. En aplicaciones actuariales y financieras, el evento puede ser si ocurre un siniestro, si una persona compra un seguro, si una persona se jubila o si una empresa se vuelve insolvente. Este capítulo introduce los modelos de regresión logística y probit para variables dependientes binarias. Las variables categóricas también pueden representar más de dos grupos, conocidos como resultados multicategoría. Las variables multicategoría pueden estar desordenadas o ordenadas, dependiendo de si tiene sentido clasificar los resultados de la variable. Para los resultados desordenados, conocidos como variables nominales, el capítulo introduce los modelos de logits generalizados y logit multinomial. Para los resultados ordenados, conocidos como variables ordinales, el capítulo introduce los modelos de logit acumulativo y probit. 11.1 Variables Dependientes Binarias Ya hemos introducido las variables binarias como un tipo especial de variable discreta que puede utilizarse para indicar si un sujeto tiene una característica de interés, como el sexo de una persona o la propiedad de una empresa de seguros cautiva por parte de una firma. Las variables binarias también describen si ha ocurrido o no un evento de interés, como un accidente. Un modelo con una variable dependiente binaria permite predecir si ha ocurrido un evento o si un sujeto tiene una característica de interés. Ejemplo: Gastos MEPS. La Sección 11.4 describirá una extensa base de datos de la Encuesta del Panel de Gastos Médicos (MEPS, por sus siglas en inglés) sobre la utilización y los gastos de hospitalización. Para estos datos, consideraremos \\[ y_i = \\left\\{ \\begin{array}{ll} 1 &amp; \\text{la i-ésima persona fue hospitalizada durante el período de la muestra} \\\\ 0 &amp; \\text{de lo contrario} \\end{array} \\right. . \\] Hay \\(n=2,000\\) personas en esta muestra, distribuidas de la siguiente manera: Tabla 11.1: Hospitalización por Sexo Hombres Mujeres No hospitalizado \\(y=0\\) 902 (95.3%) 941 (89.3%) Hospitalizado \\(y=1\\) 44 (4.7%) 113 (10.7%) Total 946 1,054 Código R para Generar la Tabla 11.1 Hexpend &lt;- read.csv(&quot;CSVData/HealthExpend.csv&quot;, header=TRUE) # Tabla 11.1 POSEXP = 1*(Hexpend$EXPENDIP&gt;0) #table(POSEXP) #table(Hexpend$GENDER) #Hmisc::summarize(POSEXP, Hexpend$GENDER, mean) row1 &lt;- c(&quot;No hospitalizado&quot; , &quot;$y=0$&quot; , &quot;902 (95.3%)&quot; , &quot;941 (89.3%)&quot; ) row2 &lt;- c(&quot;Hospitalizado&quot; , &quot;$y=1$ &quot;, &quot;44 (4.7%)&quot; , &quot;113 (10.7%)&quot; ) row3 &lt;- c(&quot;Total&quot; , &quot;&quot;, &quot;946&quot; , &quot;1,054&quot; ) tableout &lt;- rbind(row1, row2, row3) row.names(tableout) &lt;- NULL colnames(tableout) &lt;- c(&quot;&quot;, &quot;&quot;, &quot;Hombres&quot;, &quot;Mujeres&quot;) TableGen1(TableData=tableout, TextTitle=&#39;Hospitalización por Sexo&#39;, Align=&#39;lccc&#39;, ColumnSpec=1:3, ColWidth = &quot;3cm&quot;) %&gt;% kableExtra::column_spec(1, width = &quot;4cm&quot;) La Tabla 11.1 sugiere que el sexo tiene una influencia importante sobre si una persona se hospitaliza. Al igual que con las técnicas de regresión lineal introducidas en capítulos anteriores, estamos interesados en usar las características de una persona, como su edad, sexo, educación, ingresos y estado de salud previo, para ayudar a explicar la variable dependiente \\(y\\). A diferencia de los capítulos anteriores, ahora la variable dependiente es discreta y no sigue una distribución normal, ni siquiera de manera aproximada. En circunstancias limitadas, la regresión lineal puede usarse con variables dependientes binarias; esta aplicación se conoce como un modelo de probabilidad lineal. Modelos de Probabilidad Lineal Para introducir algunas de las complejidades que se encuentran con variables dependientes binarias, denotemos la probabilidad de que la respuesta sea igual a 1 como \\(\\pi_i= \\mathrm{Pr}(y_i=1)\\). Una variable aleatoria binaria tiene una distribución de Bernoulli. Por lo tanto, podemos interpretar la respuesta media como la probabilidad de que la respuesta sea uno, es decir, \\(\\mathrm{E~}y_i=0\\times \\mathrm{Pr}(y_i=0) + 1 \\times \\mathrm{Pr}(y_i=1) = \\pi_i\\). Además, la varianza está relacionada con la media a través de la expresión \\(\\mathrm{Var}~y_i = \\pi_i(1-\\pi_i)\\). Comenzamos considerando un modelo lineal de la forma \\[ y_i = \\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta + \\varepsilon_i, \\] conocido como modelo de probabilidad lineal. Asumiendo \\(\\mathrm{E~}\\varepsilon_i=0\\), tenemos que \\(\\mathrm{E~}y_i=\\mathbf{x}_i^{\\mathbf{\\prime }} \\boldsymbol \\beta =\\pi_i\\). Dado que \\(y_i\\) tiene una distribución de Bernoulli, \\(\\mathrm{Var}~y_i=\\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta(1-\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta)\\). Los modelos de probabilidad lineal se utilizan debido a la facilidad de interpretación de los parámetros. Para conjuntos de datos grandes, la simplicidad computacional de los estimadores de mínimos cuadrados ordinarios es atractiva en comparación con algunos modelos no lineales más complejos que se introducen más adelante en este capítulo. Como se describió en el Capítulo 3, los estimadores de mínimos cuadrados ordinarios para \\(\\boldsymbol \\beta\\) tienen propiedades deseables. Es sencillo comprobar que los estimadores son consistentes y asintóticamente normales bajo condiciones moderadas sobre las variables explicativas {\\(\\mathbf{x}_i\\)}. Sin embargo, los modelos de probabilidad lineal tienen varios inconvenientes que son graves en muchas aplicaciones. Desventajas del Modelo de Probabilidad Lineal Los valores ajustados pueden ser inadecuados. La respuesta esperada es una probabilidad y, por lo tanto, debe variar entre 0 y 1. Sin embargo, la combinación lineal, \\(\\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta\\), puede variar entre infinito negativo y positivo. Esta desproporción implica, por ejemplo, que los valores ajustados pueden ser poco razonables. Heterocedasticidad. Los modelos lineales suponen homocedasticidad (varianza constante), pero la varianza de la respuesta depende de la media, que varía entre las observaciones. El problema de la variabilidad cambiante se conoce como heterocedasticidad. El análisis de los residuos no tiene sentido. La respuesta debe ser 0 o 1, aunque los modelos de regresión generalmente consideran la distribución del término de error como continua. Esta desproporción implica, por ejemplo, que el análisis usual de los residuos en los modelos de regresión no tiene sentido. Para manejar el problema de la heterocedasticidad, es posible un procedimiento de mínimos cuadrados ponderados (en dos etapas). En la primera etapa, se usan mínimos cuadrados ordinarios para calcular estimaciones de \\(\\boldsymbol \\beta\\). Con esta estimación, se puede calcular una varianza estimada para cada sujeto utilizando la relación \\(\\mathrm{Var}~y_i=\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta (1-\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta)\\). En la segunda etapa, se realiza un ajuste de mínimos cuadrados ponderados utilizando el inverso de las varianzas estimadas como ponderaciones para obtener nuevas estimaciones de \\(\\boldsymbol \\beta\\). Es posible iterar este procedimiento, aunque estudios han demostrado que tiene pocas ventajas hacerlo (ver Carroll y Ruppert, 1988). Alternativamente, se pueden usar estimadores de mínimos cuadrados ordinarios de \\(\\boldsymbol \\beta\\) con errores estándar robustos a la heterocedasticidad (ver Sección 5.7.2). 11.2 Modelos de Regresión Logística y Probit 11.2.1 Uso de Funciones No Lineales de Variables Explicativas Para evitar las desventajas de los modelos de probabilidad lineal, consideramos modelos alternativos en los que expresamos la expectativa de la respuesta como una función de las variables explicativas, \\(\\pi_i=\\mathrm{\\pi }(\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta)\\) \\(=\\Pr (y_i=1|\\mathbf{x}_i)\\). Nos centramos en dos casos especiales de la función \\(\\mathrm{\\pi }(\\cdot)\\): \\(\\mathrm{\\pi }(z)=\\frac{1}{1+\\exp (-z)}=\\frac{e^{z}}{1+e^{z}}\\), el caso logit, y \\(\\mathrm{\\pi }(z)=\\mathrm{\\Phi }(z)\\), el caso probit. Aquí, \\(\\mathrm{\\Phi }(\\cdot)\\) es la función de distribución normal estándar. La elección de la función identidad (un tipo especial de función lineal), \\(\\mathrm{\\pi }(z)=z\\), da lugar al modelo de probabilidad lineal. En cambio, \\(\\mathrm{\\pi}\\) es no lineal tanto en el caso logit como en el probit. Estas dos funciones son similares en el sentido de que están casi linealmente relacionadas en el intervalo \\(0.1le ple 0.9\\). Así que, en gran medida, la elección de la función depende de las preferencias del analista. La Figura 11.1 compara las funciones logit y probit, mostrando que será difícil distinguir entre las dos especificaciones en la mayoría de los conjuntos de datos. La inversa de la función, \\(\\mathrm{\\pi }^{-1}\\), especifica la forma de la probabilidad que es lineal en las variables explicativas, es decir, \\(\\mathrm{\\pi }^{-1}(\\pi_i)= \\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta\\). En el Capítulo 13, nos referimos a esta inversa como la función de enlace. Figura 11.1: Comparación de la Distribución Logit y Probit (Normal Estándar) Ejemplo: Puntuación de Crédito. Los bancos, las agencias de crédito y otras instituciones financieras desarrollan “puntuaciones de crédito” para individuos que se utilizan para predecir la probabilidad de que el prestatario reembolse sus deudas actuales y futuras. Se dice que las personas que no cumplen con los plazos de pago estipulados en un acuerdo de préstamo están en “incumplimiento”. Una puntuación de crédito es entonces una probabilidad predicha de estar en incumplimiento, utilizando la información de la solicitud de crédito como variables explicativas para desarrollar la puntuación. La elección de las variables explicativas depende del propósito de la solicitud; la puntuación de crédito se usa tanto para emitir tarjetas de crédito para pequeñas compras de consumo como para solicitudes de hipotecas de casas multimillonarias. En la Tabla 11.2, Hand y Henley (1997) proporcionan una lista de características típicas que se utilizan en la puntuación de crédito. Tabla 11.2. Características Utilizadas en Algunos Procedimientos de Puntuación de Crédito \\[ \\small{ \\begin{array}{ll} \\hline \\textbf{Características} &amp; \\textbf{Valores Potenciales} \\\\ \\hline \\text{Tiempo en la dirección actual} &amp; \\text{0-1, 1-2, 3-4, 5+ años}\\\\ \\text{Estado de la vivienda} &amp; \\text{Propietario, inquilino, otro }\\\\ \\text{Código postal} &amp; \\text{Rango A, B, C, D, E} \\\\ \\text{Teléfono} &amp; \\text{Sí, no} \\\\ \\text{Ingresos anuales del solicitante} &amp; \\text{£ (0-10000),} \\text{£ (10,000-20,000)} \\text{£ (20,000+)} \\\\ \\text{Tarjeta de crédito} &amp; \\text{Sí, no} \\\\ \\text{Tipo de cuenta bancaria} &amp; \\text{Corriente y/o ahorro, ninguna} \\\\ \\text{Edad }&amp; \\text{18-25, 26-40, 41-55, 55+ años} \\\\ \\text{Juicios del Tribunal del Condado} &amp; \\text{Número} \\\\ \\text{Tipo de ocupación} &amp; \\text{Codificado} \\\\ \\text{Propósito del préstamo} &amp; \\text{Codificado} \\\\ \\text{Estado civil} &amp; \\text{Casado, divorciado, soltero, viudo, otro} \\\\ \\text{Tiempo con el banco} &amp; \\text{Años} \\\\ \\text{Tiempo con el empleador} &amp; \\text{Años }\\\\ \\hline \\textit{Fuente}: \\text{Hand y Henley (1997)} \\\\ \\end{array} } \\] Con la información de la solicitud de crédito y la experiencia de incumplimiento, se puede utilizar un modelo de regresión logística para ajustar la probabilidad de incumplimiento con puntuaciones de crédito derivadas de los valores ajustados. Wiginton (1980) proporciona una de las primeras aplicaciones de la regresión logística a la puntuación de crédito de consumidores. En ese momento, otros métodos estadísticos conocidos como análisis discriminante estaban a la vanguardia de las metodologías de puntuación cuantitativa. En su artículo de revisión, Hand y Henley (1997) discuten otros competidores de la regresión logística, incluidos los sistemas de aprendizaje automático y las redes neuronales. Como señalan Hand y Henley, no existe un “mejor” método de manera uniforme. Las técnicas de regresión son importantes por sí mismas debido a su uso generalizado y porque pueden proporcionar una plataforma para aprender sobre métodos más nuevos. Las puntuaciones de crédito estiman la probabilidad de incumplimiento en préstamos, pero los emisores de crédito también están interesados en la cantidad y el momento del pago de la deuda. Por ejemplo, un “buen” riesgo puede pagar un saldo de crédito tan rápidamente que el prestamista obtiene pocas ganancias. Además, un mal riesgo hipotecario puede incumplir un préstamo tan tarde en el contrato que el prestamista ya ha ganado suficiente ganancia. Véase Gourieroux y Jasiak (2007) para una discusión amplia sobre cómo el modelado de crédito puede usarse para evaluar el riesgo y la rentabilidad de los préstamos. 11.2.2 Interpretación del Umbral Tanto el caso logit como el probit se pueden interpretar de la siguiente manera. Supongamos que existe un modelo lineal subyacente, \\(y_i^{\\ast} = \\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta + \\varepsilon_i^{\\ast}\\). Aquí, no observamos la respuesta \\(y_i^{\\ast}\\), pero la interpretamos como la “propensión” a poseer una característica. Por ejemplo, podríamos pensar en la fortaleza financiera de una empresa de seguros como una medida de su propensión a volverse insolvente (incapaz de cumplir con sus obligaciones financieras). Bajo la interpretación del umbral, no observamos la propensión, pero sí observamos cuando la propensión cruza un umbral. Es habitual asumir que este umbral es 0, por simplicidad. Así, observamos \\[ y_i=\\left\\{ \\begin{array}{ll} 0 &amp; y_i^{\\ast}le 0 \\\\ 1 &amp; y_i^{\\ast}&gt;0 \\end{array} \\right. . \\] Para ver cómo se deriva el caso logit a partir del modelo del umbral, supongamos una función de distribución logística para las perturbaciones, de modo que \\[ \\mathrm{\\Pr }(\\varepsilon_i^{\\ast}le a)=\\frac{1}{1+\\exp (-a)}. \\] Al igual que la distribución normal, se puede verificar calculando la densidad que la distribución logística es simétrica alrededor de cero. Así, \\(-\\varepsilon_i^{\\ast}\\) tiene la misma distribución que \\(\\varepsilon_i^{\\ast}\\) y entonces \\[ \\pi_i=\\Pr (y_i=1|\\mathbf{x}_i)=\\mathrm{\\Pr }(y_i^{\\ast}&gt;0)=\\mathrm{ \\Pr }(\\varepsilon_i^{\\ast}le \\mathbf{x}_i^{\\mathbf{\\prime}}\\mathbf{ \\beta })=\\frac{1}{1+\\exp (-\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta)} =\\mathrm{\\pi }(\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta). \\] Esto establece la interpretación del umbral para el caso logit. El desarrollo para el caso probit es similar y se omite. 11.2.3 Interpretación de Utilidad Aleatoria Tanto el caso logit como el probit también se justifican apelando a la siguiente interpretación de “utilidad aleatoria” del modelo. En algunas aplicaciones económicas, los individuos seleccionan una de dos opciones. Aquí, las preferencias entre opciones están indexadas por una función de utilidad no observada; los individuos seleccionan la opción que les brinda mayor utilidad. Para el sujeto \\(i\\), utilizamos la notación \\(u_i\\) para esta función de utilidad. Modelamos la utilidad (\\(U\\)) como una función de un valor subyacente (\\(V\\)) más un ruido aleatorio (\\(\\varepsilon\\)), es decir, \\(U_{ij}=u_i(V_{ij}+\\varepsilon_{ij})\\), donde \\(j\\) puede ser 1 o 2, correspondiente a la elección. Para ilustrar, asumimos que el individuo elige la categoría correspondiente a \\(j=1\\) si \\(U_{i1}&gt;U_{i2}\\) y denotamos esta elección como \\(y_i=1\\). Asumiendo que \\(u_i\\) es una función estrictamente creciente, tenemos \\[\\begin{eqnarray*} \\Pr (y_i &amp;=&amp;1)=\\mathrm{\\Pr }(U_{i2}&lt;U_{i1})=\\mathrm{\\Pr }\\left( u_i(V_{i2}+\\varepsilon_{i2})&lt;u_i(V_{i1}+\\varepsilon_{i1})\\right) \\\\ &amp;=&amp;\\mathrm{\\Pr }(\\varepsilon_{i2}-\\varepsilon_{i1}&lt;V_{i1}-V_{i2}). \\end{eqnarray*}\\] Para parametrizar el problema, asumimos que el valor \\(V\\) es una combinación lineal desconocida de las variables explicativas. Específicamente, tomamos \\(V_{i2}=0\\) y \\(V_{i1}=\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta\\). Podemos asumir que la diferencia en los errores, \\(\\varepsilon_{i2}-\\varepsilon_{i1}\\), sigue una distribución normal o logística, correspondiente a los casos probit y logit, respectivamente. La distribución logística se cumple si asumimos que los errores tienen una distribución de valor extremo, o Gumbel (ver, por ejemplo, Amemiya, 1985). 11.2.4 Regresión Logística Una ventaja del caso logit es que permite expresiones en forma cerrada, a diferencia de la función de distribución normal. Regresión logística es otra frase utilizada para describir el caso logit. Usando \\(p=\\mathrm{\\pi }(z)= \\left( 1+ \\mathrm{e}^{-z}\\right)^{-1}\\), la inversa de \\(\\mathrm{\\pi }\\) se calcula como \\(z=\\mathrm{\\pi }^{-1}(p)=\\ln(p/(1-p))\\). Para simplificar presentaciones futuras, definimos \\[ \\mathrm{logit}(p)=\\ln \\left( \\frac{p}{1-p}\\right) \\] como la función logit. Con un modelo de regresión logística, representamos la combinación lineal de variables explicativas como el logit de la probabilidad de éxito, es decir, \\(\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta=\\mathrm{logit}(\\pi_i)\\). Interpretación de los Odds Cuando la respuesta \\(y\\) es binaria, conocer solo \\(p=\\Pr(y=1)\\) resume toda la distribución. En algunas aplicaciones, una simple transformación de \\(p\\) tiene una interpretación importante. El ejemplo más común de esto son los odds, dados por \\(p/(1-p)\\). Por ejemplo, supongamos que \\(y\\) indica si un caballo gana una carrera y \\(p\\) es la probabilidad de que el caballo gane. Si \\(p=0.25\\), entonces los odds de que el caballo gane son \\(0.25/(1.00-0.25)=0.3333\\). Podríamos decir que los odds de ganar son 0.3333 a 1, o de uno a tres. De manera equivalente, decimos que la probabilidad de no ganar es \\(1-p=0.75\\), de modo que los odds de que el caballo no gane son \\(0.75/(1-0.75)=3\\) y los odds en contra del caballo son tres a uno. Los odds tienen una interpretación útil desde el punto de vista de las apuestas. Supongamos que estamos jugando un juego justo y que hacemos una apuesta de 1 con odds de uno a tres. Si el caballo gana, entonces recuperamos nuestro 1 más una ganancia de 3. Si el caballo pierde, perdemos nuestra apuesta de 1. Es un juego justo en el sentido de que el valor esperado del juego es cero porque ganamos 3 con probabilidad \\(p=0.25\\) y perdemos 1 con probabilidad \\(1-p=0.75\\). Desde el punto de vista económico, los odds proporcionan los números importantes (apuesta de 1 y ganancia de 3), no las probabilidades. Por supuesto, si conocemos \\(p\\), siempre podemos calcular los odds. Del mismo modo, si conocemos los odds, siempre podemos calcular la probabilidad \\(p\\). El logit es la función logarítmica de los odds, también conocida como log-odds. Interpretación de la Razón de Momios Para interpretar los coeficientes de regresión en el modelo de regresión logística, \\(\\boldsymbol \\beta=(\\beta_0,\\ldots ,\\beta_{k})^{\\prime}\\), comenzamos asumiendo que la \\(j\\)-ésima variable explicativa, \\(x_{ij}\\), es 0 o 1. Entonces, con la notación \\(\\mathbf{x}_i=(x_{i0},...,x_{ij},\\ldots ,x_{ik})^{\\prime}\\), podemos interpretar \\[\\begin{eqnarray*} \\beta_j &amp;=&amp;(x_{i0},...,1,\\ldots ,x_{ik})^{\\prime}\\boldsymbol \\beta -(x_{i0},...,0,\\ldots ,x_{ik})^{\\prime}\\boldsymbol \\beta \\\\ &amp;=&amp;\\ln \\left( \\frac{\\Pr (y_i=1|x_{ij}=1)}{1-\\Pr (y_i=1|x_{ij}=1)}\\right) -\\ln \\left( \\frac{\\Pr (y_i=1|x_{ij}=0)}{1-\\Pr (y_i=1|x_{ij}=0)}\\right) \\end{eqnarray*}\\] Así, \\[ e^{\\beta_j}=\\frac{\\Pr (y_i=1|x_{ij}=1)/\\left( 1-\\Pr (y_i=1|x_{ij}=1)\\right) }{\\Pr (y_i=1|x_{ij}=0)/\\left( 1-\\Pr (y_i=1|x_{ij}=0)\\right) }. \\] Esto muestra que \\(e^{\\beta_j}\\) puede expresarse como la razón de dos momios, conocida como la razón de momios. Es decir, el numerador de esta expresión es el momio cuando \\(x_{ij}=1\\), mientras que el denominador es el momio cuando \\(x_{ij}=0\\). Así, podemos decir que el momio cuando \\(x_{ij}=1\\) es \\(\\exp (\\beta_j)\\) veces mayor que el momio cuando \\(x_{ij}=0\\). Para ilustrar, supongamos que \\(\\beta_j=0.693\\), de modo que \\(\\exp (\\beta _j)=2\\). A partir de esto, decimos que los momios (para \\(y=1\\)) son el doble para \\(x_{ij}=1\\) que para \\(x_{ij}=0\\). De manera similar, suponiendo que la \\(j\\)-ésima variable explicativa es continua (diferenciable), tenemos \\[\\begin{eqnarray} \\beta_j &amp;=&amp;\\frac{\\partial }{\\partial x_{ij}}\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta =\\frac{\\partial }{\\partial x_{ij}}\\ln \\left( \\frac{\\Pr (y_i=1|x_{ij})}{1-\\Pr (y_i=1|x_{ij})}\\right) \\nonumber \\\\ &amp;=&amp;\\frac{\\frac{\\partial }{\\partial x_{ij}}\\Pr (y_i=1|x_{ij})/\\left( 1-\\Pr (y_i=1|x_{ij})\\right) }{\\Pr (y_i=1|x_{ij})/\\left( 1-\\Pr (y_i=1|x_{ij})\\right) }. \\tag{11.1} \\end{eqnarray}\\] Así, podemos interpretar \\(\\beta_j\\) como el cambio proporcional en la razón de momios, conocido como elasticidad en economía. Ejemplo: Gastos MEPS - Continuación. La Tabla 11.1 muestra que el porcentaje de mujeres que fueron hospitalizadas es del \\(10.7\\%\\); alternativamente, el momio de que una mujer sea hospitalizada es \\(0.107/(1-0.107)=0.120\\). Para los hombres, el porcentaje es del \\(4.7\\%\\), de modo que el momio es \\(0.0493\\). La razón de momios es \\(0.120/0.0493=2.434\\); las mujeres tienen más del doble de probabilidad de ser hospitalizadas que los hombres. A partir de un ajuste de regresión logística (descrito en la Sección 11.4), el coeficiente asociado al sexo es \\(0.733\\). Con base en este modelo, decimos que las mujeres tienen \\(\\exp (0.733)=2.081\\) veces más probabilidad que los hombres de ser hospitalizadas. La estimación de regresión de la razón de momios controla por variables adicionales (como edad y educación) en comparación con el cálculo básico basado en frecuencias crudas. 11.3 Inferencia para Modelos de Regresión Logística y Probit 11.3.1 Estimación de Parámetros El método habitual de estimación para modelos logísticos y probit es el máxima verosimilitud, descrito con más detalle en la Sección 11.9. Para proporcionar una intuición, describimos las ideas en el contexto de los modelos de regresión con variables dependientes binarias. La verosimilitud es el valor observado de la función de probabilidad. Para una sola observación, la verosimilitud es \\[ \\left\\{ \\begin{array}{ll} 1-\\pi_i &amp; \\mathrm{si}\\ y_i=0 \\\\ \\pi_i &amp; \\mathrm{si}\\ y_i=1 \\end{array} \\right. . \\] El objetivo de la estimación de máxima verosimilitud es encontrar los valores de los parámetros que producen la mayor verosimilitud. Encontrar el máximo de la función logarítmica produce la misma solución que encontrar el máximo de la función correspondiente. Debido a que generalmente es más sencillo computacionalmente, consideramos la verosimilitud logarítmica (o log-verosimilitud), escrita como \\[\\begin{equation} \\left\\{ \\begin{array}{ll} \\ln \\left( 1-\\pi_i\\right) &amp; \\mathrm{si}\\ y_i=0 \\\\ \\ln \\pi_i &amp; \\mathrm{si}\\ y_i=1 \\end{array} \\right. . \\tag{11.2} \\end{equation}\\] De manera más compacta, la log-verosimilitud de una sola observación es \\[ y_i\\ln \\mathrm{\\pi }(\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta) + (1-y_i) \\ln \\left( 1-\\mathrm{\\pi }(\\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta)\\right) , \\] donde \\(\\pi_i=\\mathrm{\\pi }(\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta)\\). Asumiendo independencia entre las observaciones, la verosimilitud del conjunto de datos es un producto de las verosimilitudes de cada observación. Tomando logaritmos, la log-verosimilitud del conjunto de datos es la suma de las log-verosimilitudes de cada observación. La log-verosimilitud del conjunto de datos es \\[\\begin{equation} L(\\boldsymbol \\beta)=\\sum\\limits_{i=1}^{n}\\left\\{ y_i\\ln \\mathrm{\\pi }( \\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta) + (1-y_i) \\ln \\left( 1- \\mathrm{\\pi }(\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta)\\right) \\right\\} . \\tag{11.3} \\end{equation}\\] La log-verosimilitud se considera como una función de los parámetros, con los datos fijos. En contraste, la función de probabilidad conjunta se considera como una función de los datos realizados, con los parámetros fijos. El método de máxima verosimilitud consiste en encontrar los valores de \\(\\boldsymbol \\beta\\) que maximizan la log-verosimilitud. El método habitual para encontrar el máximo es tomar las derivadas parciales con respecto a los parámetros de interés y encontrar las raíces de las ecuaciones resultantes. En este caso, al tomar las derivadas parciales con respecto a \\(\\boldsymbol \\beta\\) se obtienen las ecuaciones de puntaje: \\[\\begin{equation} \\frac{\\partial }{\\partial \\boldsymbol \\beta}L(\\boldsymbol \\beta )=\\sum\\limits_{i=1}^{n}\\mathbf{x}_i\\left( y_i-\\mathrm{\\pi }(\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta)\\right) \\frac{\\mathrm{\\pi }^{\\prime}( \\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta)}{\\mathrm{\\pi }(\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta)(1-\\mathrm{\\pi }(\\mathbf{x}_i^{ \\mathbf{\\prime}}\\boldsymbol \\beta))}=\\mathbf{0}, \\tag{11.4} \\end{equation}\\] donde \\(\\pi^{\\prime}\\) es la derivada de \\(\\pi\\). La solución de estas ecuaciones, denotada como \\(\\mathbf{b}_{MLE}\\), es el estimador de máxima verosimilitud. Para la función logit, las ecuaciones de puntaje se reducen a \\[\\begin{equation} \\frac{\\partial }{\\partial \\boldsymbol \\beta}L(\\boldsymbol \\beta )=\\sum\\limits_{i=1}^{n}\\mathbf{x}_i\\left( y_i-\\mathrm{\\pi }(\\mathbf{x} _i^{\\mathbf{\\prime}}\\boldsymbol \\beta)\\right) =\\mathbf{0}, \\tag{11.5} \\end{equation}\\] donde \\(\\mathrm{\\pi }(z)=1/(1+\\exp (-z))\\). 11.3.2 Inferencia Adicional Un estimador de la varianza muestral grande de \\(\\boldsymbol \\beta\\) puede calcularse tomando las derivadas parciales de las ecuaciones de puntaje. Específicamente, el término \\[ \\mathbf{I}(\\boldsymbol \\beta) = - \\mathrm{E} \\left( \\frac{\\partial^2} {\\partial \\boldsymbol \\beta ~ \\partial \\boldsymbol \\beta ^{\\prime}}L(\\boldsymbol \\beta) \\right) \\] es la matriz de información. Como caso especial, usando la función logit y la ecuación (11.5), cálculos sencillos muestran que la matriz de información es \\[ \\mathbf{I}(\\boldsymbol \\beta) = \\sum\\limits_{i=1}^{n} \\sigma_i^2 \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\] donde \\(\\sigma_i^2 = \\mathrm{\\pi} (\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta) (1 - \\mathrm{\\pi}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta))\\). La raíz cuadrada del \\((j+1)\\)-ésimo elemento diagonal de esta matriz, evaluado en \\(\\boldsymbol \\beta = \\mathbf{b}_{MLE}\\), proporciona el error estándar de \\(b_{j,MLE}\\), denotado como \\(se(b_{j,MLE})\\). Para evaluar el ajuste general del modelo, es habitual citar estadísticos de prueba de razón de verosimilitud en modelos de regresión no lineales. Para probar la adecuación general del modelo \\(H_0:\\boldsymbol \\beta=\\mathbf{0}\\), utilizamos el estadístico \\[ LRT=2\\times (L(\\mathbf{b}_{MLE})-L_0), \\] donde \\(L_0\\) es la log-verosimilitud maximizada solo con el término de intercepto. Bajo la hipótesis nula \\(H_0\\), este estadístico tiene una distribución chi-cuadrado con \\(k\\) grados de libertad. La Sección 11.9.3 describe los estadísticos de prueba de razón de verosimilitud con mayor detalle técnico. Como se describe en la Sección 11.9, las medidas de bondad de ajuste pueden ser difíciles de interpretar en modelos no lineales. Una medida es el llamado \\(max-scaled~R^2\\), definido como \\(R_{ms}^2=R^2/R_{max}^2\\), donde \\[ R^2=1-\\left( \\frac{\\exp (L_0/n)}{\\exp (L(\\mathbf{b}_{MLE})/n)}\\right) \\] y \\(R_{max }^2 = 1 - \\exp(L_0/n)^2\\). Aquí, \\(L_0/n\\) representa el valor promedio de esta log-verosimilitud. Otra medida es un “pseudo-\\(R^2\\)” \\[ \\frac{L( \\mathbf{b}_{MLE}) - L_0}{L_{max}-L_0}, \\] donde \\(L_0\\) y \\(L_{max }\\) son la log-verosimilitud basada solo en un intercepto y en el máximo alcanzable, respectivamente. Al igual que el coeficiente de determinación, el pseudo-\\(R^2\\) toma valores entre cero y uno, con valores mayores que indican un mejor ajuste a los datos. Otras versiones del pseudo-\\(R^2\\) están disponibles en la literatura, véase, por ejemplo, Cameron y Trivedi (1998). Una ventaja de esta medida de pseudo-\\(R^2\\) es su relación con las pruebas de hipótesis de los coeficientes de regresión. Ejemplo: Seguridad Laboral. Valletta (1999) estudió la disminución de la seguridad laboral utilizando la base de datos de la Encuesta Panel de Dinámicas de Ingresos (PSID). Aquí consideramos uno de los modelos de regresión presentados por Valletta, basado en una muestra de jefes de hogar masculinos que consta de \\(n=24,168\\) observaciones durante los años 1976-1992, inclusive. La encuesta PSID registra las razones por las cuales los hombres dejaron su empleo más reciente, incluyendo cierres de planta, “renuncia” y cambios de trabajo por otras razones. Sin embargo, Valletta se centró en los despidos (“lay off” o “despedido”) porque las separaciones involuntarias están asociadas con la inseguridad laboral. Tabla 11.3 presenta un modelo de regresión probit realizado por Valletta (1999), utilizando los despidos como variable dependiente. Además de las variables explicativas enumeradas en Tabla 11.3, otras variables controladas incluyeron educación, estado civil, número de hijos, raza, años de experiencia laboral a tiempo completo y su cuadrado, afiliación sindical, empleo en el gobierno, salario logarítmico, la tasa de empleo en EE.UU. y ubicación según el área estadística metropolitana de residencia. En la Tabla 11.3, la antigüedad representa los años trabajados en la empresa actual. Además, el empleo en el sector fue medido examinando el empleo según la Encuesta de Precios al Consumidor en 387 sectores de la economía, basada en 43 categorías industriales y nueve regiones del país. Por un lado, el coeficiente de antigüedad revela que los trabajadores con más experiencia tienen menos probabilidades de ser despedidos. Por otro lado, el coeficiente asociado a la interacción entre antigüedad y la tendencia temporal revela una tasa creciente de despidos para los trabajadores con más experiencia. La interpretación de los coeficientes de empleo por sector también es de interés. Con una antigüedad promedio de aproximadamente 7.8 años en la muestra, vemos que los hombres con poca antigüedad no se ven muy afectados por los cambios en el empleo por sector. Sin embargo, para los hombres con más experiencia, hay una probabilidad creciente de despido asociada con los sectores de la economía donde el crecimiento disminuye. Tabla 11.3. Estimaciones de Regresión Probit para Despidos \\[ \\small{ \\begin{array}{lrr} \\hline \\textbf{Variable} &amp; \\textbf{Estimación del} &amp; \\textbf{Error} \\\\ &amp; \\textbf{Parámetro} &amp; \\textbf{Estándar} \\\\ \\hline \\text{Antigüedad} &amp; -0.084 &amp; 0.010 \\\\ \\text{Tendencia Temporal} &amp; -0.002 &amp; 0.005 \\\\ \\text{Antigüedad*(Tendencia Temporal)} &amp; 0.003 &amp; 0.001 \\\\ \\text{Cambio en el Empleo Logarítmico por Sector} &amp; 0.094 &amp; 0.057 \\\\ \\text{Antigüedad*(Cambio en el Empleo Logarítmico por Sector)} &amp; -0.020 &amp; 0.009 \\\\ \\hline \\text{-2 Log Verosimilitud} &amp; 7,027.8 &amp; \\\\ \\text{Pseudo}-R^2 &amp; 0.097 &amp; \\\\ \\hline \\end{array} } \\] 11.4 Aplicación: Gastos Médicos Esta sección considera datos de la Encuesta del Panel de Gastos Médicos (MEPS), realizada por la Agencia de Investigación y Calidad de la Salud de EE. UU. MEPS es una encuesta probabilística que proporciona estimaciones representativas a nivel nacional sobre el uso de atención médica, los gastos, las fuentes de pago y la cobertura de seguros para la población civil de EE. UU. Esta encuesta recoge información detallada sobre las personas y cada episodio de atención médica, por tipo de servicios, incluyendo visitas al consultorio del médico, visitas a la sala de emergencias del hospital, visitas ambulatorias al hospital, estancias hospitalarias, visitas a otros proveedores médicos y uso de medicamentos recetados. Esta información detallada permite desarrollar modelos de utilización de atención médica para predecir gastos futuros. Consideramos datos de MEPS del primer panel de 2003 y tomamos una muestra aleatoria de \\(n=2,000\\) individuos entre 18 y 65 años. Variable Dependiente Nuestra variable dependiente es un indicador de gastos positivos por admisiones hospitalarias. En MEPS, las admisiones hospitalarias incluyen personas que fueron admitidas en un hospital y pasaron la noche. En contraste, los eventos ambulatorios incluyen visitas al departamento ambulatorio del hospital, visitas a proveedores en consultorios y visitas a la sala de emergencias, excluyendo servicios dentales. (Los servicios dentales, en comparación con otros tipos de atención médica, son más predecibles y ocurren de manera más regular). Las estancias hospitalarias con la misma fecha de ingreso y alta, conocidas como “estancias de cero noches”, se incluyeron en los recuentos y gastos ambulatorios. Los pagos asociados con visitas a la sala de emergencias que precedieron inmediatamente a una estancia hospitalaria se incluyeron en los gastos hospitalarios. Los medicamentos recetados vinculados a admisiones hospitalarias se incluyeron en los gastos hospitalarios (no en la utilización ambulatoria). Variables Explicativas Las variables explicativas que pueden ayudar a explicar la utilización de atención médica se categorizan en factores demográficos, geográficos, de salud, educación y económicos. Los factores demográficos incluyen edad, sexo y etnia. A medida que las personas envejecen, la tasa a la que su salud se deteriora aumenta con la edad; como resultado, la edad tiene un impacto creciente en la demanda de atención médica. El sexo y la etnia pueden tratarse como aproximaciones de la herencia de salud y los hábitos sociales en el mantenimiento de la salud. Para un factor geográfico, usamos la región como una aproximación de la accesibilidad a los servicios de salud y del impacto económico o regional general en el comportamiento de atención médica de los residentes. Se piensa que la demanda de servicios médicos está influenciada por el estado de salud y la educación de las personas. En MEPS, la salud física y mental autoevaluada, y cualquier limitación funcional o relacionada con la actividad durante el período de la muestra, se utilizan como aproximaciones del estado de salud. La educación tiende a tener un impacto ambiguo en la demanda de servicios de atención médica. Una teoría es que las personas más educadas son más conscientes de los riesgos para la salud, por lo tanto, son más activas en el mantenimiento de su salud; como resultado, las personas educadas pueden ser menos propensas a enfermedades graves que conduzcan a hospitalizaciones. Otra teoría es que las personas con menos educación tienen mayor exposición a riesgos para la salud y, a través de esta exposición, desarrollan una mayor tolerancia a ciertos tipos de riesgos. En MEPS, la educación se aproxima por los títulos recibidos y se clasifica en tres niveles diferentes: menos que secundaria, secundaria, y universidad o superior. Las covariables económicas incluyen ingresos y cobertura de seguro. Una medida de ingresos en MEPS es el ingreso relativo al nivel de pobreza. Este enfoque es adecuado porque resume los efectos de los diferentes niveles de ingresos en la utilización de atención médica en dólares constantes. La cobertura de seguro también es una variable importante para explicar la utilización de atención médica. Un problema con la cobertura de seguro de salud es que reduce los precios pagados por los asegurados, lo que induce un riesgo moral. La investigación asociada con el Experimento de Seguro de Salud de Rand sugirió empíricamente que los efectos del costo compartido derivados de la cobertura de seguro afectarán principalmente el número de contactos médicos más que la intensidad de cada contacto. Esto motivó nuestra introducción de una variable binaria que toma el valor de 1 si una persona tuvo algún seguro público o privado durante al menos un mes, y 0 de lo contrario. Estadísticas Descriptivas Tabla 11.4 describe estas variables explicativas y proporciona estadísticas descriptivas que sugieren sus efectos sobre la probabilidad de gastos hospitalarios positivos. Por ejemplo, vemos que las mujeres tuvieron una mayor utilización general que los hombres. Específicamente, el 10.7% de las mujeres tuvo un gasto positivo durante el año en comparación con solo el 4.7% de los hombres. De manera similar, la utilización varía según otras covariables, lo que sugiere su importancia como predictores de los gastos. Tabla 11.4. Porcentaje de Gastos Positivos por Variable Explicativa \\[ \\scriptsize{ \\begin{array}{lllrr} \\hline &amp; &amp; &amp; \\textbf{Por-} &amp; \\textbf{Porcentaje} \\\\ \\textbf{Categoría} &amp; \\textbf{Variable} &amp; \\textbf{Descripción} &amp; \\textbf{centaje} &amp; \\textbf{Gastos} \\\\ &amp; &amp; &amp; \\textbf{de datos} &amp; \\textbf{Positivos} \\\\ \\hline \\text{Demografía} &amp; AGE &amp; \\text{Edad en años entre} \\\\ &amp; &amp; \\text{ 18 a 65 (media: 39.0)} \\\\ &amp; GENDER &amp; 1 \\text{si mujer} &amp; 52.7 &amp; 10.7 \\\\ &amp; &amp; \\text{0 si hombre} &amp; 47.3 &amp; 4.7\\\\ \\text{Etnia} &amp; ASIAN &amp; \\text{1 si asiático} &amp; 4.3 &amp; 4.7 \\\\ &amp; BLACK &amp; \\text{1 si negro} &amp; 14.8 &amp; 10.5 \\\\ &amp; NATIVE &amp; \\text{1 si nativo} &amp; 1.1 &amp; 13.6 \\\\ &amp; WHITE &amp; \\text{Nivel de referencia} &amp; 79.9 &amp; 7.5 \\\\ \\text{Región} &amp; NORTHEAST &amp; 1 \\text{si noreste} &amp; 14.3 &amp; 10.1 \\\\ &amp; MIDWEST &amp; 1 \\text{si medio oeste} &amp; 19.7 &amp; 8.7 \\\\ &amp; SOUTH &amp; 1 \\text{si sur} &amp; 38.2 &amp; 8.4 \\\\ &amp; WEST &amp; \\text{Nivel de referencia} &amp;27.9 &amp; 5.4 \\\\ \\hline \\text{Educación} &amp; \\text{COLLEGE} &amp; 1 \\text{si universidad o grado superior} &amp; 27.2 &amp; 6.8 \\\\ &amp; HIGHSCHOOL &amp; 1 \\text{si grado de secundaria} &amp; 43.3 &amp; 7.9\\\\ &amp; \\text{Nivel de referencia } &amp; &amp; 29.5 &amp; 8.8\\\\ &amp; \\text{ es menor que grado} &amp; &amp; \\\\ &amp; \\text{ de secundaria} &amp; &amp; \\\\ \\hline \\text{Salud } &amp; POOR &amp; \\text{1 si pobre} &amp; 3.8 &amp; 36.0 \\\\ \\ \\ \\text{autoevaluada} &amp; FAIR &amp; \\text{1 si regular} &amp; 9.9 &amp; 8.1 \\\\ \\ \\ \\text{física} &amp; GOOD &amp; \\text{1 si buena} &amp; 29.9 &amp; 8.2 \\\\ \\ \\ \\text{salud}&amp; VGOOD &amp; \\text{1 si muy buena} &amp; 31.1 &amp; 6.3 \\\\ &amp; \\text{Nivel de referencia} &amp; &amp; 25.4 &amp; 5.1 \\\\ &amp; ~~~\\text{ es excelente salud} &amp; &amp; \\\\ \\text{Salud mental} &amp; MNHPOOR &amp; \\text{1 si pobre o regular} &amp; 7.5 &amp; 16.8 \\\\ \\ \\ \\text{autoevaluada} &amp; &amp; \\text{0 si buena a excelente salud mental} &amp; 92.6 &amp; 7.1 \\\\ \\text{Cualquier} &amp; ANYLIMIT &amp; \\text{1 si cualquier limitación}&amp; 22.3 &amp; 14.6 \\\\ \\ \\ \\ \\text{ limitación} &amp; &amp; \\ \\ \\ \\text{funcional/actividad}&amp; &amp; \\\\ \\ \\ \\text{en la actividad} &amp; &amp; \\text{0 si no hay limitación} &amp; 77.7 &amp; 5.9 \\\\ \\hline \\text{Ingresos} &amp; HINCOME &amp; \\text{1 si ingresos altos} &amp; 31.6 &amp; 5.4 \\\\ \\ \\ \\text{comparado con} &amp; MINCOME &amp; \\text{1 si ingresos medios} &amp; 29.9 &amp; 7.0 \\\\ \\ \\ \\text{nivel de pobreza} &amp; LINCOME &amp; \\text{1 si ingresos bajos} &amp; 15.8 &amp; 8.3 \\\\ &amp; NPOOR &amp; \\text{1 si casi pobre} &amp; 5.8 &amp; 9.5 \\\\ &amp; \\text{Nivel de referencia} &amp; 17.0 &amp; 13.0 \\\\ &amp; ~~~\\text{ es pobre/negativo} &amp; &amp; \\\\ \\hline \\text{Seguro} &amp; INSURE &amp; \\text{1 si cubierto por seguro } &amp; 77.8 &amp; 9.2 \\\\ \\ \\ \\text{de salud} &amp; &amp; \\ \\ \\text{público/privado en } &amp; &amp; \\\\ &amp; &amp; \\ \\ \\text{cualquier mes de 2003} &amp; &amp; \\\\ &amp; &amp; \\text{0 si no tiene seguro de salud en 2003} &amp; 22.3 &amp; 3.1 \\\\ \\hline Total &amp; &amp; &amp; 100.0 &amp; 7.9 \\\\ \\hline \\end{array} } \\] Código R para Generar la Tabla 11.4 # CREAR UNA FUNCIÓN CORTA PARA AHORRAR TRABAJO fun1 &lt;- function(y){ options(digits=3) temp0 &lt;- cbind(table(y)/length(y),summarize(POSEXP, y, mean)) temp &lt;- temp0[c(2,1),] temp[,c(2,4)] &lt;- round(temp[,c(2,4)], digits=3) return(cbind(temp[,3],temp[,2],temp[,4]))} var1 &lt;- fun1(Hexpend$GENDER) var2 &lt;- fun1(Hexpend$RACE) var3 &lt;- fun1(Hexpend$REGION) var4 &lt;- fun1(Hexpend$EDUC) var5 &lt;- fun1(Hexpend$PHSTAT) #var6 &lt;- fun1(Hexpend$MPOOR) var7 &lt;- fun1(Hexpend$ANYLIMIT) var8 &lt;- fun1(Hexpend$INCOME) var9 &lt;- fun1(Hexpend$insure) tableout &lt;- rbind(var1, var2, var3, var4, var5, var7, var8, var9) #tableout La Tabla 11.5 resume el ajuste de varios modelos de regresión binaria. Los ajustes se informan en la columna “Modelo Completo” para todas las variables utilizando la función logit. Los \\(t\\)-ratios para muchas de las variables explicativas superan dos en valor absoluto, lo que sugiere que son predictores útiles. A partir de una inspección de estos \\(t\\)-ratios, uno podría considerar un modelo más parsimonioso eliminando las variables estadísticamente insignificantes. La Tabla 11.5 muestra un “Modelo Reducido,” en el cual las variables de edad y estado de salud mental han sido eliminadas. Para evaluar su significancia conjunta, podemos calcular un estadístico de prueba de razón de verosimilitud como el doble del cambio en la log-verosimilitud. Esto resulta ser solo \\(2\\times \\left( -488.78-(-488.69)\\right) =0.36.\\) Comparando esto con una distribución chi-cuadrado con \\(df=2\\) grados de libertad, obtenemos un valor-\\(p=0.835\\), lo que indica que los parámetros adicionales para la edad y el estado de salud mental no son estadísticamente significativos. La Tabla 11.5 también proporciona los ajustes del modelo probit. Aquí, vemos que los resultados son similares a los del modelo logit, según el signo de los coeficientes y su significancia, lo que sugiere que para esta aplicación hay poca diferencia entre las dos especificaciones. knitr::kable(2, caption = &quot;Tonto. Crear una tabla solo para actualizar el contador...&quot;) Tabla 11.2: Tonto. Crear una tabla solo para actualizar el contador… x 2 knitr::kable(2, caption = &quot;Tonto.&quot;) Tabla 11.3: Tonto. x 2 knitr::kable(2, caption = &quot;Tonto. &quot;) Tabla 11.4: Tonto. x 2 Tabla 11.5. Comparación de Modelos de Regresión Binaria \\[ \\scriptsize{ \\begin{array}{l|rr|rr|rr} \\hline &amp; \\text{Logistic} &amp; &amp; \\text{Logistic} &amp;&amp;\\text{Probit} \\\\ \\hline &amp; \\text{Full Model} &amp; &amp;\\text{Reduced Model} &amp;&amp; \\text{Reduced Model} \\\\ &amp; \\text{Parameter} &amp; &amp; \\text{Parameter} &amp; &amp; \\text{Parameter} &amp; \\\\ \\text{Effect} &amp; \\text{Estimate} &amp; t\\text{-ratio}o &amp; \\text{Estimate} &amp; t\\text{-rati}o &amp; \\text{Estimate} &amp; t\\text{-ratio} \\\\ \\hline Intercept &amp; -4.239 &amp; -8.982 &amp; -4.278 &amp; -10.094 &amp; -2.281 &amp; -11.432 \\\\ AGE &amp; -0.001 &amp; -0.180 &amp; &amp; &amp; &amp; \\\\ GENDER &amp; 0.733 &amp; 3.812 &amp; 0.732 &amp; 3.806 &amp; 0.395 &amp; 4.178 \\\\ ASIAN &amp; -0.219 &amp; -0.411 &amp; -0.219 &amp; -0.412 &amp; -0.108 &amp; -0.427 \\\\ BLACK &amp; -0.001 &amp; -0.003 &amp; 0.004 &amp; 0.019 &amp; 0.009 &amp; 0.073 \\\\ NATIVE &amp; 0.610 &amp; 0.926 &amp; 0.612 &amp; 0.930 &amp; 0.285 &amp; 0.780 \\\\ NORTHEAST &amp; 0.609 &amp; 2.112 &amp; 0.604 &amp; 2.098 &amp; 0.281 &amp; 1.950 \\\\ MIDWEST &amp; 0.524 &amp; 1.904 &amp; 0.517 &amp; 1.883 &amp; 0.237 &amp; 1.754 \\\\ SOUTH &amp; 0.339 &amp; 1.376 &amp; 0.328 &amp; 1.342 &amp; 0.130 &amp; 1.085 \\\\ \\hline COLLEGE &amp; 0.068 &amp; 0.255 &amp; 0.070 &amp; 0.263 &amp; 0.049 &amp; 0.362 \\\\ HIGHSCHOOL &amp; 0.004 &amp; 0.017 &amp; 0.009 &amp; 0.041 &amp; 0.003 &amp; 0.030 \\\\ \\hline POOR &amp; 1.712 &amp; 4.385 &amp; 1.652 &amp; 4.575 &amp; 0.939 &amp; 4.805 \\\\ FAIR &amp; 0.136 &amp; 0.375 &amp; 0.109 &amp; 0.306 &amp; 0.079 &amp; 0.450 \\\\ GOOD &amp; 0.376 &amp; 1.429 &amp; 0.368 &amp; 1.405 &amp; 0.182 &amp; 1.412 \\\\ VGOOD &amp; 0.178 &amp; 0.667 &amp; 0.174 &amp; 0.655 &amp; 0.094 &amp; 0.728 \\\\ MNHPOOR &amp; -0.113 &amp; -0.369 &amp; &amp; &amp; &amp; \\\\ ANYLIMIT &amp; 0.564 &amp; 2.680 &amp; 0.545 &amp; 2.704 &amp; 0.311 &amp; 3.022 \\\\ \\hline HINCOME &amp; -0.921 &amp; -3.101 &amp; -0.919 &amp; -3.162 &amp; -0.470 &amp; -3.224 \\\\ MINCOME &amp; -0.609 &amp; -2.315 &amp; -0.604 &amp; -2.317 &amp; -0.314 &amp; -2.345 \\\\ LINCOME &amp; -0.411 &amp; -1.453 &amp; -0.408 &amp; -1.449 &amp; -0.241 &amp; -1.633 \\\\ NPOOR &amp; -0.201 &amp; -0.528 &amp; -0.204 &amp; -0.534 &amp; -0.146 &amp; -0.721 \\\\ INSURE &amp; 1.234 &amp; 4.047 &amp; 1.227 &amp; 4.031 &amp; 0.579 &amp; 4.147 \\\\ \\hline Log-Likelihood &amp; -488.69 &amp;&amp; -488.78 &amp;&amp; -486.98 \\\\ \\textit{AIC} &amp; 1,021.38 &amp;&amp; 1,017.56 &amp;&amp; 1,013.96 \\\\ \\hline \\end{array} } \\] Código R para Generar la Tabla 11.5 #Hexpend &lt;- read.csv(&quot;CSVData/HealthExpend.csv&quot;, header=TRUE) # Tabla 11.5 Hexpend$POSEXP = 1*(Hexpend$EXPENDIP&gt;0) # CAMBIAR NIVELES DE REFERENCIA PARA COINCIDIR CON EL LIBRO (HECHO EN SAS) attach(Hexpend) RACE = relevel(factor(RACE),ref=&quot;WHITE&quot;) REGION = relevel(factor(REGION),ref=&quot;WEST&quot;) EDUC = relevel(factor(EDUC),ref=&quot;LHIGHSC&quot;) PHSTAT = relevel(factor(PHSTAT),ref=&quot;EXCE&quot;) INCOME = relevel(factor(INCOME),ref=&quot;POOR&quot;) # MODELO LOGIT COMPLETO; PosExpglmFull = glm(POSEXP~AGE+GENDER +factor(RACE)+ factor(REGION)+factor(EDUC) +factor(PHSTAT)+ANYLIMIT+factor(INCOME) +insure, family=binomial(link=logit)) #summary(PosExpglmFull) Table1 &lt;- summary(PosExpglmFull) Table1Red &lt;- round(Table1$coefficients[,c(1,3)], digits=3) # MODELO LOGIT REDUCIDO; PosExpglmRed = glm(POSEXP~GENDER + factor(RACE) + +factor(REGION)+factor(EDUC) +factor(PHSTAT)+ANYLIMIT+factor(INCOME) +insure, family=binomial(link=logit)) #summary(PosExpglmRed) Table2 &lt;- summary(PosExpglmRed) Table2Red &lt;- round(Table2$coefficients[,c(1,3)], digits = 3) #anova(PosExpglmRed,PosExpglmFull, test=&quot;Chisq&quot;) # MODELO PROBIT REDUCIDO; PosExpglmRedProbit = glm(POSEXP~GENDER+ factor(RACE)+ +factor(REGION)+factor(EDUC) +factor(PHSTAT)+factor(ANYLIMIT)+factor(INCOME) +factor(insure), binomial(link=probit)) #summary(PosExpglmRedProbit) Table3 &lt;- summary(PosExpglmRedProbit) Table3Red &lt;- round(Table3$coefficients[,c(1,3)], digits = 3) detach(Hexpend) row.names(Table2Red) &lt;- NULL row.names(Table3Red) &lt;- NULL Table23Join &lt;- cbind(Table2Red,Table3Red) Table23JoinA &lt;- rbind(Table23Join[1,], c(&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;), Table23Join[2:14,], c(&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;), Table23Join[15:20,]) Table123 &lt;- cbind(Table1Red, Table23JoinA) rowLogLik &lt;- round(c(logLik(PosExpglmFull) , logLik(PosExpglmRed) , logLik(PosExpglmRedProbit) ), digits = 2) rowAIC &lt;- round(c(AIC(PosExpglmFull) , AIC(PosExpglmRed) , AIC(PosExpglmRedProbit) ), digits = 2) rowSumStats &lt;- rbind(c(rowLogLik[1], &quot;&quot;,rowLogLik[2], &quot;&quot;,rowLogLik[3], &quot;&quot;), c(rowAIC[1], &quot;&quot;,rowAIC[2], &quot;&quot;,rowAIC[3], &quot;&quot;) ) row.names(rowSumStats) &lt;- c(&quot;Log-Verosimilitud&quot;, &quot;$AIC$&quot;) Table123A &lt;- rbind(Table123, rowSumStats) colnames(Table123A) &lt;- rep(c(&quot;Estimaciones de Parámetro&quot;, &quot;$t$-Ratio&quot;),3) TableGen1(TableData=Table123A, TextTitle=&#39;Comparación de Modelos de Regresión Binaria&#39;, Align=&#39;r&#39;, ColumnSpec=1:6, ColWidth = ColWidth6) %&gt;% add_header_above(c(&quot; &quot;=1, &quot;Modelo Logístico Completo&quot; = 2, &quot;Modelo Logístico Reducido&quot; = 2, &quot;Modelo Probit Reducido&quot;=2)) Tabla 11.5: Comparación de Modelos de Regresión Binaria Modelo Logístico Completo Modelo Logístico Reducido Modelo Probit Reducido Estimaciones de Parámetro \\(t\\)-Ratio Estimaciones de Parámetro \\(t\\)-Ratio Estimaciones de Parámetro \\(t\\)-Ratio (Intercept) -4.239 -8.981 -4.274 -10.082 -2.279 -11.346 AGE -0.001 -0.17 GENDER 0.734 3.815 0.735 3.817 0.395 4.197 factor(RACE)ASIAN -0.222 -0.417 -0.223 -0.418 -0.108 -0.432 factor(RACE)BLACK -0.004 -0.017 -0.002 -0.008 0.008 0.062 factor(RACE)NATIV 0.602 0.913 0.607 0.92 0.283 0.781 factor(RACE)OTHER -0.215 -0.32 -0.214 -0.319 -0.05 -0.148 factor(REGION)MIDWEST 0.518 1.887 0.517 1.882 0.236 1.747 factor(REGION)NORTHEAST 0.605 2.099 0.603 2.092 0.28 1.941 factor(REGION)SOUTH 0.332 1.355 0.33 1.348 0.13 1.081 factor(EDUC)COLLEGE 0.068 0.255 0.068 0.253 0.048 0.357 factor(EDUC)HIGHSCH 0.005 0.025 0.005 0.024 0.003 0.024 factor(PHSTAT)FAIR 0.115 0.321 0.108 0.303 0.078 0.445 factor(PHSTAT)GOOD 0.371 1.409 0.366 1.399 0.181 1.409 factor(PHSTAT)POOR 1.668 4.524 1.656 4.583 0.939 4.739 factor(PHSTAT)VGOO 0.175 0.654 ANYLIMIT 0.554 2.651 0.171 0.644 0.093 0.723 factor(INCOME)HINCOME -0.911 -3.082 0.545 2.702 0.311 3.008 factor(INCOME)LINCOME -0.404 -1.431 -0.92 -3.165 -0.471 -3.187 factor(INCOME)MINCOME -0.6 -2.288 -0.408 -1.448 -0.241 -1.635 factor(INCOME)NPOOR -0.199 -0.522 -0.604 -2.317 -0.315 -2.326 insure 1.232 4.041 -0.199 -0.522 -0.146 -0.722 Log-Verosimilitud -488.71 -488.72 -486.97 \\(AIC\\) 1021.42 1019.45 1015.94 11.5 Variables Dependientes Nominales Ahora consideramos una respuesta que es una variable categórica no ordenada, también conocida como variable dependiente nominal. Suponemos que la variable dependiente \\(y\\) puede tomar los valores \\(1, 2, \\ldots , c,\\) correspondientes a \\(c\\) categorías. Cuando \\(c&gt;2\\), nos referimos a los datos como “multicategoría”, también conocidos como policótomos o policitomos. En muchas aplicaciones, las categorías de respuesta corresponden a un atributo poseído o a elecciones hechas por individuos, hogares o empresas. Algunas aplicaciones incluyen: Elección de empleo, como en Valletta (1999) Modo de transporte, como en el trabajo clásico de McFadden (1978) Tipo de seguro de salud, como en Browne y Frees (2007). Para una observación del sujeto \\(i\\), denotamos la probabilidad de elegir la categoría \\(j\\) como \\(\\pi_{ij}= \\mathrm{Pr}(y_i = j)\\), de modo que \\(\\pi_{i1}+\\cdots+\\pi_{ic}=1\\). En general, modelaremos estas probabilidades como una función (conocida) de parámetros y utilizaremos la estimación de máxima verosimilitud para la inferencia estadística. Sea \\(y_{ij}\\) una variable binaria que es 1 si \\(y_i=j\\). Extendiendo la ecuación (11.2) a \\(c\\) categorías, la verosimilitud para el sujeto \\(i\\) es: \\[ \\prod_{j=1}^c \\left( \\pi_{i,j} \\right)^{y_{i,j}} =\\left\\{ \\begin{array}{cc} \\pi_{i,1} &amp; \\mathrm {if}~ y_i = 1 \\\\ \\pi_{i,2} &amp; \\mathrm {if}~ y_i = 2 \\\\ \\vdots &amp; \\vdots \\\\ \\pi_{i,c} &amp; \\mathrm {if}~ y_i = c \\\\ \\end{array} \\right. . \\] Por lo tanto, suponiendo independencia entre las observaciones, la verosimilitud total es \\[ L = \\sum_{i=1}^n \\sum_{j=1}^c y_{i,j}~ \\mathrm{ln}~ \\pi_{i,j} . \\] Con este marco, la estimación estándar de máxima verosimilitud está disponible (Sección 11.9). Por lo tanto, nuestra tarea principal es especificar una forma apropiada para \\(\\pi\\). 11.5.1 Logit Generalizado Al igual que la regresión lineal estándar, los modelos de logit generalizado emplean combinaciones lineales de variables explicativas de la forma: \\[\\begin{equation} V_{i,j} = \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta_j . \\tag{11.6} \\end{equation}\\] Debido a que las variables dependientes no son numéricas, no podemos modelar la respuesta \\(y\\) como una combinación lineal de variables explicativas más un error. En su lugar, utilizamos las probabilidades \\[\\begin{equation} \\mathrm{Pr} \\left(y_i = j \\right) = \\pi_{i,j} = \\frac {\\exp (V_{i,j})}{\\sum_{k=1}^c \\exp(V_{i,k})} . \\tag{11.7} \\end{equation}\\] Tenga en cuenta aquí que \\(\\boldsymbol \\beta_j\\) es el vector correspondiente de parámetros que puede depender de la alternativa \\(j\\), mientras que las variables explicativas \\(\\mathbf{x}_i\\) no. Para que las probabilidades sumen uno, una normalización conveniente para este modelo es \\(\\boldsymbol \\beta_c =\\mathbf{0}\\). Con esta normalización y el caso especial de \\(c = 2\\), el logit generalizado se reduce al modelo de logit introducido en la Sección 11.2. Interpretaciones de Parámetros Ahora describimos una interpretación de los coeficientes en los modelos de logit generalizado, similar al modelo logístico. De las ecuaciones (11.6) y (11.7), tenemos \\[ \\mathrm{ln}~ \\frac{\\mathrm{Pr} \\left(y_i = j \\right)} {\\mathrm{Pr} \\left(y_i = c \\right)} = V_{i,j} - V_{i,c} =\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta_j . \\] El lado izquierdo de esta ecuación se interpreta como el logaritmo de las probabilidades de elegir la opción \\(j\\) en comparación con la opción \\(c\\). Por lo tanto, podemos interpretar \\(\\boldsymbol \\beta_j\\) como el cambio proporcional en la razón de probabilidad. Los logits generalizados tienen una interesante estructura anidada que exploraremos brevemente en la Sección 11.5.3. Es decir, es fácil comprobar que, condicional a no elegir la primera categoría, la forma de Pr(\\(y_i = j| y_i \\neq 1\\)) tiene una forma de logit generalizado en la ecuación (11.7). Además, si \\(j\\) y \\(h\\) son alternativas diferentes, observamos que \\[\\begin{eqnarray*} \\mathrm{Pr}(y_i = j| y_i=j ~\\mathrm{or}~ y_i=h) &amp;=&amp;\\frac{\\mathrm{Pr}(y_i = j)}{\\mathrm{Pr}(y_i = j)+\\mathrm{Pr}(y_i = h)} =\\frac{\\mathrm{exp}(V_{i,j})}{\\mathrm{exp}(V_{i,j})+\\mathrm{exp}(V_{i,h})} \\\\ &amp;=&amp;\\frac{1}{1+\\mathrm{exp}(\\mathbf{x}_i^{\\prime}(\\boldsymbol \\beta _h - \\boldsymbol \\beta_j))} . \\end{eqnarray*}\\] Esto tiene una forma de logit que se introdujo en la Sección 11.2. Caso Especial - Modelo con solo intercepto. Para desarrollar intuición, ahora consideramos el modelo con solo interceptos. Así, sea \\(\\mathbf{x}_i = 1\\) y \\(\\boldsymbol \\beta_j = \\beta_{0,j} = \\alpha_j\\). Con la convención de que \\(\\alpha_c=0\\), tenemos \\[ \\mathrm{Pr} \\left(y_i = j \\right) = \\pi_{i,j} = \\frac {e^{\\alpha_j}}{e^{\\alpha_1}+e^{\\alpha_2}+\\cdots+e^{\\alpha_{c-1}}+1} \\] y \\[ \\mathrm{ln}~ \\frac{\\mathrm{Pr} \\left(y_i = j \\right)} {\\mathrm{Pr} \\left(y_i = c \\right)} = \\alpha_j. \\] A partir de la segunda relación, podemos interpretar el \\(j\\)-ésimo intercepto \\(\\alpha_j\\) como las probabilidades logarítmicas de elegir la alternativa \\(j\\) en comparación con la alternativa \\(c\\). Ejemplo: Seguridad Laboral - Continuación. Esta es una continuación del ejemplo de la Sección 11.2 sobre los determinantes de la rotación laboral, basado en el trabajo de Valletta (1999). El primer análisis de estos datos consideró solo la variable dependiente binaria de despido, ya que este resultado es la principal fuente de inseguridad laboral. Valletta (1999) también presentó resultados de un modelo logit generalizado, su principal motivación fue que la teoría económica que describe la rotación laboral implica que otras razones para dejar un trabajo pueden afectar las probabilidades de despido. Para el modelo logit generalizado, la variable de respuesta tiene \\(c = 5\\) categorías: despido, dejó el trabajo debido al cierre de plantas, “renunció”, cambió de trabajo por otras razones y no hubo cambio en el empleo. La categoría de “no hubo cambio en el empleo” es la omitida en Tabla 11.6. Las variables explicativas del logit generalizado son las mismas que en la regresión probit; las estimaciones resumidas en la Tabla 11.1 se reproducen aquí para mayor conveniencia. Tabla 11.6 muestra que la rotación disminuye a medida que aumenta la antigüedad. Para ilustrar, considere a un hombre típico en la muestra de 1992 donde tenemos tiempo = 16 y nos enfocamos en las probabilidades de despido. Para este valor de tiempo, el coeficiente asociado con la antigüedad para el despido es -0.221 + 16 (0.008) = -0.093 (debido al término de interacción). A partir de esto, interpretamos que un año adicional de antigüedad implica que la probabilidad de despido es exp(-0.093) = 91% de lo que sería de otra manera, lo que representa una disminución del 9%. Tabla 11.6 también muestra que los coeficientes generalizados asociados con el despido son similares a los ajustes del modelo probit. Los errores estándar también son cualitativamente similares, aunque más altos para los logit generalizados en comparación con el modelo probit. En particular, nuevamente vemos que el coeficiente asociado con la interacción entre la antigüedad y la tendencia del tiempo revela una tasa de despido en aumento para los trabajadores con experiencia. Lo mismo ocurre con la tasa de renuncia. Tabla 11.6. Estimaciones de Regresión Logit Generalizado y Probit para la Rotación Laboral \\[ \\small{ \\begin{array}{lcrrrr} \\hline &amp; \\textbf{Probit} &amp; &amp;\\textbf{Logit} &amp;\\textbf{Generalizado} &amp;\\textbf{Modelo} \\\\ &amp; \\text{Regresión} &amp; &amp; \\text{Cierre de} &amp; \\text{Otras} &amp; \\\\ \\text{Variable} &amp; \\text{Modelo} &amp; \\text{Despido} &amp; \\text{Plantas} &amp; \\text{razones} &amp; \\text{Renuncia} \\\\ &amp; \\text{(Despido)}\\\\ \\hline \\text{Antigüedad} &amp; -0.084 &amp; -0.221 &amp; -0.086 &amp; -0.068 &amp; -0.127 \\\\ &amp; (0.010) &amp; (0.025) &amp; (0.019) &amp; (0.020) &amp; (0.012) \\\\ \\text{Tendencia Temporal} &amp; -0.002 &amp; -0.008 &amp; -0.024 &amp; 0.011 &amp; -0.022 \\\\ &amp; (0.005) &amp; (0.011) &amp; (0.016) &amp; (0.013) &amp; (0.007)\\\\ \\text{Antigüedad (Tendencia Temporal)} &amp; 0.003 &amp; 0.008 &amp; 0.004 &amp; -0.005 &amp; 0.006 \\\\ &amp; (0.001) &amp; (0.002) &amp; (0.001) &amp; (0.002) &amp; (0.001) \\\\ \\text{Cambio en Logaritmo} &amp; 0.094 &amp; 0.286 &amp; 0.459 &amp; -0.022 &amp; 0.333 \\\\ ~~\\text{de Empleo en el Sector} &amp; (0.057) &amp; (0.123) &amp; (0.189) &amp; (0.158) &amp; (0.082) \\\\ \\text{Antigüedad (Cambio en Logaritmo} &amp; -0.020 &amp; -0.061 &amp; -0.053 &amp; -0.005 &amp; -0.027 \\\\ ~~\\text{de Empleo en el Sector)} &amp; (0.009) &amp; (0.023) &amp; (0.025) &amp; (0.025) &amp; (0.012) \\\\ \\hline \\end{array} } \\] Notas: Errores estándar en paréntesis. La categoría omitida es la de no cambio en el empleo para el logit generalizado. Otras variables controladas incluyen educación, estado civil, número de hijos, raza, años de experiencia laboral a tiempo completo y su cuadrado, membresía sindical, empleo en el gobierno, salario logarítmico, la tasa de empleo en EE.UU. y ubicación. 11.5.2 Logit Multinomial Similar al ecuación (11.6), una combinación lineal alternativa de las variables explicativas es \\[\\begin{equation} V_{i,j} = \\mathbf{x}_{i,j}^{\\prime} \\boldsymbol \\beta, \\tag{11.8} \\end{equation}\\] donde \\(\\mathbf{x}_{i,j}\\) es un vector de variables explicativas que depende de la \\(j\\)-ésima alternativa mientras que los parámetros \\(\\boldsymbol \\beta\\) no. Utilizando las expresiones en las ecuaciones (11.7) y (11.8) se forma la base del modelo logit multinomial, también conocido como el modelo logit condicional (McFadden, 1974). Con esta especificación, la log-verosimilitud total es \\[ L = \\sum_{i=1}^n \\sum_{j=1}^c y_{i,j}~ \\mathrm{ln}~ \\pi_{i,j} = \\sum_{i=1}^n \\left[ \\sum_{j=1}^c y_{i,j} \\mathbf{x}_{i,j}^{\\prime} \\boldsymbol \\beta \\ - \\mathrm{ln} \\left(\\sum_{k=1}^c \\mathrm{exp}(\\mathbf{x}_{i,k}^{\\prime} \\boldsymbol \\beta) \\right) \\right]. \\] Esta expresión directa para la verosimilitud permite realizar fácilmente la inferencia por máxima verosimilitud. El modelo logit generalizado es un caso especial del modelo logit multinomial. Para ver esto, considere las variables explicativas \\(\\mathbf{x}_i\\) y los parámetros \\(\\boldsymbol \\beta_j\\), cada uno de dimensión \\(k\\times 1\\). Defina \\[ \\mathbf{x}_{i,j} = \\left( \\begin{array}{c} \\mathbf{0} \\\\ \\vdots \\\\ \\mathbf{0} \\\\ \\mathbf{x}_i \\\\ \\mathbf{0} \\\\ \\vdots \\\\ \\mathbf{0} \\\\ \\end{array}\\right) ~~~ \\mathrm{y}~~~ \\boldsymbol \\beta = \\left( \\begin{array}{c} \\boldsymbol \\beta_1 \\\\ \\boldsymbol \\beta_2 \\\\ \\vdots \\\\ \\boldsymbol \\beta_c \\\\ \\end{array} \\right). \\] Específicamente, \\(\\mathbf{x}_{i,j}\\) se define como \\(j-1\\) vectores nulos (cada uno de dimensión \\(k\\times 1\\)), seguido por \\(\\mathbf{x}_i\\) y luego seguido por \\(c-j\\) vectores nulos. Con esta especificación, tenemos \\(\\mathbf{x}_{i,j}^{\\prime} \\boldsymbol \\beta =\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta_j\\). Así, un paquete estadístico que realiza estimaciones logit multinomiales también puede realizar estimaciones logit generalizadas mediante la codificación apropiada de variables explicativas y parámetros. Otra consecuencia de esta conexión es que algunos autores usan el término logit multinomial cuando se refieren al modelo logit generalizado. Además, mediante esquemas de codificación similares, los modelos logit multinomiales también pueden manejar combinaciones lineales de la forma: \\[ V_i = \\mathbf{x}_{i,1,j}^{\\prime} \\boldsymbol \\beta + \\mathbf{x}_{i,2}^{\\prime} \\boldsymbol \\beta_j . \\] Aquí, \\(\\mathbf{x}_{i,1,j}\\) son variables explicativas que dependen de la alternativa, mientras que \\(\\mathbf{x}_{i,2}\\) no. De manera similar, \\(\\boldsymbol \\beta_j\\) son parámetros que dependen de la alternativa, mientras que \\(\\boldsymbol \\beta\\) no. Este tipo de combinación lineal es la base de un modelo logit mixto. Al igual que con los logits condicionales, es común elegir un conjunto de parámetros como base y especificar \\(\\boldsymbol \\beta_c = \\mathbf{0}\\) para evitar redundancias. Para interpretar los parámetros del modelo logit multinomial, podemos comparar las alternativas \\(h\\) y \\(k\\) usando las ecuaciones (11.7) y (11.8), obteniendo \\[ \\mathrm{ln}~ \\frac{\\mathrm{Pr} \\left(y_i = h \\right)} {\\mathrm{Pr} \\left(y_i = k \\right)} = (\\mathbf{x}_{i,h}-\\mathbf{x}_{i,k}) ^{\\prime} \\boldsymbol \\beta . \\] Así, podemos interpretar \\(\\beta_j\\) como el cambio proporcional en la razón de probabilidades, donde el cambio es el valor de la \\(j\\)-ésima variable explicativa, pasando de la alternativa \\(k\\) a la \\(h\\). Con la ecuación (11.7), note que \\(\\pi_{i,1} / \\pi_{i,2} = \\mathrm{exp}(V_{i,1}) /\\mathrm{exp}(V_{i,2})\\). Esta razón no depende de los valores subyacentes de las otras alternativas, \\(V_{i,j}\\), para \\(j=3, \\ldots, c\\). Esta característica, llamada independencia de alternativas irrelevantes, puede ser una desventaja del modelo logit multinomial para algunas aplicaciones. Ejemplo: Elección de Seguro de Salud. Para ilustrar, Browne y Frees (2007) examinaron \\(c=4\\) opciones de seguro de salud, que consistían en: \\(y=1\\) - un individuo cubierto por seguro grupal, \\(y=2\\) - un individuo cubierto por seguro privado, no grupal, \\(y=3\\) - un individuo cubierto por seguro gubernamental, pero no privado, o \\(y=4\\) - un individuo no cubierto por seguro de salud. Sus datos sobre cobertura de seguro de salud provinieron del suplemento de marzo de la Encuesta de Población Actual (CPS, por sus siglas en inglés), realizada por la Oficina de Estadísticas Laborales. Browne y Frees (2007) analizaron aproximadamente 10,800 hogares de personas solteras por año, cubriendo de 1988 a 1995, lo que dio un total de \\(n=86,475\\) observaciones. Examinaron si las restricciones de suscripción, leyes aprobadas para prohibir que los aseguradores discriminen, facilitan o desalientan el consumo de seguros de salud. Se centraron en las leyes de discapacidad que prohibían a los aseguradores utilizar la discapacidad física como criterio de suscripción. La Tabla 11.7 sugiere que las leyes de discapacidad tienen poco efecto en el comportamiento promedio de compra de seguro de salud. Para ilustrar, para los individuos encuestados con las leyes de discapacidad en vigor, el 57.6% compró seguro de salud grupal en comparación con el 59.3% de aquellos donde las restricciones no estaban en vigor. De manera similar, el 19.9% no tenía seguro cuando las restricciones de discapacidad estaban en vigor en comparación con el 20.1% cuando no lo estaban. En términos de probabilidades, cuando las restricciones de discapacidad estaban en vigor, las probabilidades de comprar un seguro de salud grupal en comparación con quedar sin seguro son 57.6/19.9 = 2.895. Cuando las restricciones de discapacidad no estaban en vigor, las probabilidades son 2.946. La razón de probabilidades, 2.895/2.946 = 0.983, indica que hay poco cambio en las probabilidades cuando se compara si las restricciones de discapacidad estaban en vigor o no. knitr::kable(2, caption = &quot;Silly. Create a table just to update the counter...&quot;) Tabla 11.6: Silly. Create a table just to update the counter… x 2 Tabla 11.7: Porcentajes de Cobertura de Salud por Variable de Ley Ley de Discapacidad en Vigor Número Sin Seguro No Grupal Gubernamental Grupal Prob. Comparativa Grupal vs. Sin Seguro Razón de Probabilidades No 82246 20.1 12.2 8.4 59.3 2.946 Sí 4229 19.9 10.1 12.5 57.6 2.895 0.983 Total 86475 20.1 12.1 8.6 59.2 En contraste, la Tabla 11.8 sugiere que las leyes de discapacidad pueden tener efectos importantes en el comportamiento promedio de compra de seguro de salud de subgrupos seleccionados de la muestra. La Tabla 11.8 muestra el porcentaje de personas sin seguro y las probabilidades de adquirir un seguro grupal (comparado con estar sin seguro) para subgrupos seleccionados. Para ilustrar, para personas con discapacidad, las probabilidades de adquirir un seguro grupal son 1.329 veces más altas cuando las restricciones de discapacidad están en vigor. La Tabla 11.7 sugiere que las restricciones de discapacidad no tienen efecto; esto puede ser cierto al observar toda la muestra. Sin embargo, al examinar subgrupos, la Tabla 11.8 muestra que podemos ver efectos importantes asociados con las restricciones legales de suscripción que no son evidentes al observar los promedios en toda la muestra. Tabla 11.8: Probabilidades de Cobertura de Salud por Ley y Discapacidad Física Subgrupos Seleccionados Ley de Discapacidad en Vigor Número Porcentaje Grupal Porcentaje Sin Seguro Prob. Comparativa Grupal vs. Sin Seguro Razón de Probabilidades Sin Discapacidad No 72150 64.2 20.5 3.134 Sin Discapacidad Sí 3649 63.4 21.2 2.985 0.952 Con Discapacidad No 10096 24.5 17.6 1.391 Con Discapacidad Sí 580 21 11.4 1.848 1.329 Hay muchas formas de seleccionar subgrupos de interés. Con un gran conjunto de datos de \\(n=86,475\\) observaciones, probablemente se podrían elegir subgrupos para confirmar casi cualquier hipótesis. Además, existe la preocupación de que los datos de la CPS pueden no proporcionar una muestra representativa de las poblaciones estatales. Por lo tanto, es habitual utilizar técnicas de regresión para “controlar” las variables explicativas, como la discapacidad física. La Tabla 11.9 presenta los principales resultados de un modelo logit multinomial con muchas variables de control incluidas. Se incluyó una variable dummy para cada uno de los 50 estados (el Distrito de Columbia es un “estado” en este conjunto de datos, por lo que necesitamos \\(51-1=50\\) variables dummy). Estas variables fueron sugeridas en la literatura y son descritas con más detalle en Browne y Frees (2007). Incluyen el género del individuo, estado civil, raza, nivel educativo, si es trabajador independiente o no y si el individuo trabajó a tiempo completo, a tiempo parcial o no trabajó. En la Tabla 11.9, “Ley” se refiere a la variable binaria que es 1 si una restricción legal estaba en vigor y “Discapacidad” es una variable binaria que es 1 si un individuo tiene una discapacidad física. Por lo tanto, la interacción “Ley*Discapacidad” informa sobre el efecto de una restricción legal en una persona con discapacidad física. La interpretación es similar a la de la Tabla 11.8. Específicamente, interpretamos el coeficiente 1.419 como que las personas con discapacidad son un 41.9% más propensas a adquirir un seguro de salud grupal comparado con no adquirir ningún seguro, cuando la restricción de suscripción por discapacidad está en vigor. De manera similar, las personas sin discapacidad son un 21.2% (\\(=1/0.825 - 1\\)) menos propensas a adquirir un seguro de salud grupal comparado con no adquirir ningún seguro, cuando la restricción de suscripción por discapacidad está en vigor. Este resultado sugiere que las personas sin discapacidad son más propensas a quedar sin seguro como resultado de las prohibiciones sobre el uso del estado de discapacidad como criterio de suscripción. En general, los resultados son estadísticamente significativos, confirmando que esta restricción legal tiene un impacto en el consumo de seguros de salud. Tabla 11.9: Razones de Probabilidades del Modelo de Regresión Logit Multinomial Grupal vs. Sin Seguro No Grupal vs. Sin Seguro Gubernamental vs. Sin Seguro Grupal vs. No Grupal Grupal vs. Gubernamental No Grupal vs. Gubernamental Ley \\(\\times\\) Sin Discapacidad 0.825 1.053 1.010 0.784 0.818 1.043 \\(p\\)-Valor 0.001 0.452 0.900 0.001 0.023 0.677 Ley \\(\\times\\) Con Discapacidad 1.419 0.953 1.664 1.490 0.854 0.573 \\(p\\)-Valor 0.062 0.789 0.001 0.079 0.441 0.001 Notas: La regresión incluye 150 (\\(=50 \\times 3\\)) efectos específicos por estado, varias variables continuas (edad, educación e ingresos, así como términos de orden superior) y variables categóricas (como raza y año). 11.5.3 Logit Anidado Para mitigar el problema de la independencia de alternativas irrelevantes en los logits multinomiales, ahora introducimos un tipo de modelo jerárquico conocido como un logit anidado. Para interpretar el modelo logit anidado, en la primera etapa se elige una alternativa (digamos la primera alternativa) con probabilidad \\[\\begin{equation} \\pi_{i,1} = \\mathrm{Pr}(y_i = 1) = \\frac{\\mathrm{exp}(V_{i,1})}{\\mathrm{exp}(V_{i,1})+ \\left[ \\sum_{k=2}^c \\mathrm{exp}(V_{i,k}/ \\rho) \\right]^{\\rho}} . \\tag{11.9} \\end{equation}\\] Luego, condicionado a no elegir la primera alternativa, la probabilidad de elegir cualquiera de las otras alternativas sigue un modelo logit multinomial con probabilidades \\[\\begin{equation} \\frac{\\pi_{i,j}}{1-\\pi_{i,1}} = \\mathrm{Pr}(y_i = j | y_i \\neq 1) = \\frac{\\mathrm{exp}(V_{i,j}/ \\rho)}{\\sum_{k=2}^c \\mathrm{exp}(V_{i,k}/ \\rho) }, ~~~j=2, \\ldots, c . \\tag{11.10} \\end{equation}\\] En las ecuaciones (11.9) y (11.10), el parámetro \\(\\rho\\) mide la asociación entre las elecciones \\(j = 2, \\ldots, c\\). El valor de \\(\\rho=1\\) se reduce al modelo logit multinomial, lo que interpretamos como independencia de alternativas irrelevantes. También interpretamos Prob(\\(y_i = 1\\)) como un promedio ponderado de los valores de la primera elección y las otras. Condicionado a no elegir la primera categoría, la forma de \\(\\mathrm{Pr}(y_i = j| y_i \\neq 1)\\) en la ecuación (11.10) tiene la misma forma que el logit multinomial. La ventaja del logit anidado es que generaliza el modelo logit multinomial de manera que ya no tenemos el problema de la independencia de alternativas irrelevantes. Una desventaja, señalada por McFadden (1981), es que solo se observa una elección; por lo tanto, no sabemos qué categoría pertenece a la primera etapa de la anidación sin una teoría adicional sobre el comportamiento de elección. No obstante, el logit anidado generaliza el logit multinomial al permitir estructuras de “dependencia” alternativas. Es decir, se puede ver el logit anidado como una alternativa robusta al logit multinomial y examinar cada una de las categorías en la primera etapa de la anidación. 11.6 Variables Dependientes Ordinales Ahora consideramos una respuesta que es una variable categórica ordenada, también conocida como una variable dependiente ordinal. Para ilustrar, cualquier tipo de respuesta de encuesta en la que se califique la impresión en una escala de siete puntos que va desde “muy insatisfecho” hasta “muy satisfecho” es un ejemplo de una variable ordinal. Ejemplo: Elección de Plan de Salud. Pauly y Herring (2007) examinaron \\(c=4\\) opciones de tipos de planes de salud, que consistían en: \\(y=1\\) - una organización para el mantenimiento de la salud (HMO), \\(y=2\\) - un plan de punto de servicio (POS), \\(y=3\\) - una organización de proveedores preferidos (PPO) o \\(y=4\\) - un plan de pago por servicio (FFS). Un plan FFS es el menos restrictivo, permitiendo a los afiliados ver a los proveedores de atención médica (como médicos de atención primaria) por una tarifa que refleja el costo de los servicios prestados. El plan PPO es el siguiente menos restrictivo; este plan generalmente utiliza pagos FFS pero los afiliados generalmente deben elegir de una lista de “proveedores preferidos”. Pauly y Herring (2007) consideraron los planes POS y HMO como el tercer y cuarto menos restrictivo, respectivamente. Un HMO a menudo utiliza la capitación (una tarifa fija por persona) para reembolsar a los proveedores, restringiendo a los afiliados a una red de proveedores. En contraste, un plan POS da a los afiliados la opción de ver a proveedores fuera de la red de HMO (por una tarifa adicional). 11.6.1 Logit Acumulativo Los modelos de variables dependientes ordinales se basan en probabilidades acumulativas de la forma \\[ \\mathrm{Pr} ( y \\le j ) = \\pi_1 + \\cdots + \\pi_j, ~ ~ j=1, \\ldots, c . \\] En esta sección, usamos logits acumulativos \\[\\begin{equation} \\mathrm{logit}\\left(\\mathrm{Pr} ( y \\le j ) \\right) = \\mathrm{ln} \\left(\\frac{\\Pr ( y \\le j )}{1-\\Pr ( y \\le j )} \\right) = \\mathrm{ln} \\left(\\frac{\\pi_1 + \\cdots + \\pi_j}{\\pi_{j+1} + \\cdots + \\pi_c} \\right) . \\tag{11.11} \\end{equation}\\] El modelo de logit acumulativo más simple es \\[ \\mathrm{logit}\\left(\\Pr ( y \\le j ) \\right) = \\alpha_j \\] que no utiliza ninguna variable explicativa. Los parámetros de “punto de corte” \\(\\alpha_j\\) son no decrecientes, de modo que \\(\\alpha_1 \\le \\alpha_2 \\le \\ldots \\le \\alpha_c,\\) reflejando la naturaleza acumulativa de la función de distribución \\(\\mathrm{Pr} ( y \\le j )\\). El modelo de razones proporcionales incorpora variables explicativas. Con este modelo, los logits acumulativos se expresan como \\[\\begin{equation} \\mathrm{logit}\\left(\\Pr ( y \\le j ) \\right) = \\alpha_j + \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta . \\tag{11.12} \\end{equation}\\] Este modelo proporciona interpretaciones de los parámetros similares a las descritas para la regresión logística en la Sección 11.4. Por ejemplo, si la variable \\(x_1\\) es continua, entonces como en la ecuación (11.1) tenemos \\[ \\beta_1 = \\frac{\\partial }{\\partial x_{i1}}\\left( \\alpha_j + \\mathbf{x}_i^{\\prime}\\boldsymbol \\beta \\right) = \\frac{\\frac{\\partial }{\\partial x_{i1}}\\Pr (y_i \\le j|\\mathbf{x}_i)/\\left( 1-\\Pr (y_ile j|\\mathbf{x}_i)\\right) }{\\Pr (y_ile j|\\mathbf{x}_i)/\\left( 1-\\Pr (y_ile j|\\mathbf{x}_i)\\right) }. \\] Por lo tanto, podemos interpretar \\(\\beta_1\\) como el cambio proporcional en la razón de probabilidades acumulativas. Ejemplo: Elección de Plan de Salud - Continuación. Pauly y Herring utilizaron datos de las Encuestas del Estudio de Seguimiento Comunitario de Hogares (CTS-HS) de 1996-1997 y 1998-1999 para estudiar la demanda de seguros de salud. Esta es una encuesta representativa a nivel nacional que contiene más de 60,000 individuos por período. Como una medida de la demanda, Pauly y Herring examinaron la elección de plan de salud, razonando que los individuos que eligieron (a través de empleo o membresía en una asociación) planes menos restrictivos buscaban una mayor protección para la atención médica. (También analizaron otras medidas, incluyendo el número de restricciones impuestas a los planes y la cantidad de compartición de costos.) Tabla 11.10 proporciona los determinantes de la elección de plan de salud basado en \\(n=34,486\\) individuos que tenían seguro de salud grupal, de entre 18 y 64 años sin seguro público. Pauly y Herring también compararon estos resultados con aquellos que tenían seguro de salud individual para entender las diferencias en los determinantes entre estos dos mercados. Tabla 11.10. Modelo de Logit Acumulativo para la Elección de Plan de Salud \\[ \\small{ \\begin{array}{llll} \\hline \\textbf{Variable} &amp; \\textbf{Razón de Probabilidades} &amp; \\textbf{Variable} &amp; \\textbf{Razón de Probabilidades} \\\\ \\hline \\text{Edad} &amp; 0.992^{***} &amp; \\text{Hispano} &amp; 1.735^{***} \\\\ \\text{Mujer} &amp; 1.064^{***} &amp; \\text{Tomador de riesgos} &amp; 0.967 \\\\ \\text{Tamaño de la familia} &amp; 0.985 &amp; \\text{Fumador} &amp; 1.055^{***} \\\\ \\text{Ingresos familiares} &amp; 0.963^{***} &amp; \\text{Salud regular/mala} &amp; 1.056 \\\\ \\text{Educación} &amp; 1.006 &amp; \\alpha_1 &amp; 0.769^{***} \\\\ \\text{Asiático} &amp; 1.180^{***} &amp; \\alpha_2 &amp; 1.406^{***} \\\\ \\text{Afroamericano} &amp; 1.643^{***} &amp; \\alpha_3 &amp; 12.089^{***} \\\\ \\text{R^2 Máximo Rescalado} &amp; 0.102 &amp; \\\\ \\hline \\end{array} } \\] Notas: Fuente: Pauly y Herring (2007). \\(^{***}\\) indica que los \\(p\\)-valores asociados son menores a 0.01. Para la raza, Caucásico es la variable omitida. Para interpretar las razones de probabilidades en Tabla 11.10, primero notamos que las estimaciones de los puntos de corte, correspondientes a \\(\\alpha_1,\\) \\(\\alpha_2\\) y \\(\\alpha_3\\), aumentan a medida que las opciones se vuelven menos restrictivas, como se anticipaba. Para el género, vemos que las probabilidades estimadas para las mujeres son 1.064 veces las de los hombres en la dirección de elegir un plan de salud menos restrictivo. Controlando por otras variables, las mujeres tienen más probabilidades de elegir planes menos restrictivos que los hombres. De manera similar, los más jóvenes, menos adinerados, no caucásicos y fumadores tienen más probabilidades de elegir planes menos restrictivos. Los coeficientes asociados con el tamaño de la familia, educación, toma de riesgos y salud auto-reportada no fueron estadísticamente significativos en este modelo ajustado. 11.6.2 Probit Acumulativo Como en la Sección 11.2.2 para la regresión logística, los modelos de logit acumulativo tienen una interpretación de umbral. Específicamente, sea \\(y_i^{\\ast}\\) una variable latente, no observada, aleatoria sobre la cual basamos la variable dependiente observada como \\[ y_i=\\left\\{ \\begin{array}{cc} 1 &amp; y_i^{\\ast} \\le \\alpha_1 \\\\ 2 &amp; \\alpha_1 &lt; y_i^{\\ast} \\le \\alpha_2 \\\\ \\vdots &amp; \\vdots \\\\ c-1 &amp; \\alpha_{c-2} &lt; y_i^{\\ast} \\le \\alpha_{c-1} \\\\ c &amp; \\alpha_{c-1} &lt; y_i^{\\ast}\\\\ \\end{array} \\right. . \\] Si \\(y_i^{\\ast} - \\mathbf{x}_i^{\\prime}\\boldsymbol \\beta\\) tiene una distribución logística, entonces \\[ \\Pr(y_i^{\\ast} - \\mathbf{x}_i^{\\prime}\\boldsymbol \\beta \\le a)=\\frac{1}{1+\\exp (-a)} \\] y por lo tanto \\[ \\Pr(y_i \\le j ) = \\Pr(y_i^{\\ast} \\le \\alpha_j) =\\frac{1}{1+\\exp \\left( -(\\alpha_j - \\mathbf{x}_i^{\\prime}\\boldsymbol \\beta) \\right)}. \\] Aplicando la transformación logit a ambos lados se obtiene la ecuación (11.12). Alternativamente, asumamos que \\(y_i^{\\ast} - \\mathbf{x}_i^{prime}\\boldsymbol \\beta\\) tiene una distribución normal estándar. Entonces, \\[ \\Pr(y_i \\le j ) = \\Pr(y_i^{\\ast} \\le \\alpha_j) =\\Phi \\left( \\alpha_j - \\mathbf{x}_i^{\\prime}\\boldsymbol \\beta \\right). \\] Este es el modelo de probit acumulativo. Al igual que en los modelos de variables binarias, el probit acumulativo da resultados que son similares al modelo logit acumulativo. 11.7 Lecturas Adicionales y Referencias Los modelos de regresión de variables binarias se utilizan ampliamente. Para introducciones más detalladas, consulte Hosmer y Lemshow (1989) o Agresti (1996). También puede examinar tratamientos más rigurosos como los de Agresti (1990) y Cameron y Trivedi (1998). El trabajo de Agresti (1990, 1996) discute variables dependientes multicategoría, al igual que el tratamiento avanzado de econometría en Amemiya (1985). Referencias del Capítulo Agresti, Alan (1990). Categorical Data Analysis. Wiley, New York. Agresti, Alan (1996). An Introduction to Categorical Data Analysis. Wiley, New York. Amemiya, Takeshi (1985). Advanced Econometrics. Harvard University Press, Cambridge, Massachusetts. Browne, Mark J. and Edward W. Frees (2007). Prohibitions on health insurance underwriting. Working paper. Cameron, A. Colin and Pravin K. Trivedi (1998). Regression Analysis of Count Data. Cambridge University Press, Cambridge. Carroll, Raymond J. and David Ruppert (1988). Transformation and Weighting in Regression. Chapman-Hall. Gourieroux, Christian and Joann Jasiak (2007). The Econometrics of Individual Risk. Princeton University Press, Princeton. Hand, D.J. and W. E. Henley (1997). Statistical classification methods in consumer credit scoring: A review. Journal of the Royal Statistical Society A, 160(3), 523-541. Hosmer, David W. and Stanley Lemeshow (1989). Applied Logistic Regression. Wiley, New York. Pauly, Mark V. and Bradley Herring (2007). The demand for health insurance in the group setting: Can you always get what you want? Journal of Risk and Insurance 74, 115-140. Smith, Richard M. and Phyllis Schumacher (2006). Academic attributes of college freshmen that lead to success in actuarial studies in a business college. Journal of Education for Business 81(5), 256-260. Valletta, R. G. (1999). Declining job security. Journal of Labor Economics 17, S170-S197. Wiginton, John C. (1980). A note on the comparison of logit and discriminant models of consumer credit behavior. Journal of Financial and Quantitative Analysis 15(3), 757-770. 11.8 Ejercicios 11.1 Similitud entre Logit y Probit. Suponga que la variable aleatoria \\(y^{\\ast}\\) tiene una función de distribución logit, \\(\\Pr(y^{\\ast} le y) = \\mathrm{F}(y) = e^y/(1+e^y).\\) Calcule la correspondiente función de densidad de probabilidad. Utilice la función de densidad de probabilidad para calcular la media (\\(\\mu_y\\)). Calcule la desviación estándar correspondiente (\\(\\sigma_y\\)). Defina la variable aleatoria reescalada \\(y^{\\ast \\ast} =\\frac{y^{\\ast}-\\mu_y}{\\sigma_y}.\\) Determine la función de densidad de probabilidad para \\(y^{\\ast \\ast}\\). Trace la función de densidad de probabilidad en la parte (d). Superponga este gráfico con uno de una función de densidad de probabilidad normal estándar. (Esto proporciona una versión de la función de densidad de las gráficas de la función de distribución en la Figura 11.1.) 11.2 Interpretación de umbral del modelo de regresión probit. Considere un modelo lineal subyacente, \\(y_i^{\\ast }=\\mathbf{x}_i^{\\mathbf{ \\prime }}\\boldsymbol \\beta+\\epsilon_i^{\\ast }\\), donde \\(\\epsilon_i^{\\ast }\\) está distribuido normalmente con media cero y varianza \\(\\sigma ^{2}\\). Defina \\(y_i=\\mathrm{I}(y_i^{\\ast }&gt;0),\\) donde I(\\(\\cdot\\)) es la función indicadora. Muestre que \\(\\pi_i=\\Pr (y_i=1|\\mathbf{x}_i)\\) \\(=\\mathrm{\\Phi }(\\mathbf{x}_i^{\\mathbf{\\prime }}\\mathbf{\\beta /\\sigma })\\), donde \\(\\mathrm{\\Phi }(\\cdot)\\) es la función de distribución normal estándar. 11.3 Interpretación de utilidad aleatoria del modelo de regresión logística. Bajo la interpretación de utilidad aleatoria, un individuo con utilidad $ U_{ij}=u_i(V_{ij}+_{ij})$, donde \\(j\\) puede ser 1 o 2, selecciona la categoría correspondiente a \\(j=1\\) con probabilidad \\[\\begin{eqnarray*} \\pi_i &amp;=&amp; \\Pr (y_i =1)=\\mathrm{\\Pr }(U_{i2}&lt;U_{i1}) \\\\ &amp;=&amp;\\mathrm{\\Pr }(\\epsilon _{i2}-\\epsilon _{i1}&lt;V_{i1}-V_{i2}). \\end{eqnarray*}\\] Como en la Sección 11.2.3, tomamos \\(V_{i2}=0\\) y \\(V_{i1}=\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta\\). Supongamos además que los errores provienen de una distribución de valor extremo de la forma \\[ \\Pr (\\epsilon_{ij}&lt;a)=\\exp (-e^{-a}). \\] Muestre que la probabilidad de elección \\(\\pi_i\\) tiene una forma logit. Es decir, muestre que \\[ \\pi_i=\\frac{1}{1+\\exp (-\\mathbf{x}_i^{\\mathbf{\\prime }}\\boldsymbol \\beta)}. \\] 11.4 Dos Poblaciones. Comience con una población y suponga que \\(y_1, \\ldots, y_n\\) es una muestra i.i.d. de una distribución Bernoulli con media \\(\\pi\\). Muestre que el estimador de máxima verosimilitud de \\(\\pi\\) es \\(\\overline{y}\\). Ahora considere dos poblaciones. Suponga que \\(y_1, \\ldots, y_{n_1}\\) es una muestra i.i.d. de una distribución Bernoulli con media \\(\\pi_1\\) y que \\(y_{n_1+1}, \\ldots, y_{n_1+n_2}\\) es una muestra i.i.d. de una distribución Bernoulli con media \\(\\pi_2\\), donde las muestras son independientes entre sí. b(i). Muestre que el estimador de máxima verosimilitud de \\(\\pi_2 - \\pi_1\\) es \\(\\overline{y}_2 - \\overline{y}_1\\). b(ii). Determine la varianza del estimador en la parte b(i). Ahora exprese el problema de las dos poblaciones en un contexto de regresión usando una variable explicativa. Específicamente, suponga que \\(x_i\\) solo toma los valores 0 y 1. De las \\(n\\) observaciones, \\(n_1\\) toman el valor \\(x=0\\). Estas \\(n_1\\) observaciones tienen un valor promedio de \\(y\\) de \\(\\overline{y}_1\\). Las restantes \\(n_2 =n-n_1\\) observaciones tienen el valor \\(x=1\\) y un valor promedio de \\(y\\) de \\(\\overline{y}_2\\). Usando el caso logit, sea \\(b_{0,MLE}\\) y \\(b_{1,MLE}\\) representen los estimadores de máxima verosimilitud de \\(\\beta_0\\) y \\(\\beta_1\\), respectivamente. c(i). Muestre que los estimadores de máxima verosimilitud satisfacen las ecuaciones \\[ \\overline{y}_1 = \\mathrm{\\pi}\\left(b_{0,MLE}\\right) \\] y \\[ \\overline{y}_2 = \\mathrm{\\pi}\\left(b_{0,MLE}+b_{1,MLE}\\right). \\] c(ii). Use la parte c(i) para mostrar que el estimador de máxima verosimilitud para \\(\\beta_1\\) es \\(\\mathrm{\\pi}^{-1}(\\overline{y}_2)-\\mathrm{\\pi}^{-1}(\\overline{y}_1)\\). c(iii). Con la notación \\(\\pi_1 = \\mathrm{\\pi}(\\beta_0)\\) y \\(\\pi_2 = \\mathrm{\\pi}(\\beta_0 +\\beta_1)\\), confirme que la matriz de información se puede expresar como \\[ \\mathbf{I}(\\beta_0, \\beta_1) = n_1 \\pi_1 (1-\\pi_1) \\left( \\begin{array}{cc} 1 &amp; 0 \\\\ 0 &amp; 0 \\\\ \\end{array} \\right) + n_2 \\pi_2 (1-\\pi_2) \\left( \\begin{array}{cc} 1 &amp; 1 \\\\ 1 &amp; 1 \\\\ \\end{array} \\right). \\] c(iv). Utilice la matriz de información para determinar la varianza en muestras grandes del estimador de máxima verosimilitud para \\(\\beta_1\\). 11.5 Valores Ajustados. Sea \\(\\widehat{y}_i = \\mathrm{\\pi }\\left( \\mathbf{x}_i^{\\prime} \\mathbf{b}_{MLE})\\right)\\) el \\(i\\)-ésimo valor ajustado para la función logit. Suponga que se utiliza un intercepto en el modelo, de modo que una de las variables explicativas \\(x\\) es una constante igual a uno. Muestre que la respuesta promedio es igual al valor ajustado promedio, es decir, muestre que \\(\\overline{y} = n^{-1} \\sum_{i=1}^n \\widehat{y}_i\\). 11.6 Comenzando con las ecuaciones de puntaje (11.4), verifique la expresión para el caso logit en la ecuación (11.5). 11.7 Matriz de Información Comenzando con la función de puntaje para el caso logit en la ecuación (11.5), muestre que la matriz de información puede ser expresada como \\[ \\mathbf{I}(\\boldsymbol \\beta) = \\sum\\limits_{i=1}^{n} \\sigma_i^2 \\mathbf{x}_i\\mathbf{x}_i^{\\mathbf{\\prime }}, \\] donde \\(\\sigma_i^2 = \\mathrm{\\pi}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta)(1-\\mathrm{\\pi}(\\mathbf{x}_i^{\\prime}\\boldsymbol \\beta))\\). Comenzando con la función de puntaje general en la ecuación (11.4), determine la matriz de información. 11.8 Reclamaciones de seguro por lesiones en automóviles. Refiérase a la descripción en el Ejercicio 1.5. Consideramos \\(n=1,340\\) reclamaciones por responsabilidad civil por lesiones corporales de un solo estado utilizando una encuesta de 2002 realizada por el Consejo de Investigación de Seguros (IRC). El IRC es una división del Instituto Americano de Chartered Property Casualty Underwriters y el Instituto de Seguros de América. La encuesta solicitó a las empresas participantes que informaran sobre reclamaciones cerradas con pago durante un período de dos semanas designado. En esta asignación, nos interesa entender las características de los demandantes que eligen ser representados por un abogado al resolver su reclamo. Las descripciones de las variables se dan en la Tabla 11.11. knitr::kable(2, caption = &quot;Silly. Create a table just to update the counter...&quot;) Tabla 11.10: Silly. Create a table just to update the counter… x 2 Tabla 11.11: Reclamaciones por Lesiones Corporales Variable \\(\\textbf{Descripción}\\) ATTORNEY si el reclamante está representado por un abogado (=1 si sí y =2 si no) CLMAGE edad del reclamante CLMSEX género del reclamante (=1 si masculino y =2 si femenino) MARITAL estado civil del reclamante (=1 si casado, =2 si soltero, =3 si viudo, y =4 si divorciado/separado) SEATBELT si el reclamante estaba usando un cinturón de seguridad/restricción infantil (=1 si sí, =2 si no, y =3 si no aplicable) CLMINSUR si el conductor del vehículo del reclamante estaba sin seguro (=1 si sí, =2 si no, y =3 si no aplicable) LOSS pérdida económica total del reclamante (en miles). Estadísticas Resumidas. Calcule histogramas y estadísticas resumidas de las variables explicativas continuas CLMAGE y LOSS. Basado en estos resultados, cree una versión logarítmica de LOSS, llamada lnLOSS. Examine las medias de CLMAGE, LOSS y lnLOSS por nivel de ATTORNEY. ¿Sugieren estas estadísticas que las variables continuas difieren según ATTORNEY? Cree tablas de conteo (o porcentajes) de ATTORNEY por nivel de CLMSEX, MARITAL, SEATBELT y CLMINSUR. ¿Sugieren estas estadísticas que las variables categóricas difieren según ATTORNEY? Identifique el número de valores faltantes para cada variable explicativa. Modelos de Regresión Logística. Ejecute un modelo de regresión logística utilizando solo la variable explicativa CLMSEX. ¿Es un factor importante para determinar el uso de un abogado? Proporcione una interpretación en términos de las probabilidades de usar un abogado. Ejecute un modelo de regresión logística utilizando las variables explicativas CLMAGE, CLMSEX, MARITAL, SEATBELT y CLMINSUR. ¿Qué variables parecen ser estadísticamente significativas? Para el modelo en la parte (ii), ¿quién usa más abogados, hombres o mujeres? Proporcione una interpretación en términos de las probabilidades de usar un abogado para la variable CLMSEX. Ejecute un modelo de regresión logística utilizando las variables explicativas CLMAGE, CLMSEX, MARITAL, SEATBELT, CLMINSUR, LOSS y lnLOSS. Decida cuál de las dos medidas de pérdida es más importante y vuelva a ejecutar el modelo utilizando solo una de estas variables. En este modelo, ¿es la medida de las pérdidas una variable estadísticamente significativa? Ejecute su modelo en la parte (iv) pero omitiendo la variable CLMAGE. Describa las diferencias entre este ajuste de modelo y el de la parte (iv), enfocándose en las variables estadísticamente significativas y en el número de observaciones utilizadas en el ajuste del modelo. Considere un reclamante masculino soltero de 32 años de edad. Suponga que el reclamante estaba usando un cinturón de seguridad, que el conductor estaba asegurado y la pérdida económica total es de $5,000. Para el modelo en la parte (iv), ¿cuál es la estimación de la probabilidad de usar un abogado? Regresión Probit. Repita la parte b(v) utilizando modelos de regresión probit, pero interprete solo el signo de los coeficientes de regresión. 11.9 Carreras de Caballos en Hong Kong. El hipódromo es un ejemplo fascinante de la dinámica de los mercados financieros en acción. Vamos a la pista y hagamos una apuesta. Supongamos que, de un campo de 10 caballos, simplemente queremos elegir un ganador. En el contexto de la regresión, dejaremos que \\(y\\) sea la variable de respuesta que indica si un caballo gana (\\(y\\) = 1) o no (\\(y\\) = 0). De los formularios de carreras, periódicos, y otras fuentes, hay muchas variables explicativas que están disponibles públicamente y que podrían ayudarnos a predecir el resultado para \\(y\\). Algunas variables candidatas pueden incluir la edad del caballo, el rendimiento reciente del caballo y el jinete, el pedigrí del caballo, y así sucesivamente. Estas variables son evaluadas por los inversores presentes en la carrera, la multitud apostadora. Al igual que en muchos mercados financieros, resulta que una de las variables explicativas más útiles es la evaluación general de la multitud sobre las habilidades del caballo. Estas evaluaciones no se hacen basadas en una encuesta de la multitud, sino más bien en función de las apuestas realizadas. La información sobre las apuestas de la multitud está disponible en un gran cartel en la carrera llamado el tote board (tablero de apuestas). El tote board muestra las probabilidades de que cada caballo gane una carrera. Tabla 11.12 es un tote board hipotético para una carrera de 10 caballos. Tabla 11.12. Tote Board Hipotético \\[ \\scriptsize{ \\begin{array}{l|cccccccccc} \\hline \\text{Caballo} &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 &amp; 10 \\\\ \\text{Probabilidades Publicadas} &amp; 1-1 &amp; 79-1 &amp; 7-1 &amp; 3-1 &amp; 15-1 &amp; 7-1 &amp; 49-1 &amp; 49-1 &amp; 19-1 &amp; 79-1 \\\\ \\hline \\end{array} } \\] Las probabilidades que aparecen en el tote board han sido ajustadas para proporcionar una “tasa de la pista.” Es decir, por cada dólar apostado, $\\(T\\) va a la pista por patrocinar la carrera y $(1-\\(T\\)) va a los apostadores ganadores. Las tasas típicas de la pista están en el orden del veinte por ciento, o \\(T\\)=0.20. Podemos convertir fácilmente las probabilidades en el tote board en la evaluación de la multitud de las probabilidades de ganar. Para ilustrar esto, Tabla 11.13 muestra apuestas hipotéticas para ganar que resultaron en la información mostrada en el tote board hipotético en la Tabla 11.12. Tabla 11.13. Apuestas Hipotéticas \\[ \\scriptsize{ \\begin{array}{l|cccccccccc} \\hline \\text{Caballo} &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 &amp; 10 &amp; Total\\\\ \\hline \\text{Apuestas} para Ganar &amp; 8,000 &amp; 200 &amp; 2,000 &amp; 4,000 &amp; 1,000 &amp; 3,000 &amp; 400 &amp; 400 &amp; 800 &amp; 200 &amp; 20,000 \\\\ \\text{Probabilidad} &amp; 0.40 &amp; 0.01 &amp; 0.10 &amp; 0.20 &amp; 0.05 &amp; 0.15 &amp; 0.02 &amp; 0.02 &amp; 0.04 &amp; 0.02 &amp; 1.000 \\\\ \\text{Probabilidades Publicadas} &amp; 1-1 &amp; 79-1 &amp; 7-1 &amp; 3-1 &amp; 15-1 &amp; 7-1 &amp; 49-1 &amp; 49-1 &amp; 19-1 &amp; 79-1 \\\\ \\hline \\end{array} } \\] Para esta carrera hipotética, se apostaron 20,000 para ganar. Debido a que 8,000 de estos 20,000 se apostaron en el primer caballo, interprete la relación 8000/20000 = 0.40 como la evaluación de la multitud de la probabilidad de ganar. Las probabilidades teóricas se calculan como 0.4/(1-0.4) = 2/3, o una apuesta de 0.67 gana 1. Sin embargo, las probabilidades teóricas asumen un juego justo sin tasa de la pista. Para ajustar al hecho de que solo (1-\\(T\\)) están disponibles para el ganador, las probabilidades publicadas para este caballo serían 0.4/(1-\\(T\\)-0.4) = 1, si \\(T\\)=0.20. En este caso, ahora se requiere una apuesta de 1 para ganar 1. Entonces tenemos la relación \\(probabilidades~ajustadas = x/(1-T-x)\\), donde \\(x\\) es la evaluación de la multitud de la probabilidad de ganar. Antes del inicio de la carrera, el tote board nos proporciona probabilidades ajustadas que pueden convertirse fácilmente en \\(x\\), la evaluación de la multitud sobre ganar. Usamos esta medida para ayudarnos a predecir \\(y\\), el evento de que el caballo realmente gane la carrera. Consideramos datos de 925 carreras realizadas en Hong Kong desde septiembre de 1981 hasta septiembre de 1989. En cada carrera, había diez caballos, uno de los cuales fue seleccionado aleatoriamente para estar en la muestra. En los datos, use FINISH = \\(y\\) como el indicador de que un caballo gane una carrera y WIN = \\(x\\) como la evaluación a priori de la multitud de la probabilidad de que un caballo gane una carrera. Un colega estadísticamente ingenuo quisiera duplicar el tamaño de la muestra eligiendo dos caballos de cada carrera en lugar de seleccionar aleatoriamente un caballo de un campo de 10. Describa la relación entre las variables dependientes de los dos caballos seleccionados. Explique cómo esto viola las suposiciones del modelo de regresión. Calcule la media de FINISH y las estadísticas resumidas de WIN. Note que la desviación estándar de FINISH es mayor que la de WIN, aunque las medias de las muestras sean aproximadamente las mismas. Para la variable FINISH, ¿cuál es la relación entre la media muestral y la desviación estándar? Calcule las estadísticas resumidas de WIN por nivel de FINISH. Note que la media muestral es mayor para los caballos que ganaron (FINISH = 1) que para aquellos que perdieron (FINISH = 0). Interprete este resultado. Estime un modelo de probabilidad lineal, utilizando WIN para predecir FINISH. ¿Es WIN un predictor estadísticamente significativo de FINISH? ¿Qué tan bien se ajusta este modelo a los datos utilizando la estadística de bondad de ajuste habitual? Para este modelo estimado, ¿es posible que los valores ajustados se encuentren fuera del intervalo [0, 1]? Note que, por definición, la variable x WIN debe estar dentro del intervalo [0, 1]. Estime un modelo de regresión logística, utilizando WIN para predecir FINISH. ¿Es WIN un predictor estadísticamente significativo de FINISH? Compare los valores ajustados de los modelos en las partes (d) y (e) Para cada modelo, proporcione valores ajustados en WIN = 0, 0.01, 0.05, 0.10 y 1.0. Trace un gráfico de los valores ajustados del modelo de probabilidad lineal versus los valores ajustados del modelo de regresión logística. Interprete WIN como la evaluación a priori de la multitud de la probabilidad de que un caballo gane una carrera. Los valores ajustados, FINISH, es su nueva estimación de la probabilidad de que un caballo gane una carrera, basada en la evaluación de la multitud. Trace el gráfico de la diferencia FINISH - WIN versus WIN. Discuta una estrategia de apuestas que podría emplear basada en la diferencia, FINISH - WIN. 11.10 Demanda de Seguro de Vida a Término. Continuamos nuestro estudio de la Demanda de Seguro de Vida a Término de los Capítulos 3 y 4. Específicamente, examinamos la Encuesta de Finanzas del Consumidor (SCF) de 2004, una muestra representativa a nivel nacional que contiene información extensa sobre activos, pasivos, ingresos y características demográficas de los encuestados (potenciales clientes de EE. UU.). Ahora volvemos a la muestra original de \\(n=500\\) familias con ingresos positivos y estudiamos si una familia compra o no seguro de vida a término. De nuestra muestra, resulta que 225 no compraron (FACEPOS=0), mientras que 275 sí compraron seguro de vida a término (FACEPOS=1). Estadísticas Resumidas. Proporcione una tabla de medias de las variables explicativas por nivel de la variable dependiente FACEPOS. Interprete lo que aprendemos de esta tabla. Modelo de Probabilidad Lineal. Ajuste un modelo de probabilidad lineal usando FACEPOS como la variable dependiente y LINCOME, EDUCATION, AGE y GENDER como variables explicativas continuas, junto con el factor MARSTAT. b(i). Defina brevemente un modelo de probabilidad lineal. b(ii). Comente sobre la calidad del modelo ajustado. b(iii). ¿Cuáles son los tres principales inconvenientes del modelo de probabilidad lineal? Modelo de Regresión Logística. Ajuste un modelo de regresión logística utilizando el mismo conjunto de variables explicativas. c(i). Identifique qué variables parecen ser estadísticamente significativas. En su identificación, describa la base para sus conclusiones. c(ii). ¿Qué medida resume la bondad de ajuste? Modelo de Regresión Logística Reducido. Defina MARSTAT1 como una variable binaria que indica MARSTAT=1. Ajuste un segundo modelo de regresión logística utilizando LINCOME, EDUCATION y MARSTAT1. d(i). Compare estos dos modelos, utilizando una prueba de razón de verosimilitud. Establezca sus hipótesis nula y alternativa, criterio de decisión y su regla de decisión. d(ii). ¿Quién es más probable que compre un seguro de vida a término, casados o no casados? Proporcione una interpretación en términos de las probabilidades de comprar un seguro de vida a término para la variable MARSTAT1. d(iii). Considere a un hombre casado que tiene 54 años. Suponga que esta persona tiene 13 años de educación, un salario anual de $70,000 y vive en un hogar compuesto por cuatro personas. Para este modelo, ¿cuál es la estimación de la probabilidad de comprar un seguro de vida a término? 11.11 Éxito en los Estudios Actuariales. Al igual que en los campos médicos y legales, los miembros de la profesión actuarial enfrentan problemas interesantes y generalmente son bien remunerados por sus esfuerzos en resolver estos problemas. También, como en las profesiones médicas y legales, las barreras educativas para convertirse en actuario son desafiantes, limitando la entrada en el campo. Para asesorar a los estudiantes sobre si tienen el potencial para cumplir con las demandas de este campo intelectualmente desafiante, Smith y Schumacher (2006) estudiaron los atributos de los estudiantes en una facultad de negocios. Específicamente, examinaron a \\(n=185\\) estudiantes de primer año en la Universidad de Bryant en Rhode Island que habían comenzado sus carreras universitarias entre 1995 y 2001. La variable dependiente de interés era si se graduaron con una concentración en actuaría, para estos estudiantes el primer paso para convertirse en actuario profesional. De estos, 77 se graduaron con una concentración en actuaría y los otros 108 abandonaron la concentración (en Bryant, la mayoría se transfirió a otras concentraciones, aunque algunos dejaron la universidad). Smith y Schumacher (2006) informaron sobre los efectos de cuatro mecanismos de evaluación temprana, así como GENDER, una variable de control. Los mecanismos de evaluación fueron: PLACE%, rendimiento en un examen de ubicación matemática administrado justo antes del primer año, MSAT y VSAT, las porciones de matemáticas (M) y verbal (V) del Scholastic Aptitude Test (SAT), y RANK, el rango en la escuela secundaria dado como una proporción (siendo más cercano a uno mejor). La Tabla 11.14 muestra que los estudiantes que eventualmente se graduaron con una concentración en actuaría obtuvieron mejores resultados en estos mecanismos de evaluación temprana que los que abandonaron la concentración actuarial. Se ajustó una regresión logística a los datos, con los resultados reportados en la Tabla 11.14. Para tener una idea de qué variables son estadísticamente significativas, calcule los \\(t\\)-ratios para cada variable. Para cada variable, indique si es o no estadísticamente significativa. Para tener una idea del impacto relativo de los mecanismos de evaluación, use los coeficientes en la Tabla 11.14 para calcular las probabilidades de éxito estimadas para las siguientes combinaciones de variables. En sus cálculos, asuma que GENDER=1. b(i). Asuma PLACE% =0.80, MSAT = 680, VSAT=570 y RANK=0.90. b(ii). Asuma PLACE% =0.60, MSAT = 680, VSAT=570 y RANK=0.90. b(iii). Asuma PLACE% =0.80, MSAT = 620, VSAT=570 y RANK=0.90. b(iv). Asuma PLACE% =0.80, MSAT = 680, VSAT=540 y RANK=0.90. b(v). Asuma PLACE% =0.80, MSAT = 680, VSAT=570 y RANK=0.70. knitr::kable(2, caption = &quot;Silly. Create a table just to update the counter...&quot;) Tabla 11.12: Silly. Create a table just to update the counter… x 2 knitr::kable(2, caption = &quot;Silly.&quot;) Tabla 11.13: Silly. x 2 Tabla 11.14: Estadísticas Resumidas y Ajustes de Regresión Logística para Predecir Graduación Actuarial Promedio para Actuariales Regresión Logística Variable Graduados Desertores Estimación Error Estándar Intercepto -12.094 2.575 GENDER 0.256 0.407 PLACE% 0.83 0.64 4.336 1.657 MSAT 679.25 624.25 0.008 0.004 VSAT 572.2 544.25 -0.002 0.003 RANK 0.88 0.76 4.442 1.836 11.12 Caso-Control. Considere el siguiente método de selección de muestra “caso-control” para variables dependientes binarias. Intuitivamente, si estamos trabajando con un problema donde el evento de interés es raro, queremos asegurarnos de que muestreamos una cantidad suficiente de eventos para que nuestros procedimientos de estimación sean confiables. Suponga que tenemos una gran base de datos que consiste en \\(\\{y_i, \\mathbf{x}_i\\}\\), con \\(i=1,\\ldots, N\\) observaciones. (Para los registros de una compañía de seguros, \\(N\\) podría fácilmente ser de diez millones o más). Queremos asegurarnos de obtener una cantidad suficiente de \\(y_i = 1\\) (correspondiente a reclamaciones o “casos”) en nuestra muestra, más una muestra de \\(y_i = 0\\) (correspondiente a no reclamaciones o “controles”). Por lo tanto, dividimos el conjunto de datos en dos subconjuntos. Para el primer subconjunto que consiste en observaciones con \\(y_i = 1\\), tomamos una muestra aleatoria con probabilidad \\(\\tau_1\\). De manera similar, para el segundo subconjunto que consiste en observaciones con \\(y_i = 0\\), tomamos una muestra aleatoria con probabilidad \\(\\tau_0\\). Por ejemplo, en la práctica podríamos usar \\(\\tau_1=1\\) y \\(\\tau_0 = 0.10\\), lo que correspondería a tomar todas las reclamaciones y una muestra del 10% de no reclamaciones - por lo tanto, se considera que \\(\\tau_1\\) y \\(\\tau_0\\) son conocidos por el analista. Sea \\(\\{r_i = 1\\}\\) el evento que indica que la observación es seleccionada para ser parte del análisis. Determine \\(\\Pr(y_i = 1, r_i = 1)\\), \\(\\Pr(y_i = 0, r_i = 1)\\) y \\(\\Pr(r_i = 1)\\) en términos de \\(\\tau_0\\), \\(\\tau_1\\) y \\(\\pi_i = \\Pr(y_i=1)\\). Usando los cálculos en la parte (a), determine la probabilidad condicional \\(\\Pr(y_i=1 | r_i=1)\\). Ahora suponga que \\(\\pi_i\\) tiene una forma logística (\\(\\pi(z) = \\exp(z)/(1+\\exp(z))\\) y \\(\\pi_i= \\pi(\\mathbf{x}_i^{\\prime}\\boldsymbol \\beta ))\\). Reescriba su respuesta a la parte (b) usando esta forma logística. Escriba la verosimilitud de los \\(y_i\\) observados (condicional en \\(r_i = 1, i=1, \\ldots, n\\)). Muestre cómo podemos interpretar esto como la verosimilitud de una regresión logística usual con la excepción de que el intercepto ha cambiado. Especifique el nuevo intercepto en términos del intercepto original, \\(\\tau_0\\) y \\(\\tau_1\\). 11.9 Suplementos Técnicos - Inferencia Basada en Verosimilitud Comencemos con variables aleatorias \\(\\left( y_1, \\ldots, y_n \\right) ^{\\prime} = \\mathbf y\\) cuya distribución conjunta es conocida hasta un vector de parámetros \\(\\boldsymbol \\theta\\). En aplicaciones de regresión, \\(\\boldsymbol \\theta\\) consiste en los coeficientes de regresión, \\(\\boldsymbol \\beta\\), y posiblemente un parámetro de escala \\(\\sigma^2\\) así como parámetros adicionales. Esta función de densidad de probabilidad conjunta se denota como \\(\\mathrm{f}(\\mathbf{y};\\boldsymbol \\theta)\\). La función también puede ser una función de masa de probabilidad para variables aleatorias discretas o una distribución mixta para variables aleatorias que tienen componentes discretos y continuos. En cada caso, podemos usar la misma notación, \\(\\mathrm{f}(\\mathbf{y};\\boldsymbol \\theta),\\) y llamarla la función de verosimilitud. La verosimilitud es una función de los parámetros con los datos (\\(\\mathbf{y}\\)) fijos en lugar de una función de los datos con los parámetros (\\(\\boldsymbol \\theta\\)) fijos. Es habitual trabajar con la versión logarítmica de la función de verosimilitud y así definimos la función de log-verosimilitud como \\[ L(\\boldsymbol \\theta) = L(\\mathbf{y};\\boldsymbol \\theta ) = \\ln \\mathrm{f}(\\mathbf{y};\\boldsymbol \\theta), \\] evaluada en una realización de \\(\\mathbf{y}\\). En parte, esto se debe a que a menudo trabajamos con el caso especial importante donde las variables aleatorias \\(y_1, \\ldots, y_n\\) son independientes. En este caso, la función de densidad conjunta se puede expresar como un producto de las funciones de densidad marginales y, al tomar logaritmos, podemos trabajar con sumas. Incluso cuando no se trata de variables aleatorias independientes, como con datos de series temporales, a menudo es más conveniente desde el punto de vista computacional trabajar con log-verosimilitudes en lugar de la función de verosimilitud original. 11.9.1 Propiedades de las Funciones de Verosimilitud Dos propiedades básicas de las funciones de verosimilitud son: \\[\\begin{equation} \\mathrm{E} \\left( \\frac{ \\partial}{\\partial \\boldsymbol \\theta} L(\\boldsymbol \\theta) \\right) = \\mathbf 0 \\tag{11.13} \\end{equation}\\] y \\[\\begin{equation} \\mathrm{E} \\left( \\frac{ \\partial^2}{\\partial \\boldsymbol \\theta \\partial \\boldsymbol \\theta^{\\prime}} L(\\boldsymbol \\theta) \\right) + \\mathrm{E} \\left( \\frac{ \\partial L(\\boldsymbol \\theta)}{\\partial \\boldsymbol \\theta} \\frac{ \\partial L(\\boldsymbol \\theta)}{\\partial \\boldsymbol \\theta^{\\prime}} \\right) = \\mathbf 0. \\tag{11.14} \\end{equation}\\] La derivada de la función de log-verosimilitud, \\(\\partial L(\\boldsymbol \\theta)/\\partial \\boldsymbol \\theta\\), se llama función de puntaje. La ecuación (11.13) muestra que la función de puntaje tiene media cero. Para ver esto, bajo condiciones de regularidad adecuadas, tenemos \\[\\begin{eqnarray*} \\mathrm{E} \\left( \\frac{ \\partial}{\\partial \\boldsymbol \\theta} L(\\boldsymbol \\theta) \\right) &amp;=&amp; \\mathrm{E} \\left( \\frac{ \\frac{\\partial}{\\partial \\boldsymbol \\theta} \\mathrm{f}(\\mathbf{y};\\boldsymbol \\theta )}{\\mathrm{f}(\\mathbf{y};\\boldsymbol \\theta )} \\right) = \\int \\frac{\\partial}{\\partial \\boldsymbol \\theta} \\mathrm{f}(\\mathbf{y};\\boldsymbol \\theta ) d \\mathbf y = \\frac{\\partial}{\\partial \\boldsymbol \\theta} \\int \\mathrm{f}(\\mathbf{y};\\boldsymbol \\theta ) d \\mathbf y \\\\ &amp;=&amp; \\frac{\\partial}{\\partial \\boldsymbol \\theta} 1 = \\mathbf 0. \\end{eqnarray*}\\] Por conveniencia, esta demostración asume una densidad para f(\\(\\cdot\\)); las extensiones a distribuciones de masa y mixtas son sencillas. La demostración de la ecuación (11.14) es similar y se omite. Para establecer la ecuación (11.13), implícitamente utilizamos “condiciones de regularidad adecuadas” para permitir el intercambio de la derivada y el signo de integral. Para ser más precisos, un analista que trabaje con un tipo específico de distribución puede utilizar esta información para verificar que el intercambio de la derivada y el signo de integral es válido. Usando la ecuación (11.14), podemos definir la matriz de información \\[\\begin{equation} \\mathbf{I}(\\boldsymbol \\theta) = \\mathrm{E} \\left( \\frac{ \\partial L(\\boldsymbol \\theta)}{\\partial \\boldsymbol \\theta} \\frac{ \\partial L(\\boldsymbol \\theta)}{\\partial \\boldsymbol \\theta^{\\prime}} \\right) = -\\mathrm{E} \\left( \\frac{ \\partial^2}{\\partial \\boldsymbol \\theta \\partial \\boldsymbol \\theta^{\\prime}} L(\\boldsymbol \\theta) \\right). \\tag{11.15} \\end{equation}\\] Esta cantidad se utiliza ampliamente en el estudio de las propiedades de muestras grandes de las funciones de verosimilitud. La matriz de información aparece en la distribución de muestras grandes de la función de puntaje. Específicamente, bajo condiciones amplias, tenemos que \\(\\partial L(\\boldsymbol \\theta)/\\partial \\boldsymbol \\theta\\) tiene una distribución normal en muestras grandes con media 0 y varianza \\(\\mathbf{I}(\\boldsymbol \\theta)\\). Para ilustrar, supongamos que las variables aleatorias son independientes, de modo que la función de puntaje se puede escribir como \\[ \\frac{ \\partial}{\\partial \\boldsymbol \\theta} L(\\boldsymbol \\theta) =\\frac{ \\partial}{\\partial \\boldsymbol \\theta} \\ln \\prod_{i=1}^n \\mathrm{f}(y_i;\\boldsymbol \\theta ) =\\sum_{i=1}^n \\frac{ \\partial}{\\partial \\boldsymbol \\theta} \\ln \\mathrm{f}(y_i;\\boldsymbol \\theta ). \\] La función de puntaje es la suma de variables aleatorias con media cero debido a la ecuación (11.13); los teoremas del límite central están ampliamente disponibles para garantizar que las sumas de variables aleatorias independientes tengan distribuciones normales en muestras grandes (ver Sección 1.4 para un ejemplo). Además, si las variables aleatorias son idénticas, entonces a partir de la ecuación (11.15) podemos ver que el segundo momento de \\(\\partial \\ln \\mathrm{f}(y_i;\\boldsymbol \\theta ) /\\partial \\boldsymbol \\theta\\) es la matriz de información, obteniendo el resultado. 11.9.2 Estimadores de Máxima Verosimilitud Los estimadores de máxima verosimilitud son valores de los parámetros \\(\\boldsymbol \\theta\\) que son “más probables” de haber sido producidos por los datos. El valor de \\(\\boldsymbol \\theta\\), denotado como \\(\\boldsymbol \\theta_{MLE}\\), que maximiza \\(\\mathrm{f}(\\mathbf{y};\\boldsymbol \\theta)\\) se llama el estimador de máxima verosimilitud. Debido a que \\(\\ln(\\cdot)\\) es una función uno a uno, también podemos determinar \\(\\boldsymbol \\theta_{MLE}\\) maximizando la función de log-verosimilitud, \\(L(\\boldsymbol \\theta)\\). Bajo condiciones amplias, tenemos que \\(\\boldsymbol \\theta_{MLE}\\) tiene una distribución normal en muestras grandes con media \\(\\boldsymbol \\theta\\) y varianza \\(\\left( \\mathbf{I}(\\boldsymbol \\theta) \\right)^{-1}\\). Este es un resultado crítico sobre el cual se basa gran parte de la estimación y la prueba de hipótesis. Para subrayar este resultado, examinamos el caso especial de la regresión “basada en normales”. Caso Especial. Regresión con distribuciones normales. Supongamos que \\(y_1, \\ldots, y_n\\) son independientes y están distribuidos normalmente, con media \\(\\mathrm{E~}y_i = \\mu_i = \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta\\) y varianza \\(\\sigma^2\\). Los parámetros se pueden resumir como \\(\\boldsymbol \\theta = \\left( \\boldsymbol \\beta^{\\prime}, \\sigma^2 \\right)^{\\prime}.\\) Recordemos de la ecuación (1.1) que la función de densidad de probabilidad normal es \\[ \\mathrm{f}(y; \\mu_i, \\sigma^2)=\\frac{1}{\\sigma \\sqrt{2\\pi }}\\exp \\left( -\\frac{1}{2\\sigma^2}\\left( y-\\mu_i \\right)^2\\right) . \\] Con esto, los dos componentes de la función de puntaje son \\[\\begin{eqnarray*} \\frac{ \\partial}{\\partial \\boldsymbol \\beta} L(\\boldsymbol \\theta) &amp;=&amp; \\sum_{i=1}^n \\frac{ \\partial}{\\partial \\boldsymbol \\beta} \\ln \\mathrm{f}(y_i; \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta, \\sigma^2) =-\\frac{1}{2\\sigma^2} \\sum_{i=1}^n \\frac{ \\partial}{\\partial \\boldsymbol \\beta} \\left(y_i-\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta \\right)^2 \\\\ &amp;=&amp; -\\frac{(-2)}{2 \\sigma^2} \\sum_{i=1}^n \\left(y_i-\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta \\right) \\mathbf{x}_i \\end{eqnarray*}\\] y \\[\\begin{eqnarray*} \\frac{ \\partial}{\\partial \\sigma^2} L(\\boldsymbol \\theta) &amp;=&amp; \\sum_{i=1}^n \\frac{ \\partial}{\\partial \\sigma^2} \\ln \\mathrm{f}(y_i; \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta, \\sigma^2) = -\\frac{n}{2 \\sigma^2} + \\frac {1}{2 \\sigma ^4}\\sum_{i=1}^n \\left(y_i-\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta \\right)^2 . \\end{eqnarray*}\\] Igualando estas ecuaciones a cero y resolviendo se obtienen los estimadores de máxima verosimilitud \\[ \\boldsymbol \\beta_{MLE} = \\left(\\sum_{i=1}^n \\mathbf{x}_i \\mathbf{x}_i^{\\prime}\\right)^{-1} \\sum_{i=1}^n \\mathbf{x}_i y_i = \\mathbf{b} \\] y \\[ \\sigma^2_{MLE} = \\frac{1}{n} \\sum_{i=1}^n \\left( y_i - \\mathbf{x}_i^{\\prime} \\mathbf{b} \\right)^2 = \\frac{n-(k+1)}{n} s^2. \\] Así, el estimador de máxima verosimilitud de \\(\\boldsymbol \\beta\\) es igual al estimador habitual de mínimos cuadrados. El estimador de máxima verosimilitud de \\(\\sigma^2\\) es un múltiplo escalar del estimador habitual de mínimos cuadrados. El estimador de mínimos cuadrados \\(s^2\\) es insesgado, mientras que \\(\\sigma^2_{MLE}\\) es solo aproximadamente insesgado en muestras grandes. La matriz de información es \\[ \\mathbf{I}(\\boldsymbol \\theta) = -\\mathrm{E~} \\left( \\begin{array}{cc} \\frac{ \\partial^2}{\\partial \\boldsymbol \\beta ~\\partial \\boldsymbol \\beta^{\\prime}} L(\\boldsymbol \\theta) &amp; \\frac{ \\partial^2}{\\partial \\boldsymbol \\beta ~\\partial \\sigma^2} L(\\boldsymbol \\theta) \\\\ \\frac{ \\partial^2}{\\partial \\sigma^2 \\partial \\boldsymbol \\beta^{\\prime} } L(\\boldsymbol \\theta) &amp; \\frac{ \\partial^2}{\\partial \\sigma^2 \\partial \\sigma^2} L(\\boldsymbol \\theta)\\\\ \\end{array} \\right)= \\left( \\begin{array}{cc} \\frac{ 1}{\\sigma^2} \\sum_{i=1}^n \\mathbf{x}_i \\mathbf{x}_i^{\\prime} &amp; 0 \\\\ 0 &amp; \\frac{n}{2 \\sigma^4}\\\\ \\end{array} \\right). \\] Así, \\(\\boldsymbol \\beta_{MLE} = \\mathbf{b}\\) tiene una distribución normal en muestras grandes con media \\(\\boldsymbol \\beta\\) y matriz de varianza-covarianza \\(\\sigma^2 \\left(\\sum_{i=1}^n \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\right)^{-1}\\), como se vio anteriormente. Además, \\(\\sigma^2_{MLE}\\) tiene una distribución normal en muestras grandes con media \\(\\sigma^2\\) y varianza \\(2 \\sigma^4 /n.\\) La máxima verosimilitud es una técnica de estimación general que se puede aplicar en muchos contextos estadísticos, no solo en aplicaciones de regresión y series temporales. Se puede aplicar ampliamente y disfruta de ciertas propiedades de optimalidad. Ya hemos mencionado el resultado de que los estimadores de máxima verosimilitud suelen tener una distribución normal en muestras grandes. Además, los estimadores de máxima verosimilitud son los más eficientes en el siguiente sentido. Supongamos que \\(\\widehat{\\boldsymbol \\theta}\\) es un estimador alternativo insesgado. El teorema de Cramer-Rao establece, bajo condiciones de regularidad leves, para todos los vectores \\(\\mathbf c\\), que \\(\\mathrm{Var~} \\mathbf c^{\\prime} \\boldsymbol \\theta_{MLE} \\le \\mathrm{Var~} \\mathbf c^{\\prime} \\widehat{\\boldsymbol \\theta}\\), para \\(n\\) suficientemente grande. También notamos que \\(2 \\left( L(\\boldsymbol \\theta_{MLE}) - L(\\boldsymbol \\theta) \\right)\\) tiene una distribución chi-cuadrado con grados de libertad igual a la dimensión de \\(\\boldsymbol \\theta\\). En algunas aplicaciones, como el caso de regresión con una distribución normal, los estimadores de máxima verosimilitud se pueden calcular analíticamente como una expresión de forma cerrada. Típicamente, esto se puede hacer encontrando raíces de la primera derivada de la función. Sin embargo, en general, los estimadores de máxima verosimilitud no se pueden calcular con expresiones de forma cerrada y se determinan iterativamente. Se utilizan ampliamente dos procedimientos generales: 1. Newton-Raphson utiliza el algoritmo iterativo \\[\\begin{equation} \\boldsymbol \\theta_{NEW} = \\boldsymbol \\theta_{OLD} - \\left. \\left\\{ \\left( \\frac{ \\partial^2 L}{\\partial \\boldsymbol \\theta \\partial \\boldsymbol \\theta^{\\prime}} \\right)^{-1} \\frac{\\partial L}{\\partial \\boldsymbol \\theta } \\right\\} \\right|_ {\\boldsymbol \\theta = \\boldsymbol \\theta_{OLD}} . \\tag{11.16} \\end{equation}\\] 2. Puntuación de Fisher utiliza el algoritmo iterativo \\[\\begin{equation} \\boldsymbol \\theta_{NEW} = \\boldsymbol \\theta_{OLD} + \\mathbf{I}(\\boldsymbol \\theta_{OLD})^{-1} \\left. \\left\\{ \\frac{\\partial L}{\\partial \\boldsymbol \\theta } \\right\\} \\right|_ {\\boldsymbol \\theta = \\boldsymbol \\theta_{OLD}} . \\tag{11.17} \\end{equation}\\] donde \\(\\mathbf{I}(\\boldsymbol \\theta)\\) es la matriz de información. 11.9.3 Pruebas de Hipótesis Consideramos probar la hipótesis nula \\(H_0: h(\\boldsymbol \\theta) = \\mathbf{d}\\), donde \\(\\mathbf{d}\\) es un vector conocido de dimensión \\(r \\times 1\\) y h(\\(\\cdot\\)) es conocido y diferenciable. Este marco de pruebas abarca como un caso especial la hipótesis lineal general introducida en el Capítulo 4. Existen tres enfoques generales para probar hipótesis, denominados razón de verosimilitud, Wald y Rao. El enfoque de Wald evalúa una función de la verosimilitud en \\(\\boldsymbol \\theta_{MLE}\\). El enfoque de la razón de verosimilitud utiliza \\(\\boldsymbol \\theta_{MLE}\\) y \\(\\boldsymbol \\theta_{Reduced}\\). Aquí, \\(\\boldsymbol \\theta_{Reduced}\\) es el valor de \\(\\boldsymbol \\theta\\) que maximiza \\(L(\\boldsymbol \\theta_{Reduced})\\) bajo la restricción de que \\(h(\\boldsymbol \\theta) = \\mathbf{d}\\). El enfoque de Rao también utiliza \\(\\boldsymbol \\theta_{Reduced}\\) pero lo determina maximizando \\(L(\\boldsymbol \\theta) - \\boldsymbol \\lambda^{\\prime}(h(\\boldsymbol \\theta) -\\mathbf{d})\\), donde \\(\\boldsymbol \\lambda\\) es un vector de multiplicadores de Lagrange. Por lo tanto, la prueba de Rao también se llama la prueba del multiplicador de Lagrange. Las estadísticas de prueba asociadas con los tres enfoques son: \\(LRT = 2 \\times \\left\\{L(\\boldsymbol \\theta_{MLE})-L(\\boldsymbol \\theta_{Reduced}) \\right\\}\\) Wald: \\(TS_W(\\boldsymbol \\theta_{MLE})\\), donde \\[ TS_W(\\boldsymbol \\theta)=(h(\\boldsymbol \\theta) -\\mathbf{d})^{\\prime} \\left\\{ \\frac{\\partial}{\\partial \\boldsymbol \\theta} h(\\boldsymbol \\theta)^{\\prime} \\left(-\\mathbf{I}(\\boldsymbol \\theta) \\right)^{-1} \\frac{\\partial}{\\partial \\boldsymbol \\theta} h(\\boldsymbol \\theta) \\right\\}^{-1} (h(\\boldsymbol \\theta) -\\mathbf{d}), \\] y Rao: \\(TS_R(\\boldsymbol \\theta_{Reduced})\\), donde \\[ TS_R(\\boldsymbol \\theta) = \\frac{\\partial}{\\partial \\boldsymbol \\theta} L(\\boldsymbol \\theta) \\left(-\\mathbf{I}(\\boldsymbol \\theta) \\right)^{-1} \\frac{\\partial}{\\partial \\boldsymbol \\theta} L(\\boldsymbol \\theta)^{\\prime}. \\] Bajo condiciones amplias, las tres estadísticas de prueba tienen distribuciones chi-cuadrado en muestras grandes con \\(r\\) grados de libertad bajo \\(H_0\\). Los tres métodos funcionan bien cuando el número de parámetros es de dimensión finita y la hipótesis nula especifica que \\(\\boldsymbol \\theta\\) está en el interior del espacio de parámetros. La principal ventaja de la estadística de Wald es que solo requiere el cálculo de \\(\\boldsymbol \\theta_{MLE}\\) y no de \\(\\boldsymbol \\theta_{Reduced}\\). En contraste, la principal ventaja de la estadística de Rao es que solo requiere el cálculo de \\(\\boldsymbol \\theta_{Reduced}\\) y no de \\(\\boldsymbol \\theta_{MLE}\\). En muchas aplicaciones, el cálculo de \\(\\boldsymbol \\theta_{MLE}\\) es laborioso. La prueba de razón de verosimilitud es una extensión directa de la prueba \\(F\\) parcial introducida en el Capítulo 4: permite comparar directamente modelos anidados, una técnica útil en aplicaciones. 11.9.4 Criterios de Información Las pruebas de razón de verosimilitud son útiles para elegir entre dos modelos que son anidados, es decir, donde un modelo es un subconjunto del otro. ¿Cómo comparamos modelos cuando no están anidados? Una forma es utilizar los siguientes criterios de información. La distancia entre dos distribuciones de probabilidad dadas por funciones de densidad de probabilidad \\(g\\) y \\(f_{\\boldsymbol \\theta}\\) se puede resumir como \\[ \\mathrm{KL}(g,f_{\\boldsymbol \\theta}) = \\mathrm{E}_g \\ln \\frac{g(y)}{f_{\\boldsymbol \\theta}(y)} . \\] Esta es la distancia de Kullback-Leibler. Aquí, hemos indexado \\(f\\) con un vector de parámetros \\(\\boldsymbol \\theta\\). Si dejamos que la función de densidad \\(g\\) sea fija en un valor hipotético, digamos \\(f_{{\\boldsymbol \\theta}_0}\\), entonces minimizar \\(\\mathrm{KL}(f_{{\\boldsymbol \\theta}_0},f_{\\boldsymbol \\theta})\\) es equivalente a maximizar el log-verosimilitud. Sin embargo, maximizar la verosimilitud no impone una estructura suficiente en el problema porque sabemos que siempre podemos aumentar la verosimilitud introduciendo parámetros adicionales. Así, Akaike en 1974 mostró que una alternativa razonable es minimizar \\[ AIC = -2 \\times L(\\boldsymbol \\theta_{MLE}) + 2 \\times (número~de~parámetros), \\] conocido como Criterio de Información de Akaike. Aquí, el término adicional \\(2 \\times (número~de~parámetros)\\) es una penalización por la complejidad del modelo. Con esta penalización, no se puede mejorar el ajuste simplemente introduciendo parámetros adicionales. Esta estadística se puede utilizar al comparar varios modelos alternativos que no necesariamente están anidados. Se elige el modelo que minimiza \\(AIC\\). Si los modelos bajo consideración tienen el mismo número de parámetros, esto es equivalente a elegir el modelo que maximiza el log-verosimilitud. Observamos que esta definición no es adoptada uniformemente en la literatura. Por ejemplo, en análisis de series temporales, el \\(AIC\\) se reescala por el número de parámetros. Otras versiones que proporcionan correcciones para muestras finitas también están disponibles en la literatura. Schwarz en 1978 derivó un criterio alternativo utilizando métodos bayesianos. Su medida se conoce como el Criterio de Información Bayesiano, definido como \\[ BIC = -2 \\times L(\\boldsymbol \\theta_{MLE}) + (número~de~parámetros) \\times \\ln (número~de~observaciones), \\] Esta medida da un mayor peso al número de parámetros. Es decir, todo lo demás siendo igual, el \\(BIC\\) sugerirá un modelo más parsimonioso que el \\(AIC\\). Al igual que el coeficiente de determinación ajustado \\(R^2_a\\) que hemos introducido en la literatura de regresión, tanto el \\(AIC\\) como el \\(BIC\\) proporcionan medidas de ajuste con una penalización por la complejidad del modelo. En los modelos de regresión lineal normal, la Sección 5.6 señaló que minimizar el \\(AIC\\) es equivalente a minimizar \\(n \\ln s^2 + k\\). Otra estadística de regresión lineal que equilibra la bondad de ajuste y la complejidad del modelo es la estadística \\(C_p\\) de Mallows. Para \\(p\\) variables candidatas en el modelo, esto se define como \\(C_p = (Error~SS)_p/s^2 - (n-2p).\\) Véase, por ejemplo, Cameron y Trivedi (1998) para referencias y más discusión sobre criterios de información. "],["C12Count.html", "Chapter 12 Variables Dependientes de Conteo 12.1 Regresión de Poisson 12.2 Aplicación: Seguro de Automóviles en Singapur 12.3 Sobre dispersión y Modelos Binomiales Negativos 12.4 Otros Modelos de Conteo 12.5 Lecturas Adicionales y Referencias 12.6 Ejercicios", " Chapter 12 Variables Dependientes de Conteo Vista Previa del Capítulo. En este capítulo, la variable dependiente \\(y\\) es un conteo, tomando valores 0, 1, 2 y así sucesivamente, que describe el número de eventos. Las variables dependientes de conteo forman la base de los modelos actuariales de frecuencia de reclamaciones. En otras aplicaciones, una variable dependiente de conteo puede ser el número de accidentes, el número de personas que se jubilan o el número de empresas que se vuelven insolventes. El capítulo introduce la regresión de Poisson, un modelo que incluye variables explicativas con una distribución de Poisson para conteos. Este modelo fundamental maneja muchos conjuntos de datos de interés para los actuarios. Sin embargo, con la distribución de Poisson, la media es igual a la varianza, una limitación que sugiere la necesidad de distribuciones más generales como la binomial negativa. Incluso la binomial negativa de dos parámetros puede no capturar algunas características importantes, lo que motiva la necesidad de modelos más complejos como los modelos “inflados de ceros” y los modelos de variables latentes introducidos en este capítulo. 12.1 Regresión de Poisson 12.1.1 Distribución de Poisson Una variable aleatoria de conteo \\(y\\) es aquella que tiene resultados en los enteros no negativos, \\(j=0,1,2,...\\) La Poisson es una distribución fundamental utilizada para conteos que tiene una función de masa de probabilidad \\[\\begin{equation} \\Pr \\left( y=j\\right) =\\frac{\\mu^j}{j!}e^{-\\mu },~~~j=0,1,2,... \\tag{12.1} \\end{equation}\\] Se puede demostrar que \\(\\mathrm{E~} y =\\sum\\nolimits_{j=0}^{\\infty}j\\Pr \\left( y=j\\right) =\\mu\\), por lo que podemos interpretar el parámetro \\(\\mu\\) como la media de la distribución. De manera similar, se puede demostrar que \\(\\mathrm{Var~}y =\\mu\\), por lo que la media es igual a la varianza en esta distribución. Una de las primeras aplicaciones (Bortkiewicz, 1898) se basó en usar la distribución de Poisson para representar el número anual de muertes en el ejército prusiano debido a “patadas de mulas”. La distribución todavía se usa ampliamente como un modelo del número de accidentes, como lesiones en un entorno industrial (para cobertura de compensación de trabajadores) y daños a la propiedad en seguros de automóviles. Ejemplo: Datos de Automóviles de Singapur. Estos datos provienen de una cartera de 1993 de \\(n=7,483\\) pólizas de seguro de automóviles de una importante compañía de seguros en Singapur. Los datos se describirán más a fondo en la Sección 12.2. La Tabla 12.1 proporciona la distribución del número de accidentes. La variable dependiente es el número de accidentes automovilísticos por asegurado. Para este conjunto de datos, resulta que el número máximo de accidentes en un año fue tres. En promedio, hubo \\(\\overline{y}=0.06989\\) accidentes por persona. Tabla 12.1: Comparación de Conteos Observados y Ajustados Basados en Datos de Automóviles de Singapur Conteo (\\(j\\)) Observado (\\(n_j\\)) Conteos Ajustados usando la Distribución de Poisson \\((n\\widehat{p}_j)\\) 0 6996 6977.86 1 455 487.69 2 28 17.04 3 4 0.4 4 0 0.01 Total 7483 7483 Código R para Producir la Tabla 12.1 # Tabla 12.1 # ESTE CÓDIGO USA EL CONJUNTO DE DATOS SingaporeAuto.csv #Singapore &lt;- read.csv(&quot;../../CSVData/SingaporeAuto.csv&quot;, header=TRUE) Singapore &lt;- read.csv(&quot;CSVData/SingaporeAuto.csv&quot;, header=TRUE) # TABLA DE CONTEOS OBSERVADOS Y AJUSTADOS POISSON muhat &lt;- mean(Singapore$Clm_Count) col2 &lt;- c(table(Singapore$Clm_Count),0) col1 &lt;- ynum &lt;- c(0,1,2,3,4) col3 &lt;- length(Singapore$Clm_Count)*dpois(ynum, muhat) tableoutA &lt;- cbind(col1, col2, col3) tableoutA[,3] &lt;- round(tableoutA[,3],digits = 2) row5 &lt;- c(&quot;Total&quot;, sum(col2), round(sum(col3),digits = 2)) tableout &lt;- rbind(tableoutA, row5) row.names(tableout) &lt;- NULL colnames(tableout) &lt;- c(&quot;Conteo ($j$)&quot;, &quot;Observado ($n_j$)&quot;, &quot;Conteos Ajustados usando la Distribución de Poisson $(n\\\\widehat{p}_j)$&quot;) TableGen1(TableData=tableout, TextTitle=&#39;Comparación de Conteos Observados y Ajustados Basados en Datos de Automóviles de Singapur&#39;, Align=&#39;c&#39;, Digits = 2, ColumnSpec=1:2, BorderRight=1, ColWidth = &quot;3cm&quot;) # OTRA MANERA #CountPoisson1 &lt;- glm(Clm_Count ~ 1,poisson(link=log), data = Singapore) #summary(CountPoisson1) #exp(CountPoisson1$coefficients) La Tabla 12.1 también proporciona los conteos ajustados que se calcularon utilizando el estimador de máxima verosimilitud de \\(\\mu\\). Específicamente, a partir de la ecuación (12.1) podemos escribir la función de masa como \\(\\mathrm{f}(y,\\mu) = \\mu^y e^{-\\mu} /y!,\\) y así la log-verosimilitud es \\[\\begin{equation} L(\\mu) = \\sum_{i=1}^{n} \\ln \\mathrm{f}(y_i,\\mu) = \\sum_{i=1}^{n}\\left( -\\mu +y_i\\ln \\mu -\\ln y_i!\\right) . \\tag{12.2} \\end{equation}\\] Es sencillo demostrar que la log-verosimilitud tiene un máximo en \\(\\widehat{\\mu }=\\overline{y}\\), el número promedio de reclamaciones. Las probabilidades estimadas, utilizando la ecuación (12.1) y \\(\\widehat{\\mu }= \\overline{y}\\), se denotan como \\(\\widehat{p}_j\\). Usamos estas probabilidades estimadas en la Tabla 12.1 al calcular los conteos ajustados con \\(n=7,483\\). Para comparar los conteos observados y ajustados, una estadística de bondad de ajuste ampliamente utilizada es la estadística chi-cuadrado de Pearson, dada por \\[\\begin{equation} \\sum_j\\frac{\\left( n_j-n\\widehat{p}_j\\right)^2}{n\\widehat{p}_j}. \\tag{12.3} \\end{equation}\\] Bajo la hipótesis nula de que la distribución de Poisson es un modelo correcto, esta estadística tiene una distribución chi-cuadrado en muestras grandes, donde los grados de libertad son el número de celdas menos uno menos el número de parámetros estimados. Para los datos de Singapur en la Tabla 12.1, esto es \\(df=5-1-1=3\\). Resulta que la estadística es 41.98, lo que indica que este modelo básico de Poisson es inadecuado. Código R para producir la estadística de bondad de ajuste de Pearson CountPoisson1 &lt;- glm(Clm_Count ~ 1,poisson(link=log), data = Singapore) temp &lt;- summary(CountPoisson1) str(temp) (temp$aic - 2*(1+1))/2 # COMPARACIÓN DE MODELOS DE FRECUENCIA AJUSTADOS options(digits=8) table1p = cbind(sum(dpois(0,CountPoisson1$fitted.values)), sum(dpois(1,CountPoisson1$fitted.values)), sum(dpois(2,CountPoisson1$fitted.values)), sum(dpois(3,CountPoisson1$fitted.values)), sum(dpois(4,CountPoisson1$fitted.values))) # ESTADÍSTICA CHI-CUADRADO DE PEARSON actual = data.frame(table(Singapore$Clm_Count))[,2]; actual[5] = 0 diff = actual-table1p (PearsonG = sum(diff*diff/table1p)) 12.1.2 Modelo de Regresión Para extender el modelo básico de Poisson, primero permitimos que la media varíe por una cantidad conocida llamada exposición \\(E_i\\) , de modo que \\[ \\mathrm{E~}y_i=E_i\\times \\mu . \\] Para motivar esta especificación, recordemos que las sumas de variables aleatorias de Poisson independientes también tienen una distribución de Poisson, por lo que es razonable pensar en las exposiciones como grandes números positivos. Así, es común modelar el número de accidentes por mil vehículos o el número de homicidios por millón de habitantes. Además, consideramos también los casos en los que las unidades de exposición pueden ser fracciones. Para ilustrar, en nuestros datos de Singapur, \\(E_i\\) representará la fracción del año en la que un asegurado tuvo cobertura de seguro. La lógica detrás de esto es que el número esperado de accidentes es directamente proporcional a la duración de la cobertura. (Esto también puede motivarse desde un marco probabilístico basado en colecciones de variables aleatorias distribuidas según Poisson, conocidas como procesos de Poisson, véase, por ejemplo, Klugman et al., 2008). Más generalmente, deseamos permitir que la media varíe de acuerdo con la información contenida en otras variables explicativas. Para el Poisson, es común especificar \\[ \\mathrm{E~}y_i = \\mu_i = \\exp \\left( \\mathbf{x}_i^{\\prime}\\boldsymbol \\beta \\right) . \\] Usar la función exponencial para mapear el componente sistemático \\(\\mathbf{x}_i^{\\prime }\\boldsymbol \\beta\\) en la media asegura que \\(\\mathrm{E~}y_i\\) permanecerá positiva. Suponiendo la linealidad de los coeficientes de regresión, se permite una fácil interpretación. Específicamente, dado que \\[ \\frac{\\partial \\mathrm{E~}y_i}{\\partial x_{ij}} \\times \\frac{1}{\\mathrm{E~}y_i} =\\beta_j, \\] podemos interpretar \\(\\beta_j\\) como el cambio proporcional en la media por unidad de cambio en \\(x_{ij}\\). La función que conecta la media con el componente sistemático se conoce como la función de enlace logarítmico, es decir, \\(\\ln \\mu_i=\\mathbf{x}_i^{\\prime }\\boldsymbol \\beta\\). Para incorporar las exposiciones, siempre se puede especificar que una de las variables explicativas sea \\(\\ln E_i\\) y restringir el coeficiente de regresión correspondiente a ser 1. Este término se conoce como un desplazamiento. Con esta convención, la función de enlace es \\[\\begin{equation} \\ln \\mu_i=\\ln E_i+\\mathbf{x}_i^{\\prime }\\boldsymbol \\beta. \\tag{12.4} \\end{equation}\\] Ejemplo: Accidentes de Automóviles en California. Weber (1971) proporcionó la primera aplicación de la regresión de Poisson a frecuencias de accidentes automovilísticos en su estudio de los registros de conducción en California. En uno de sus modelos, Weber examinó el número de accidentes automovilísticos durante 1963 de casi 87,000 conductores hombres. Sus variables explicativas consistían en: \\(x_1\\) = el logaritmo natural del índice de densidad de tráfico del condado donde reside el conductor, \\(x_2 =5/(edad-13)\\) \\(x_3\\) = el número de condenas contables incurridas durante los años 1961-62 \\(x_4\\) = el número de involucramientos en accidentes durante los años 1961-62 \\(x_5\\) = el número de condenas no contables incurridas durante los años 1961-62. Curiosamente, en esta aplicación temprana, Weber logró un ajuste satisfactorio representando la media como una combinación lineal de variables explicativas (\\(\\mathrm{E }~y_i=\\mathbf{x}_i^{\\prime }\\boldsymbol \\beta\\)), no en la versión exponenciada como en la ecuación (12.4) que ahora es comúnmente utilizada. 12.1.3 Estimación La estimación de máxima verosimilitud es la técnica usual para los modelos de regresión de Poisson. Utilizando la función de enlace logarítmico en la ecuación (12.4), la log-verosimilitud se expresa como: \\[\\begin{eqnarray*} L(\\boldsymbol \\beta) &amp;=&amp;\\sum_{i=1}^{n}\\left( -\\mu_i+y_i\\ln \\mu _i-\\ln y_i!\\right) \\\\ &amp;=&amp;\\sum_{i=1}^{n}\\left( -E_i\\exp \\left( \\mathbf{x}_i^{\\prime }\\boldsymbol \\beta \\right) +y_i\\left( \\ln E_i+\\mathbf{x}_i^{\\prime }\\boldsymbol \\beta \\right) -\\ln y_i!\\right) . \\end{eqnarray*}\\] Al igualar la función de puntuación a cero se obtiene \\[\\begin{equation} \\left. \\frac{\\partial }{\\partial \\boldsymbol \\beta}\\mathrm{L}(\\boldsymbol \\beta )\\right\\vert_{\\mathbf{\\beta =b}}=\\sum_{i=1}^{n}\\left( y_i-E_i\\exp \\left( \\mathbf{x}_i^{\\prime }\\mathbf{b}\\right) \\right) \\mathbf{x} _i=\\sum_{i=1}^{n}\\left( y_i-\\widehat{\\mu }_i\\right) \\mathbf{x}_i= \\mathbf{0}, \\tag{12.5} \\end{equation}\\] donde \\(\\widehat{\\mu }_i = E_i\\exp \\left( \\mathbf{x}_i^{\\prime }\\mathbf{b} \\right)\\). Resolver esta ecuación (numéricamente) nos da \\(\\mathbf{b}\\), el estimador de máxima verosimilitud de \\(\\boldsymbol \\beta\\). A partir de la ecuación (12.5), vemos que si una fila de \\(\\mathbf{x}_i\\) es constante (correspondiendo a un término de intercepto constante en la regresión), entonces la suma de los residuos \\(y_i - \\widehat{\\mu}_i\\) es cero. Tomar las segundas derivadas nos da la matriz de información, \\[ \\mathbf{I}(\\boldsymbol \\beta) = - \\mathrm{E} \\frac{\\partial ^2}{\\partial \\boldsymbol \\beta\\partial \\boldsymbol \\beta^{\\prime }}\\mathrm{L}(\\boldsymbol \\beta)=\\sum_{i=1}^{n}E_i\\exp \\left( \\mathbf{x}_i^{\\prime }\\boldsymbol \\beta\\right) \\mathbf{x}_i\\mathbf{x}_i^{\\prime }=\\sum_{i=1}^{n}\\mu_i\\mathbf{x}_i\\mathbf{x}_i^{\\prime }. \\] La teoría estándar de estimación por máxima verosimilitud (Sección 11.9.2) muestra que la matriz de varianza-covarianza asintótica de \\(\\mathbf{b}\\) es \\[ \\widehat{\\mathrm{Var~}\\mathbf{b}}=\\left( \\sum\\limits_{i=1}^{n}\\widehat{\\mu } _i\\mathbf{x}_i\\mathbf{x}_i^{\\prime }\\right)^{-1}. \\] La raíz cuadrada del \\(j\\)-ésimo elemento diagonal de \\(\\widehat{\\mathrm{Var~} \\mathbf{b}}\\) nos da el error estándar para \\(b_j\\), que denotamos como \\(se(b_j)\\). Ejemplo: Seguro de Mala Praxis Médica. Los médicos cometen errores y pueden ser demandados por las partes perjudicadas por estos errores. Al igual que muchos profesionales, es común que los médicos contraten cobertura de seguro para mitigar las consecuencias financieras de las demandas por “mala praxis”. Dado que las aseguradoras desean fijar precios precisos para este tipo de cobertura, parece natural preguntar qué tipo de médicos es más probable que presenten reclamaciones de mala praxis. Fournier y McInnes (2001) examinaron una muestra de \\(n=9,059\\) médicos de Florida utilizando datos del archivo de reclamaciones de seguros de responsabilidad profesional médica de Florida. Los autores examinaron reclamaciones cerradas entre 1985 y 1989 para médicos que obtuvieron su licencia antes de 1981, omitiendo así las reclamaciones de médicos recién licenciados. Las reclamaciones por mala praxis médica pueden tardar mucho en resolverse (“liquidarse”); en su estudio, Fournier y McInnes encontraron que el 2 por ciento de las reclamaciones aún no se habían resuelto después de 5 años del evento de mala praxis. Por lo tanto, eligieron un período temprano (1985-1989) para permitir que la experiencia madurara. Los autores también ignoraron las reclamaciones menores al considerar solo aquellas que excedieron los $100. Tabla 12.2 proporciona los coeficientes de la regresión de Poisson ajustada, junto con los errores estándar que aparecen en Fournier y McInnes (2001). La tabla muestra que el área de especialización del médico, la región, el tamaño de la práctica y las características personales del médico (experiencia y género) son determinantes importantes del número de demandas por mala praxis médica. Por ejemplo, podemos interpretar el coeficiente asociado al género como que se espera que los hombres tengan \\(\\exp (0.432)= 1.540\\) veces más reclamaciones que las mujeres. Tabla 12.2. Coeficientes de Regresión del Modelo de Regresión Poisson para Mala Praxis Médica \\[ \\small{ \\begin{array}{lcc|lcc} \\hline &amp; &amp; \\text{Error} &amp; &amp; &amp; \\text{Error} \\\\ \\text{Variables Explicativas} &amp; \\text{Coeficiente} &amp; \\text{Estándar} &amp; \\text{Variables Explicativas} &amp; \\text{Coeficiente} &amp; \\text{Estándar} \\\\ \\hline \\text{Intercepto} &amp; -1.634 &amp; 0.254 &amp; \\text{MSA: Miami Dade-Broward} &amp; 0.377 &amp; 0.094 \\\\ \\text{Log Años con Licencia} &amp; -0.392 &amp; 0.054 &amp; \\text{MSA: Otros} &amp; 0.012 &amp; 0.084 \\\\ \\text{Femenino} &amp; -0.432 &amp; 0.082 &amp; \\ \\ \\ \\ \\textit{Especialidad} \\\\ \\text{Volumen de Pacientes} &amp; 0.643 &amp; 0.045 &amp; \\text{Anestesiología} &amp; 0.944 &amp; 0.099 \\\\ \\text{(Volumen de Pacientes)}^2 &amp; -0.066 &amp; 0.008 &amp; \\text{Medicina de Emergencia} &amp; 0.583 &amp; 0.105 \\\\ \\text{Educación Per Cápita} &amp; -0.015 &amp; 0.006 &amp; \\text{Medicina Interna} &amp; 0.428 &amp; 0.066 \\\\ \\text{Ingreso Per Cápita} &amp; 0.047 &amp; 0.011 &amp; \\text{Obstetricia-Ginecología} &amp; 1.226 &amp; 0.070 \\\\ \\ \\ \\ \\ \\textit{Variables Regionales} &amp; &amp; &amp; \\text{Otorrinolaringología} &amp; 1.063 &amp; 0.109 \\\\ \\text{Segundo Circuito} &amp; 0.066 &amp; 0.072 &amp; \\text{Pediatría} &amp; 0.385 &amp; 0.089 \\\\ \\text{Tercer Circuito} &amp; 0.103 &amp; 0.088 &amp; \\text{Radiología} &amp; 0.478 &amp; 0.099 \\\\ \\text{Cuarto Circuito} &amp; 0.214 &amp; 0.098 &amp; \\text{Cirugía} &amp; 1.410 &amp; 0.061 \\\\ \\text{Quinto Circuito} &amp; 0.287 &amp; 0.069 &amp; \\text{Otras Especialidades} &amp; 0.011 &amp; 0.076 \\\\ \\hline \\end{array} } \\] 12.1.4 Inferencia Adicional En los modelos de regresión de Poisson, anticipamos que las variables dependientes sean heterocedásticas debido a la relación \\(\\mathrm{Var~}y_i=\\mu_i\\). Esta característica significa que los residuales ordinarios \\(y_i-\\widehat{\\mu}_i\\) son menos útiles, por lo que es más común examinar los residuales de Pearson definidos como \\[ r_i=\\frac{y_i-\\widehat{\\mu}_i}{\\sqrt{\\widehat{\\mu}_i}}. \\] Por construcción, los residuales de Pearson son aproximadamente homocedásticos. Gráficos de los residuales de Pearson pueden usarse para identificar observaciones inusuales o para detectar si variables adicionales de interés pueden mejorar la especificación del modelo. Los residuales de Pearson también pueden usarse para calcular una estadística de bondad de ajuste de Pearson, \\[\\begin{equation} \\sum\\limits_{i=1}^{n}r_i^2=\\sum\\limits_{i=1}^{n}\\frac{\\left( y_i-\\widehat{\\mu}_i\\right)^2}{\\widehat{\\mu}_i}. \\tag{12.6} \\end{equation}\\] Esta estadística es una medida general de qué tan bien se ajusta el modelo a los datos. Si el modelo está correctamente especificado, esta estadística debería ser aproximadamente \\(n-(k+1)\\). En general, las estadísticas de bondad de ajuste de Pearson toman la forma \\(\\sum \\left( O-E\\right)^2/E\\), donde \\(O\\) es una cantidad observada y \\(E\\) es el valor estimado (esperado) correspondiente basado en un modelo. La estadística en la ecuación (12.6) se calcula a nivel de observación, mientras que la estadística en la ecuación (12.3) se calculó resumiendo información sobre celdas. En la regresión lineal, el coeficiente de determinación \\(R^2\\) es una medida de bondad de ajuste ampliamente aceptada. En la regresión no lineal, como para variables dependientes binarias y de conteo, esto no es así. Las estadísticas de información, como el Criterio de Información de Akaike, \\[ AIC=-2 L(\\mathbf{b}) +2(k+1), \\] representan un tipo de estadística útil para la bondad de ajuste, que se define de manera amplia en un rango amplio de modelos. Los modelos con valores más pequeños de \\(AIC\\) ajustan mejor y son preferidos. Como se mencionó en la Sección 12.1.3, los estadísticos \\(t\\) se utilizan regularmente para probar la significancia de los coeficientes de regresión individuales. Para probar colecciones de coeficientes de regresión, es común utilizar la prueba de razón de verosimilitud. La prueba de razón de verosimilitud es un procedimiento bien conocido para probar la hipótesis nula \\(H_0:\\mathrm{h}(\\boldsymbol \\beta) = \\mathbf{d}\\), donde \\(\\mathbf{d}\\) es un vector conocido de dimensión \\(r\\times 1\\) y \\(\\mathrm{h}(\\mathbf{.})\\) es una función conocida y diferenciable. Este enfoque utiliza \\(\\mathbf{b}\\) y \\(\\mathbf{b}_{\\mathrm{Reducido}}\\), donde \\(\\mathbf{b}_{\\mathrm{Reducido}}\\) es el valor de \\(\\boldsymbol \\beta\\) que maximiza \\(L(\\boldsymbol \\beta)\\) bajo la restricción de que \\(\\mathrm{h}(\\boldsymbol \\beta)=\\mathbf{d}\\). Se calcula la estadística de prueba \\[\\begin{equation} LRT = 2 \\left( L(\\mathbf{b}) - L(\\mathbf{b}_{\\mathrm{Reducido}}) \\right) . \\tag{12.7} \\end{equation}\\] Bajo la hipótesis nula \\(H_0\\), la estadística de prueba \\(LRT\\) tiene una distribución asintótica chi-cuadrado con \\(r\\) grados de libertad. Por lo tanto, valores grandes de \\(LRT\\) sugieren que la hipótesis nula no es válida. 12.2 Aplicación: Seguro de Automóviles en Singapur Frees y Valdez (2008) investigan modelos jerárquicos de la experiencia de conducción en Singapur. Aquí examinamos en detalle un subconjunto de sus datos, centrándonos en los conteos de accidentes automovilísticos de 1993. El propósito del análisis es comprender el impacto de las características del vehículo y del conductor en la experiencia de accidentes. Estas relaciones proporcionan una base para un actuario que trabaja en la tarificación, es decir, establecer el precio de las coberturas de seguros. Los datos provienen de la Asociación de Seguros Generales de Singapur, una organización que agrupa a aseguradoras generales (propiedad y accidentes) en Singapur (ver el sitio web de la organización: www.gia.org.sg). A partir de esta base de datos, se disponía de varias características para explicar la frecuencia de accidentes automovilísticos. Estas características incluyen variables del vehículo, como el tipo y la edad, así como variables a nivel de persona, como la edad, el género y la experiencia previa de conducción. La Tabla 12.3 resume estas características. knitr::kable(2, caption = &quot;Silly. Create a table just to update the counter...&quot;) Tabla 12.2: Silly. Create a table just to update the counter… x 2 Tabla 12.3: Descripción de las Covariables Covariable Descripción Tipo de Vehículo El tipo de vehículo asegurado, ya sea automóvil (A) u otro (O). Edad del Vehículo La edad del vehículo, en años, agrupada en seis categorías. Género El género del titular de la póliza, ya sea masculino o femenino Edad La edad del titular de la póliza, en años, agrupada en siete categorías. NCD Descuento por No Reclamos. Esto se basa en el historial de accidentes previo del titular de la póliza. Cuanto mayor sea el descuento, mejor será el historial de accidentes anterior. Tabla 12.4 muestra los efectos de las características del vehículo sobre el número de reclamaciones. La categoría “Automóvil” tiene una experiencia de reclamaciones general más baja. La categoría “Otro” consiste principalmente en vehículos de mercancías (comerciales), así como coches de fin de semana y de alquiler. La edad del vehículo muestra efectos no lineales sobre la frecuencia de accidentes. Aquí, observamos pocas reclamaciones para autos nuevos, con un aumento inicial en la frecuencia de accidentes con el tiempo. Sin embargo, para vehículos en funcionamiento durante largos periodos, las frecuencias de accidentes son relativamente bajas. También hay algunos efectos de interacción importantes entre el tipo de vehículo y la edad que no se muestran aquí. No obstante, Tabla 12.4 sugiere claramente la importancia de estas dos variables en las frecuencias de reclamaciones. Tabla 12.4. Efecto de las Características del Vehículo sobre las Reclamaciones \\[ \\small{ \\begin{array}{crrrr|r} \\hline &amp; \\text{Conteo=0} &amp; \\text{Conteo=1} &amp; \\text{Conteo=2} &amp; \\text{Conteo=3} &amp; \\text{Totales} \\\\ \\hline \\text{Tipo de Vehículo} \\\\ \\text{Otro} &amp; 3,441 &amp; 184 &amp; 13 &amp; 3 &amp; 3,641 \\\\ &amp; (94.5) &amp; (5.1) &amp; (0.4) &amp; (0.1) &amp; (48.7) \\\\ \\text{Automóvil} &amp; 3,555 &amp; 271 &amp; 15 &amp; 1 &amp; 3,842 \\\\ &amp; (92.5) &amp; (7.1) &amp; (0.4) &amp; (0.0) &amp; (51.3) \\\\ \\hline \\text{Edad del Vehículo (en años)} \\\\ 0-2 &amp; 4,069 &amp; 313 &amp; 20 &amp; 4 &amp; 4,406 \\\\ &amp; (92.4) &amp; (7.1) &amp; (0.5) &amp; (0.1) &amp; (50.8) \\\\ 3 a 5 &amp; 708 &amp; 59 &amp; 4 &amp; &amp; 771 \\\\ &amp; (91.8) &amp; (7.7) &amp; (0.5) &amp; &amp; (10.3) \\\\ 6 a 10 &amp; 872 &amp; 49 &amp; 3 &amp; &amp; 924 \\\\ &amp; (94.4) &amp; (5.3) &amp; (0.3) &amp; &amp; (12.3) \\\\ 11 a 15 &amp; 1,133 &amp; 30 &amp; 1 &amp; &amp; 1,164 \\\\ &amp; (97.3) &amp; (2.6)&amp; (0.1) &amp; &amp; (15.6) \\\\ \\text{16 años y más} &amp; 214 &amp; 4 &amp; &amp; &amp; 218 \\\\ &amp; (98.2) &amp; (1.8) &amp; &amp; &amp; (2.9) \\\\ \\hline \\text{Totales} &amp; 6,996 &amp; 455 &amp; 28 &amp; 4 &amp; 7,483 \\\\ \\hline \\end{array} } \\] Nota: Los números entre paréntesis son porcentajes. Código R para generar la Tabla 12.4 # Tabla 12.4 # EFECTO DE LAS CARACTERÍSTICAS DEL VEHÍCULO Auto &lt;- 1*(Singapore$VehicleType==&quot;A&quot;) TAuto &lt;- table(Auto, Singapore$Clm_Count) TAuto1 &lt;- cbind(TAuto, rowSums(TAuto)) TVehA &lt;- table(Singapore$VAgecat1, Singapore$Clm_Count) TVehA1 &lt;- cbind(TVehA, rowSums(TVehA)) TComb &lt;- rbind(TAuto1, TVehA1) AddRow &lt;- function(row){ rowper &lt;- 100*row/row[5] rowper[5] &lt;- 100*row[5]/length(Singapore$Clm_Count) return(rbind(row, rowper)) } TCombBig &lt;- rbind( AddRow(TComb[1,]), AddRow(TComb[2,]), AddRow(TComb[3,]), AddRow(TComb[4,]), AddRow(TComb[5,]), AddRow(TComb[6,]), AddRow(TComb[7,]) ) TCombBig[c(1,3,5,7,9, 11, 13),] &lt;- round(TCombBig[c(1,3,5,7,9, 11, 13),],digits=0) TCombBig &lt;- round(TCombBig,digits=1) row.names(TCombBig) &lt;- c(&quot;Otro&quot;, &quot;&quot;, &quot;Automóvil&quot;, &quot;&quot;, &quot;0-2&quot;, &quot;&quot;, &quot;3-5&quot;, &quot;&quot;, &quot;6-10&quot;, &quot;&quot;, &quot;11-15&quot;,&quot;&quot;, &quot;16 años y más&quot;, &quot;&quot;) colnames(TCombBig) &lt;- c(&quot;Conteo=0&quot;,&quot;Conteo=1&quot;, &quot;Conteo=2&quot;,&quot;Conteo=3&quot;,&quot;Totales&quot;) TableGen1(TableData=TCombBig, TextTitle=&#39;Efecto de las Características del Vehículo sobre las Reclamaciones&#39;, Align=&#39;r&#39;, ColumnSpec=1:4, Digits = 1, BorderRight = c(1,5), ColWidth = ColWidth5) Tabla 12.4: Efecto de las Características del Vehículo sobre las Reclamaciones Conteo=0 Conteo=1 Conteo=2 Conteo=3 Totales Otro 3441.0 184.0 13.0 3.0 3641.0 94.5 5.1 0.4 0.1 48.7 Automóvil 3555.0 271.0 15.0 1.0 3842.0 92.5 7.1 0.4 0.0 51.3 0-2 4069.0 313.0 20.0 4.0 4406.0 92.4 7.1 0.5 0.1 58.9 3-5 708.0 59.0 4.0 0.0 771.0 91.8 7.7 0.5 0.0 10.3 6-10 872.0 49.0 3.0 0.0 924.0 94.4 5.3 0.3 0.0 12.3 11-15 1133.0 30.0 1.0 0.0 1164.0 97.3 2.6 0.1 0.0 15.6 16 años y más 214.0 4.0 0.0 0.0 218.0 98.2 1.8 0.0 0.0 2.9 La Tabla 12.5 muestra los efectos de las características a nivel personal, como género, edad y descuento por no reclamación (NCD), sobre la distribución de frecuencia. Las características a nivel personal no estaban disponibles en su mayoría para los vehículos de uso comercial, por lo que la Tabla 12.5 presenta estadísticas resumidas solo para aquellas observaciones que tenían cobertura de automóviles con la información de género y edad necesaria. Cuando restringimos la consideración a automóviles de uso privado, relativamente pocas pólizas no contenían información de género y edad. La Tabla 12.5 sugiere que la experiencia de conducción era bastante similar entre hombres y mujeres. Esta compañía aseguraba muy pocos conductores jóvenes, por lo que la categoría de conductores jóvenes masculinos, que normalmente tiene tasas de accidentes extremadamente altas en la mayoría de los estudios sobre automóviles, es menos relevante para estos datos. No obstante, la Tabla 12.5 sugiere fuertes efectos de la edad, con conductores mayores mostrando una mejor experiencia de conducción. La Tabla 12.5 también demuestra la importancia de los descuentos por no reclamación (NCD). Como se anticipaba, los conductores con mejores historiales de conducción, que disfrutan de un mayor NCD, tienen menos accidentes. Tabla 12.5: Efecto de las Características Personales sobre las Reclamaciones. Basado en la muestra con Auto = 1. Conteo = 0 Número Porcentaje Total Género Femenino 654 93.4 700 Masculino 2901 92.3 3142 Categoría de Edad 22-25 131 92.9 141 26-35 1354 91.7 1476 36-45 1412 93.2 1515 46-55 503 93.8 536 56-65 140 89.2 157 66 y más 15 88.2 17 Descuento por No Reclamaciones 0 889 89.6 992 10 433 91.2 475 20 361 92.8 389 30 344 93.5 368 40 291 94.8 307 50 1237 94.4 1311 Código R para generar la Tabla 12.5 # Tabla 12.5 Auto &lt;- 1*(Singapore$VehicleType==&quot;A&quot;) # EFECTO DE LAS CARACTERÍSTICAS PERSONALES SingaporeA &lt;- subset(Singapore, (Auto==1)) Count0 &lt;- 1*(SingaporeA$Clm_Count==0) rowGender &lt;- table(Count0,SingaporeA$SexInsured) rowAge&lt;- table(Count0,SingaporeA$AgeCat) rowNCD &lt;- table(Count0,SingaporeA$NCD) TabPersonal &lt;- t(cbind(rowGender, rowAge, rowNCD)) TabPersonal[,1] &lt;- TabPersonal[,1]+TabPersonal[,2] TabPersonalA &lt;- cbind(TabPersonal[,2],100*TabPersonal[,2]/TabPersonal[,1], TabPersonal[,1]) TabPersonalA[,2] &lt;- round(TabPersonalA[,2], digits = 1) row.names(TabPersonalA) &lt;- c(&quot;Femenino&quot;, &quot;Masculino&quot;, &quot;22-25&quot;, &quot;26-35&quot;, &quot;36-45&quot;, &quot;46-55&quot;, &quot;56-65&quot;, &quot;66 y más&quot;, 0, 10, 20, 30, 40, 50) `*Género*` &lt;- c(&quot;&quot;, &quot;&quot;, &quot;&quot;) -&gt; `*Categoría de Edad*` -&gt; `*Descuento por No Reclamaciones*` TabPersonalB &lt;- rbind(`*Género*`, TabPersonalA[1:2,], `*Categoría de Edad*`, TabPersonalA[3:8,], `*Descuento por No Reclamaciones*`, TabPersonalA[9:14,]) colnames(TabPersonalB) &lt;- c(&quot;Número&quot;, &quot;Porcentaje&quot;, &quot;Total&quot;) TableGen1(TableData=TabPersonalB, TextTitle=&#39;Efecto de las Características Personales sobre las Reclamaciones. Basado en la muestra con Auto = 1.&#39;, Align=&#39;ccc&#39;, ColumnSpec=1:2, Digits = 1, BorderRight = c(1,3), ColWidth = ColWidth4) %&gt;% add_header_above(c(&quot; &quot;=1, &quot;Conteo = 0&quot; = 2, &quot; &quot;=1)) %&gt;% kableExtra::column_spec(1, width = &quot;4cm&quot;) Como parte del proceso de examen, investigamos términos de interacción entre las covariables y especificaciones no lineales. Sin embargo, Tabla 12.6 resume un modelo Poisson ajustado más simple con solo efectos aditivos. Tabla 12.6 muestra que tanto la edad del vehículo como el descuento por no reclamaciones son categorías importantes, ya que los \\(t\\)-ratios de muchos de los coeficientes son estadísticamente significativos. La verosimilitud logarítmica total para este modelo es \\(L( \\mathbf{b}) =-1,776.730\\). Los niveles de referencia omitidos se indican en la nota al pie de Tabla 12.6 para ayudar a interpretar los parámetros. Por ejemplo, para \\(NCD=0\\), esperamos que un conductor con mal historial con \\(NCD=0\\) tenga \\(\\exp (0.729)=2.07\\) veces más accidentes que un conductor excelente comparable con \\(NCD=50\\). Del mismo modo, esperamos que un conductor con mal historial con \\(NCD=0\\) tenga \\(\\exp (0.729-0.293)=1.55\\) veces más accidentes que un conductor promedio comparable con \\(NCD=20\\). Tabla 12.6. Estimaciones de Parámetros de un Modelo Poisson Ajustado \\[ \\small{ \\begin{array}{rrr|rrr} \\hline &amp; \\text{Parámetro} &amp; &amp; &amp; \\text{Parámetro} &amp; \\\\ \\text{Variable} &amp; \\text{Estimación} &amp; t\\text{-ratio} &amp; \\text{Variable} &amp; \\text{Estimación} &amp; t\\text{-ratio} \\\\ \\hline &amp; &amp; &amp; (Auto=1)\\times \\text{Descuento por No} \\\\ &amp; &amp; &amp; \\text{Reclamaciones*} \\\\ \\text{Intercepto} &amp; -3.306 &amp; -6.602 &amp; 0 &amp; 0.729 &amp; 4.704 \\\\ \\text{Auto} &amp; -0.667 &amp; -1.869 &amp; 10 &amp; 0.528 &amp; 2.732 \\\\ \\text{Femenino} &amp; -0.173 &amp; -1.115 &amp; 20 &amp; 0.293 &amp; 1.326 \\\\ &amp; &amp; &amp; 30 &amp; 0.260 &amp; 1.152 \\\\ (Auto=1)\\times &amp; &amp; &amp;40 &amp; -0.095 &amp; -0.342 \\\\ \\text{Categoría de Edad*} &amp; &amp; &amp;\\text{Edad del Vehículo} \\\\ 22-25 &amp; 0.747 &amp; 0.961 &amp;\\ \\ \\ \\text{en años)*} \\\\ 26-35 &amp; 0.489 &amp; 1.251 &amp; 0-2 &amp; 1.674 &amp; 3.276 \\\\ 36-45 &amp; -0.057 &amp; -0.161 &amp; 3-5 &amp;1.504 &amp; 2.917 \\\\ 46-55 &amp; 0.124 &amp; 0.385 &amp; 6-10 &amp; 1.081&amp; 2.084 \\\\ 56-65 &amp; 0.165 &amp; 0.523 &amp; 11-15 &amp; 0.362 &amp; 0.682 \\\\ \\hline \\end{array} } \\] *Los niveles de referencia omitidos son: “66 y más” para la Categoría de Edad, “50” para el Descuento por No Reclamaciones y “16 años y más” para la Edad del Vehículo. Código R para generar la Tabla 12.6 Tabla 12.6: Estimaciones de Parámetros de un Modelo Poisson Ajustado Estimación del Parámetro \\(t\\)-Ratio Intercepto -3.306 -6.602 Femenino -0.173 -1.115 Auto 0.079 0.11 (Auto = 1) × Categoría de Edad * 22-25 -0.747 -0.961 26-35 -0.582 -0.81 36-45 -0.623 -0.87 46-55 -0.803 -1.099 56-65 -0.257 -0.343 (Auto = 1) × Descuento por No Reclamaciones * 0 0.729 4.704 10 0.528 2.732 20 0.293 1.326 30 0.26 1.152 40 -0.095 -0.342 Edad del Vehículo (en años) * 0-2 1.674 3.276 3-5 1.504 2.917 6-10 1.081 2.084 11-15 0.362 0.682 Nota: Los niveles de referencia omitidos son “66 y más” para la edad, “50” para el descuento por no reclamaciones, y “16 y más” para la edad del vehículo. Para un modelo más parsimonioso, se podría considerar eliminar las variables de automóvil, género y edad. Al eliminar estas siete variables, el modelo resultante tiene una verosimilitud logarítmica de \\(L \\left( \\mathbf{b}_{\\mathrm{Reduced}}\\right) =-1,779.420\\). Para entender si esto representa una reducción significativa, podemos calcular el estadístico de razón de verosimilitud usando la ecuación (12.7), \\[ LRT=2\\times \\left( -1,776.730 - (-1,779.420) \\right) =5.379. \\] Comparando este valor con una distribución chi-cuadrado con \\(df=7\\) grados de libertad, el valor \\(p\\) del estadístico \\(=\\Pr \\left( \\chi _{7}^2&gt;5.379\\right) =0.618\\) indica que estas variables no son estadísticamente significativas. No obstante, para propósitos de desarrollo adicional del modelo, hemos retenido las variables de automóvil, género y edad, ya que es común incluir estas variables en los modelos de tarificación. Como se describió en la Sección 12.1.4, existen varias formas de evaluar el ajuste general de un modelo. Tabla 12.7 compara varios modelos ajustados, proporcionando valores ajustados para cada nivel de respuesta y resumiendo el ajuste general con estadísticas de bondad de ajuste chi-cuadrado de Pearson. La parte izquierda de la tabla repite la información básica que apareció en la Tabla 12.1, para mayor comodidad. Para empezar, primero note que incluso sin covariables, la inclusión del término de ajuste, exposiciones, mejora dramáticamente el ajuste del modelo. Esto es intuitivamente atractivo; a medida que un conductor tiene más cobertura de seguro durante un año, es más probable que esté involucrado en un accidente cubierto por el contrato de seguro. Tabla 12.7 también muestra la mejora en el ajuste general al incluir el modelo ajustado resumido en Tabla 12.6. Al compararlo con una distribución chi-cuadrado, el valor \\(p\\) del estadístico \\(=\\Pr \\left( \\chi_{4}^2&gt;8.77\\right) =0.067\\) sugiere una concordancia entre los datos y el valor ajustado. Sin embargo, esta especificación del modelo puede mejorarse: la siguiente sección introduce un modelo binomial negativo que resulta ser un mejor ajuste para este conjunto de datos. Tabla 12.7. Comparación de Modelos de Frecuencia Ajustados \\[ \\small{ \\begin{array}{cr|rrrr} \\hline &amp; &amp; \\text{Sin} &amp; \\text{Con} &amp; \\text{Exposiciones}\\\\ \\text{Conteo} &amp; \\text{Observado} &amp; \\text{Exposiciones/} &amp; \\text{Sin} &amp; \\text{Poisson} &amp; \\text{Binomial} \\\\ &amp; &amp; \\text{Sin Covariables} &amp; \\text{Covariables} &amp; &amp; \\text{Negativo} \\\\ \\hline 0 &amp; 6,996 &amp; 6,977.86 &amp; 6,983.05 &amp; 6,986.94 &amp; 6,996.04 \\\\ 1 &amp; 455 &amp; 487.70 &amp; 477.67 &amp; 470.30 &amp; 453.40 \\\\ 2 &amp; 28 &amp; 17.04 &amp; 21.52 &amp; 24.63 &amp; 31.09 \\\\ 3 &amp; 4 &amp; 0.40 &amp; 0.73 &amp; 1.09 &amp; 2.28 \\\\ 4 &amp; 0 &amp; 0.01 &amp; 0.02 &amp; 0.04 &amp; 0.18 \\\\ \\hline \\text{Bondad de ajuste de Pearson} &amp;&amp; 41.98 &amp; 17.62 &amp; 8.77 &amp; 1.79\\\\ \\hline \\end{array} } \\] Código en R para generar la Tabla 12.7 Tabla 12.7: Comparación de Modelos de Frecuencia Ajustados Con Exposiciones Conteo Observado Sin Exposiciones/Sin Covariables Sin Covariables Poisson Binomial Negativa 0 6996 6977.86 6983.05 6986.94 6997.01 1 455 487.69 477.67 470.3 451.64 2 28 17.04 21.52 24.63 31.72 3 4 0.4 0.73 1.09 2.42 4 0 0.01 0.02 0.04 0.2 Pearson Bondad de Ajuste 41.98 17.62 8.77 1.69 12.3 Sobre dispersión y Modelos Binomiales Negativos Aunque la simplicidad es una virtud del modelo de regresión Poisson, su forma también puede ser demasiado restrictiva. En particular, la exigencia de que la media sea igual a la varianza, conocida como equidispersión, no se cumple para muchos conjuntos de datos de interés. Si la varianza excede la media, se dice que los datos están sobredispersos. Un caso menos común ocurre cuando la varianza es menor que la media, lo que se conoce como subdispersión. Ajustando los Errores Estándar para Datos no Equidispersos Para mitigar esta preocupación, una especificación común es asumir que \\[\\begin{equation} \\mathrm{Var~}y_i=\\phi \\mu_i, \\tag{12.8} \\end{equation}\\] donde \\(\\phi &gt;0\\) es un parámetro que acomoda la posible sobre- o sub-dispersión. Como se sugiere en la ecuación (12.5), la estimación consistente de \\(\\boldsymbol \\beta\\) requiere únicamente que la función de la media esté correctamente especificada, sin necesidad de que se cumplan las suposiciones de equidispersión o de la distribución de Poisson. Esta característica también se aplica a la regresión lineal. Debido a esto, el estimador \\(\\mathbf{b}\\) a veces se denomina estimador de cuasi-verosimilitud. Con este estimador, podemos calcular las medias estimadas \\(\\widehat{\\mu}_i\\) y luego estimar \\(\\phi\\) como \\[\\begin{equation} \\widehat{\\phi }=\\frac{1}{n-(k+1)}\\sum\\limits_{i=1}^{n}\\frac{\\left( y_i-\\widehat{\\mu }_i\\right)^2}{\\widehat{\\mu }_i}. \\tag{12.9} \\end{equation}\\] Los errores estándar se basan entonces en \\[ \\widehat{\\mathrm{Var~}\\mathbf{b}}=\\left( \\widehat{\\phi }\\sum\\limits_{i=1}^{n}\\widehat{\\mu }_i\\mathbf{x}_i\\mathbf{x}_i^{\\prime }\\right)^{-1}. \\] Un inconveniente de la ecuación (12.8) es que se asume que la varianza de cada observación es un múltiplo constante de su media. Para conjuntos de datos donde esta suposición es dudosa, es común utilizar un error estándar robusto, que se calcula como la raíz cuadrada del elemento diagonal de \\[ \\mathrm{Var~}\\mathbf{b}=\\left( \\sum\\limits_{i=1}^{n}\\mu_i\\mathbf{x}_i \\mathbf{x}_i^{\\prime }\\right)^{-1}\\left( \\sum\\limits_{i=1}^{n}\\left( y_i-\\mu_i\\right)^2\\mathbf{x}_i\\mathbf{x}_i^{\\prime }\\right) \\left( \\sum\\limits_{i=1}^{n}\\mu_i\\mathbf{x}_i\\mathbf{x}_i^{\\prime }\\right)^{-1}, \\] evaluado en \\(\\widehat{\\mu }_i\\). Aquí, la idea es que \\(\\left( y_i-\\mu_i\\right)^2\\) es un estimador insesgado de \\(\\mathrm{Var~}y_i\\), independientemente de la forma. Aunque \\(\\left( y_i-\\mu_i\\right)^2\\) es un estimador deficiente de \\(\\mathrm{Var~}y_i\\) para cada observación \\(i\\), la suma ponderada \\(\\sum\\nolimits_i\\left( y_i-\\mu_i\\right)^2\\mathbf{x}_i\\mathbf{x}_i^{\\prime }\\) es un estimador fiable de \\(\\sum\\nolimits_i\\left( \\mathrm{Var~}y_i\\right) \\mathbf{x}_i\\mathbf{x}_i^{\\prime }\\). Para el estimador de cuasi-verosimilitud, la estrategia de estimación asume solo una especificación correcta de la media y utiliza una especificación más robusta de la varianza que la implicada por la distribución de Poisson. La ventaja y desventaja de este estimador es que no está vinculado a una distribución completa. Esta suposición lo hace difícil, por ejemplo, si el interés está en estimar la probabilidad de conteos de ceros. Un enfoque alternativo es suponer un modelo paramétrico más flexible que permita una mayor dispersión. Binomial Negativa Un modelo ampliamente utilizado para conteos es la binomial negativa, con función de masa de probabilidad \\[\\begin{equation} \\mathrm{Pr}(y=j)=\\left( \\begin{array}{c} j+r-1 \\\\ r-1 \\end{array} \\right) p^{r}\\left( 1-p\\right)^j, \\tag{12.10} \\end{equation}\\] donde \\(r\\) y \\(p\\) son parámetros del modelo. Para ayudar a interpretar los parámetros del modelo, cálculos sencillos muestran que \\(\\mathrm{E~}y=r(1-p)/p\\) y \\(\\mathrm{Var~}y = r(1-p)/p^2\\). La binomial negativa tiene varias ventajas importantes en comparación con la distribución de Poisson. Primero, debido a que hay dos parámetros que describen la distribución binomial negativa, tiene mayor flexibilidad para ajustar los datos. Segundo, se puede demostrar que la distribución de Poisson es un caso límite de la binomial negativa (permitiendo que \\(p\\rightarrow 1\\) y \\(r \\rightarrow 0\\) de modo que \\(rp \\rightarrow \\lambda\\)). En este sentido, la distribución de Poisson está anidada dentro de la binomial negativa. Tercero, se puede demostrar que la distribución binomial negativa surge de una mezcla de variables de Poisson. Por ejemplo, piense en el conjunto de datos de Singapur con cada conductor teniendo su propio valor de \\(\\lambda\\). Condicional en \\(\\lambda\\), suponga que la distribución de accidentes del conductor sigue una distribución de Poisson con parámetro \\(\\lambda\\). Además, suponga que la distribución de \\(\\lambda\\) puede describirse como una distribución gamma. Entonces, se puede demostrar que los conteos totales de accidentes tienen una distribución binomial negativa. Véase, por ejemplo, Klugman et al. (2008). Estas interpretaciones de “mezcla” son útiles para explicar resultados a los consumidores de análisis actuariales. Para la modelización de regresión, el parámetro “\\(p\\)” varía según el sujeto \\(i\\). Es habitual reparametrizar el modelo y usar una función de enlace logarítmico de modo que \\(\\sigma =1/r\\) y que \\(p_i\\) esté relacionado con la media a través de \\(\\mu_i =r(1-p_i)/p_i = \\exp (\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta)\\). Dado que la binomial negativa es una distribución de frecuencias de probabilidad, no hay dificultad en estimar características de esta distribución, como la probabilidad de conteos de ceros, después de un ajuste de regresión. Esto contrasta con la estimación de cuasi-verosimilitud de un modelo de Poisson con una especificación ad hoc de la varianza, resumida en la ecuación (12.9). Ejemplo: Datos de Automóviles en Singapur - Continuación. La distribución binomial negativa se ajustó a los datos de Singapur en la Sección 12.2 utilizando el conjunto de covariables resumido en Tabla 12.6. La verosimilitud resultante fue \\(\\mathrm{L}_{NegBin}(\\mathbf{b})=-1,774.494;\\) esto es mayor que la verosimilitud del ajuste Poisson \\(\\mathrm{L}_{Poisson}\\left( \\mathbf{b} \\right) =-1,776.730\\) debido a un parámetro adicional. La prueba de razón de verosimilitud habitual no es formalmente apropiada porque los modelos solo están anidados en un sentido límite. Es más útil comparar las estadísticas de bondad de ajuste presentadas en Tabla 12.7. Aquí, vemos que la binomial negativa es un mejor ajuste que el modelo de Poisson (con los mismos componentes sistemáticos). Una prueba chi-cuadrado sobre si la binomial negativa con covariables es adecuada arroja un valor \\(p\\) \\(=\\Pr \\left( \\chi_{4}^2&gt;1.79\\right) =0.774\\), lo que sugiere un fuerte acuerdo entre los datos observados y los valores ajustados. Interpretamos los resultados de la Tabla 12.7 como que la distribución binomial negativa captura bien la heterogeneidad en la distribución de frecuencia de accidentes. Código R para la Distribución Binomial Negativa con Datos de Singapur library(MASS) #Singapore &lt;- read.csv(&quot;CSVData/SingaporeAuto.csv&quot;, header=TRUE) Singapore$Female &lt;- 1*(Singapore$SexInsured == &quot;F&quot; ) Singapore$Auto &lt;- 1*(Singapore$VehicleType==&quot;A&quot;) NCD1F &lt;- relevel(factor(Singapore$NCD), ref=&quot;50&quot;) AgeCatF &lt;- relevel(factor(Singapore$AgeCat), ref=&quot;7&quot;) VAgecat1F &lt;-relevel(factor(Singapore$VAgecat1), ref=&quot;6&quot;) # AJUSTAR UN MODELO BINOMIAL NEGATIVO; CountNB1 &lt;- MASS::glm.nb(Clm_Count ~ Female + Auto + Auto:AgeCatF + Auto:NCD1F + VAgecat1F + offset(LNWEIGHT), link=log, data = Singapore) temp &lt;- summary(CountNB1) summary(temp) temp$twologlik/2 # ELIMINAR UN FACTOR DEL MODELO BINOMIAL NEGATIVO; CountNB2 &lt;- MASS::glm.nb(Clm_Count ~ Female + Auto + Auto:NCD1F + VAgecat1F + offset(LNWEIGHT), link=log, data = Singapore) summary(CountNB2) 12.4 Otros Modelos de Conteo Los actuarios están familiarizados con una variedad de modelos de frecuencia; ver, por ejemplo, Klugman et al. (2008). En principio, cada modelo de frecuencia podría usarse en un contexto de regresión simplemente incorporando un componente sistemático, \\(\\mathbf{x}^{\\prime}\\boldsymbol \\beta\\), en uno o más parámetros del modelo. Sin embargo, los analistas han encontrado que cuatro variaciones de los modelos básicos funcionan bien para ajustar modelos a datos y proporcionan una plataforma intuitiva para interpretar los resultados del modelo. 12.4.1 Modelos Inflados en Ceros Para muchos conjuntos de datos, un aspecto problemático es el número “excesivo” de ceros, en comparación con un modelo especificado. Por ejemplo, esto podría ocurrir en los datos de reclamos de automóviles porque los asegurados son reacios a reportar reclamos, temiendo que un reclamo reportado resulte en primas de seguro más altas en el futuro. Por lo tanto, tenemos un número mayor al anticipado de ceros debido a la no presentación de reclamos. Un modelo inflado en ceros representa el número de reclamos \\(y_i\\) como una mezcla de una masa puntual en cero y otra distribución de frecuencia de reclamos, digamos \\(g_i(j)\\) (que típicamente es Poisson o binomial negativa). (Podríamos interpretar la masa puntual como la tendencia a no reportar.) La probabilidad de obtener la masa puntual se modelaría mediante un modelo de conteo binario como, por ejemplo, el modelo logit \\[ \\pi_i=\\frac{\\exp \\left( \\mathbf{x}_i^{\\prime}\\boldsymbol \\beta _{1}\\right) }{1+\\exp \\left( \\mathbf{x}_i^{\\prime}\\boldsymbol \\beta _{1}\\right) }. \\] Como consecuencia de la suposición de mezcla, la distribución de conteo inflada en ceros puede escribirse como \\[\\begin{equation} \\Pr \\left( y_i=j\\right) =\\left\\{ \\begin{array}{ll} \\pi_i+(1-\\pi_i)g_i(0) &amp; j=0 \\\\ (1-\\pi_i)g_i(j) &amp; j=1,2,... \\end{array} \\right. . \\tag{12.11} \\end{equation}\\] A partir de la ecuación (12.11), vemos que los ceros podrían surgir tanto de la masa puntual como de la otra distribución de frecuencia de reclamos. Para ver los efectos de un modelo inflado en ceros, supongamos que \\(g_i\\) sigue una distribución Poisson con media \\(\\mu_i\\). Entonces, cálculos simples muestran que \\[ \\mathrm{E~} y_i = (1 - \\pi_i) \\mu_i \\] y \\[ \\mathrm{Var~} y_i = \\pi_i \\mu_i + \\pi_i\\mu_i^2(1-\\pi_i). \\] Así, para el modelo Poisson inflado en ceros, la varianza siempre excede a la media, lo que acomoda la sobredispersión en comparación con el modelo Poisson. Ejemplo: Seguro de Automóviles. Yip y Yau (2005) examinan una cartera de \\(n=2,812\\) pólizas de automóviles disponibles en SAS Institute, Inc. Las variables explicativas incluyen edad, género, estado civil, ingreso anual, categoría laboral y nivel educativo del asegurado. Para este conjunto de datos, encontraron que varios modelos de conteo inflados en ceros se adaptaban bien a la presencia de ceros adicionales. 12.4.2 Modelos Hurdle Un “modelo hurdle” proporciona otro mecanismo para modificar distribuciones básicas de conteo para representar situaciones con un exceso de ceros. Los modelos hurdle pueden ser motivados por procesos de toma de decisiones secuenciales enfrentados por los individuos. Por ejemplo, en la elección de atención médica, podemos pensar en la decisión de un individuo de buscar atención médica como un proceso inicial. Condicional a haber buscado atención \\(\\{y \\geq 1\\}\\), la cantidad de atención médica es una decisión tomada por un proveedor de atención médica (como un médico u hospital), lo que representa un proceso diferente. Uno necesita superar el primer “hurdle” (la decisión de buscar atención médica) para abordar el segundo (la cantidad de atención médica). Un atractivo del modelo hurdle es su conexión con el modelo “principal-agente”, donde el proveedor (agente) decide la cantidad después de que el asegurado (principal) haya establecido contacto. Como otro ejemplo, en el seguro de propiedad y accidentes, el proceso de decisión que utiliza el asegurado para reportar el primer reclamo puede diferir del que utiliza para reportar reclamos subsiguientes. Para representar los modelos hurdle, sea \\(\\pi_i\\) la probabilidad de que \\(\\{y_i=0\\}\\) utilizada para la primera decisión, y supongamos que \\(g_i\\) representa la distribución de conteo que se utilizará para la segunda decisión. Definimos la función de masa de probabilidad como \\[\\begin{equation} \\Pr \\left( y_i=j\\right) =\\left\\{ \\begin{array}{ll} \\pi_i &amp; j=0 \\\\ k_i g_i(j) &amp; j=1,2,... \\end{array} \\right. . \\tag{12.12} \\end{equation}\\] donde \\(k_i = (1-\\pi_i)/(1-g_i(0))\\). Al igual que con los modelos inflados en ceros, un modelo logit podría ser adecuado para representar \\(\\pi_i\\). Para ver los efectos de un modelo hurdle, supongamos que \\(g_i\\) sigue una distribución Poisson con media \\(\\mu_i\\). Entonces, cálculos simples muestran que \\[ \\mathrm{E~} y_i = k_i \\mu_i \\] y \\[ \\mathrm{Var~} y_i = k_i \\mu_i + k_i \\mu_i^2(1-k_i). \\] Dado que \\(k_i\\) puede ser mayor o menor que 1, este modelo permite tanto subdispersión como sobredispersión en comparación con el modelo Poisson. El modelo hurdle es un caso especial del “modelo de dos partes” descrito en el Capítulo 16. Allí, veremos que para los modelos de dos partes, la cantidad de atención médica utilizada puede ser una variable continua, además de una variable de conteo. Un atractivo de los modelos de dos partes es que los parámetros de cada hurdle/parte pueden analizarse por separado. Específicamente, la log-verosimilitud para el \\(i\\)-ésimo sujeto puede escribirse como \\[ \\ln \\left[ \\Pr \\left( y_i=j\\right) \\right] =\\left[ \\mathrm{I}(j=0)\\ln \\pi_i+\\mathrm{I}(j\\geq 1)\\ln (1-\\pi_i)\\right] +\\mathrm{I}(j\\geq 1)\\ln \\frac{g_i(j)}{(1-g_i(0))}. \\] Los términos en los corchetes en el lado derecho corresponden a la verosimilitud para un modelo binario de conteo. Los términos posteriores corresponden a un modelo de conteo con los ceros eliminados (conocido como un modelo truncado). Si los parámetros para las dos piezas son diferentes (“separables”), entonces la maximización puede hacerse por separado para cada parte. 12.4.3 Modelos de Heterogeneidad En un modelo de heterogeneidad, se permite que uno o más parámetros del modelo varíen de manera aleatoria. La motivación es que estos parámetros aleatorios capturan características no observadas de un sujeto. Por ejemplo, supongamos que \\(\\alpha_i\\) representa un parámetro aleatorio y que \\(y_i\\), dado \\(\\alpha_i\\), tiene una media condicional \\(\\exp \\left( \\alpha_i + \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta \\right)\\). Interpretamos \\(\\alpha_i\\), llamado componente de heterogeneidad, como una representación de características no observadas del sujeto que contribuyen de manera lineal al componente sistemático \\(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta\\). Para ver los efectos del componente de heterogeneidad en la distribución de conteo, cálculos básicos muestran que \\[ \\mathrm{E~} y_i = \\exp \\left( \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta \\right) = \\mu_i \\] y \\[ \\mathrm{Var~} y_i = \\mu_i + \\mu_i^2 \\mathrm{Var}\\left( e^{\\alpha_i} \\right), \\] donde típicamente asumimos que \\(\\mathrm{E}\\left( e^{\\alpha_i} \\right) = 1\\) para la identificación de parámetros. Así, los modelos de heterogeneidad acomodan fácilmente la sobredispersión en los conjuntos de datos. Es común suponer que la distribución de conteo es Poisson, condicional a \\(\\alpha_i\\). Hay varias opciones para la distribución de \\(\\alpha_i\\), siendo las dos más comunes la log-gamma y la log-normal. Para la primera, se asume que \\(\\exp \\left( \\alpha_i \\right)\\) sigue una distribución gamma, lo que implica que \\(\\exp \\left( \\alpha_i + \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta \\right)\\) también sigue una distribución gamma. Recordemos que ya hemos señalado en la Sección 12.3 que usar una distribución de mezcla gamma para conteos Poisson da como resultado una distribución binomial negativa. Por lo tanto, esta elección proporciona otra motivación para la popularidad de la binomial negativa como la distribución de conteo preferida. Para la segunda, es bastante común en análisis de datos aplicados asumir que una cantidad observada como \\(\\exp \\left( \\alpha_i \\right)\\) tiene una distribución normal. Aunque no hay expresiones analíticas en forma cerrada para la distribución marginal de conteo resultante, hay varios paquetes de software que facilitan las dificultades computacionales. El componente de heterogeneidad es particularmente útil en muestras repetidas, donde puede usarse para modelar la agrupación de observaciones. Las observaciones de diferentes grupos tienden a ser disímiles en comparación con las observaciones dentro de un grupo, una característica conocida como heterogeneidad. La similitud de las observaciones dentro de un grupo puede capturarse mediante un término común \\(\\alpha_i\\). Diferentes términos de heterogeneidad para observaciones de diferentes grupos pueden capturar la heterogeneidad. Para una introducción a la modelización en muestreo repetido, véase el Capítulo 10. Ejemplo: Seguro de Responsabilidad Civil de Automóviles en España. Boucher et al. (2006) analizaron una cartera de \\(n=548,830\\) contratos de automóviles de una importante compañía de seguros que opera en España. Los reclamos eran por responsabilidad civil de automóviles, por lo que, en caso de un accidente automovilístico, el monto que el asegurado debe pagar por daños no materiales a otras partes está cubierto bajo el contrato de seguro. Para estos datos, la frecuencia media de reclamos fue aproximadamente del 6.9%. Las variables explicativas incluyen edad, género, ubicación de conducción, experiencia de conducción, tamaño del motor y tipo de póliza. El artículo considera una amplia variedad de modelos inflados en ceros, hurdle y de heterogeneidad, mostrando que cada uno de ellos mejoró sustancialmente el modelo Poisson básico. 12.4.4 Modelos de Clases Latentes En la mayoría de los conjuntos de datos, es fácil pensar en clasificaciones de sujetos que el analista quisiera hacer para promover la homogeneidad entre las observaciones. Algunos ejemplos incluyen: “personas saludables” y “personas enfermas” al examinar los gastos en atención médica, conductores de automóviles que tienen más probabilidades de presentar un reclamo en caso de accidente en comparación con aquellos que son reacios a hacerlo, y médicos que son “bajos” riesgos en comparación con “altos” riesgos al examinar la cobertura de seguros por negligencia médica. Para muchos conjuntos de datos de interés, dicha información de clasificación obvia no está disponible y se dice que es no observada o latente. Un modelo de “clases latentes” todavía emplea esta idea de clasificación, pero la trata como una variable aleatoria discreta desconocida. Así, al igual que en las Secciones 12.4.1-12.4.3, utilizamos modelos de mezcla para modificar las distribuciones básicas de conteo, pero ahora asumimos que la mezcla es una variable aleatoria discreta que interpretamos como la clase latente. Para ser específicos, supongamos que tenemos dos clases, “bajo riesgo” y “alto riesgo”, con probabilidad \\(\\pi_L\\) de que un sujeto pertenezca a la clase de bajo riesgo. Entonces, podemos escribir la función de masa de probabilidad como \\[\\begin{equation} \\Pr \\left( y_i=j\\right) =\\pi_L \\Pr \\left( y_i=j;L\\right) + \\left( 1-\\pi_L \\right) \\Pr \\left( y_i=j;H \\right), \\tag{12.13} \\end{equation}\\] donde \\(\\Pr \\left( y_i=j;L \\right)\\) y \\(\\Pr \\left( y_i=j;H \\right)\\) son las funciones de masa de probabilidad para los riesgos bajos y altos, respectivamente. Este modelo es intuitivamente agradable, ya que corresponde a la percepción de un analista sobre el comportamiento del mundo. Es flexible en el sentido de que el modelo acomoda fácilmente la subdispersión y sobredispersión, distribuciones con colas largas y distribuciones bimodales. Sin embargo, esta flexibilidad también conlleva dificultades con respecto a los problemas computacionales. Existe la posibilidad de múltiples máximos locales al estimar mediante máxima verosimilitud. La convergencia puede ser más lenta en comparación con otros métodos descritos en las Secciones 12.4.1-12.4.3. No obstante, los modelos de clases latentes han demostrado ser fructíferos en aplicaciones de interés para los actuarios. Ejemplo: Experimento de Seguro de Salud Rand. Deb y Trivedi (2002) encontraron una fuerte evidencia de que un modelo de clases latentes funciona bien en comparación con el modelo hurdle. Ellos examinaron conteos de utilización de gastos en atención médica para el Experimento de Seguro de Salud Rand, un conjunto de datos que ha sido ampliamente analizado en la literatura de economía de la salud. Interpretaron \\(\\Pr \\left( y_i=j;L\\right)\\) como una distribución de usuarios de atención médica poco frecuentes y \\(\\Pr \\left( y_i=j;H\\right)\\) como una distribución de usuarios frecuentes de atención médica. Cada distribución se basó en una distribución binomial negativa, con diferentes parámetros para cada clase. Encontraron diferencias estadísticamente significativas para sus cuatro variables de seguro, dos variables de coseguro, una variable que indicaba si había un deducible individual y una variable que describía el límite máximo reembolsado. Debido a que los sujetos fueron asignados aleatoriamente a planes de seguro (algo muy inusual), los efectos de las variables de seguro sobre la utilización de atención médica son particularmente interesantes desde un punto de vista político, al igual que las diferencias entre sujetos de bajo y alto uso. Para sus datos, estimaron que aproximadamente el 20% estaban en la clase de alto uso. 12.5 Lecturas Adicionales y Referencias La distribución de Poisson fue derivada por Poisson (1837) como un caso límite de la distribución binomial. Greenwood y Yule (1920) derivaron la distribución binomial negativa como una mezcla de una Poisson con una distribución gamma. Curiosamente, un ejemplo del artículo de 1920 fue utilizar la distribución de Poisson como un modelo de accidentes, con la media como una variable aleatoria gamma, reflejando la variación de los trabajadores en una población. Greenwood y Yule se refirieron a esto como individuos sujetos a “accidentes repetidos”, lo que otros autores han denominado “propensión a los accidentes.” La primera aplicación de la regresión Poisson se debe a Cochran (1940) en el contexto del modelado ANOVA y a Jorgensen (1961) en el contexto de la regresión lineal múltiple. Como se describe en la Sección 12.2, Weber (1971) presenta la primera aplicación a los accidentes de automóviles. Este capítulo se centra en las aplicaciones de modelos de conteo en seguros y gestión de riesgos. Para aquellos interesados en automóviles, existe una literatura relacionada sobre estudios del proceso de accidentes de vehículos de motor, véase, por ejemplo, Lord et al. (2005). Para aplicaciones en otras áreas de las ciencias sociales y desarrollo adicional de modelos, nos remitimos a Cameron y Trivedi (1998). Referencias Bortkiewicz, L. von (1898). Das Gesetz de Kleinen Zahlen. Leipzig, Teubner. Boucher, Jean-Philippe, Michel Denuit and Montserratt Guill'{e}n (2006). Risk classification for claim counts: A comparative analysis of various zero-inflated mixed Poisson and hurdle models. Working paper. Cameron, A. Colin and Pravin K. Trivedi. (1998) Regression Analysis of Count Data. Cambridge University Press, Cambridge. Cochran, W. G. (1940). The analysis of variance when experimental errors follow the Poisson or binomial law. Annals of Mathematical Statistics 11, 335-347. Deb, Partha and Pravin K. Trivedi (2002). The structure of demand for health care: latent class versus two-part models. Journal of Health Economics 21, 601-625. Fournier, Gary M. and Melayne Morgan McInnes (2001). The case of experience rating in medical malpractice insurance: An empirical evaluation. The Journal of Risk and Insurance 68, 255-276. Frees, Edward W. and Emiliano Valdez (2008). Hierarchical insurance claims modeling. Journal of the American Statistical Association 103, 1457-1469. Greenwood, M. and G. U. Yule (1920). An inquiry into the nature of frequency distributions representative of multiple happenings with particular reference to the occurrence of multiple attacks of disease or of repeated accidents. Journal of the Royal Statistical Society 83, 255-279. Jones, Andrew M. (2000). Health econometrics. Chapter 6 of the Handbook of Health Economics, Volume 1. Edited by Antonio.J. Culyer, and Joseph.P. Newhouse, Elsevier, Amersterdam. 265-344. Jorgensen, Dale W. (1961). Multiple regression analysis of a Poisson process. Journal of the American Statistical Association 56, 235-245. Lord, Dominique, Simon P. Washington and John N. Ivan (2005). Poisson, Poisson-gamma and zero-inflated regression models of motor vehicle crashes: Balancing statistical theory and fit. Accident Analysis and Prevention 37, 35-46. Klugman, Stuart A, Harry H. Panjer and Gordon E. Willmot (2008). Loss Models: From Data to Decisions. John Wiley &amp; Sons, Hoboken, New Jersey. Purcaru, Oana and Michel Denuit (2003). Dependence in dynamic claim frequency credibility models. ASTIN Bulletin 33(1), 23-40. Weber, Donald C. (1971). Accident rate potential: An application of multiple regression analysis of a Poisson process. Journal of the American Statistical Association 66, 285-288. Yip, Karen C. H. and Kelvin K.W. Yau (2005). On modeling claim frequency data in general insurance with extra zeros. Insurance: Mathematics and Economics 36(2) 153-163. 12.6 Ejercicios 12.1 Muestra que la log-verosimilitud en la ecuación (12.2) tiene un máximo en \\(\\widehat{\\mu }=\\overline{y}\\). 12.2 Para los datos de la Tabla 12.1, confirma que el estadístico de Pearson en la ecuación (12.3) es 41.98. 12.3 Residuos de Poisson. Considera una regresión de Poisson. Sea \\(e_i = y_i - \\widehat{\\mu}_i\\) el residuo ordinario \\(i\\)-ésimo. Supón que se utiliza una intersección en el modelo de modo que una de las variables explicativas \\(x\\) es una constante igual a uno. Demuestra que el promedio de los residuos ordinarios es 0. Demuestra que la correlación entre los residuos ordinarios y cada variable explicativa es cero. 12.4 Distribución Binomial Negativa. Supón que \\(y_1, \\ldots, y_n\\) son i.i.d. con una distribución binomial negativa con parámetros \\(r\\) y \\(p\\). Determina los estimadores de máxima verosimilitud. Utiliza el mecanismo de muestreo en la parte (a) pero con los parámetros \\(\\sigma =1/r\\) y \\(\\mu\\) donde \\(\\mu =r(1-p)/p\\). Determina los estimadores de máxima verosimilitud de \\(\\sigma\\) y \\(\\mu\\). Supón que \\(y_1, \\ldots, y_n\\) son independientes con \\(y_i\\) teniendo una distribución binomial negativa con parámetros \\(r\\) y \\(p_i\\), donde \\(\\sigma =1/r\\) y \\(p_i\\) satisface \\(r(1-p_i)/p_i=\\exp (\\mathbf{x}_i^{\\prime }\\boldsymbol \\beta) (= \\mu_i)\\). Determina la función de puntaje en términos de \\(\\sigma\\) y \\(\\boldsymbol \\beta\\). 12.5 Datos de Gastos Médicos. Este ejercicio considera datos de la Encuesta del Panel de Gastos Médicos (MEPS) descritos en el Ejercicio 1.1 y la Sección 11.4. Nuestra variable dependiente consiste en el número de visitas ambulatorias (COUNTOP). Para MEPS, los eventos ambulatorios incluyen visitas a departamentos ambulatorios de hospitales, consultas con proveedores en consultorios y visitas a salas de emergencia, excluyendo los servicios dentales. (Los servicios dentales, en comparación con otros tipos de servicios de salud, son más predecibles y ocurren de manera más regular). Las estancias hospitalarias con la misma fecha de admisión y alta, conocidas como “estancias de cero noches”, también se incluyeron en los conteos y gastos ambulatorios. (Los pagos asociados con visitas a la sala de emergencias que preceden inmediatamente a una estancia hospitalaria se incluyeron en los gastos de hospitalización. Los medicamentos recetados que pueden vincularse con hospitalizaciones se incluyeron en los gastos de hospitalización, no en la utilización ambulatoria). Considera las variables explicativas descritas en la Sección 11.4. Proporciona una tabla de conteos, un histograma y estadísticas resumidas de COUNTOP. Nota la forma de la distribución y la relación entre la media muestral y la varianza muestral. Crea tablas de medias de COUNTOP por nivel de GÉNERO, etnicidad, región, educación, salud física autoevaluada, salud mental autoevaluada, limitación de actividad, ingresos y seguro. ¿Sugerirían estas tablas que estas variables explicativas tienen un impacto en COUNTOP? Como línea base, estima un modelo de Poisson sin ninguna variable explicativa y calcula un estadístico chi-cuadrado de Pearson para bondad de ajuste (a nivel individual). Estima un modelo de Poisson utilizando las variables explicativas en la parte (b). d(i). Comenta brevemente sobre la significancia estadística de cada variable. d(ii). Proporciona una interpretación del coeficiente de GÉNERO. d(iii). Calcula un estadístico chi-cuadrado de Pearson (a nivel individual) para la bondad de ajuste. Compáralo con el de la parte (b). Basado en este estadístico y en la significancia estadística de los coeficientes discutidos en la parte d(i), ¿qué modelo prefieres? d(iv). Reestima el modelo utilizando el estimador de cuasi-verosimilitud del parámetro de dispersión. ¿Cómo han cambiado tus comentarios en la parte d(i)? Estima un modelo binomial negativo utilizando las variables explicativas de la parte (d). e(i). Comenta brevemente sobre la significancia estadística de cada variable. e(ii). Calcula un estadístico chi-cuadrado de Pearson (a nivel individual) para la bondad de ajuste. Compáralo con los de las partes (b) y (d). ¿Qué modelo prefieres? Cita también el estadístico \\(AIC\\) en tu comparación. e(iii). Reestima el modelo, eliminando el factor ingreso. Utiliza la prueba de razón de verosimilitud para determinar si el ingreso es un factor estadísticamente significativo. Como verificación de robustez, estima un modelo de regresión logística utilizando las variables explicativas de la parte (d). ¿Los signos y la significancia de los coeficientes de este ajuste de modelo proporcionan la misma interpretación que en el modelo binomial negativo en la parte (e)? 12.6 Dos Poisson de Poblaciones. Podemos expresar el problema de dos poblaciones en un contexto de regresión utilizando una variable explicativa. Específicamente, supón que \\(x_i\\) solo toma los valores 0 y 1. De las \\(n\\) observaciones, \\(n_0\\) toman el valor \\(x=0\\). Estas \\(n_0\\) observaciones tienen un valor promedio de \\(y\\) de \\(\\overline{y}_0\\). Las \\(n_1 =n-n_0\\) observaciones restantes tienen valor \\(x=1\\) y un valor promedio de \\(y\\) de \\(\\overline{y}_1\\). Utiliza el modelo de Poisson con la función de enlace logarítmica y el componente sistemático \\(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta = \\beta_0 +\\beta_1 x_i\\). Determina los estimadores de máxima verosimilitud de \\(\\beta_0\\) y \\(\\beta_1\\), respectivamente. Supón que \\(n_0 = 10\\), \\(n_1= 90\\), \\(\\overline{y}_0 = 0.20\\) y \\(\\overline{y}_1= 0.05\\). Utilizando tus resultados en la parte a(i), calcula los estimadores de máxima verosimilitud de \\(\\beta_0\\) y \\(\\beta_1\\), respectivamente. Determina la matriz de información. "],["C13GLM.html", "Chapter 13 Modelos Lineales Generalizados 13.1 Introducción 13.2 Modelo GLM 13.3 Estimación 13.4 Aplicación: Gastos Médicos 13.5 Residuales 13.6 Distribución de Tweedie 13.7 Lecturas adicionales y referencias 13.8 Ejercicios 13.9 Suplementos Técnicos - Familia Exponencial", " Chapter 13 Modelos Lineales Generalizados Vista Previa del Capítulo. Este capítulo describe un marco unificador para el modelo lineal de la Parte I y los modelos binarios y de conteo en los Capítulos 11 y 12. Los modelos lineales generalizados, conocidos comúnmente por el acrónimo GLM, representan una clase importante de modelos de regresión no lineal que han encontrado un uso extensivo en la práctica actuarial. Este marco unificador no solo abarca muchos de los modelos que hemos visto, sino que también proporciona una plataforma para nuevos modelos, incluyendo las regresiones gamma para datos con colas gruesas y las distribuciones de “Tweedie” para datos de dos partes. 13.1 Introducción Existen muchas maneras de extender o generalizar el modelo de regresión lineal. Este capítulo introduce una extensión que es tan utilizada que se conoce como el “modelo lineal generalizado”, o por el acrónimo GLM. Los modelos lineales generalizados incluyen regresiones lineales, logísticas y de Poisson, todas como casos especiales. Una característica común de estos modelos es que en cada caso podemos expresar la media de la respuesta como una función de combinaciones lineales de variables explicativas. En el contexto de los GLM, es habitual usar \\(\\mu_i = \\mathrm{E}~y_i\\) para la media de la respuesta y llamar \\(\\eta_i = \\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta\\) el componente sistemático del modelo. Hemos visto que podemos expresar el componente sistemático como: \\(\\mathbf{x}_i^{\\mathbf{\\prime}}\\boldsymbol \\beta = \\mu_i\\), para la regresión lineal (normal), \\(\\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta = \\exp(\\mu_i)/(1+\\exp(\\mu_i))\\), para la regresión logística y \\(\\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta = \\ln (\\mu_i)\\), para la regresión de Poisson. Para los GLM, el componente sistemático está relacionado con la media a través de la expresión \\[\\begin{equation} \\eta _i = \\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta = \\mathrm{g}\\left( \\mu _i\\right). \\tag{13.1} \\end{equation}\\] Aquí, g(.) es conocida y se llama función de enlace. La inversa de la función de enlace, \\(\\mu _i = \\mathrm{g}^{-1}( \\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta)\\), es la función de la media. La segunda característica común implica la distribución de las variables dependientes. En la Sección 13.2, introduciremos la familia exponencial lineal de distribuciones, una extensión de la distribución exponencial. Esta familia incluye la normal, Bernoulli y Poisson como casos especiales. La tercera característica común de los modelos GLM es la robustez de la inferencia con respecto a la elección de distribuciones. Aunque la regresión lineal está motivada por la teoría de la distribución normal, hemos visto que las respuestas no necesitan estar distribuidas normalmente para que los procedimientos de inferencia estadística sean efectivos. Las suposiciones de muestreo de la Sección 3.2 se centran en: la forma de la función de la media (suposición F1), variables explicativas no estocásticas o exógenas (F2), varianza constante (F3) y independencia entre observaciones (F4). Los modelos GLM mantienen las suposiciones F2 y F4 y generalizan F1 a través de la función de enlace. La elección de diferentes distribuciones nos permite relajar F3 especificando la varianza como una función de la media, escrita como \\(\\mathrm{Var~}y_i = \\phi v(\\mu_i)\\). Tabla 13.1 muestra cómo la varianza depende de la media para diferentes distribuciones. Como veremos al considerar la estimación (Sección 13.3), es la elección de la función de varianza la que impulsa las propiedades más importantes de la inferencia, no la elección de la distribución. Tabla 13.1. Funciones de Varianza para Distribuciones Seleccionadas \\[ \\small{ \\begin{array}{lc} \\hline \\text{Distribución} &amp; \\text{Función de Varianza }v(\\mu) \\\\ \\hline \\text{Normal} &amp; 1 \\\\ \\text{Bernoulli} &amp; \\mu ( 1- \\mu ) \\\\ \\text{Poisson} &amp; \\mu \\\\ \\text{Gamma} &amp; \\mu ^2 \\\\ \\text{Gaussiana Inversa} &amp; \\mu ^3 \\\\ \\hline \\end{array} } \\] Al considerar la regresión en el contexto de los GLM, podremos manejar variables dependientes que sean aproximadamente normales, binarias o que representen conteos, todo dentro de un único marco. Esto facilitará nuestra comprensión de la regresión al permitirnos ver el “panorama general” y no preocuparnos tanto por los detalles. Además, la generalidad de los GLM nos permitirá introducir nuevas aplicaciones, como las regresiones gamma, que son útiles para distribuciones con colas gruesas, y las llamadas distribuciones “Tweedie” para datos de dos partes. Los datos de dos partes son un tema que se aborda en el Capítulo 16, donde hay una masa en cero y un componente continuo. En el caso de los datos de reclamaciones de seguros, el cero representa la ausencia de una reclamación y el componente continuo representa el monto de una reclamación. Este capítulo describe los procedimientos de estimación para calibrar los modelos GLM, pruebas de significancia y estadísticas de bondad de ajuste para documentar la utilidad del modelo, y residuos para evaluar la robustez del ajuste del modelo. Veremos que el trabajo que realizamos anteriormente en modelos de regresión lineal, binaria y de conteo proporciona las bases para las herramientas necesarias para el modelo GLM. De hecho, muchas de estas herramientas y conceptos son ligeras variaciones de lo que ya hemos desarrollado y podremos construir sobre estas bases. 13.2 Modelo GLM Para especificar un GLM, el analista elige una distribución subyacente de la respuesta, tema de la Sección 13.2.1, y una función que vincula la media de la respuesta con las covariables, tema de la Sección 13.2.2. 13.2.1 Familia Exponencial Lineal de Distribuciones Definición. La distribución de la familia exponencial lineal es \\[\\begin{equation} \\mathrm{f}(y; \\theta, \\phi) = \\exp \\left( \\frac{y\\theta - b(\\theta)}{\\phi} + S(y, \\phi) \\right). \\tag{13.2} \\end{equation}\\] Aquí, \\(y\\) es una variable dependiente y \\(\\theta\\) es el parámetro de interés. La cantidad \\(\\phi\\) es un parámetro de escala. El término \\(b(\\theta)\\) depende solo del parámetro \\(\\theta\\), no de la variable dependiente. El estadístico \\(S(y, \\phi)\\) es una función de la variable dependiente y el parámetro de escala, pero no del parámetro \\(\\theta\\). La variable dependiente \\(y\\) puede ser discreta, continua o una mezcla. Así, \\(\\mathrm{f}(.)\\) puede interpretarse como una función de densidad o de masa, dependiendo de la aplicación. Tabla 13.8 proporciona varios ejemplos, incluyendo las distribuciones normal, binomial y de Poisson. Para ilustrar, consideremos una distribución normal con una función de densidad de probabilidad de la forma: \\[\\begin{eqnarray*} \\mathrm{f}(y; \\mu, \\sigma^2) &amp;=&amp; \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(- \\frac{(y-\\mu)^2}{2\\sigma^2}\\right) \\\\ &amp;=&amp; \\exp\\left(\\frac{(y\\mu - \\mu^2/2)}{\\sigma^2} - \\frac{y^2}{2\\sigma^2} - \\frac{1}{2} \\ln(2\\pi \\sigma^2)\\right). \\end{eqnarray*}\\] Con las elecciones \\(\\theta = \\mu\\), \\(\\phi = \\sigma^2\\), \\(b(\\theta) = \\theta^2/2\\) y \\(S(y, \\phi) = -y^2/(2\\phi) - \\ln(2\\pi\\phi)/2\\), vemos que la función de densidad normal puede expresarse como en la ecuación (13.2). Para la distribución en la ecuación (13.2), algunos cálculos sencillos muestran que: \\(\\mathrm{E~}y = b^{\\prime}(\\theta)\\) y \\(\\mathrm{Var~}y = \\phi b^{\\prime\\prime}(\\theta)\\). Para referencia, estos cálculos aparecen en la Sección 13.9.2. Para ilustrar, en el contexto del ejemplo de la distribución normal mencionado arriba, es fácil verificar que \\(\\mathrm{E~}y = b^{\\prime}(\\theta) = \\theta = \\mu\\) y \\(\\mathrm{Var~} y = \\sigma^2 b^{\\prime\\prime}(\\theta) = \\sigma^2\\), como se esperaba. En situaciones de modelado de regresión, la distribución de \\(y_i\\) varía por observación a través del subíndice “\\(i\\)”. Es habitual dejar que la familia de distribuciones permanezca constante, pero permitir que los parámetros varíen por observación utilizando la notación \\(\\theta_i\\) y \\(\\phi_i\\). Para nuestras aplicaciones, la variación del parámetro de escala se debe a factores de peso conocidos. Específicamente, cuando el parámetro de escala varía por observación, se sigue \\(\\phi_i = \\phi / w_i\\), es decir, una constante dividida por un peso conocido \\(w_i\\). Con la relación \\(\\mathrm{Var~}y_i = \\phi_i b^{\\prime\\prime}(\\theta_i) = \\phi b^{\\prime\\prime}(\\theta_i) / w_i\\), tenemos que un peso mayor implica una varianza menor, todo lo demás constante. 13.2.2 Funciones de Enlace En situaciones de regresión, deseamos entender el impacto de \\(\\eta_i = \\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta\\), el componente sistemático. Como vimos en la subsección anterior, podemos expresar la media de \\(y_i\\) como \\(\\mathrm{E~}y_i = \\mu_i = b^{\\prime}(\\theta_i)\\). La ecuación (13.1) sirve para “enlazar” el componente sistemático con \\(\\mu_i\\) y, por lo tanto, con el parámetro \\(\\theta_i\\). Es posible usar la función identidad para g(.) de modo que \\(\\mu_i = b^{\\prime}(\\theta_i)\\). De hecho, este es el caso habitual en la regresión lineal. Sin embargo, las combinaciones lineales de variables explicativas, \\(\\mathbf{x}_i^{\\mathbf{\\prime}} \\boldsymbol \\beta\\), pueden variar entre negativo e infinito positivo, mientras que las medias a menudo están restringidas a un rango más pequeño. Por ejemplo, las medias de Poisson varían entre cero e infinito. La función de enlace sirve para mapear el dominio de la función de la media en toda la recta real. Caso Especial: Enlaces para la distribución Bernoulli. Las medias de Bernoulli son probabilidades y, por lo tanto, varían entre cero y uno. Para este caso, es útil elegir una función de enlace que mapee el intervalo unitario (0,1) en toda la recta real. A continuación se presentan tres ejemplos importantes de funciones de enlace para la distribución Bernoulli: Logit: \\(g(\\mu )=\\mathrm{logit}(\\mu )=\\ln (\\mu /(1-\\mu ))\\) . Probit: \\(g(\\mu )=\\Phi ^{-1}(\\mu )\\), donde \\(\\Phi ^{-1}\\) es la inversa de la función de distribución normal estándar. Complementario log-log: $g()=( -(1-)) $. Esta ilustración demuestra que puede haber varias funciones de enlace que sean adecuadas para una distribución particular. Para ayudar en la selección, un caso intuitivamente atractivo ocurre cuando el componente sistemático es igual al parámetro de interés ($=$). Para ver esto, recordemos primero que \\(\\eta =g(\\mu )\\) y \\(\\mu =b^{\\prime }(\\theta )\\), omitiendo los subíndices “\\(i\\)” por el momento. Entonces, es fácil ver que si \\(g^{-1}=b^{\\prime }\\), entonces $=g(b^{}())=$. La elección de \\(g\\) que es la inversa de \\(b^{\\prime }(\\theta )\\) se llama el enlace canónico. Tabla 13.2 muestra la función de la media y el enlace canónico correspondiente para varias distribuciones importantes. Tabla 13.2. Funciones de Media y Enlaces Canónicos para Distribuciones Seleccionadas \\[ \\small{ \\begin{array}{lcc} \\hline \\text{Distribución} &amp; \\text{Función de media } b^{\\prime }(\\theta ) &amp; \\text{Enlace canónico }g(\\mu ) \\\\ \\hline \\text{Normal} &amp; \\theta &amp; \\mu \\\\ \\text{Bernoulli} &amp; e^{\\theta}/(1+e^{\\theta} ) &amp; \\mathrm{logit}(\\mu ) \\\\ \\text{Poisson} &amp; e^{\\theta } &amp; \\ln \\mu \\\\ \\text{Gamma} &amp; -1/\\theta &amp; -1/\\mu \\\\ \\text{Gaussiana Inversa} &amp; (-2 \\theta )^{-1/2} &amp; -1 /(2 \\mu^2) \\\\ \\hline \\end{array} } \\] Las funciones de enlace relacionan la media con el componente sistemático y con los parámetros de la regresión. Dado que los parámetros de la regresión son desconocidos, es común especificar los enlaces solo hasta la escala. Por ejemplo, es común especificar el enlace canónico para la gaussiana inversa como \\(1 /\\mu^2\\) (en lugar de $-1 /(2 ^2) $). Si es necesario, siempre se puede recuperar la escala al estimar los coeficientes de regresión desconocidos. Ejemplo: Clasificación para la Fijación de Tarifas. El proceso de agrupar riesgos con características similares se conoce como clasificación de riesgos. La fijación de tarifas es el arte de establecer primas, o tarifas, basadas en la experiencia de pérdidas y las exposiciones de las clases de riesgo. Por ejemplo, Mildenhall (1999) consideró 8,942 pérdidas por colisión de pólizas de seguros de automóviles de uso privado en el Reino Unido (UK). Los datos fueron obtenidos de Nelder y McCullagh (1989, Sección 8.4.1) pero se originaron en Baxter et al. (1980). Un plan de tarifas típico para automóviles personales se basa en las características del conductor y del vehículo. Las características del conductor pueden incluir la edad, género, estado civil, historial (accidentes e infracciones) y descuento por buen estudiante. Las características del vehículo pueden incluir el tipo y año del modelo del vehículo, propósito (negocios/escuela o placer), área de estacionamiento, entre otras. Podemos representar el componente sistemático como: \\[ \\eta_{ij} = \\beta_0 + \\alpha_i + \\tau_j, \\] donde \\(\\alpha_i\\) representa el efecto de la \\(i\\)-ésima categoría de clasificación del conductor y \\(\\tau_j\\) el efecto del \\(j\\)-ésimo tipo de vehículo. Tabla 13.3 muestra los datos de Mildenhall para ocho tipos de conductores (grupos de edad) y cuatro clases de vehículos (uso del vehículo). La severidad promedio está en libras esterlinas ajustadas por inflación. En la terminología de GLM, un plan tarifario aditivo se basa en la función de enlace identidad, mientras que un plan multiplicativo se basa en una función de enlace logarítmica. Específicamente, si usamos \\(\\eta_{ij} = \\ln (\\mu_{ij})\\), entonces podemos escribir la media como: \\[\\begin{equation} \\mu_{ij} = \\exp(\\beta_0 + \\alpha_i + \\tau_j) = B \\times A_i \\times T_j, \\tag{13.3} \\end{equation}\\] donde \\(B=\\exp(\\beta_0)\\) es una constante de escala, \\(A_i=\\exp(\\alpha_i)\\) representa los efectos del conductor y \\(T_j=\\exp(\\tau_j)\\) representa los efectos del vehículo. Tabla 13.3. Datos de Colisiones en Automóviles Privados en el Reino Unido \\[ \\scriptsize{ \\begin{array}{lcrr|llcrr} \\hline \\text{Edad} &amp; \\text{Uso del} &amp; \\text{Severidad} &amp; \\text{Número de} &amp;~~~ &amp; \\text{Edad} &amp; \\text{Uso del} &amp; \\text{Severidad} &amp; \\text{Número de } \\\\ &amp; \\text{ Vehículo} &amp; \\text{Promedio} &amp; \\text{Reclamaciones} &amp;~~~ &amp; \\text{Edad} &amp; \\text{Vehículo} &amp; \\text{Promedio} &amp; \\text{Reclamaciones} \\\\ \\hline 17-20 &amp; \\text{Recreativo} &amp; 250.48 &amp; 21 &amp; &amp; 35-39 &amp; \\text{Recreativo} &amp; 153.62 &amp; 151 \\\\ 17-20 &amp; \\text{ConducirCorto} &amp; 274.78 &amp; 40 &amp; &amp; 35-39 &amp; \\text{ConducirCorto} &amp; 201.67 &amp; 479 \\\\ 17-20 &amp; \\text{ConducirLargo} &amp; 244.52 &amp; 23 &amp; &amp; 35-39 &amp; \\text{ConducirLargo} &amp; 238.21 &amp; 381 \\\\ 17-20 &amp; \\text{Negocios} &amp; 797.80 &amp; 5 &amp; &amp; 35-39 &amp; \\text{Negocios} &amp; 256.21 &amp; 166 \\\\ \\hline 21-24 &amp; \\text{Recreativo} &amp; 213.71 &amp; 63 &amp; &amp; 40-49 &amp; \\text{Recreativo} &amp; 208.59 &amp; 245 \\\\ 21-24 &amp; \\text{ConducirCorto} &amp; 298.60 &amp; 171 &amp; &amp; 40-49 &amp; \\text{ConducirCorto} &amp; 202.80 &amp; 970 \\\\ 21-24 &amp; \\text{ConducirLargo} &amp; 298.13 &amp; 92 &amp; &amp; 40-49 &amp; \\text{ConducirLargo} &amp; 236.06 &amp; 719 \\\\ 21-24 &amp; \\text{Negocios} &amp; 362.23 &amp; 44 &amp; &amp; 40-49 &amp; \\text{Negocios} &amp; 352.49 &amp; 304 \\\\ \\hline 25-29 &amp; \\text{Recreativo} &amp; 250.57 &amp; 140 &amp; &amp; 50-59 &amp; \\text{Recreativo} &amp; 207.57 &amp; 266 \\\\ 25-29 &amp; \\text{ConducirCorto} &amp; 248.56 &amp; 343 &amp; &amp; 50-59 &amp; \\text{ConducirCorto} &amp; 202.67 &amp; 859 \\\\ 25-29 &amp; \\text{ConducirLargo} &amp; 297.90 &amp; 318 &amp; &amp; 50-59 &amp; \\text{ConducirLargo} &amp; 253.63 &amp; 504 \\\\ 25-29 &amp; \\text{Negocios} &amp; 342.31 &amp; 129 &amp; &amp; 50-59 &amp; \\text{Negocios} &amp; 340.56 &amp; 162 \\\\ \\hline 30-34 &amp; \\text{Recreativo} &amp; 229.09 &amp; 123 &amp; &amp; 60+ &amp; \\text{Recreativo} &amp; 192.00 &amp; 260 \\\\ 30-34 &amp; \\text{ConducirCorto} &amp; 228.48 &amp; 448 &amp; &amp; 60+ &amp; \\text{ConducirCorto} &amp; 196.33 &amp; 578 \\\\ 30-34 &amp; \\text{ConducirLargo} &amp; 293.87 &amp; 361 &amp; &amp; 60+ &amp; \\text{ConducirLargo} &amp; 259.79 &amp; 312 \\\\ 30-34 &amp; \\text{Negocios} &amp; 367.46 &amp; 169 &amp; &amp; 60+ &amp; \\text{Negocios} &amp; 342.58 &amp; 96 \\\\ \\hline \\end{array} } \\] Fuente: Mildenhall (1999). “ConducirCorto” significa conducir al trabajo menos de 10 millas. “ConducirLargo” significa conducir al trabajo más de 10 millas. Código en R para Generar la Tabla 13.3 AutoDat &lt;- read.csv(&quot;../../CSVData/AutoCollision1.csv&quot;, quote=&quot;&quot;, header=TRUE) AutoDat1 &lt;- AutoDat AutoDat1[,1] &lt;- gsub(&quot;\\226&quot;, &quot;-&quot;, AutoDat1[,1] , fixed = TRUE) tableout &lt;- cbind(AutoDat1[1:16,],AutoDat1[17:32,]) TableGen1(TableData=tableout, TextTitle=&#39;Datos de Colisiones en Automóviles Privados en el Reino Unido&#39;, Align=&#39;c&#39;, ColumnSpec=1:7, BorderRight = 4, ColWidth = ColWidth8 ) 13.3 Estimación Esta sección presenta la estimación por máxima verosimilitud, la forma habitual de estimación. Para proporcionar una intuición, nos enfocamos en el caso más simple de enlaces canónicos. Los resultados para enlaces más generales aparecen en la Sección 13.9.3. 13.3.1 Estimación de Máxima Verosimilitud para Enlaces Canónicos A partir de la ecuación (13.2) y la independencia entre las observaciones, la función de log-verosimilitud es: \\[\\begin{equation} \\ln \\mathrm{f}( \\mathbf{y}) =\\sum_{i=1}^n \\left\\{ \\frac{y_i\\theta_i-b(\\theta_i)}{\\phi _i}+S( y_i,\\phi _i ) \\right\\} . \\tag{13.4} \\end{equation}\\] Recuerda que para enlaces canónicos, tenemos la igualdad entre el parámetro de la distribución y el componente sistemático, de modo que \\(\\theta_i=\\eta _i=\\mathbf{x}_i^{\\mathbf{\\prime }}\\boldsymbol \\beta\\). Así, con \\(\\phi _i=\\phi /w_i\\), la función de log-verosimilitud es: \\[\\begin{equation} L (\\boldsymbol \\beta, \\phi ) = \\ln \\mathrm{f}( \\mathbf{y}) =\\sum_{i=1}^n \\left\\{ \\frac{y_i\\mathbf{x}_i^{\\mathbf{\\prime }}\\boldsymbol \\beta-b(\\mathbf{x}_i^{\\mathbf{\\prime }} \\boldsymbol \\beta)}{\\phi / w_i}+S( y_i,\\phi / w_i) \\right\\} . \\tag{13.5} \\end{equation}\\] Al tomar la derivada parcial con respecto a \\(\\boldsymbol \\beta\\), obtenemos la función de puntuación: \\[\\begin{equation} \\frac{\\partial }{\\partial \\boldsymbol \\beta} L( \\boldsymbol \\beta, \\phi ) = \\frac{1}{\\phi} \\sum_{i=1}^n \\left( y_i-b^{\\prime }(\\mathbf{x}_i^{\\mathbf{\\prime }}\\boldsymbol \\beta) \\right) w_i \\mathbf{x}_i . \\tag{13.6} \\end{equation}\\] Dado que \\(\\mu _i=b^{\\prime }(\\theta_i)=b^{\\prime }(\\mathbf{x}_i^{\\mathbf{\\prime }}\\boldsymbol \\beta)\\), podemos resolver para los estimadores de máxima verosimilitud de \\(\\boldsymbol \\beta\\), $_{MLE} $, a través de las “ecuaciones normales”: \\[\\begin{equation} \\mathbf{0}=\\sum_{i=1}^n w_i \\left( y_i-\\mu _i\\right) \\mathbf{x}_i. \\tag{13.7} \\end{equation}\\] Estas ecuaciones representan un sistema con \\(k+1\\) ecuaciones y \\(k+1\\) incógnitas. Normalmente, la solución es única y usamos la notación \\(\\mathbf{b}_{MLE}\\) para denotar la solución. Una de las razones del uso generalizado de los métodos GLM es que los estimadores de máxima verosimilitud pueden calcularse rápidamente mediante una técnica conocida como mínimos cuadrados iterados ponderados, descrita en la Sección 13.9.4. Ten en cuenta que, al igual que en las ecuaciones normales de la regresión lineal ordinaria, no necesitamos considerar la estimación del parámetro de escala de la varianza \\(\\phi\\) en esta etapa. Es decir, primero podemos calcular \\(\\mathbf{b}_{MLE}\\) y, cuando sea necesario, estimar \\(\\phi\\). (Para ciertas distribuciones como la binomial y la de Poisson, \\(\\phi\\) es conocido y no requiere estimación). Como se describe en la Sección 11.9, los estimadores de máxima verosimilitud son consistentes y tienen distribuciones normales para muestras grandes bajo condiciones generales. La inferencia de máxima verosimilitud proporciona un mecanismo para calcular esta distribución. A partir de las ecuaciones (13.6) y del suplemento técnico sobre la verosimilitud (Sección 11.9, ecuación 11.14), la matriz de información correspondiente es: \\[\\begin{equation} \\mathbf{I} \\left( \\mathbf{b}_{MLE} \\right) = \\frac{1}{\\phi}\\sum_{i=1}^n w_i ~b^{\\prime \\prime }(\\mathbf{x}_i^{\\mathbf{\\prime }} \\mathbf{b}_{MLE} ) ~ \\mathbf{x}_i \\mathbf{x}_i^{\\mathbf{\\prime }} . \\tag{13.8} \\end{equation}\\] La inversa de la matriz de información es la matriz de varianza-covarianza para muestras grandes de \\(\\mathbf{b}_{MLE}\\). Específicamente, la raíz cuadrada del \\((j+1)\\)-ésimo elemento diagonal de la inversa de esta matriz proporciona el error estándar para \\(b_{j,MLE}\\), el cual denotamos como \\(se(b_{j,MLE})\\). Las extensiones a enlaces generales son similares. La inferencia para \\(\\mathbf{b}_{MLE}\\) es robusta en cuanto a la elección de distribuciones en el siguiente sentido: la solución de los estimadores de máxima verosimilitud en la ecuación (13.7) depende solo de la función de media; se puede demostrar que la consistencia de los estimadores depende únicamente de la correcta elección de esta función. Además, el comportamiento de muestra grande de \\(\\mathbf{b}_{MLE}\\) esencialmente solo requiere que la media y la varianza sean especificadas correctamente, no la elección de la distribución. (Se requieren algunas condiciones adicionales de regularidad, pero estas son requisitos técnicos leves). Por ejemplo, supongamos que un analista elige una distribución de Poisson con un enlace logarítmico. Si el enlace logarítmico es apropiado, solo se necesita la igualdad entre la media y la varianza, ver Tabla 13.1. A diferencia del dominio usual de la distribución de Poisson, las variables dependientes podrían ser no enteras o incluso negativas. La inferencia para \\(\\mathbf{b}_{MLE}\\) en muestras grandes solo requiere que se elijan correctamente las funciones de media y varianza. Ejemplo: Clasificación de Tarifas - Continuación. Utilizando los datos en la Tabla 13.3, se ajustó una función de enlace logarítmico con una distribución gamma utilizando el número de reclamaciones como pesos (\\(w_i\\)). La Tabla 13.4 muestra las estimaciones de la severidad esperada utilizando la ecuación (13.3). Los promedios sugieren que los conductores jóvenes (edades 17-20 y 21-24) tienen las reclamaciones más altas. En cuanto al uso del vehículo, aquellos que conducen por placer tuvieron las reclamaciones más bajas, mientras que aquellos que conducen por negocios tuvieron las reclamaciones más altas. Tabla 13.4. Estimación de la Severidad Esperada para un Plan Tarifario Multiplicativo \\[ \\small{ \\begin{array}{l|rrrr|r} \\hline \\text{Grupo de Edad } &amp; \\text{ConducirCorto }&amp; \\text{ConducirLargo} &amp; \\text{Placer} &amp; \\text{Negocios} &amp; \\text{Promedio} \\\\ \\hline 17-20 &amp; 322.17 &amp; 265.56 &amp; 254.90 &amp; 419.07 &amp; 315.42 \\\\ 21-24 &amp; 320.66 &amp; 264.31 &amp; 253.70 &amp; 417.10 &amp; 313.94 \\\\ 25-29 &amp; 297.26 &amp; 245.02 &amp; 235.19 &amp; 386.66 &amp; 291.03 \\\\ 30-34 &amp; 284.85 &amp; 234.80 &amp; 225.37 &amp; 370.53 &amp; 278.89 \\\\ 35-39 &amp; 229.37 &amp; 189.06 &amp; 181.47 &amp; 298.35 &amp; 224.56 \\\\ 40-49 &amp; 248.15 &amp; 204.54 &amp; 196.33 &amp; 322.78 &amp; 242.95 \\\\ 50-59 &amp; 251.95 &amp; 207.67 &amp; 199.34 &amp; 327.72 &amp; 246.67 \\\\ 60+ &amp; 246.47 &amp; 203.16 &amp; 195.00 &amp; 320.60 &amp; 241.31 \\\\ \\hline Promedio &amp; 275.11 &amp; 226.77 &amp; 217.66 &amp; 357.85 &amp; 269.35 \\\\ \\hline \\end{array} } \\] Código en R para Generar la Tabla 13.4 # AutoDat &lt;- read.csv(&quot;CSVData/AutoCollision.csv&quot;, quote=&quot;&quot;, header=TRUE) AutoDat &lt;- read.table(&quot;CSVData/AutoCollision1.txt&quot;, header=TRUE) # MODELO CON DOS FACTORES model1 &lt;- glm(Severity~factor(Age)+factor(Vehicle_Use), control = glm.control(maxit = 50), weights=Claim_Count, family=Gamma(link=&quot;log&quot;), data = AutoDat) #summary(model1) #model1$coefficients Agecoeff &lt;- model1$coefficients[1:8] Agecoeff[1]&lt;- 0 EAgecoeff &lt;- exp(Agecoeff) #EAgecoeff Vehcoeff &lt;- model1$coefficients[9:11]; Vehcoeff &lt;- c(Vehcoeff,0) EVehcoeff &lt;- exp(Vehcoeff) #EVehcoeff Premiums &lt;- exp(model1$coefficients[1])*EAgecoeff %*%t(EVehcoeff) Premiums1 &lt;- round(Premiums, digits = 2) AgeGroup &lt;- dimnames( table(AutoDat$Age) ) AgeGroup1 &lt;- AgeGroup # AgeGroup1 &lt;- gsub(&quot;\\226&quot;, &quot;-&quot;, AgeGroup1[[1]] , fixed = TRUE) tableout &lt;- cbind(AgeGroup1, Premiums1) colnames(tableout) &lt;- c(&quot;Grupo de Edad&quot;, &quot;ConducirCorto&quot;, &quot;ConducirLargo&quot;, &quot;Placer&quot;, &quot;Negocios&quot;) TableGen1(TableData=tableout, TextTitle=&#39;Estimación de la Severidad Esperada para un Plan Tarifario Multiplicativo&#39;, Align=&#39;c&#39;, ColumnSpec=1:3, Digits = 2, BorderRight = 1, ColWidth = ColWidth4 ) Tabla 13.1: Estimación de la Severidad Esperada para un Plan Tarifario Multiplicativo Grupo de Edad ConducirCorto ConducirLargo Placer Negocios c(“17?20”, “21?24”, “25?29”, “30?34”, “35?39”, “40?49”, “50?59”, “60+”) 322.17 265.56 254.9 419.07 c(“17?20”, “21?24”, “25?29”, “30?34”, “35?39”, “40?49”, “50?59”, “60+”) 320.66 264.31 253.7 417.1 c(“17?20”, “21?24”, “25?29”, “30?34”, “35?39”, “40?49”, “50?59”, “60+”) 297.26 245.02 235.19 386.66 c(“17?20”, “21?24”, “25?29”, “30?34”, “35?39”, “40?49”, “50?59”, “60+”) 284.85 234.8 225.37 370.53 c(“17?20”, “21?24”, “25?29”, “30?34”, “35?39”, “40?49”, “50?59”, “60+”) 229.37 189.06 181.47 298.35 c(“17?20”, “21?24”, “25?29”, “30?34”, “35?39”, “40?49”, “50?59”, “60+”) 248.15 204.54 196.33 322.78 c(“17?20”, “21?24”, “25?29”, “30?34”, “35?39”, “40?49”, “50?59”, “60+”) 251.95 207.67 199.34 327.72 c(“17?20”, “21?24”, “25?29”, “30?34”, “35?39”, “40?49”, “50?59”, “60+”) 246.47 203.16 195 320.6 13.3.2 Sobredispersión Para algunos miembros de la familia exponencial lineal, como las distribuciones Bernoulli y Poisson, la varianza está determinada por la media. En contraste, la distribución normal tiene un parámetro de escala separado. Al ajustar modelos a datos con variables dependientes binarias o de conteo, es común observar que la varianza excede la anticipada por el ajuste de los parámetros de la media. Este fenómeno se conoce como sobredispersión. Existen varios modelos probabilísticos alternativos disponibles para explicar este fenómeno, dependiendo de la aplicación en cuestión. Ver la Sección 12.3 para un ejemplo y McCullagh y Nelder (1989) para un inventario más detallado. Aunque llegar a un modelo probabilístico satisfactorio es el camino más deseable, en muchas situaciones los analistas se conforman con postular un modelo aproximado mediante la relación: \\[ \\mathrm{Var~}y_i=\\sigma ^{2}\\phi ~b^{\\prime \\prime }(\\theta_i)/w_i. \\] El parámetro \\(\\phi\\) se especifica a través de la elección de la distribución, mientras que el parámetro de escala \\(\\sigma ^{2}\\) permite una variabilidad extra. Por ejemplo, la Tabla 13.8 muestra que al especificar ya sea la distribución Bernoulli o Poisson, tenemos \\(\\phi =1\\). Aunque el parámetro de escala \\(\\sigma ^{2}\\) permite una variabilidad adicional, también puede acomodar situaciones en las que la variabilidad es menor de la especificada por la forma de la distribución (aunque esta situación es menos común). Finalmente, cabe destacar que para algunas distribuciones, como la normal, el término adicional ya está incorporado en el parámetro \\(\\phi\\), por lo que no tiene un propósito útil. Cuando se incluye el parámetro de escala adicional \\(\\sigma ^{2}\\), es común estimarlo mediante el estadístico chi-cuadrado de Pearson dividido por los grados de libertad del error. Es decir, \\[ \\widehat{\\sigma }^{2}=\\frac{1}{N-k} \\sum_{i=1}^n w_i\\frac{\\left( y_i-b^{\\prime }(\\mathbf{x}_i^{\\mathbf{\\prime }}\\mathbf{b}_{MLE})\\right) ^{2}}{\\phi b^{\\prime \\prime }(\\mathbf{x}_i^{\\mathbf{\\prime }}\\mathbf{b}_{MLE})}. \\] Al igual que con la distribución Poisson en la Sección 12.3, otra forma de manejar patrones inusuales de varianza es a través de errores estándar robustos o empíricos. La Sección 13.9.3 proporciona más detalles. 13.3.3 Estadísticas de Bondad de Ajuste En los modelos de regresión lineal, la estadística de bondad de ajuste más ampliamente citada es la medida \\(R^2\\), que se basa en la descomposición \\[ \\sum_i \\left(y_i - \\overline{y} \\right)^2 = \\sum_i \\left(y_i - \\widehat{y}_i \\right)^2 + \\sum_i \\left(\\widehat{y}_i - \\overline{y}\\right)^2 + 2 \\times \\sum_i \\left(y_i - \\widehat{y}_i \\right)\\left(\\widehat{y}_i - \\overline{y}\\right). \\] En el lenguaje de la Sección 2.3, esta descomposición es: \\[ \\textit{Total SS = Error SS + Regresión SS + 2} \\times \\textit{Suma de Productos Cruzados}. \\] La dificultad con los modelos no lineales es que el término de Suma de Productos Cruzados rara vez es igual a cero. Por lo tanto, se obtienen estadísticas diferentes al definir \\(R^2\\) como (Regresión SS/Total SS) en comparación con (1-Error SS/Total SS). La Sección 11.3.2 describió algunas medidas alternativas de \\(R^2\\) que a veces se citan en configuraciones GLM. Una medida de bondad de ajuste ampliamente citada es el estadístico chi-cuadrado de Pearson, que fue introducido en la Sección 12.1.4. En el contexto GLM, suponemos que \\(\\mathrm{E~}y_i = \\mu_i\\), \\(\\mathrm{Var~}y_i = \\phi v(\\mu_i)\\) es la función de varianza (como en los ejemplos de la Tabla 13.1) y que \\(\\widehat{\\mu}_i\\) es un estimador de \\(\\mu_i\\). Luego, el estadístico chi-cuadrado de Pearson se define como \\(\\sum_i \\left( y_i - \\widehat{\\mu}_i \\right)^2/\\ ( \\phi v(\\widehat{\\mu}_i))\\). Como hemos visto en los modelos de Poisson para datos de conteo, esta formulación se reduce a la forma \\(\\sum_i \\left( y_i - \\widehat{\\mu}_i \\right)^2/\\widehat{\\mu}_i\\). Los criterios de información generales, incluyendo \\(AIC\\) y \\(BIC\\), que fueron definidos en la Sección 11.9 también se citan regularmente en estudios de GLM. Una medida de bondad de ajuste específica para los modelos GLM es la estadística de devianza. Para definir esta estadística, trabajamos con la noción de un modelo saturado donde hay tantos parámetros como observaciones, \\(\\theta_i, i=1, \\ldots, n\\). Un modelo saturado proporciona el mejor ajuste posible. Con un parámetro para cada observación, maximizamos la verosimilitud en una base de observación por observación. Por lo tanto, al derivar la verosimilitud logarítmica de la ecuación (13.2) se obtiene \\[ \\frac{\\partial}{\\partial \\theta_i} \\ln \\mathrm{f}( y_i; \\theta_i ,\\phi ) = \\frac{y_i-b^{\\prime}(\\theta_i)}{\\phi}. \\] Al igualar esto a cero, se obtiene la estimación del parámetro, digamos \\(\\theta_{i,SAT}\\), como la solución de \\(y_i=b^{\\prime}(\\theta_{i,Sat})\\). Denotando \\(\\boldsymbol \\theta _{SAT}\\) como el vector de parámetros, la verosimilitud \\(L(\\boldsymbol \\theta _{SAT})\\) es el valor máximo posible de la verosimilitud logarítmica. Luego, para un estimador genérico \\(\\widehat{\\boldsymbol \\theta}\\), la estadística de devianza escalada se define como \\[ \\mathbf{\\mathrm{D}}^{\\ast}(\\widehat{\\boldsymbol \\theta}) = 2 \\times \\left( L(\\boldsymbol \\theta _{SAT}) - L(\\widehat{\\boldsymbol \\theta}) \\right). \\] En las familias exponenciales lineales, se multiplica por el factor de escala \\(\\phi\\) para definir la estadística de devianza, \\(\\mathbf{\\mathrm{D}}(\\widehat{\\boldsymbol \\theta}) = \\phi \\mathbf{\\mathrm{D}}^{\\ast}(\\widehat{\\boldsymbol \\theta})\\). Esta multiplicación realmente elimina el factor de escala de la varianza de la definición de la estadística. Es fácil verificar que la estadística de devianza se reduce a las siguientes formas para tres casos especiales: Normal: \\(\\mathbf{\\mathrm{D}}(\\widehat{\\boldsymbol \\mu})= \\sum_i \\left( y_i - \\widehat \\mu _i \\right) ^2\\), Bernoulli: \\(\\mathbf{\\mathrm{D}}(\\widehat{\\boldsymbol \\pi})= \\sum_i \\left\\{ y_i \\ln \\frac {y_i}{\\widehat \\pi_i} + (1-y_i) \\ln \\frac {1-y_i}{1-\\widehat \\pi_i} \\right\\}\\), y Poisson: \\(\\mathbf{\\mathrm{D}}(\\widehat{\\boldsymbol \\mu})= \\sum_i \\left\\{ y_i \\ln \\frac {y_i}{\\widehat \\mu_i} + (y_i - \\widehat \\mu _i) \\right\\}\\). Aquí usamos la convención de que \\(y \\ln y = 0\\) cuando \\(y = 0\\). 13.4 Aplicación: Gastos Médicos Ahora volvemos a los datos de la Encuesta del Panel de Gastos Médicos (MEPS) introducidos en la Sección 11.4. En esa sección, buscamos desarrollar un modelo para entender el evento de una admisión hospitalaria como paciente interno. En esta sección, ahora deseamos modelar la cantidad del gasto. En terminología actuarial, la Sección 11.4 consideraba la “frecuencia”, mientras que esta sección involucra la “severidad”. De las 2,000 observaciones seleccionadas aleatoriamente del año 2003 consideradas en la Sección 11.4, solo \\(n=157\\) fueron admitidos al hospital durante el año. La Tabla 13.5 resume los datos utilizando las mismas variables explicativas que en la Tabla 11.4. Por ejemplo, la Tabla 13.5 muestra que la muestra es 72% femenina, casi 76% blanca y más del 91% tiene seguro. La tabla también muestra relativamente pocos gastos por parte de asiáticos, nativos americanos y personas sin seguro en nuestra muestra. La Tabla 13.5 también proporciona los gastos medianos por variable categórica. Esta tabla sugiere que el género, una mala autoevaluación de la salud física y los ingresos bajos o negativos pueden ser determinantes importantes de la cantidad de los gastos médicos. Tabla 13.5. Gastos Medianos por Variable Explicativa Basado en una Muestra de \\(n=157\\) con Gastos Positivos \\[ \\scriptsize{ \\begin{array}{lllrr} \\hline \\text{Categoría} &amp; \\text{Variable} &amp; \\text{Descripción} &amp; \\text{Porcentaje} &amp; \\text{Mediana de } \\\\ &amp; &amp; &amp; \\text{de datos} &amp; \\text{Gastos}\\\\ \\hline &amp; COUNTIP&amp; \\text{Número de gastos (mediana: 1.0)} \\\\ \\text{Demografía} &amp; EDAD &amp; \\text{Edad en años entre}\\\\ &amp; &amp; \\ \\ \\ \\text{ 18 a 65 (mediana: 41.0) }\\\\ &amp; GENERO &amp;\\text{1 si es mujer} &amp; 72.0 &amp; 5,546 \\\\ &amp; &amp; \\text{0 si es hombre} &amp; 28.0 &amp; 7,313 \\\\ \\text{Etnicidad} &amp; ASIATICO &amp; \\text{1 si es asiático} &amp; 2.6 &amp; 4,003 \\\\ &amp; NEGRO &amp; \\text{1 si es negro} &amp; 19.8 &amp; 6,100\\\\ &amp; NATIVO &amp; \\text{1 si es nativo} &amp; 1.9 &amp; 2,310\\\\ &amp; BLANCO &amp; \\textit{Nivel de referencia} &amp; 75.6 &amp; 5,695\\\\ \\text{Región} &amp; NORDESTE &amp; \\text{1 si es del noreste} &amp; 18.5 &amp; 5,833 \\\\ &amp; MEDIOESTE &amp; \\text{1 si es del medio oeste} &amp; 21.7 &amp; 7,999 \\\\ &amp; SUR &amp; \\text{1 si es del sur} &amp; 40.8 &amp; 5,595 \\\\ &amp; OESTE &amp; \\textit{Nivel de referencia} &amp; 19.1 &amp; 4,297\\\\ \\hline \\text{Educación} &amp; UNIVERSIDAD &amp; \\text{1 si tiene título universitario o superior} &amp; 23.6 &amp; 5,611\\\\ &amp; \\text{SECUNDARIA} &amp; \\text{1 si tiene título de secundaria} &amp; 43.3 &amp; 5,907 \\\\ &amp;&amp; \\text{Nivel de referencia es menor} &amp; 33.1 &amp; 5,338 \\\\ &amp;&amp; \\ \\ \\ \\text{ que título de secundaria} &amp; \\\\ \\hline \\text{Autoevaluación} &amp; MALA &amp; \\text{1 si es mala} &amp; 17.2 &amp; 10,447\\\\ \\ \\ \\text{salud física} &amp; REGULAR &amp; \\text{1 si es regular} &amp; 10.2 &amp; 5,228 \\\\ \\ \\ \\text{ } &amp; BUENA &amp; \\text{1 si es buena }&amp; 31.2 &amp; 5,032\\\\ &amp; VMUYBUENA &amp; \\text{1 si es muy buena} &amp; 24.8 &amp; 5,546 \\\\ &amp;&amp; \\text{Nivel de referencia es excelente salud} &amp;16.6 &amp; 5,277 \\\\ \\text{Autoevaluación} &amp; MMALA &amp; \\text{1 si es mala o regular} &amp; 15.9 &amp; 6,583 \\\\ \\ \\ \\text{salud mental} &amp; &amp; \\text{0 si buena a excelente salud mental} &amp; 84.1 &amp; 5,599 \\\\ \\text{Alguna limitación} &amp; ALGLIMITE &amp; \\text{1 si tiene alguna limitación funcional/de actividad}&amp; 41.4 &amp; 7,826 \\\\ \\ \\ \\text{de actividad} &amp; &amp; \\text{0 si no tiene limitación}&amp; 58.6 &amp; 4,746 \\\\ \\hline \\text{Ingresos} &amp;&amp; \\text{Nivel de referencia son ingresos altos} &amp; 21.7 &amp; 7,271 \\\\ \\text{comparado con} &amp; MINGRESO &amp; \\text{1 si es ingreso medio} &amp; 26.8 &amp; 5,851 \\\\ \\text{la línea de pobreza} &amp; LINGRESO &amp; \\text{1 si es ingreso bajo} &amp; 16.6 &amp; 6,909 \\\\ &amp; NPPOBRE &amp; \\text{1 si es casi pobre} &amp; 7.0 &amp; 5,546 \\\\ &amp; POBRONEG &amp; \\text{si es pobre/ingreso negativo} &amp; 28.0 &amp; 4,097 \\\\ \\hline \\text{Seguro} &amp; SEGURO &amp; \\text{1 si está cubierto por seguro público/privado} &amp;91.1 &amp; 5,943 \\\\ \\ \\ \\text{médico} &amp; &amp; \\ \\ \\text{seguro en cualquier mes de 2003} &amp; &amp; \\\\ &amp; &amp; \\text{0 si no tiene seguro médico en 2003} &amp; 8.9 &amp; 2,668 \\\\ \\hline Total &amp; &amp; &amp; 100.0 &amp; 5,695 \\\\ \\hline \\end{array} } \\] knitr::kable(2, caption = &quot;Silly. Create a table just to update the counter...&quot;) Tabla 13.2: Silly. Create a table just to update the counter… x 2 knitr::kable(2, caption = &quot;Silly.&quot;) Tabla 13.3: Silly. x 2 knitr::kable(2, caption = &quot;Silly. &quot;) Tabla 13.4: Silly. x 2 Código R para generar la Tabla 13.5 Como se señaló en el prefacio, la mayor parte del código para el libro, escrito alrededor de 2008, estaba en SAS. El código ilustrativo proporcionado aquí, en R, presenta algunas ligeras discrepancias con el original. Hexpend &lt;- read.csv(&quot;CSVData/HealthExpend.csv&quot;, header=TRUE) # Tabla 13.5 #Hexpend$POSEXP &lt;- 1*(Hexpend$EXPENDIP&gt;0) HexpendPos &lt;- subset(Hexpend, EXPENDIP &gt; 0) # CREAR UNA FUNCIÓN CORTA PARA AHORRAR TRABAJO fun2 &lt;- function(group_var, summary_vars){ # Convertir group_var y summary_vars a caracteres si no lo son group_var &lt;- as.character(substitute(group_var)) summary_vars &lt;- as.character(substitute(summary_vars)) temp &lt;- doBy::summaryBy( formula = as.formula(paste(summary_vars, &quot;~&quot;, group_var)), data = HexpendPos, FUN = function(x) { c(m = median(x), num = length(x)) } ) temp1 &lt;- temp[,c(1,3,2)] temp1[,2] &lt;- round(100*temp1[,2]/length(HexpendPos$EXPENDIP), digits=1) colnames(temp1) &lt;- NULL temp1[,1] &lt;- as.character(temp1[,1]) return(as.matrix(temp1) ) } var1 &lt;- fun2(GENDER,EXPENDIP) var2 &lt;- fun2(RACE,EXPENDIP) var3 &lt;- fun2(REGION,EXPENDIP) var4 &lt;- fun2(EDUC,EXPENDIP) var5 &lt;- fun2(PHSTAT,EXPENDIP) #var6 &lt;- fun2(MPOOR,EXPENDIP) var7 &lt;- fun2(ANYLIMIT,EXPENDIP) var8 &lt;- fun2(INCOME,EXPENDIP) var9 &lt;- fun2(insure,EXPENDIP) tableout &lt;- rbind(var1, var2, var3, var4, var5, var7, var8, var9) TableGen1(TableData=tableout, TextTitle=&#39;Gastos Medianos por Variable Explicativa Basado en una Muestra de $n=157$ con Gastos Positivos&#39;, Align=&#39;crr&#39;, ColumnSpec=1:3, ColWidth = ColWidth4 ) Tabla 13.5: Gastos Medianos por Variable Explicativa Basado en una Muestra de \\(n=157\\) con Gastos Positivos 1 0 28 7312.695 2 1 72 5546.470 1 ASIAN 2.5 4002.735 2 BLACK 19.7 6100.200 3 NATIV 1.9 2310.320 4 OTHER 1.9 4050.650 5 WHITE 73.9 5725.325 1 MIDWEST 21.7 7998.660 2 NORTHEAST 18.5 5832.860 3 SOUTH 40.8 5595.295 4 WEST 19.1 4296.540 1 COLLEGE 23.6 5610.76 2 HIGHSCH 43.3 5907.33 3 LHIGHSC 33.1 5338.04 1 EXCE 16.6 5277.160 2 FAIR 10.2 5228.465 3 GOOD 31.2 5031.960 4 POOR 17.2 10447.130 5 VGOO 24.8 5546.470 1 0 58.6 4745.89 2 1 41.4 7825.50 1 HINCOME 21.7 7270.780 2 LINCOME 16.6 6908.720 3 MINCOME 26.8 5851.160 4 NPOOR 7.0 5546.470 5 POOR 28.0 4096.545 1 0 8.9 2668.37 2 1 91.1 5943.25 Tabla 13.5 utiliza medianas en lugar de medias debido a que la distribución de los gastos está sesgada hacia la derecha. Esto es evidente en la Figura 13.1, que proporciona un histograma suave (conocido como “estimación de densidad por kernel”, ver Sección 15.2) para los gastos hospitalarios. Para distribuciones sesgadas, la mediana a menudo brinda una mejor idea del centro de la distribución que la media. La distribución está aún más sesgada de lo que sugiere esta figura, ya que el gasto más grande (que es $607,800) se omite en la representación gráfica. Figura 13.1: Histograma Empírico Suave de Gastos Hospitalarios Positivos. Se omite el gasto más grande. Código R para generar la Figura 13.1 # ELIMINAR TEMPORALMENTE EL OBS # 58 Hexpend &lt;- read.csv(&quot;CSVData/HealthExpend.csv&quot;, header=TRUE) Hexpend58 &lt;- subset(Hexpend, !(EXPENDIP&gt;600000)) plot(density(Hexpend58$EXPENDIP), main=&quot;&quot;, xlab=&quot;Gastos&quot;) #hist(Hexpend58$EXPENDIP, main=&quot;&quot;, xlab=&quot;Gastos&quot;) Un modelo de regresión gamma con un enlace logarítmico se ajustó a los gastos hospitalarios utilizando todas las variables explicativas. Los resultados de este ajuste de modelo aparecen en la Tabla 13.6. Aquí vemos que muchos de los posibles determinantes importantes de los gastos médicos no son estadísticamente significativos. Esto es común en el análisis de gastos, donde las variables ayudan a predecir la frecuencia, aunque no son tan útiles para explicar la severidad. Debido a la colinealidad, hemos visto en modelos lineales que tener demasiadas variables en un modelo ajustado puede llevar a la insignificancia estadística de variables importantes e incluso causar que los signos se inviertan. Para un modelo más simple, eliminamos las variables de Asian, Native American y uninsured, ya que representan un pequeño subconjunto de nuestra muestra. También utilizamos solo la variable POOR para el estado de salud autoinformado y solo POORNEG para los ingresos, esencialmente reduciendo estas variables categóricas a variables binarias. La Tabla 13.6, bajo el encabezado “Modelo Reducido”, muestra los resultados de este ajuste del modelo. Este modelo tiene casi el mismo estadístico de bondad de ajuste, AIC, lo que sugiere que es una alternativa razonable. Bajo el ajuste del modelo reducido, las variables COUNTIP (conteo de pacientes hospitalizados), AGE, COLLEGE y POORNEG son variables estadísticamente significativas. Para estas variables significativas, los signos son intuitivamente razonables. Por ejemplo, el coeficiente positivo asociado con COUNTIP significa que a medida que aumenta el número de visitas hospitalarias, los gastos totales aumentan, como era de esperar. Para otra especificación alternativa del modelo, la Tabla 13.6 también muestra un ajuste de un modelo inverso gaussiano con un enlace logarítmico. A partir del estadístico AIC, vemos que este modelo no se ajusta tan bien como el modelo de regresión gamma. Todas las variables son estadísticamente insignificantes, lo que dificulta la interpretación de este modelo. Tabla 13.6. Comparación de Modelos de Regresión Gamma e Inversa Gaussiana \\[ \\small{ \\begin{array}{l|rr|rr|rr} \\hline &amp; \\text{Gamma} &amp; &amp;\\text{Gamma}&amp;&amp;\\text{Inversa}&amp;\\text{Gaussiana} \\\\ \\hline &amp; \\text{Modelo} &amp;\\text{Modelo}&amp; \\text{Modelo} &amp; \\text{Modelo}&amp;\\text{Modelo}&amp;\\text{Modelo} \\\\ &amp; \\text{Completo} &amp;\\text{Reducido}&amp; \\text{Completo} &amp; \\text{Reducido}&amp;\\text{Reducido}&amp;\\text{Reducido} \\\\ \\hline &amp; \\scriptsize{Parámetro} &amp; &amp; \\scriptsize{Parámetro} &amp; &amp; \\scriptsize{Parámetro} &amp; \\\\ \\text{Efecto} &amp; \\scriptsize{Estimación} &amp; t\\text{-valor} &amp; \\scriptsize{Estimación} &amp; t\\text{-valor} &amp; \\scriptsize{Estimación} &amp; t\\text{-valor} \\\\ \\hline Intercepto &amp; 6.891 &amp; 13.080 &amp; 7.859 &amp; 17.951 &amp; 6.544 &amp; 3.024 \\\\ COUNTIP &amp; 0.681 &amp; 6.155 &amp; 0.672 &amp; 5.965 &amp; 1.263 &amp; 0.989 \\\\ AGE &amp; 0.021 &amp; 3.024 &amp; 0.015 &amp; 2.439 &amp; 0.018 &amp; 0.727 \\\\ GENDER &amp; -0.228 &amp; -1.263 &amp; -0.118 &amp; -0.648 &amp; 0.363 &amp; 0.482 \\\\ ASIAN &amp; -0.506 &amp; -1.029 &amp; &amp; &amp; &amp; \\\\ BLACK &amp; -0.331 &amp; -1.656 &amp; -0.258 &amp; -1.287 &amp; -0.321 &amp; -0.577 \\\\ NATIVE &amp; -1.220 &amp; -2.217 &amp; &amp; &amp; &amp; \\\\ NORTHEAST &amp; -0.372 &amp; -1.548 &amp; -0.214 &amp; -0.890 &amp; 0.109 &amp; 0.165 \\\\ MIDWEST &amp; 0.255 &amp; 1.062 &amp; 0.448 &amp; 1.888 &amp; 0.399 &amp; 0.654 \\\\ SOUTH &amp; 0.010 &amp; 0.047 &amp; 0.108 &amp; 0.516 &amp; 0.164 &amp; 0.319 \\\\ \\hline COLLEGE &amp; -0.413 &amp; -1.723 &amp; -0.469 &amp; -2.108 &amp; -0.367 &amp; -0.606 \\\\ HIGHSCHOOL &amp; -0.155 &amp; -0.827 &amp; -0.210 &amp; -1.138 &amp; -0.039 &amp; -0.078 \\\\ \\hline POOR &amp; -0.003 &amp; -0.010 &amp; 0.167 &amp; 0.706 &amp; 0.167 &amp; 0.258 \\\\ FAIR &amp; -0.194 &amp; -0.641 &amp; &amp; &amp; &amp; \\\\ GOOD &amp; 0.041 &amp; 0.183 &amp; &amp; &amp; &amp; \\\\ VGOOD &amp; 0.000 &amp; 0.000 &amp; &amp; &amp; &amp; \\\\ MNHPOOR &amp; -0.396 &amp; -1.634 &amp; -0.314 &amp; -1.337 &amp; -0.378 &amp; -0.642 \\\\ ANYLIMIT &amp; 0.010 &amp; 0.053 &amp; 0.052 &amp; 0.266 &amp; 0.218 &amp; 0.287 \\\\ \\hline MINCOME &amp; 0.114 &amp; 0.522 &amp; &amp; &amp; &amp; \\\\ LINCOME &amp; 0.536 &amp; 2.148 &amp; &amp; &amp; &amp; \\\\ NPOOR &amp; 0.453 &amp; 1.243 &amp; &amp; &amp; &amp; \\\\ POORNEG &amp; -0.078 &amp; -0.308 &amp; -0.406 &amp; -2.129 &amp; -0.356 &amp; -0.595 \\\\ INSURE &amp; 0.794 &amp; 3.068 &amp; &amp; &amp; &amp; \\\\ \\hline Escala &amp; 1.409 &amp; 9.779 &amp; 1.280 &amp; 9.854 &amp; 0.026 &amp; 17.720 \\\\ \\hline \\scriptsize{Log-Verosimilitud} &amp; -1,558.67 &amp;&amp; -1,567.93 &amp;&amp; -1,669.02 \\\\ AIC &amp; 3,163.34 &amp;&amp; 3,163.86 &amp;&amp; 3,366.04 \\\\ \\hline \\end{array} } \\] Código R para generar la Tabla 13.6 Como se señaló en el prefacio, la mayor parte del código para el libro, escrito alrededor de 2008, estaba en SAS. El código ilustrativo proporcionado aquí, en R, presenta algunas ligeras discrepancias con el original. Hexpend &lt;- read.csv(&quot;CSVData/HealthExpend.csv&quot;, header=TRUE) # Tabla 13.6 #POSEXP = 1*(Hexpend$EXPENDIP&gt;0) HexpendPos &lt;- subset(Hexpend, EXPENDIP &gt; 0) # MODELO CON TODAS LAS VARIABLES # SE TUVO QUE AUMENTAR EL NÚMERO POR DEFECTO DE ITERACIONES PARA LA CONVERGENCIA model1 = glm(EXPENDIP~COUNTIP+AGE+GENDER +factor(RACE)+factor(REGION)+factor(EDUC)+factor(PHSTAT) +MNHPOOR+ANYLIMIT+factor(INCOME)+insure, control = glm.control(maxit = 50), data=HexpendPos,family=Gamma(link=&quot;log&quot;)) output1 &lt;- summary(model1 ) tidy_model &lt;- broom::tidy(model1) kable(tidy_model, format = &quot;html&quot;, digits = 3, table.attr = &quot;class=&#39;table table-striped&#39;&quot;, caption = &quot;Resumen del Modelo de Regresión Gamma&quot;) Tabla 13.6: Resumen del Modelo de Regresión Gamma term estimate std.error statistic p.value (Intercept) 6.211 0.664 9.352 0.000 COUNTIP 0.682 0.094 7.287 0.000 AGE 0.021 0.007 2.989 0.003 GENDER -0.238 0.172 -1.382 0.169 factor(RACE)BLACK 0.182 0.512 0.356 0.722 factor(RACE)NATIV -0.697 0.732 -0.953 0.343 factor(RACE)OTHER 0.726 0.707 1.027 0.306 factor(RACE)WHITE 0.513 0.481 1.066 0.289 factor(REGION)NORTHEAST -0.628 0.238 -2.642 0.009 factor(REGION)SOUTH -0.256 0.199 -1.288 0.200 factor(REGION)WEST -0.261 0.233 -1.118 0.266 factor(EDUC)HIGHSCH 0.261 0.193 1.356 0.177 factor(EDUC)LHIGHSC 0.411 0.225 1.828 0.070 factor(PHSTAT)FAIR -0.165 0.314 -0.524 0.601 factor(PHSTAT)GOOD 0.063 0.227 0.276 0.783 factor(PHSTAT)POOR 0.026 0.298 0.088 0.930 factor(PHSTAT)VGOO 0.018 0.237 0.076 0.939 MNHPOOR -0.397 0.238 -1.664 0.098 ANYLIMIT -0.006 0.189 -0.031 0.976 factor(INCOME)LINCOME 0.551 0.257 2.147 0.034 factor(INCOME)MINCOME 0.123 0.211 0.583 0.561 factor(INCOME)NPOOR 0.463 0.354 1.308 0.193 factor(INCOME)POOR -0.068 0.251 -0.273 0.785 insure 0.789 0.257 3.068 0.003 # MODELO REDUCIDO HexpendPos$BLACK = (HexpendPos$RACE == &quot;BLACK&quot;) HexpendPos$POOR = (HexpendPos$PHSTAT == &quot;POOR&quot;) HexpendPos$POORNEG = (HexpendPos$INCOME == &quot;POOR&quot;) model2 &lt;- glm(EXPENDIP ~ COUNTIP + AGE + GENDER + factor(BLACK) + factor(REGION) + factor(EDUC) + factor(POOR) + MNHPOOR + ANYLIMIT + factor(POORNEG), data=HexpendPos, family=Gamma(link=&quot;log&quot;) ) #summary(model2) anova(model1, model2) Analysis of Deviance Table Model 1: EXPENDIP ~ COUNTIP + AGE + GENDER + factor(RACE) + factor(REGION) + factor(EDUC) + factor(PHSTAT) + MNHPOOR + ANYLIMIT + factor(INCOME) + insure Model 2: EXPENDIP ~ COUNTIP + AGE + GENDER + factor(BLACK) + factor(REGION) + factor(EDUC) + factor(POOR) + MNHPOOR + ANYLIMIT + factor(POORNEG) Resid. Df Resid. Dev Df Deviance 1 133 123.954 2 143 137.876 -10 -13.9218 Hexpend58 &lt;- subset(HexpendPos, !(EXPENDIP&gt;600000)) # MODELO REDUCIDO - INVERSA GAUSSIANA # ¡NO QUIERE CONVERGER! # model3 &lt;- glm(EXPENDIP ~ COUNTIP + AGE + GENDER + # factor(BLACK) + factor(REGION) + factor(EDUC) + factor(POOR) + # MNHPOOR + ANYLIMIT + factor(POORNEG), # data=Hexpend58, family=inverse.gaussian(link = &quot;log&quot;) ) # summary(model3) # TAMBIÉN PROBLEMAS CON family=inverse.gaussian(link = &quot;1/mu^2&quot;) 13.5 Residuales Una forma de seleccionar un modelo adecuado es ajustar una especificación tentativa y analizar formas de mejorarlo. Este método diagnóstico se basa en los residuales. En el modelo lineal, definimos los residuales como la respuesta menos los valores ajustados correspondientes. En un contexto de GLM, nos referimos a estos como “residuales crudos”, denotados como \\(y_i - \\widehat{\\mu}_i\\). Como hemos visto, los residuales son útiles para: descubrir nuevas covariables o los efectos de patrones no lineales en covariables existentes, identificar observaciones con mal ajuste, cuantificar los efectos de las observaciones individuales en los parámetros del modelo, y revelar otros patrones del modelo, como heterocedasticidad o tendencias temporales. Como se enfatiza en esta sección, los residuales también son los componentes básicos de muchas estadísticas de bondad de ajuste. Como vimos en la Sección 11.1 sobre variables dependientes binarias, el análisis de los residuales crudos puede ser irrelevante en algunos contextos no lineales. Cox y Snell (1968, 1971) introdujeron una noción general de residuales que es más útil en modelos no lineales que los simples residuales crudos. Para nuestras aplicaciones, asumimos que \\(y_i\\) tiene una función de distribución F(\\(\\cdot\\)) que está indexada por las variables explicativas \\(\\mathbf{x}_i\\) y un vector de parámetros \\(\\boldsymbol \\theta\\) denotado como F(\\(\\mathbf{x}_i,\\boldsymbol \\theta\\)). Aquí, la función de distribución es común a todas las observaciones, pero la distribución varía a través de las variables explicativas. El vector de parámetros \\(\\boldsymbol \\theta\\) incluye los parámetros de regresión \\(\\boldsymbol \\beta\\) así como los parámetros de escala. Con conocimiento de F(\\(\\cdot\\)), ahora asumimos que se puede calcular una nueva función R(\\(\\cdot\\)) tal que \\(\\varepsilon_i = \\mathrm{R}(y_i; \\mathbf{x}_i,\\boldsymbol \\theta)\\), donde \\(\\varepsilon_i\\) son distribuidos idénticamente e independientemente. Aquí, la función R(\\(\\cdot\\)) depende de las variables explicativas \\(\\mathbf{x}_i\\) y los parámetros \\(\\boldsymbol \\theta\\). Los residuales de Cox-Snell son entonces \\(e_i = \\mathrm{R}(y_i; \\mathbf{x}_i,\\widehat{\\boldsymbol \\theta})\\). Si el modelo está bien especificado y las estimaciones de los parámetros \\(\\widehat{\\boldsymbol \\theta}\\) están cerca de los parámetros del modelo \\(\\boldsymbol \\theta\\), entonces los residuales \\(e_i\\) deberían estar cerca de ser i.i.d. Para ilustrar, en el modelo lineal utilizamos la función de residuales \\(\\mathrm{R}(y_i; \\mathbf{x}_i,\\boldsymbol \\theta) = y_i - \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta = y_i - \\mu_i = \\varepsilon_i\\), resultando en residuales crudos (ordinarios). Otra opción es reescalar mediante la desviación estándar \\[ \\mathrm{R}(y_i; \\mathbf{x}_i,\\boldsymbol \\theta) = \\frac{y_i - \\mu_i}{\\sqrt{\\mathrm{Var~} y_i}} , \\] que produce residuales de Pearson. Otro tipo de residual se basa en transformar primero la respuesta con una función conocida h(\\(\\cdot\\)), \\[ \\mathrm{R}(y_i; \\mathbf{x}_i,\\boldsymbol \\theta) = \\frac{\\mathrm{h}(y_i) - \\mathrm{E~} \\mathrm{h}(y_i)}{\\sqrt{\\mathrm{Var~}\\mathrm{h}(y_i)}}. \\] Elegir la función de modo que h(\\(y_i\\)) sea aproximadamente distribuida normalmente produce residuales de Anscombe. Otra elección popular es seleccionar la transformación de modo que la varianza sea estabilizada. Tabla 13.7 presenta transformaciones para las distribuciones binomial, Poisson y gamma. Tabla 13.7. Transformaciones Aproximadas a la Normalidad y de Estabilización de Varianza \\[ \\small{ \\begin{array}{lcc} \\hline \\text{Distribución} &amp; \\text{Transformación Aproximada a la Normalidad} &amp; \\text{Transformación de Estabilización de Varianza} \\\\ &amp; \\text{Transformación} &amp; \\text{Transformación} \\\\ \\hline \\text{Binomial}(m,p) &amp; \\frac{\\mathrm{h}_B(y/m)-[\\mathrm{h}_B(p)+(p(1-p))^{-1/3}(2p-1)/(6m)]}{(p(1-p)^{1/6}/\\sqrt{m})} &amp; \\frac{\\sin^{-1}(\\sqrt{y/m})-\\sin^{-1}(\\sqrt{p})}{a/(2\\sqrt{m})} \\\\ \\text{Poisson}(\\lambda) &amp; 1.5 \\lambda^{-1/6} \\left[ y^{2/3}-(\\lambda^{2/3}-\\lambda^{-1/3}/9) \\right] &amp; 2(\\sqrt{y}-\\sqrt{\\lambda})\\\\ \\text{Gamma}(\\alpha, \\gamma) &amp; 3 \\alpha^{1/6} \\left[ (y/\\gamma)^{1/3}-(\\alpha^{1/3}-\\alpha^{-2/3}/9) \\right] &amp; \\text{No considerado}\\\\ \\hline \\\\ \\end{array} } \\] Nota: \\(\\mathrm{h}_B(u) = \\int_0^u s^{-1/3} (1-s)^{-1/3}ds\\) es la función beta incompleta evaluada en \\((2/3, 2/3)\\), hasta una constante escalar. Fuente: Pierce y Schafer (1986). Otra opción ampliamente utilizada en estudios de GLM son los residuales de devianza, definidos como \\[ \\mathrm{sign} \\left(y_i - \\widehat{\\mu}_i \\right) \\sqrt{2 \\left( \\ln \\mathrm{f}(y_i;\\theta_{i,SAT}) - \\ln \\mathrm{f}(y_i;\\widehat{\\theta}_{i}) \\right)}. \\] La Sección 13.3.3 introdujo las estimaciones de los parámetros del modelo saturado, \\(\\theta_{i,SAT}\\). Como mencionan Pierce y Schafer (1986), los residuales de devianza son muy cercanos a los residuales de Anscombe en muchos casos; podemos verificar los residuales de devianza para la normalidad aproximada. Además, los residuales de devianza pueden definirse fácilmente para cualquier modelo GLM y son fáciles de calcular. 13.6 Distribución de Tweedie Hemos visto que la familia exponencial natural incluye distribuciones continuas, como la normal y gamma, así como distribuciones discretas, como la binomial y Poisson. También incluye distribuciones que son mezclas de componentes discretos y continuos. En la modelización de reclamaciones de seguros, la mezcla más utilizada es la distribución de Tweedie (1984). Esta tiene una masa positiva en cero, representando la ausencia de reclamaciones, y un componente continuo para valores positivos que representan el monto de una reclamación. La distribución de Tweedie se define como una suma de Poisson de variables aleatorias gamma, conocida como una pérdida agregada en ciencias actuariales. Específicamente, supongamos que \\(N\\) tiene una distribución de Poisson con media \\(\\lambda\\), representando el número de reclamaciones. Sea {\\(y_j\\)} una secuencia i.i.d., independiente de \\(N\\), con cada \\(y_j\\) siguiendo una distribución gamma con parámetros \\(\\alpha\\) y \\(\\gamma\\), representando el monto de una reclamación. Entonces, \\(S_N = y_1 + \\ldots + y_N\\) es una suma de Poisson de gammas. La Sección 16.5 discutirá con más detalle los modelos de pérdidas agregadas. Esta sección se enfoca en el caso especial importante de la distribución de Tweedie. Para entender el aspecto de mezcla de la distribución de Tweedie, primero observa que es sencillo calcular la probabilidad de tener cero reclamaciones como \\[ \\Pr ( S_N=0) = \\Pr (N=0) = e^{-\\lambda}. \\] La función de distribución puede calcularse usando expectativas condicionales, \\[ \\Pr ( S_N \\le y) = e^{-\\lambda}+\\sum_{n=1}^{\\infty} \\Pr(N=n) \\Pr(S_n \\le y), ~~~~~y \\geq 0. \\] Dado que la suma de gammas i.i.d. es una gamma, \\(S_n\\) (no \\(S_N\\)) tiene una distribución gamma con parámetros \\(n\\alpha\\) y \\(\\gamma\\). Así, para \\(y&gt;0\\), la densidad de la distribución de Tweedie es \\[\\begin{equation} \\mathrm{f}_{S}(y) = \\sum_{n=1}^{\\infty} e^{-\\lambda} \\frac{\\lambda ^n}{n!} \\frac{\\gamma^{n \\alpha}}{\\Gamma(n \\alpha)} y^{n \\alpha -1} e^{-y \\gamma}. \\tag{13.9} \\end{equation}\\] A primera vista, esta densidad no parece pertenecer a la familia exponencial lineal dada en la ecuación (13.2). Para ver la relación, primero calculamos los momentos usando expectativas iteradas como \\[\\begin{equation} \\mathrm{E~}S_N = \\lambda \\frac{\\alpha}{\\gamma}~~~~~~\\mathrm{y}~~~~~ \\mathrm{Var~}S_N = \\frac{\\lambda \\alpha}{\\gamma^2} (1+\\alpha). \\tag{13.10} \\end{equation}\\] Ahora, definimos tres parámetros \\(\\mu, \\phi, p\\) mediante las relaciones \\[ \\lambda = \\frac{\\mu^{2-p}}{\\phi (2-p)},~~~~~~\\alpha = \\frac{2-p}{p-1}~~~~~~\\mathrm{y}~~~~~ \\frac{1}{\\gamma} = \\phi(p-1)\\mu^{p-1}. \\] Al insertar estos nuevos parámetros en la ecuación (13.9) obtenemos \\[\\begin{equation} \\mathrm{f}_{S}(y) = \\exp \\left[ \\frac{-1}{\\phi} \\left( \\frac{\\mu^{2-p}}{2-p} + \\frac{y}{(p-1)\\mu^{p-1}} \\right) + S(y,\\phi) \\right]. \\tag{13.11} \\end{equation}\\] Dejamos el cálculo de \\(S(y,\\phi)\\) como un ejercicio. Así, la distribución de Tweedie pertenece a la familia exponencial lineal. Cálculos sencillos muestran que \\[\\begin{equation} \\mathrm{E~}S_N = \\mu~~~~~~\\mathrm{y}~~~~~ \\mathrm{Var~}S_N = \\phi \\mu^p, \\tag{13.12} \\end{equation}\\] donde \\(1&lt;p&lt;2.\\) Al examinar nuestra función de varianza Tabla 13.1, la distribución de Tweedie también puede verse como una elección que es intermedia entre las distribuciones Poisson y gamma. 13.7 Lecturas adicionales y referencias Un tratamiento más extenso de los GLM puede encontrarse en el trabajo clásico de McCullagh y Nelder (1989) o la introducción más sencilla de Dobson (2002). de Jong y Heller (2008) proporcionan una reciente introducción a los GLM con un énfasis especial en seguros. Los GLM han recibido una considerable atención de parte de los actuarios de seguros de propiedad y accidentes (generales) en los últimos tiempos. Véase Anderson et al. (2004) y Clark y Thayer (2004) para introducciones. Mildenhall (1999) proporciona un análisis sistemático de la conexión entre los modelos GLM y los algoritmos para evaluar diferentes planes de tarificación. Fu y Wu (2008) proporcionan una versión actualizada, introduciendo una clase más amplia de algoritmos iterativos que se conectan bien con los modelos GLM. Para más información sobre la distribución de Tweedie, consulte J{}rgensen y de Souza (1994) y Smyth y J{}rgensen (2002). Referencias del capítulo Anderson, Duncan, Sholom Feldblum, Claudine Modlin, Doris Schirmacher, Ernesto Schirmacher and Neeza Thandi (2004). A practitioner’s guide to generalized linear models. Casualty Actuarial Society 2004 Discussion Papers 1-116, Casualty Actuarial Society. Baxter, L. A., S. M. Coutts and G. A. F. Ross (1980). Applications of linear models in motor insurance. Proceedings of the 21st International Congress of Actuaries. Zurich. pp. 11-29. Clark, David R. and Charles A. Thayer (2004). A primer on the exponential family of distributions. Casualty Actuarial Society 2004 Discussion Papers 117-148, Casualty Actuarial Society. Cox, David R. and E. J. Snell (1968). A general definition of residuals. Journal of the Royal Statistical Society, Series B, 30, 248-275. Cox, David R. and E. J. Snell (1971). On test statistics computed from residuals. Biometrika 71, 589-594. Dobson, Annette J. (2002). An Introduction to Generalized Linear Models, Second Edition. Chapman &amp; Hall, London. Fu, Luyang and Cheng-sheng Peter Wu (2008). General iteration algorithm for classification ratemaking. Variance 1(2), 193-213, Casualty Actuarial Society. de Jong, Piet and Gillian Z. Heller (2008). Generalized Linear Models for Insurance Data. Cambridge University Press, Cambridge, UK. J{}rgensen, Bent and Marta C. Paes de Souza (1994). Fitting Tweedie’s compound Poisson model to insurance claims data. Scandinavian Actuarial Journal 1994;1, 69-93. McCullagh, P. and J.A. Nelder (1989). Generalized Linear Models, Second Edition. Chapman &amp; Hall, London. Mildenhall, Stephen J. (1999). A systematic relationship between minimum bias and generalized linear models. Casualty Actuarial Society Proceedings 86, Casualty Actuarial Society. Pierce, Donald A. and Daniel W. Schafer (1986). Residuals in generalized linear models. Journal of the American Statistical Association 81, 977-986. Smyth, Gordon K. and Bent J{}rgensen (2002). Fitting Tweedie’s compound Poisson model to insurance claims data: Dispersion modelling. Astin Bulletin 32(1), 143-157. Tweedie, M. C. K. (1984). An index which distinguishes between some important exponential families. In Statistics: Applications and New Directions. Proceedings of the Indian Statistical Golden Jubilee International Conference* (Editors J. K. Ghosh and J. Roy), pp. 579-604. Indian Statistical Institute, Calcutta. 13.8 Ejercicios 13.1 Verifica las entradas en Tabla 13.8 para la distribución gamma. Específicamente: Demuestra que la distribución gamma es un miembro de la familia exponencial lineal de distribuciones. Describe los componentes de la familia exponencial lineal (\\(\\theta, \\phi, b(\\theta), S(y,\\phi)\\)) en términos de los parámetros de la distribución gamma. Demuestra que la media y la varianza de la distribución gamma y de las distribuciones de la familia exponencial lineal coinciden. 13.2 Clasificación de Tarificación. Este ejercicio considera los datos descritos en el ejemplo de clasificación de tarificación de la Sección 13.2.2, utilizando los datos de la Tabla 13.3. Ajusta un modelo de regresión gamma usando una función de enlace logarítmica con los conteos de reclamaciones como ponderaciones (\\(w_i\\)). Utiliza las variables explicativas categóricas de grupo de edad y uso del vehículo para estimar la severidad media esperada. Con base en tus parámetros estimados en la parte (a), verifica las severidades esperadas estimadas en la Tabla 13.4. 13.3 Verifica que la distribución de Tweedie es un miembro de la familia exponencial lineal de distribuciones comprobando la ecuación (13.9). En particular, proporciona una expresión para \\(S(y,\\phi)\\) (nota que \\(S(y,\\phi)\\) también depende de \\(p\\) pero no de \\(\\mu\\)). Puedes consultar a Clark y Thayer (2004) para verificar tu trabajo. Además, verifica los momentos en la ecuación (13.10). 13.9 Suplementos Técnicos - Familia Exponencial 13.9.1 Familia Exponencial Lineal de Distribuciones La distribución de la variable aleatoria \\(y\\) puede ser discreta, continua o una mezcla. Así, f(.) en la ecuación (13.2) puede interpretarse como una función de densidad o una función de masa, dependiendo de la aplicación. Tabla 13.8 proporciona varios ejemplos, incluyendo las distribuciones normal, binomial y Poisson. Tabla 13.8. Distribuciones Seleccionadas de la Familia Exponencial de Un Parámetro \\[ \\scriptsize{ \\begin{array}{l|ccccc} \\hline &amp; &amp; \\text{Densidad o} &amp; &amp; &amp; \\\\ \\text{Distribución} &amp; \\text{Parámetros} &amp; \\text{Función de Masa} &amp; \\text{Componentes} &amp; \\mathrm{E}~y &amp; \\mathrm{Var}~y \\\\ \\hline \\text{General} &amp; \\theta,~ \\phi &amp; \\exp \\left( \\frac{y\\theta -b(\\theta )}{\\phi } +S\\left( y,\\phi \\right) \\right) &amp; \\theta,~ \\phi, b(\\theta), S(y, \\phi) &amp; b^{\\prime}(\\theta) &amp; b^{\\prime \\prime}(\\theta) \\phi \\\\ \\text{Normal} &amp; \\mu, \\sigma^2 &amp; \\frac{1}{\\sigma \\sqrt{2\\pi }}\\exp \\left( -\\frac{(y-\\mu )^{2}}{2\\sigma ^{2}}\\right) &amp; \\mu, \\sigma^2, \\frac{\\theta^2}{2}, - \\left(\\frac{y^2}{2\\phi} + \\frac{\\ln(2 \\pi \\phi)}{2} \\right) &amp; \\theta=\\mu &amp; \\phi= \\sigma^2 \\\\ \\text{Binomial} &amp; \\pi &amp; {n \\choose y} \\pi ^y (1-\\pi)^{n-y} &amp; \\ln \\left(\\frac{\\pi}{1-\\pi} \\right), 1, n \\ln(1+e^{\\theta} ), &amp; n \\frac {e^{\\theta}}{1+e^{\\theta}} &amp; n \\frac {e^{\\theta}}{(1+e^{\\theta})^2} \\\\ &amp; &amp; &amp; \\ln {n \\choose y} &amp; = n \\pi &amp; = n \\pi (1-\\pi) \\\\ \\text{Poisson} &amp; \\lambda &amp; \\frac{\\lambda^y}{y!} \\exp(-\\lambda) &amp; \\ln \\lambda, 1, e^{\\theta}, - \\ln (y!) &amp; e^{\\theta} = \\lambda &amp; e^{\\theta} = \\lambda \\\\ \\text{Negativa} &amp; r,p &amp; \\frac{\\Gamma(y+r)}{y! \\Gamma(r)} p^r ( 1-p)^y &amp; \\ln(1-p), 1, -r \\ln(1-e^{\\theta}), &amp; \\frac{r(1-p)}{p} &amp; \\frac{r(1-p)}{p^2} \\\\ \\ \\ \\ \\text{Binomial}^{\\ast} &amp; &amp; &amp; ~~~\\ln \\left[ \\frac{\\Gamma(y+r)}{y! \\Gamma(r)} \\right] &amp; = \\mu &amp; = \\mu+\\mu^2/r \\\\ \\text{Gamma} &amp; \\alpha, \\gamma &amp; \\frac{\\gamma ^ \\alpha}{\\Gamma (\\alpha)} y^{\\alpha -1 }\\exp(-y \\gamma) &amp; - \\frac{\\gamma}{\\alpha}, \\frac{1}{\\alpha}, - \\ln ( - \\theta), -\\phi^{-1} \\ln \\phi &amp; - \\frac{1}{\\theta} = \\frac{\\alpha}{\\gamma} &amp; \\frac{\\phi}{\\theta ^2} = \\frac{\\alpha}{\\gamma ^2} \\\\ &amp; &amp; &amp; - \\ln \\left( \\Gamma(\\phi ^{-1}) \\right) + (\\phi^{-1} - 1) \\ln y &amp; &amp; \\\\ \\text{Inversa} &amp; \\mu, \\lambda &amp; \\sqrt{\\frac{\\lambda}{2 \\pi y^3} } \\exp \\left(- \\frac{\\lambda (y-\\mu)^2}{2 \\mu^2 y} \\right) &amp; -1/( 2\\mu^2), 1/\\lambda, -\\sqrt{-2 \\theta}, &amp; \\left(-2 \\theta \\right)^{-1/2} &amp; \\phi (-2 \\theta)^{-3/2} \\\\ \\ \\ \\ \\text{Gaussiana} &amp; &amp; &amp; \\theta/(\\phi y) - 0.5 \\ln (\\phi 2 \\pi y^3 ) &amp; = \\mu &amp; = \\frac{\\mu^3}{\\lambda} \\\\ \\text{Tweedie} &amp; &amp; \\textit{Ver Sección 13.6}\\\\ \\hline \\\\ \\end{array} } \\] \\(^{\\ast}\\) Esto supone que el parámetro \\(r\\) es fijo, pero no tiene que ser un número entero. 13.9.2 Momentos Para evaluar los momentos de las familias exponenciales, es conveniente trabajar con la función generadora de momentos. Para simplificar, asumimos que la variable aleatoria \\(y\\) es continua. Definimos la función generadora de momentos \\[\\begin{eqnarray*} M(s) &amp;=&amp; \\mathrm{E}~ e^{sy} = \\int \\exp \\left( sy+ \\frac{y \\theta - b(\\theta)}{\\phi} + S(y, \\phi) \\right) dy \\\\ &amp;=&amp; \\exp \\left(\\frac{b(\\theta + s \\phi) - b(\\theta)}{\\phi} \\right) \\int \\exp \\left( \\frac{y(\\theta + s\\phi) - b(\\theta+s\\phi)}{\\phi} + S(y, \\phi) \\right) dy \\\\ &amp;=&amp; \\exp \\left(\\frac{b(\\theta + s \\phi) - b(\\theta)}{\\phi} \\right), \\end{eqnarray*}\\] porque \\(\\int \\exp \\left( \\frac{1}{\\phi} \\left[ y(\\theta + s\\phi) - b(\\theta+s\\phi) \\right] + S(y, \\phi) \\right) dy=1\\). Con esta expresión, podemos generar los momentos. Así, para la media, tenemos \\[\\begin{eqnarray*} \\mathrm{E}~ y &amp;=&amp; M^{\\prime}(0) = \\left . \\frac{\\partial}{\\partial s} \\exp \\left(\\frac{b(\\theta + s \\phi) - b(\\theta)}{\\phi} \\right) \\right | _{s=0} \\\\ &amp;=&amp; \\left[ b^{\\prime}(\\theta + s \\phi ) \\exp \\left( \\frac{b(\\theta + s \\phi) - b(\\theta)}{\\phi} \\right) \\right] _{s=0} = b^{\\prime}(\\theta). \\end{eqnarray*}\\] De manera similar, para el segundo momento, tenemos \\[\\begin{eqnarray*} M^{\\prime \\prime}(s) &amp;=&amp; \\frac{\\partial}{\\partial s} \\left[ b^{\\prime}(\\theta + s \\phi) \\exp \\left(\\frac{b(\\theta + s \\phi) - b(\\theta)}{\\phi} \\right) \\right] \\\\ &amp;=&amp; \\phi b^{\\prime \\prime}(\\theta + s \\phi) \\exp \\left(\\frac{b(\\theta + s \\phi) - b(\\theta)}{\\phi} \\right) + (b^{\\prime}(\\theta + s \\phi))^2 \\left(\\frac{b(\\theta + s \\phi) - b(\\theta)}{\\phi} \\right). \\end{eqnarray*}\\] Esto produce \\(\\mathrm{E}y^2 = M^{\\prime \\prime}(0)\\) \\(= \\phi b^{\\prime \\prime}(\\theta) + (b^{\\prime}(\\theta))^2\\) y \\(\\mathrm{Var}~y =\\phi b^{\\prime \\prime}(\\theta)\\). 13.9.3 Estimación de Máxima Verosimilitud para Enlaces Generales Para enlaces generales, ya no asumimos la relación \\(\\theta_i=\\mathbf{x}_i^{\\mathbf{\\prime }}\\boldsymbol \\beta\\), sino que asumimos que \\(\\boldsymbol \\beta\\) está relacionado con \\(\\theta_i\\) a través de las relaciones \\(\\mu _i=b^{\\prime }(\\theta_i)\\) y \\(\\mathbf{x}_i^{\\mathbf{\\prime }}\\boldsymbol \\beta = g\\left( \\mu _i\\right)\\). Seguimos asumiendo que el parámetro de escala varía según la observación, de modo que \\(\\phi_i = \\phi/w_i\\), donde \\(w_i\\) es una función de ponderación conocida. Usando la ecuación (13.4), tenemos que el \\(j\\)-ésimo elemento de la función de puntaje es \\[ \\frac{\\partial }{\\partial \\beta _{j}}\\ln \\mathrm{f}\\left( \\mathbf{y}\\right) =\\sum_{i=1}^n \\frac{\\partial \\theta_i}{\\partial \\beta _{j}} \\frac{y_i-\\mu _i}{\\phi _i}, \\] ya que \\(b^{\\prime }(\\theta_i)=\\mu _i\\). Ahora, usamos la regla de la cadena y la relación \\(\\mathrm{Var~}y_i=\\phi _ib^{\\prime \\prime }(\\theta_i)\\) para obtener \\[ \\frac{\\partial \\mu _i}{\\partial \\beta _{j}}=\\frac{\\partial b^{\\prime }(\\theta_i)}{\\partial \\beta _{j}}=b^{\\prime \\prime }(\\theta_i)\\frac{ \\partial \\theta_i}{\\partial \\beta _{j}}=\\frac{\\mathrm{Var~}y_i}{\\phi _i}\\frac{\\partial \\theta_i}{\\partial \\beta _{j}}. \\] Así, tenemos \\[ \\frac{\\partial \\theta_i}{\\partial \\beta _{j}}\\frac{1}{\\phi _i}=\\frac{\\partial \\mu _i}{\\partial \\beta _{j}}\\frac{1}{\\mathrm{Var~}y_i}. \\] Esto produce \\[ \\frac{\\partial }{\\partial \\beta _{j}}\\ln \\mathrm{f}\\left( \\mathbf{y}\\right) =\\sum_{i=1}^n \\frac{\\partial \\mu _i}{\\partial \\beta _{j}}\\left( \\mathrm{Var~}y_i\\right) ^{-1}\\left( y_i-\\mu _i\\right), \\] que resumimos como \\[\\begin{equation} \\frac{\\partial L(\\boldsymbol \\beta) }{\\partial \\boldsymbol \\beta } = \\frac{\\partial }{\\partial \\boldsymbol \\beta }\\ln \\mathrm{f}\\left( \\mathbf{y}\\right) =\\sum_{i=1}^n \\frac{\\partial \\mu _i}{\\partial \\boldsymbol \\beta}\\left( \\mathrm{Var~}y_i\\right) ^{-1}\\left( y_i-\\mu _i\\right), \\tag{13.13} \\end{equation}\\] que se conoce como la forma de las ecuaciones de estimación generalizadas. Resolver las raíces de la ecuación de puntaje \\(L(\\boldsymbol \\beta) = \\mathbf{0}\\) proporciona estimaciones de máxima verosimilitud, \\(\\mathbf{b}_{MLE}\\). En general, esto requiere métodos numéricos iterativos. Una excepción es el siguiente caso especial. Caso especial. Sin covariables. Supongamos que \\(k=1\\) y que \\(x_i =1\\). Entonces, \\(\\beta = \\eta = g(\\mu)\\), y \\(\\mu\\) no depende de \\(i\\). A partir de la relación \\(\\mathrm{Var~}y_i = \\phi b^{\\prime \\prime}(\\theta)/w_i\\) y la ecuación (13.13), la función de puntaje es \\[ \\frac{\\partial L( \\beta) }{\\partial \\beta } = \\frac{\\partial \\mu}{\\partial \\beta} ~ \\frac{1}{\\phi b^{\\prime \\prime}(\\theta)} \\sum_{i=1}^n w_i \\left( y_i-\\mu \\right). \\] Igualando esto a cero se obtiene \\(\\overline{y}_w = \\sum_i w_i y_i / \\sum_i w_i = \\widehat{\\mu}_{MLE} = g^{-1}(b_{MLE})\\), o \\(b_{MLE}=g(\\overline{y}_w)\\), donde \\(\\overline{y}_w\\) es un promedio ponderado de los \\(y\\). Para la matriz de información, usamos la independencia entre los sujetos y la ecuación (13.13) para obtener \\[\\begin{eqnarray} \\mathbf{I}(\\boldsymbol \\beta) &amp;=&amp; \\mathrm{E~} \\left( \\frac{\\partial L(\\boldsymbol \\beta) }{\\partial \\boldsymbol \\beta } \\frac{\\partial L(\\boldsymbol \\beta) }{\\partial \\boldsymbol \\beta ^{\\prime}} \\right) \\nonumber \\\\ &amp;=&amp; \\sum_{i=1}^n \\frac{\\partial \\mu _i}{\\partial \\boldsymbol \\beta}~\\mathrm{E} \\left( \\left( \\mathrm{Var~}y_i\\right) ^{-1}\\left( y_i-\\mu _i\\right)^2 \\left( \\mathrm{Var~}y_i\\right) ^{-1}\\right) \\frac{\\partial \\mu _i}{\\partial \\boldsymbol \\beta ^{\\prime}} \\nonumber \\\\ &amp;=&amp; \\sum_{i=1}^n \\frac{\\partial \\mu _i}{\\partial \\boldsymbol \\beta} \\left( \\mathrm{Var~}y_i\\right) ^{-1} \\frac{\\partial \\mu _i}{\\partial \\boldsymbol \\beta ^{\\prime}} . \\tag{13.14} \\end{eqnarray}\\] Tomar la raíz cuadrada de los elementos diagonales de la inversa de \\(\\mathbf{I}(\\boldsymbol \\beta)\\), después de insertar las estimaciones de los parámetros en las funciones de media y varianza, proporciona errores estándar basados en el modelo. Para datos en los que se duda de la correcta especificación del componente de varianza, se reemplaza Var \\(y_i\\) por una estimación insesgada \\((y_i - \\mu_i)^2\\). El estimador resultante \\[ se(b_j) = \\sqrt{ j\\text{-ésimo elemento diagonal de } [\\sum_{i=1}^n \\frac{\\partial \\mu _i}{\\partial \\boldsymbol \\beta} (y_i - \\mu_i)^{-2} \\frac{\\partial \\mu _i}{\\partial \\boldsymbol \\beta ^{\\prime}}]|_{\\boldsymbol \\beta = \\mathbf{b}_{MLE}}^{-1}} \\] se conoce como el error estándar empírico o robusto. 13.9.4 Mínimos Cuadrados Reponderados Iterativos Para ver cómo funcionan los métodos iterativos generales, usamos el enlace canónico de modo que \\(\\eta_i = \\theta_i\\). Luego, la función de puntaje está dada en la ecuación (13.6) y el Hessiano en la ecuación (13.8). Usando la ecuación de Newton-Raphson (11.15) en la Sección 11.9 obtenemos \\[\\begin{equation} \\boldsymbol \\beta_{NEW} = \\boldsymbol \\beta_{OLD} - \\left( \\sum_{i=1}^n w_i b^{\\prime \\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta _{OLD}) \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\right)^{-1} \\left( \\sum_{i=1}^n w_i (y_i - b^{\\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta_{OLD})) \\mathbf{x}_i \\right). \\tag{13.15} \\end{equation}\\] Observa que, dado que la matriz de segundas derivadas no es estocástica, Newton-Raphson es equivalente al algoritmo de puntuación de Fisher. Como se describe en la Sección 13.3.1, la estimación de \\(\\boldsymbol \\beta\\) no requiere el conocimiento de \\(\\phi\\). Seguimos usando el enlace canónico y definimos una “variable dependiente ajustada” \\[ y_i^{\\ast}(\\boldsymbol \\beta) = \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta + \\frac{y_i - b^{\\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta)}{b^{\\prime \\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta)}. \\] Esto tiene varianza \\[ \\mathrm{Var~}y_i^{\\ast}(\\boldsymbol \\beta) = \\frac{\\mathrm{Var~}y_i}{(b^{\\prime \\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta))^2} = \\frac{\\phi_i b^{\\prime \\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta)}{(b^{\\prime \\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta))^2} = \\frac{\\phi/ w_i }{b^{\\prime \\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta)}. \\] Usamos el nuevo peso como el recíproco de la varianza, \\(w_i(\\boldsymbol \\beta)=w_i b^{\\prime \\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta) / \\phi.\\) Luego, con la expresión \\[ w_i \\left(y_i - b^{\\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta)\\right) = w_i b^{\\prime \\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta) (y_i^{\\ast}(\\boldsymbol \\beta) - \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta) = \\phi w_i(\\boldsymbol \\beta) (y_i^{\\ast}(\\boldsymbol \\beta) - \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta), \\] a partir de la iteración de Newton-Raphson en la ecuación (13.15), tenemos \\(\\boldsymbol \\beta_{NEW}\\) \\[\\begin{eqnarray*} ~ &amp;=&amp; \\boldsymbol \\beta_{OLD} - \\left( \\sum_{i=1}^n w_i b^{\\prime \\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta _{OLD}) \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\right)^{-1} \\left( \\sum_{i=1}^n w_i (y_i - b^{\\prime}(\\mathbf{x}_i^{\\prime} \\boldsymbol \\beta_{OLD})) \\mathbf{x}_i \\right) \\\\ &amp;=&amp; \\boldsymbol \\beta_{OLD} - \\left( \\sum_{i=1}^n \\phi w_i(\\boldsymbol \\beta _{OLD}) \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\right)^{-1} \\left( \\sum_{i=1}^n \\phi w_i(\\boldsymbol \\beta _{OLD}) (y_i^{\\ast}(\\boldsymbol \\beta_{OLD}) - \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta_{OLD})\\mathbf{x}_i \\right) \\\\ &amp;=&amp; \\boldsymbol \\beta_{OLD} - \\left( \\sum_{i=1}^n w_i(\\boldsymbol \\beta _{OLD}) \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\right)^{-1} \\left( \\sum_{i=1}^n w_i(\\boldsymbol \\beta _{OLD})\\mathbf{x}_i y_i^{\\ast}(\\boldsymbol \\beta_{OLD}) - \\sum_{i=1}^n w_i(\\boldsymbol \\beta _{OLD})\\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\boldsymbol \\beta_{OLD}) \\right) \\\\ &amp;=&amp; \\left( \\sum_{i=1}^n w_i(\\boldsymbol \\beta _{OLD}) \\mathbf{x}_i \\mathbf{x}_i^{\\prime} \\right)^{-1} \\left( \\sum_{i=1}^n w_i(\\boldsymbol \\beta _{OLD})\\mathbf{x}_i y_i^{\\ast}(\\boldsymbol \\beta_{OLD}) \\right). \\end{eqnarray*}\\] Así, esto proporciona un método para la iteración usando mínimos cuadrados ponderados. Los mínimos cuadrados reponderados iterativos también están disponibles para enlaces generales utilizando la puntuación de Fisher. Ver McCullagh y Nelder (1989) para más detalles. "],["apéndices.html", "Chapter 14 Apéndices Apéndice A1. Inferencia Estadística Básica Apéndice A2. Álgebra de Matrices Apéndice A3. Tablas de Probabilidad", " Chapter 14 Apéndices Apéndice A1. Inferencia Estadística Básica Vista Previa del Apéndice. Este apéndice proporciona definiciones y hechos de un curso de inferencia estadística básica que son necesarios para el estudio del análisis de regresión. Distribuciones de Funciones de Variables Aleatorias Estadísticas y Distribuciones Muestrales. Una estadística resume la información en una muestra y, por lo tanto, es una función de las observaciones \\(y_1,\\ldots,y_n\\). Dado que las observaciones son realizaciones de variables aleatorias, el estudio de las distribuciones de funciones de variables aleatorias es realmente el estudio de las distribuciones de estadísticas, conocidas como distribuciones muestrales. Las combinaciones lineales de la forma \\(\\sum_{i=1}^n a_i y_i\\) representan un tipo importante de función. Aquí, \\(a_1,\\ldots,a_n\\) son constantes conocidas. Para comenzar, supongamos que \\(y_1,\\ldots,y_n\\) son variables aleatorias mutuamente independientes con \\(\\mathrm{E~}y_i = \\mu_i\\) y \\(\\mathrm{Var~}y_i = \\sigma_i^2\\). Entonces, por la linealidad de las esperanzas, tenemos \\[ \\mathrm{E}\\left( \\sum_{i=1}^n a_i y_i \\right) = \\sum_{i=1}^n a_i \\mu_i~~~\\mathrm{y}~~~\\mathrm{Var}\\left( \\sum_{i=1}^n a_i y_i \\right) = \\sum_{i=1}^n a_i^2 \\sigma_i^2. \\] Un teorema importante en la estadística matemática es que, si cada variable aleatoria se distribuye normalmente, entonces las combinaciones lineales también se distribuyen normalmente. Es decir, tenemos: Linealidad de Variables Aleatorias Normales. Supongamos que \\(y_1,\\ldots,y_n\\) son variables aleatorias mutuamente independientes con \\(y_i \\sim N(\\mu_i,\\sigma_i^2)\\). (Lea “\\(\\sim\\)” como “se distribuye como”). Entonces, \\[ \\sum_{i=1}^n a_i y_i \\sim N\\left( \\sum_{i=1}^n a_i \\mu_i, \\sum_{i=1}^n a_i^2 \\sigma_i^2 \\right) . \\] Hay varias aplicaciones de esta propiedad importante. Primero, se puede verificar que si \\(y \\sim N(\\mu ,\\sigma^2)\\), entonces \\((y - \\mu)/\\sigma \\sim N(0,1)\\). En segundo lugar, supongamos que \\(y_1,\\ldots,y_n\\) son idénticamente e independientemente distribuidos (i.i.d.) como \\(N(\\mu, \\sigma^2)\\) y tomamos \\(a_i = n^{-1}\\). Entonces, tenemos \\[ \\overline{y} = \\frac{1}{n}\\sum_{i=1}^n y_i \\sim N\\left( \\mu ,\\frac{\\sigma^2}{n}\\right) . \\] Equivalente a esto, \\(\\sqrt{n}\\left( \\overline{y}-\\mu \\right) /\\sigma\\) es normal estándar. Por lo tanto, la importante estadística muestral \\(\\overline{y}\\) tiene una distribución normal. Además, también se puede calcular la distribución de la varianza muestral \\(s_y^2\\). Para \\(y_1,\\ldots,y_n\\) que son i.i.d. \\(N(\\mu ,\\sigma^2)\\), tenemos que \\(\\left( n-1\\right) s_y^2 /\\sigma^2\\sim \\chi_{n-1}^2\\), una distribución \\(\\chi^2\\) (chi-cuadrado) con \\(n-1\\) grados de libertad. Además, \\(\\overline{y}\\) es independiente de \\(s_y^2\\). A partir de estos dos resultados, tenemos que \\[ \\frac{\\sqrt{n}}{s_y}\\left( \\overline{y}-\\mu \\right) \\sim t_{n-1}, \\] una distribución \\(t\\) con \\(n-1\\) grados de libertad. Estimación y Predicción Supongamos que \\(y_1,\\ldots,y_n\\) son variables aleatorias i.i.d. de una distribución que se puede resumir mediante un parámetro desconocido \\(\\theta\\). Nos interesa la calidad de una estimación de \\(\\theta\\) y denotamos \\(\\widehat{\\theta}\\) como este estimador. Por ejemplo, consideramos \\(\\theta = \\mu\\) con \\(\\widehat{\\theta} = \\overline{y}\\) y \\(\\theta = \\sigma^2\\) con \\(\\widehat{\\theta} = s_y^2\\) como nuestros principales ejemplos. Estimación Puntual e Imparcialidad. Dado que \\(\\widehat{\\theta}\\) proporciona una aproximación (única) de \\(\\theta\\), se le conoce como una estimación puntual de \\(\\theta\\). Como estadística, \\(\\widehat{\\theta}\\) es una función de las observaciones \\(y_1,\\ldots,y_n\\) que varía de una muestra a otra. Por lo tanto, los valores de \\(\\widehat{\\theta}\\) varían de una muestra a otra. Para examinar qué tan cerca tiende a estar \\(\\widehat{\\theta}\\) de \\(\\theta\\), examinamos varias propiedades de \\(\\widehat{\\theta}\\), en particular, el sesgo y la consistencia. Se dice que un estimador puntual \\(\\widehat{\\theta}\\) es un estimador imparcial de \\(\\theta\\) si \\(\\mathrm{E~}\\widehat{\\theta} = \\theta\\). Por ejemplo, dado que \\(\\mathrm{E~}\\overline{y} = \\mu\\), \\(\\overline{y}\\) es un estimador imparcial de \\(\\mu\\). Propiedades de Muestras Finitas versus Propiedades de Muestras Grandes de los Estimadores. Se dice que el sesgo es una propiedad de muestra finita ya que es válida para cada tamaño de muestra \\(n\\). Una propiedad límite o de muestra grande es la consistencia. La consistencia se expresa de dos maneras: consistencia débil y consistencia fuerte. Se dice que un estimador es débilmente consistente si \\[ \\lim_{n\\rightarrow \\infty }\\Pr \\left( |\\widehat{\\theta }-\\theta |&lt;h\\right) = 1, \\] para cada \\(h\\) positivo. Se dice que un estimador es fuertemente consistente si \\(\\lim_{n\\rightarrow \\infty }~\\widehat{\\theta }=\\theta\\), con probabilidad uno. Principio de Estimación de Mínimos Cuadrados. En este texto, se utilizan dos principios principales de estimación: la estimación por mínimos cuadrados y la estimación por máxima verosimilitud. Para el procedimiento de mínimos cuadrados, consideremos variables aleatorias independientes \\(y_1,\\ldots,y_n\\) con medias \\(\\mathrm{E~}y_i = \\mathrm{g}_i(\\theta )\\). Aquí, \\(\\mathrm{g}_i(.)\\) es una función conocida excepto por \\(\\theta\\), el parámetro desconocido. El estimador de mínimos cuadrados es el valor de \\(\\theta\\) que minimiza la suma de cuadrados \\[ \\mathrm{SS}(\\theta )=\\sum_{i=1}^n\\left( y_i-\\mathrm{g}_i(\\theta )\\right)^2. \\] Principio de Estimación de Máxima Verosimilitud. Las estimaciones por máxima verosimilitud son los valores del parámetro que son “más probables” de haber sido producidos por los datos. Consideremos las variables aleatorias independientes \\(y_1,\\ldots,y_n\\) con función de probabilidad \\(\\mathrm{f}_i(a_i,\\theta )\\). Aquí, \\(\\mathrm{f}_i(a_i,\\theta )\\) se interpreta como una función de masa de probabilidad para \\(y_i\\) discreto o una función de densidad de probabilidad para \\(y_i\\) continuo, evaluada en \\(a_i\\), la realización de \\(y_i\\). Se asume que la función \\(\\mathrm{f}_i(a_i,\\theta )\\) es conocida excepto por \\(\\theta\\), el parámetro desconocido. La verosimilitud de las variables aleatorias \\(y_1,\\ldots,y_n\\) tomando valores \\(a_1,\\ldots,a_n\\) es \\[ \\mathrm{L}(\\theta )=\\prod\\limits_{i=1}^n \\mathrm{f}_i(a_i,\\theta ). \\] El valor de \\(\\theta\\) que maximiza \\(\\mathrm{L}(\\theta )\\) se llama el estimador de máxima verosimilitud. Intervalos de Confianza. Aunque las estimaciones puntuales proporcionan una aproximación única a los parámetros, las estimaciones por intervalo proporcionan un rango que incluye parámetros con un cierto nivel de probabilidad preespecificado, o confianza. Un par de estadísticas, \\(\\widehat{\\theta }_1\\) y \\(\\widehat{\\theta }_{2}\\), proporcionan un intervalo de la forma \\(\\left[ \\widehat{\\theta }_1 &lt; \\widehat{\\theta }_{2}\\right]\\). Este intervalo es un intervalo de confianza de \\(100(1-\\alpha )\\%\\) para \\(\\theta\\) si \\[ \\Pr \\left( \\widehat{\\theta }_1 &lt; \\theta &lt; \\widehat{\\theta }_{2}\\right) \\geq 1-\\alpha . \\] Por ejemplo, supongamos que \\(y_1,\\ldots,y_n\\) son variables aleatorias i.i.d. \\(N(\\mu ,\\sigma^2)\\). Recuerde que \\(\\sqrt{n}\\left( \\overline{y}-\\mu\\right) /s_y\\sim t_{n-1}\\). Este hecho nos permite desarrollar un intervalo de confianza de \\(100(1-\\alpha )\\%\\) para \\(\\mu\\) de la forma \\(\\overline{y}\\pm (t-value)s_y/ \\sqrt{n}\\), donde \\(t-value\\) es el percentil \\((1-\\alpha /2)^{th}\\) de una distribución \\(t\\) con \\(n-1\\) grados de libertad. Intervalos de Predicción. Los intervalos de predicción tienen la misma forma que los intervalos de confianza. Sin embargo, un intervalo de confianza proporciona un rango para un parámetro, mientras que un intervalo de predicción proporciona un rango para valores externos de las observaciones. Basado en las observaciones \\(y_1,\\ldots,y_n\\), buscamos construir estadísticas \\(\\widehat{\\theta }_1\\) y \\(\\widehat{\\theta }_{2}\\) tal que \\[ \\Pr \\left( \\widehat{\\theta }_1 &lt; y^{\\ast } &lt; \\widehat{\\theta }_{2}\\right) \\geq 1-\\alpha . \\] Aquí, \\(y^{\\ast }\\) es una observación adicional que no forma parte de la muestra. Pruebas de Hipótesis Hipótesis Nula y Alternativa y Estadísticos de Prueba. Un procedimiento estadístico importante implica verificar ideas sobre los parámetros. Es decir, antes de que se observen los datos, se formulan ciertas ideas sobre los parámetros. En este texto, consideramos una hipótesis nula de la forma \\(H_0:\\theta =\\theta_0\\) frente a una hipótesis alternativa. Consideramos tanto una alternativa de dos colas, \\(H_{a}:\\theta \\neq \\theta_0\\), como alternativas de una cola, ya sea \\(H_{a}:\\theta &gt;\\theta_0\\) o \\(H_{a}:\\theta &lt;\\theta_0\\). Para elegir entre estas hipótesis competidoras, utilizamos un estadístico de prueba \\(T_n\\) que típicamente es una estimación puntual de \\(\\theta\\) o una versión reescalada para ajustarse a una distribución de referencia bajo \\(H_0\\). Por ejemplo, para probar \\(H_0:\\mu =\\mu_0\\), a menudo usamos \\(T_n= \\overline{y}\\) o \\(T_n=\\sqrt{n}\\left( \\overline{y}-\\mu_0\\right) /s_y\\). Nótese que esta última opción tiene una distribución \\(t_{n-1}\\), bajo los supuestos de datos normales i.i.d. Regiones de Rechazo y Nivel de Significancia. Con un estadístico en mano, ahora establecemos un criterio para decidir entre las dos hipótesis competidoras. Esto se puede hacer estableciendo una región de rechazo o región crítica. La región crítica consiste en todos los posibles resultados de \\(T_n\\) que nos llevan a rechazar \\(H_0\\) a favor de \\(H_{a}\\). Para especificar la región crítica, primero cuantificamos los tipos de errores que se pueden cometer en el procedimiento de toma de decisiones. Un error de Tipo I consiste en rechazar \\(H_0\\) falsamente y un error de Tipo II consiste en rechazar \\(H_{a}\\) falsamente. La probabilidad de un error de Tipo I se llama nivel de significancia. Preespecificar el nivel de significancia es a menudo suficiente para determinar la región crítica. Por ejemplo, supongamos que \\(y_1,\\ldots,y_n\\) son i.i.d. \\(N(\\mu ,\\sigma^2)\\) y estamos interesados en decidir entre \\(H_0:\\mu =\\mu_0\\) y \\(H_{a}:\\mu &gt; \\mu_0\\). Pensando en nuestro estadístico de prueba \\(T_n=\\overline{y}\\), sabemos que nos gustaría rechazar \\(H_0\\) si \\(\\overline{y}\\) es mayor que \\(\\mu_0\\). La pregunta es ¿cuánto mayor? Especificando un nivel de significancia \\(\\alpha\\), deseamos encontrar una región crítica de la forma \\(\\{\\overline{y}&gt;c\\}\\) para alguna constante \\(c\\). Con este fin, tenemos \\[ \\begin{array}{ll} \\alpha &amp;= \\Pr \\mathrm{(Error~Tipo~I)} = \\Pr (\\mathrm{Rechazar~}H_0 \\mathrm{~asumiendo~} H_0:\\mu =\\mu_0 \\mathrm{~es~verdadera)} \\\\ &amp; = \\Pr (\\overline{y}&gt;c) = \\Pr \\left(\\sqrt{n}\\left( \\overline{y}-\\mu_0\\right)/s_y&gt;\\sqrt{n}\\left( c-\\mu_0 \\right)/s_y\\right) \\\\ &amp;= \\Pr \\left(t_{n-1}&gt;\\sqrt{n}\\left( c-\\mu_0 \\right)/s_y\\right). \\end{array} \\] Con \\(df=n-1\\) grados de libertad, tenemos que \\(t-value = \\sqrt{n}\\left( c-\\mu_0\\right)/s_y\\) donde el \\(t-value\\) es el percentil \\((1-\\alpha)^{th}\\) de una distribución \\(t\\). Así, resolviendo para \\(c\\), nuestra región crítica es de la forma \\(\\{\\overline{y} &gt; \\mu_0 + (t-value)/s_y/\\sqrt{n}\\}\\). Relación entre Intervalos de Confianza y Pruebas de Hipótesis. Cálculos similares muestran que, para probar \\(H_0:\\mu = \\mu_0\\) frente a \\(H_{a}:\\theta \\neq \\theta_0\\), la región crítica es de la forma \\[ \\{ \\overline{y} &gt; \\mu_0 + (t-value)/s_y/\\sqrt{n} ~\\mathrm{o~} \\overline{y} &lt; \\mu_0 - (t-value)/s_y/\\sqrt{n}\\} . \\] Aquí, el \\(t\\)-value es el percentil \\((1-\\alpha /2)^{th}\\) de una distribución \\(t\\) con \\(df=n-1\\) grados de libertad. Es interesante notar que el evento de caer en esta región crítica de dos colas es equivalente al evento de que \\(\\mu_0\\) caiga fuera del intervalo de confianza \\(\\overline{y}\\pm (t-value)s_y/\\sqrt{n}\\). Esto establece el hecho de que los intervalos de confianza y las pruebas de hipótesis realmente están reportando la misma evidencia con un énfasis diferente en la interpretación de la inferencia estadística. \\(p\\)-valor. Otro concepto útil en las pruebas de hipótesis es el \\(p\\)-valor, que es la abreviatura de valor de probabilidad. Para un conjunto de datos, un \\(p\\)-valor se define como el nivel de significancia más pequeño para el cual se rechazaría la hipótesis nula. El \\(p\\)-valor es un estadístico resumen útil para que el analista de datos lo informe, ya que permite al lector comprender la fuerza de la desviación de la hipótesis nula. Apéndice A2. Álgebra de Matrices Definiciones Básicas Matriz - un arreglo rectangular de números organizados en filas y columnas (el plural de matriz es matrices). Dimensión de la matriz - el número de filas y columnas de la matriz. Consideremos una matriz \\(\\mathbf{A}\\) que tiene dimensiones \\(m \\times k\\). Sea \\(a_{ij}\\) el símbolo para el número en la fila \\(i\\) y la columna \\(j\\) de \\(\\mathbf{A}\\). En general, trabajamos con matrices de la forma \\[ \\mathbf{A} = \\left( \\begin{array}{cccc} a_{11} &amp; a_{12} &amp; \\cdots &amp; a_{1k} \\\\ a_{21} &amp; a_{22} &amp; \\cdots &amp; a_{2k} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ a_{m1} &amp; a_{m2} &amp; \\cdots &amp; a_{mk} \\end{array} \\right) . \\] Vector - un vector (columna) es una matriz que contiene solo una fila (\\(m=1\\)). Vector fila - una matriz que contiene solo una columna (\\(k=1\\)). Transpuesta - la transpuesta de una matriz \\(\\mathbf{A}\\) se define al intercambiar las filas y las columnas y se denota por \\(\\mathbf{A}^{\\prime}\\) (o \\(\\mathbf{A}^{\\mathrm{T}}\\)). Así, si \\(\\mathbf{A}\\) tiene dimensión \\(m \\times k\\), entonces \\(\\mathbf{A}^{\\prime}\\) tiene dimensión \\(k \\times m\\). Matriz cuadrada - una matriz donde el número de filas es igual al número de columnas, es decir, \\(m=k\\). Elemento diagonal - el número en la fila \\(r\\) y columna \\(r\\) de una matriz cuadrada, \\(r=1,2,\\ldots\\) Matriz diagonal - una matriz cuadrada donde todos los números no diagonales son iguales a cero. Matriz identidad - una matriz diagonal donde todos los elementos diagonales son iguales a uno y se denota por \\(\\mathbf{I}\\). Matriz simétrica - una matriz cuadrada \\(\\mathbf{A}\\) tal que la matriz permanece sin cambios si intercambiamos los roles de las filas y las columnas, es decir, si \\(\\mathbf{A} = \\mathbf{A}^{\\prime}\\). Nótese que una matriz diagonal es una matriz simétrica. Revisión de Operaciones Básicas Multiplicación por un escalar. Sea \\(c\\) un número real, llamado escalar (una matriz de \\(1 \\times 1\\)). Multiplicar un escalar \\(c\\) por una matriz \\(\\mathbf{A}\\) se denota por \\(c \\mathbf{A}\\) y se define por \\[ c\\mathbf{A} = \\left( \\begin{array}{cccc} ca_{11} &amp; ca_{12} &amp; \\cdots &amp; ca_{1k} \\\\ ca_{21} &amp; ca_{22} &amp; \\cdots &amp; ca_{2k} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ ca_{m1} &amp; ca_{m2} &amp; \\cdots &amp; ca_{mk} \\end{array} \\right) . \\] Suma y resta de matrices. Sean \\(\\mathbf{A}\\) y \\(\\mathbf{B}\\) matrices, cada una con dimensión \\(m \\times k\\). Utilice \\(a_{ij}\\) y \\(b_{ij}\\) para denotar los números en la fila \\(i\\) y columna \\(j\\) de \\(\\mathbf{A}\\) y \\(\\mathbf{B}\\), respectivamente. Entonces, la matriz \\(\\mathbf{C} = \\mathbf{A} + \\mathbf{B}\\) se define como la matriz con el número \\((a_{ij} + b_{ij})\\) para denotar el número en la fila \\(i\\) y la columna \\(j\\). De manera similar, la matriz \\(\\mathbf{C} = \\mathbf{A} - \\mathbf{B}\\) se define como la matriz con el número \\((a_{ij} - b_{ij})\\) para denotar los números en la fila \\(i\\) y la columna \\(j\\). Multiplicación de matrices. Si \\(\\mathbf{A}\\) es una matriz de dimensión \\(m \\times c\\) y \\(\\mathbf{B}\\) es una matriz de dimensión \\(c \\times k\\), entonces \\(\\mathbf{C} = \\mathbf{A} \\mathbf{B}\\) es una matriz de dimensión \\(m \\times k\\). El número en la fila \\(i\\) y columna \\(j\\) de \\(\\mathbf{C}\\) es \\(\\sum_{s=1}^c a_{is} b_{sj}\\). Determinante - una función de una matriz cuadrada, denotada por \\(\\mathrm{det}(\\mathbf{A})\\), o \\(|\\mathbf{A}|\\). Para una matriz de \\(1 \\times 1\\), el determinante es \\(\\mathrm{det}(\\mathbf{A}) = a_{11}\\). Para definir determinantes de matrices más grandes, necesitamos dos conceptos adicionales. Sea \\(\\mathbf{A}_{rs}\\) la submatriz de dimensión \\((m-1) \\times (m-1)\\) de \\(\\mathbf{A}\\) definida al eliminar la fila \\(r\\) y la columna \\(s\\). Recursivamente, definimos \\(\\mathrm{det}(\\mathbf{A}) = \\sum_{s=1}^m (-1)^{r+s} a_{rs} \\mathrm{det}(\\mathbf{A}_{rs})\\), para cualquier \\(r=1,\\ldots,m\\). Por ejemplo, para \\(m=2\\), tenemos \\(\\mathrm{det}(\\mathbf{A}) = a_{11}a_{22} - a_{12}a_{21}\\). Inversa de una matriz. En álgebra de matrices, no existe el concepto de división. En su lugar, extendemos el concepto de recíprocos de números reales. Para comenzar, supongamos que \\(\\mathbf{A}\\) es una matriz cuadrada de dimensión \\(m \\times m\\) tal que \\(\\mathrm{det}(\\mathbf{A}) \\neq 0\\). Además, sea \\(\\mathbf{I}\\) la matriz identidad de \\(m \\times m\\). Si existe una matriz \\(m \\times m\\) \\(\\mathbf{B}\\) tal que \\(\\mathbf{AB = I = BA}\\), entonces \\(\\mathbf{B}\\) se llama la inversa de \\(\\mathbf{A}\\) y se escribe como \\(\\mathbf{B} = \\mathbf{A}^{-1}\\). Definiciones Adicionales Vectores linealmente dependientes – un conjunto de vectores \\(\\mathbf{c}_{1},\\ldots,\\mathbf{c}_{k}\\) se dice que son linealmente dependientes si uno de los vectores en el conjunto puede ser escrito como una combinación lineal de los otros. Vectores linealmente independientes – un conjunto de vectores \\(\\mathbf{c}_{1},\\ldots,\\mathbf{c}_{k}\\) se dice que son linealmente independientes si no son linealmente dependientes. Específicamente, un conjunto de vectores \\(\\mathbf{c}_{1},\\ldots,\\mathbf{c}_{k}\\) se dice que son linealmente independientes si y solo si la única solución de la ecuación \\(x_{1}\\mathbf{c}_{1} + \\ldots + x_{k}\\mathbf{c}_{k} = 0\\) es \\(x_{1} = \\ldots = x_{k} = 0\\). Rango de una matriz – el mayor número de columnas (o filas) linealmente independientes de una matriz. Matriz singular – una matriz cuadrada \\(\\mathbf{A}\\) tal que \\(\\mathrm{det}(\\mathbf{A}) = 0\\). Matriz no singular – una matriz cuadrada \\(\\mathbf{A}\\) tal que \\(\\mathrm{det}(\\mathbf{A}) \\neq 0\\). Matriz definida positiva – una matriz cuadrada simétrica \\(\\mathbf{A}\\) tal que \\(\\mathbf{x}^{\\prime}\\mathbf{Ax} &gt; 0\\) para \\(\\mathbf{x} \\neq 0\\). Matriz definida no negativa – una matriz cuadrada simétrica \\(\\mathbf{A}\\) tal que \\(\\mathbf{x}^{\\prime}\\mathbf{Ax} \\geq 0\\) para \\(\\mathbf{x} \\neq 0\\). Ortogonal – dos matrices \\(\\mathbf{A}\\) y \\(\\mathbf{B}\\) son ortogonales si \\(\\mathbf{A}^{\\prime}\\mathbf{B} = 0\\), una matriz cero. Idempotente – una matriz cuadrada tal que \\(\\mathbf{AA = A}\\). Traza – la suma de todos los elementos diagonales de una matriz cuadrada. Valores propios – las soluciones del polinomio de grado \\(n\\) \\(\\mathrm{det}(\\mathbf{A} - \\lambda \\mathbf{I}) = 0\\). También conocidos como raíces características y raíces latentes. Vector propio – un vector \\(\\mathbf{x}\\) tal que \\(\\mathbf{Ax} = \\lambda \\mathbf{x}\\), donde \\(\\lambda\\) es un valor propio de \\(\\mathbf{A}\\). También conocido como vector característico y vector latente. Inversa generalizada - de una matriz \\(\\mathbf{A}\\) es una matriz \\(\\mathbf{B}\\) tal que \\(\\mathbf{ABA = A}\\). Usamos la notación \\(\\mathbf{A}^{-}\\) para denotar la inversa generalizada de \\(\\mathbf{A}\\). En el caso de que \\(\\mathbf{A}\\) sea invertible, entonces \\(\\mathbf{A}^{-}\\) es única y es igual a \\(\\mathbf{A}^{-1}\\). Aunque existen varias definiciones de inversas generalizadas, la definición anterior es suficiente para nuestros propósitos. Ver Searle (1987) para una discusión adicional de definiciones alternativas de inversas generalizadas. Vector gradiente – un vector de derivadas parciales. Si \\(\\mathrm{f}(.)\\) es una función del vector \\(\\mathbf{x} = (x_1,\\ldots,x_m)^{\\prime}\\), entonces el vector gradiente es \\(\\partial \\mathrm{f}(\\mathbf{x})/\\partial \\mathbf{x}\\). La fila \\(i\\) del vector gradiente es \\(\\partial \\mathrm{f}(\\mathbf{x})/\\partial x_i\\). Matriz Hessiana – una matriz de segundas derivadas. Si \\(\\mathrm{f}(.)\\) es una función del vector \\(\\mathbf{x} = (x_1,\\ldots,x_m)^{\\prime}\\), entonces la matriz Hessiana es \\(\\partial^2 \\mathrm{f}(\\mathbf{x})/\\partial \\mathbf{x}\\partial \\mathbf{x}^{\\prime}\\). El elemento en la fila \\(i\\) y la columna \\(j\\) de la matriz Hessiana es \\(\\partial^{2}\\mathrm{f}(\\mathbf{x})/\\partial x_i\\partial x_j\\). Apéndice A3. Tablas de Probabilidad Distribución Normal Recuerde de la ecuación (1.1) que la función de densidad de probabilidad está definida por \\[ \\mathrm{f}(y) = \\frac{1}{\\sigma \\sqrt{2\\pi }}\\exp \\left( -\\frac{1}{2\\sigma^2 }\\left( y-\\mu \\right)^2\\right) \\] donde \\(\\mu\\) y \\(\\sigma^2\\) son parámetros que describen la curva. En este caso, escribimos \\(y \\sim N(\\mu,\\sigma^2)\\). Cálculos sencillos muestran que \\[ \\mathrm{E}~y = \\int_{-\\infty}^{\\infty} y \\mathrm{f}(y) \\, dy = \\int_{-\\infty}^{\\infty} y \\frac{1}{\\sigma \\sqrt{2\\pi }}\\exp \\left( -\\frac{1}{2\\sigma^2 }\\left( y-\\mu \\right)^2 \\right) \\, dy = \\mu \\] y \\[ \\mathrm{Var}~y = \\int_{-\\infty}^{\\infty} (y-\\mu)^2 \\mathrm{f}(y) \\, dy = \\int_{-\\infty}^{\\infty} (y-\\mu)^2 \\frac{1}{\\sigma \\sqrt{2\\pi }}\\exp \\left( -\\frac{1}{2\\sigma^2 }\\left( y-\\mu \\right)^2 \\right) \\, dy = \\sigma^2 . \\] Así, la notación \\(y \\sim N(\\mu,\\sigma^2)\\) se interpreta como que la variable aleatoria está distribuida normalmente con media \\(\\mu\\) y varianza \\(\\sigma^2\\). Si \\(y \\sim N(0,1)\\), entonces se dice que \\(y\\) es normal estándar. Figura 14.1: Función de densidad de probabilidad normal estándar Tabla 14.1: Función de Distribución Normal Estándar \\(y\\) 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 0 0.5000 0.5398 0.5793 0.6179 0.6554 0.6915 0.7257 0.7580 0.7881 0.8159 1 0.8413 0.8643 0.8849 0.9032 0.9192 0.9332 0.9452 0.9554 0.9641 0.9713 2 0.9772 0.9821 0.9861 0.9893 0.9918 0.9938 0.9953 0.9965 0.9974 0.9981 3 0.9987 0.9990 0.9993 0.9995 0.9997 0.9998 0.9998 0.9999 0.9999 1.0000 Notas: Las probabilidades se pueden encontrar buscando en la fila adecuada para el dígito inicial y la columna para el decimal. Por ejemplo, \\(\\Pr ( y \\le 0.1) = 0.5398\\). Distribución Chi-Cuadrado Distribución Chi-Cuadrado. Varias distribuciones importantes pueden vincularse a la distribución normal. Si \\(y_1, \\ldots, y_n\\) son variables aleatorias i.i.d. tales que cada \\(y_i \\sim N(0,1)\\), entonces se dice que \\(\\sum_{i=1}^n y_i^2\\) tiene una distribución chi-cuadrado con parámetro \\(n\\). Más generalmente, una variable aleatoria \\(w\\) con función de densidad de probabilidad \\[ \\mathrm{f}(w) = \\frac{2^{-k/2}}{\\Gamma(k/2)} w^{k/2-1} \\exp (-w/2), ~~~~~~w &gt; 0 \\] se dice que tiene una distribución chi-cuadrado con \\(df = k\\) grados de libertad, escrita como \\(w \\sim \\chi_k^2\\). Cálculos sencillos muestran que para \\(w \\sim \\chi_k^2\\), tenemos \\(\\mathrm{E}~w = k\\) y \\(\\mathrm{Var}~w = 2k\\). En general, el parámetro de grados de libertad no necesita ser un número entero, aunque lo es para las aplicaciones de este texto. Figura 14.2: Varias funciones de densidad de probabilidad chi-cuadrado. Se muestran curvas para \\(df\\) = 3, \\(df\\) = 5, y \\(df\\) = 10. Un mayor número de grados de libertad conduce a curvas que son menos asimétricas. Tabla 14.2: Percentiles de Varias Distribuciones Chi-Cuadrado \\(df\\) 0.6 0.7 0.8 0.9 0.95 0.975 0.99 0.995 0.9975 0.999 1 0.71 1.07 1.64 2.71 3.84 5.02 6.63 7.88 9.14 10.83 2 1.83 2.41 3.22 4.61 5.99 7.38 9.21 10.60 11.98 13.82 3 2.95 3.66 4.64 6.25 7.81 9.35 11.34 12.84 14.32 16.27 4 4.04 4.88 5.99 7.78 9.49 11.14 13.28 14.86 16.42 18.47 5 5.13 6.06 7.29 9.24 11.07 12.83 15.09 16.75 18.39 20.52 10 10.47 11.78 13.44 15.99 18.31 20.48 23.21 25.19 27.11 29.59 15 15.73 17.32 19.31 22.31 25.00 27.49 30.58 32.80 34.95 37.70 20 20.95 22.77 25.04 28.41 31.41 34.17 37.57 40.00 42.34 45.31 25 26.14 28.17 30.68 34.38 37.65 40.65 44.31 46.93 49.44 52.62 30 31.32 33.53 36.25 40.26 43.77 46.98 50.89 53.67 56.33 59.70 35 36.47 38.86 41.78 46.06 49.80 53.20 57.34 60.27 63.08 66.62 40 41.62 44.16 47.27 51.81 55.76 59.34 63.69 66.77 69.70 73.40 60 62.13 65.23 68.97 74.40 79.08 83.30 88.38 91.95 95.34 99.61 120 123.29 127.62 132.81 140.23 146.57 152.21 158.95 163.65 168.08 173.62 Distribución t Supongamos que \\(y\\) y \\(w\\) son independientes con \\(y \\sim N(0,1)\\) y \\(w \\sim \\chi_k^2\\). Entonces, se dice que la variable aleatoria \\(t = y / \\sqrt{w/k}\\) tiene una distribución t con \\(df = k\\) grados de libertad. La función de densidad de probabilidad es \\[ \\mathrm{f}(t) = \\frac{\\Gamma \\left( k+ \\frac{1}{2} \\right)}{\\Gamma(k/2)} \\left( k \\pi \\right)^{-1/2} \\left( 1 + \\frac{t^2}{k} \\right)^{-(k+1/2)}, ~~~~~~-\\infty &lt; t &lt; \\infty \\] Esto tiene media 0, para \\(k &gt; 1\\), y varianza \\(k/(k-2)\\) para \\(k &gt; 2\\). Figura 14.3: Varias funciones de densidad de probabilidad de la distribución t. La distribución t con \\(df = \\infty\\) es la distribución normal estándar. Se muestran curvas para \\(df = 1\\), \\(df = 5\\) (no etiquetado) y \\(df = ∞\\). Un menor \\(df\\) significa colas más gruesas. Tabla 14.3: Percentiles de varias distribuciones \\(t\\) \\(df\\) 0.6 0.7 0.8 0.9 0.95 0.975 0.99 0.995 0.9975 0.999 1 0.325 0.727 1.376 3.078 6.314 12.706 31.821 63.657 127.321 318.309 2 0.289 0.617 1.061 1.886 2.920 4.303 6.965 9.925 14.089 22.327 3 0.277 0.584 0.978 1.638 2.353 3.182 4.541 5.841 7.453 10.215 4 0.271 0.569 0.941 1.533 2.132 2.776 3.747 4.604 5.598 7.173 5 0.267 0.559 0.920 1.476 2.015 2.571 3.365 4.032 4.773 5.893 10 0.260 0.542 0.879 1.372 1.812 2.228 2.764 3.169 3.581 4.144 15 0.258 0.536 0.866 1.341 1.753 2.131 2.602 2.947 3.286 3.733 20 0.257 0.533 0.860 1.325 1.725 2.086 2.528 2.845 3.153 3.552 25 0.256 0.531 0.856 1.316 1.708 2.060 2.485 2.787 3.078 3.450 30 0.256 0.530 0.854 1.310 1.697 2.042 2.457 2.750 3.030 3.385 35 0.255 0.529 0.852 1.306 1.690 2.030 2.438 2.724 2.996 3.340 40 0.255 0.529 0.851 1.303 1.684 2.021 2.423 2.704 2.971 3.307 60 0.254 0.527 0.848 1.296 1.671 2.000 2.390 2.660 2.915 3.232 120 0.254 0.526 0.845 1.289 1.658 1.980 2.358 2.617 2.860 3.160 ∞ 0.253 0.524 0.842 1.282 1.645 1.960 2.326 2.576 2.807 3.090 Distribución F Supongamos que \\(w_1\\) y \\(w_2\\) son independientes con distribuciones \\(w_1 \\sim \\chi_m^2\\) y \\(w_2 \\sim \\chi_n^2\\). Entonces, la variable aleatoria \\(F = (w_1/m) / (w_2/n)\\) tiene una distribución F con parámetros \\(df_1 = m\\) y \\(df_2 = n\\), respectivamente. La función de densidad de probabilidad es \\[ \\mathrm{f}(y) = \\frac{\\Gamma \\left(\\frac{m+n}{2} \\right)}{\\Gamma(m/2)\\Gamma(n/2)} \\left( \\frac{m}{n} \\right)^{m/2} \\frac{y^{(m-2)/2}} {\\left( 1 + \\frac{m}{n}y \\right)^{m+n+2}} , ~~~~~~y &gt; 0 \\] Esto tiene media \\(n/(n-2)\\), para \\(n &gt; 2\\), y varianza \\(2n^2(m+n-2)/[m(n-2)^2(n-4)]\\) para \\(n &gt; 4\\). Figura 14.4: Varias funciones de densidad de probabilidad de la distribución \\(F\\). Se muestran curvas para (i) \\(df_1\\) = 1, \\(df_2\\) = 5, (ii) \\(df_1\\) = 5, \\(df_2\\) = 1 (no etiquetado), y (iii) \\(df_1\\) = 60, \\(df_2\\) = 60. A medida que \\(df_2\\) tiende a \\(\\infty\\), la distribución \\(F\\) tiende a una distribución chi-cuadrado. Tabla 14.4: Percentiles de varias distribuciones \\(F\\) \\(df_1\\) 1 3 5 10 20 30 40 60 120 1 161.45 10.13 6.61 4.96 4.35 4.17 4.08 4.00 3.92 2 199.50 9.55 5.79 4.10 3.49 3.32 3.23 3.15 3.07 3 215.71 9.28 5.41 3.71 3.10 2.92 2.84 2.76 2.68 4 224.58 9.12 5.19 3.48 2.87 2.69 2.61 2.53 2.45 5 230.16 9.01 5.05 3.33 2.71 2.53 2.45 2.37 2.29 10 241.88 8.79 4.74 2.98 2.35 2.16 2.08 1.99 1.91 15 245.95 8.70 4.62 2.85 2.20 2.01 1.92 1.84 1.75 20 248.01 8.66 4.56 2.77 2.12 1.93 1.84 1.75 1.66 25 249.26 8.63 4.52 2.73 2.07 1.88 1.78 1.69 1.60 30 250.10 8.62 4.50 2.70 2.04 1.84 1.74 1.65 1.55 35 250.69 8.60 4.48 2.68 2.01 1.81 1.72 1.62 1.52 40 251.14 8.59 4.46 2.66 1.99 1.79 1.69 1.59 1.50 60 252.20 8.57 4.43 2.62 1.95 1.74 1.64 1.53 1.43 120 253.25 8.55 4.40 2.58 1.90 1.68 1.58 1.47 1.35 "],["bibliography.html", "Bibliography", " Bibliography "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
